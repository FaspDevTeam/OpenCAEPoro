<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenCAEPoro: MixtureComp Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="OCPLogo.png"/></td>
  <td id="projectalign">
   <div id="projectname">OpenCAEPoro<span id="projectnumber">&#160;0.1.8 Sep/22/2022</span>
   </div>
   <div id="projectbrief">A simulator for multicomponent porous media flow</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classMixtureComp-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">MixtureComp Class Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for MixtureComp:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classMixtureComp.png" usemap="#MixtureComp_map" alt=""/>
  <map id="MixtureComp_map" name="MixtureComp_map">
<area href="classMixture.html" alt="Mixture" shape="rect" coords="0,0,86,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aab79a234af33bcd0af7c892ef2a4389d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#aab79a234af33bcd0af7c892ef2a4389d">GetErrorPEC</a> () override</td></tr>
<tr class="separator:aab79a234af33bcd0af7c892ef2a4389d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae0fdd993eabded8f675ce17dfa8aa36"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#af7bad630928e2d245f39e3dc63ab3d93">OCP_ULL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#aae0fdd993eabded8f675ce17dfa8aa36">GetSSMSTAiters</a> () override</td></tr>
<tr class="separator:aae0fdd993eabded8f675ce17dfa8aa36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4820f19bab85674e0e0e3a049d48d451"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#af7bad630928e2d245f39e3dc63ab3d93">OCP_ULL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a4820f19bab85674e0e0e3a049d48d451">GetNRSTAiters</a> () override</td></tr>
<tr class="separator:a4820f19bab85674e0e0e3a049d48d451"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf1ac0ad6a024d267c5f0b9e646641b4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#af7bad630928e2d245f39e3dc63ab3d93">OCP_ULL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#adf1ac0ad6a024d267c5f0b9e646641b4">GetSSMSPiters</a> () override</td></tr>
<tr class="separator:adf1ac0ad6a024d267c5f0b9e646641b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85c6f061fd1afad9d7d6b7a5d8d91fc1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#af7bad630928e2d245f39e3dc63ab3d93">OCP_ULL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a85c6f061fd1afad9d7d6b7a5d8d91fc1">GetNRSPiters</a> () override</td></tr>
<tr class="separator:a85c6f061fd1afad9d7d6b7a5d8d91fc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af080189da9d935e1bd77264f20980a5c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#af080189da9d935e1bd77264f20980a5c">MixtureComp</a> (const <a class="el" href="classParamReservoir.html">ParamReservoir</a> &amp;rs_param, const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;i)</td></tr>
<tr class="separator:af080189da9d935e1bd77264f20980a5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7672ff008a1e0f3e95ca2d121e5b3d70"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a7672ff008a1e0f3e95ca2d121e5b3d70">MixtureComp</a> (const <a class="el" href="classEoSparam.html">EoSparam</a> &amp;param, const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;i)</td></tr>
<tr class="separator:a7672ff008a1e0f3e95ca2d121e5b3d70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b72cc6b06566e239085d0ca4bbc4606"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a8b72cc6b06566e239085d0ca4bbc4606">InitFlash</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pbbin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Tin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *Sjin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Vpore, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *Ziin) override</td></tr>
<tr class="memdesc:a8b72cc6b06566e239085d0ca4bbc4606"><td class="mdescLeft">&#160;</td><td class="mdescRight">flash calculation with saturation of phases.  <a href="classMixtureComp.html#a8b72cc6b06566e239085d0ca4bbc4606">More...</a><br /></td></tr>
<tr class="separator:a8b72cc6b06566e239085d0ca4bbc4606"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8db092535e37713c2f2b90002edc5dda"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a8db092535e37713c2f2b90002edc5dda">Flash</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Tin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *Niin, const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;ftype, const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;lastNP, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *lastKs) override</td></tr>
<tr class="memdesc:a8db092535e37713c2f2b90002edc5dda"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flash calculation with moles of components.  <a href="classMixtureComp.html#a8db092535e37713c2f2b90002edc5dda">More...</a><br /></td></tr>
<tr class="separator:a8db092535e37713c2f2b90002edc5dda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee4085190c90fb9e76260cbe032425bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#aee4085190c90fb9e76260cbe032425bd">CalFlash</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Tin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *Niin)</td></tr>
<tr class="separator:aee4085190c90fb9e76260cbe032425bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ceb9b4dc6753763425bb5c52249a1ac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a2ceb9b4dc6753763425bb5c52249a1ac">FlashDeriv</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Tin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *Niin, const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;ftype, const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;lastNP, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *lastKs) override</td></tr>
<tr class="memdesc:a2ceb9b4dc6753763425bb5c52249a1ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flash calculation with moles of components and Calculate the derivative.  <a href="classMixtureComp.html#a2ceb9b4dc6753763425bb5c52249a1ac">More...</a><br /></td></tr>
<tr class="separator:a2ceb9b4dc6753763425bb5c52249a1ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec54b4c31ae55907ffd7449e63f38eac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#aec54b4c31ae55907ffd7449e63f38eac">FlashDeriv_n</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Tin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *Niin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *Sjin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *xijin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *njin, const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;ftype, const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> *phaseExistin, const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;lastNP, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *lastKs) override</td></tr>
<tr class="separator:aec54b4c31ae55907ffd7449e63f38eac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5be09d1c319768b761bcf6427bc8535"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#ad5be09d1c319768b761bcf6427bc8535">XiPhase</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Tin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *Ziin) override</td></tr>
<tr class="separator:ad5be09d1c319768b761bcf6427bc8535"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbd472704ecf3f04ffe35316fbbf5ccf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#adbd472704ecf3f04ffe35316fbbf5ccf">RhoPhase</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Tin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *Ziin) override</td></tr>
<tr class="memdesc:adbd472704ecf3f04ffe35316fbbf5ccf"><td class="mdescLeft">&#160;</td><td class="mdescRight">return mass density of phase.  <a href="classMixtureComp.html#adbd472704ecf3f04ffe35316fbbf5ccf">More...</a><br /></td></tr>
<tr class="separator:adbd472704ecf3f04ffe35316fbbf5ccf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a405999f154866821f3513f596d77a6fa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a405999f154866821f3513f596d77a6fa">GammaPhaseO</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pbbin) override</td></tr>
<tr class="memdesc:a405999f154866821f3513f596d77a6fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">return gamma of oil phase, gamma equals to mass density times gravity factor.  <a href="classMixtureComp.html#a405999f154866821f3513f596d77a6fa">More...</a><br /></td></tr>
<tr class="separator:a405999f154866821f3513f596d77a6fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a9f34f9f35c5ac14421e2345daa1d4d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a3a9f34f9f35c5ac14421e2345daa1d4d">GammaPhaseG</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pin) override</td></tr>
<tr class="memdesc:a3a9f34f9f35c5ac14421e2345daa1d4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">return gamma of gas phase, gamma equals to mass density times gravity factor.  <a href="classMixtureComp.html#a3a9f34f9f35c5ac14421e2345daa1d4d">More...</a><br /></td></tr>
<tr class="separator:a3a9f34f9f35c5ac14421e2345daa1d4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f208b3dbcf938c2512cbb420c7797bb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a5f208b3dbcf938c2512cbb420c7797bb">GammaPhaseW</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pin) override</td></tr>
<tr class="memdesc:a5f208b3dbcf938c2512cbb420c7797bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">return gamma of water phase, gamma equals to mass density times gravity factor.  <a href="classMixtureComp.html#a5f208b3dbcf938c2512cbb420c7797bb">More...</a><br /></td></tr>
<tr class="separator:a5f208b3dbcf938c2512cbb420c7797bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6569e8518d8579046e2633298181b44"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#ab6569e8518d8579046e2633298181b44">GammaPhaseOG</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Tin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *Ziin) override</td></tr>
<tr class="separator:ab6569e8518d8579046e2633298181b44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55e004ef7b183f9c7f580634a922666f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a55e004ef7b183f9c7f580634a922666f">setPT</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;p, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;t)</td></tr>
<tr class="separator:a55e004ef7b183f9c7f580634a922666f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47ffdba69ad801ebb6d85d9661fb6adb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a47ffdba69ad801ebb6d85d9661fb6adb">setZi</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *Ziin)</td></tr>
<tr class="separator:a47ffdba69ad801ebb6d85d9661fb6adb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30d1201549ef269c47017f5d7b31784b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a30d1201549ef269c47017f5d7b31784b">setZi</a> ()</td></tr>
<tr class="separator:a30d1201549ef269c47017f5d7b31784b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a373e381d48f04a4858928bde2103073a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a373e381d48f04a4858928bde2103073a">setNi</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *Niin)</td></tr>
<tr class="separator:a373e381d48f04a4858928bde2103073a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0646e3d17992d15941ea82153f0581ca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a0646e3d17992d15941ea82153f0581ca">CallId</a> ()</td></tr>
<tr class="separator:a0646e3d17992d15941ea82153f0581ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea695edd604aa0523a6d2cccbefc9b87"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#aea695edd604aa0523a6d2cccbefc9b87">GetFtype</a> () override</td></tr>
<tr class="separator:aea695edd604aa0523a6d2cccbefc9b87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf9c119f2fdb861763b6577f0be49d79"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#aaf9c119f2fdb861763b6577f0be49d79">CalSurfaceTension</a> ()</td></tr>
<tr class="separator:aaf9c119f2fdb861763b6577f0be49d79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5be5e6f2901bd71ff9103fc50a473cd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#af5be5e6f2901bd71ff9103fc50a473cd">GetSurTen</a> () override</td></tr>
<tr class="separator:af5be5e6f2901bd71ff9103fc50a473cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a496c46d32bf4d6d96f9f8f7b2ed5f445"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a496c46d32bf4d6d96f9f8f7b2ed5f445">AllocateEoS</a> ()</td></tr>
<tr class="separator:a496c46d32bf4d6d96f9f8f7b2ed5f445"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9659d58415fc4f9a20ce2b68b1b2e1c0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a9659d58415fc4f9a20ce2b68b1b2e1c0">SolEoS</a> (<a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;ZjT, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;AjT, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;BjT) const</td></tr>
<tr class="separator:a9659d58415fc4f9a20ce2b68b1b2e1c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b47df0743c6168668e73968079c3905"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a9b47df0743c6168668e73968079c3905">CalAiBi</a> ()</td></tr>
<tr class="separator:a9b47df0743c6168668e73968079c3905"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c5e169880545f9b5443f7e664d0073e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a9c5e169880545f9b5443f7e664d0073e">CalAjBj</a> (<a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;AjT, <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;BjT, const vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt; &amp;xj) const</td></tr>
<tr class="separator:a9c5e169880545f9b5443f7e664d0073e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba437bbb9722708be4a0eb9c5347822b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#aba437bbb9722708be4a0eb9c5347822b">CalAjBj</a> (<a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;AjT, <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;BjT, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *xj) const</td></tr>
<tr class="separator:aba437bbb9722708be4a0eb9c5347822b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22d627ebaf3134a25502d0c56608b721"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a22d627ebaf3134a25502d0c56608b721">CubicRoot</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;a, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;b, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;c, const bool &amp;NTflag=false) const</td></tr>
<tr class="memdesc:a22d627ebaf3134a25502d0c56608b721"><td class="mdescLeft">&#160;</td><td class="mdescRight">Result is stored in Ztmp.  <a href="classMixtureComp.html#a22d627ebaf3134a25502d0c56608b721">More...</a><br /></td></tr>
<tr class="separator:a22d627ebaf3134a25502d0c56608b721"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab870f35221c9f0fcef6b4fb0cb4cb681"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#ab870f35221c9f0fcef6b4fb0cb4cb681">PrintZtmp</a> ()</td></tr>
<tr class="memdesc:ab870f35221c9f0fcef6b4fb0cb4cb681"><td class="mdescLeft">&#160;</td><td class="mdescRight">test  <a href="classMixtureComp.html#ab870f35221c9f0fcef6b4fb0cb4cb681">More...</a><br /></td></tr>
<tr class="separator:ab870f35221c9f0fcef6b4fb0cb4cb681"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedc16a2403548e2e9887435e78526fd1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#aedc16a2403548e2e9887435e78526fd1">AllocatePhase</a> ()</td></tr>
<tr class="separator:aedc16a2403548e2e9887435e78526fd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca505498f0e30fab090ae40701504406"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#aca505498f0e30fab090ae40701504406">CalFugPhi</a> (vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt; &amp;phiT, vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt; &amp;fugT, const vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt; &amp;xj)</td></tr>
<tr class="separator:aca505498f0e30fab090ae40701504406"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2b087325e999f18ebbe772cb4b60fe3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#ae2b087325e999f18ebbe772cb4b60fe3">CalFugPhi</a> (<a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *phiT, <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *fugT, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *xj)</td></tr>
<tr class="separator:ae2b087325e999f18ebbe772cb4b60fe3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc183093d6853b068232fb49130e9875"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#abc183093d6853b068232fb49130e9875">CalFugPhi</a> (<a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *fugT, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *xj)</td></tr>
<tr class="separator:abc183093d6853b068232fb49130e9875"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a395d2a6c288d939192573fe997aacefa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a395d2a6c288d939192573fe997aacefa">CalFugPhiAll</a> ()</td></tr>
<tr class="separator:a395d2a6c288d939192573fe997aacefa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bfc2096a5dbf9d813382a60f16d46c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a9bfc2096a5dbf9d813382a60f16d46c1">CalMW</a> ()</td></tr>
<tr class="separator:a9bfc2096a5dbf9d813382a60f16d46c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eb5d509caa1f2addcdc49458f6badd1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a7eb5d509caa1f2addcdc49458f6badd1">CalVfXiRho</a> ()</td></tr>
<tr class="separator:a7eb5d509caa1f2addcdc49458f6badd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4336e1a8a5051b6031e7ccc5fdda9a1a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a4336e1a8a5051b6031e7ccc5fdda9a1a">CalSaturation</a> ()</td></tr>
<tr class="separator:a4336e1a8a5051b6031e7ccc5fdda9a1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a063814d8e2fe4657c3147b0f0fe26d45"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a063814d8e2fe4657c3147b0f0fe26d45">FindMWmax</a> ()</td></tr>
<tr class="separator:a063814d8e2fe4657c3147b0f0fe26d45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3de24acaa27101e5dfe6f6b47946fe1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#af3de24acaa27101e5dfe6f6b47946fe1">x2n</a> ()</td></tr>
<tr class="memdesc:af3de24acaa27101e5dfe6f6b47946fe1"><td class="mdescLeft">&#160;</td><td class="mdescRight">x[j][i] -&gt; n[j][i]  <a href="classMixtureComp.html#af3de24acaa27101e5dfe6f6b47946fe1">More...</a><br /></td></tr>
<tr class="separator:af3de24acaa27101e5dfe6f6b47946fe1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace7524402082e123b33e7eff650a13dc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#ace7524402082e123b33e7eff650a13dc">PrintX</a> ()</td></tr>
<tr class="separator:ace7524402082e123b33e7eff650a13dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76e85d017d79f90f730876dfb5346357"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a76e85d017d79f90f730876dfb5346357">AllocateMethod</a> ()</td></tr>
<tr class="separator:a76e85d017d79f90f730876dfb5346357"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2740a0dd827b57af17e7b3f7888ccfde"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a2740a0dd827b57af17e7b3f7888ccfde">PhaseEquilibrium</a> ()</td></tr>
<tr class="separator:a2740a0dd827b57af17e7b3f7888ccfde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8152173955656f8dcb8553a8b556379d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a8152173955656f8dcb8553a8b556379d">CalKwilson</a> ()</td></tr>
<tr class="separator:a8152173955656f8dcb8553a8b556379d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3278e9ca799f6810324d2566d1c3e34"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#aa3278e9ca799f6810324d2566d1c3e34">PhaseStable</a> ()</td></tr>
<tr class="separator:aa3278e9ca799f6810324d2566d1c3e34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae28a25d1c0c5a2190a5962a82a10a28d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#ae28a25d1c0c5a2190a5962a82a10a28d">StableSSM</a> (const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;Id)</td></tr>
<tr class="memdesc:ae28a25d1c0c5a2190a5962a82a10a28d"><td class="mdescLeft">&#160;</td><td class="mdescRight">strict SSM  <a href="classMixtureComp.html#ae28a25d1c0c5a2190a5962a82a10a28d">More...</a><br /></td></tr>
<tr class="separator:ae28a25d1c0c5a2190a5962a82a10a28d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16d6930ae2115d9dfc3f627580cd3605"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a16d6930ae2115d9dfc3f627580cd3605">StableSSM01</a> (const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;Id)</td></tr>
<tr class="memdesc:a16d6930ae2115d9dfc3f627580cd3605"><td class="mdescLeft">&#160;</td><td class="mdescRight">relaxable SSM  <a href="classMixtureComp.html#a16d6930ae2115d9dfc3f627580cd3605">More...</a><br /></td></tr>
<tr class="separator:a16d6930ae2115d9dfc3f627580cd3605"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba425d5d3810cbc5638fe003986e6253"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#aba425d5d3810cbc5638fe003986e6253">StableNR</a> (const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;Id)</td></tr>
<tr class="separator:aba425d5d3810cbc5638fe003986e6253"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d21c453b68aa83741dd4778ae53dbb1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a5d21c453b68aa83741dd4778ae53dbb1">CalFugXSTA</a> ()</td></tr>
<tr class="memdesc:a5d21c453b68aa83741dd4778ae53dbb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate d ln(Fug) / dx for Y.  <a href="classMixtureComp.html#a5d21c453b68aa83741dd4778ae53dbb1">More...</a><br /></td></tr>
<tr class="separator:a5d21c453b68aa83741dd4778ae53dbb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46d5104d01845446c66f5829902dfc4b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a46d5104d01845446c66f5829902dfc4b">AssembleJmatSTA</a> ()</td></tr>
<tr class="separator:a46d5104d01845446c66f5829902dfc4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c0a25c3ddd47886b80a10e5eef7a37d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a3c0a25c3ddd47886b80a10e5eef7a37d">CheckSplit</a> ()</td></tr>
<tr class="separator:a3c0a25c3ddd47886b80a10e5eef7a37d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a409ea8976c8718296c0f9c467aa13393"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a409ea8976c8718296c0f9c467aa13393">PhaseSplit</a> ()</td></tr>
<tr class="separator:a409ea8976c8718296c0f9c467aa13393"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0da9418aca89bdcb2b7d2f970e5d55f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a0da9418aca89bdcb2b7d2f970e5d55f8">SplitSSM</a> (const bool &amp;flag)</td></tr>
<tr class="separator:a0da9418aca89bdcb2b7d2f970e5d55f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb268ce8d569ce5843ddb06d0c1ab27c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#afb268ce8d569ce5843ddb06d0c1ab27c">SplitSSM2</a> (const bool &amp;flag)</td></tr>
<tr class="separator:afb268ce8d569ce5843ddb06d0c1ab27c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa5ae3cc677230b038d14baa225374eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#aaa5ae3cc677230b038d14baa225374eb">SplitSSM3</a> (const bool &amp;flag)</td></tr>
<tr class="separator:aaa5ae3cc677230b038d14baa225374eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6ca68ebdd84c48a7d0c4544bc9d698a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#ab6ca68ebdd84c48a7d0c4544bc9d698a">RachfordRice2</a> ()</td></tr>
<tr class="memdesc:ab6ca68ebdd84c48a7d0c4544bc9d698a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used when NP = 2.  <a href="classMixtureComp.html#ab6ca68ebdd84c48a7d0c4544bc9d698a">More...</a><br /></td></tr>
<tr class="separator:ab6ca68ebdd84c48a7d0c4544bc9d698a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34670e4fb36f3506687915321e3f175a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a34670e4fb36f3506687915321e3f175a">RachfordRice3</a> ()</td></tr>
<tr class="memdesc:a34670e4fb36f3506687915321e3f175a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used when NP &gt; 2.  <a href="classMixtureComp.html#a34670e4fb36f3506687915321e3f175a">More...</a><br /></td></tr>
<tr class="separator:a34670e4fb36f3506687915321e3f175a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c06637490fc903d9a0bd12c053b93b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a9c06637490fc903d9a0bd12c053b93b8">UpdateXRR</a> ()</td></tr>
<tr class="memdesc:a9c06637490fc903d9a0bd12c053b93b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update X according to RR.  <a href="classMixtureComp.html#a9c06637490fc903d9a0bd12c053b93b8">More...</a><br /></td></tr>
<tr class="separator:a9c06637490fc903d9a0bd12c053b93b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af444be2fa5d53e165cfedfb20490f9e9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#af444be2fa5d53e165cfedfb20490f9e9">SplitNR</a> ()</td></tr>
<tr class="separator:af444be2fa5d53e165cfedfb20490f9e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9305f861f0d2da9313b92113bc6fba6a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a9305f861f0d2da9313b92113bc6fba6a">CalResSP</a> ()</td></tr>
<tr class="separator:a9305f861f0d2da9313b92113bc6fba6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6e8ea10ee7ec790969a57d8a327ec22"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#ae6e8ea10ee7ec790969a57d8a327ec22">CalFugNAll</a> (const bool &amp;Znflag=true)</td></tr>
<tr class="separator:ae6e8ea10ee7ec790969a57d8a327ec22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab69c6a23d5c813b02d8393838a1b74ab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#ab69c6a23d5c813b02d8393838a1b74ab">PrintFugN</a> ()</td></tr>
<tr class="separator:ab69c6a23d5c813b02d8393838a1b74ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a640d65f99a2486920c6a6d351b1b3163"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a640d65f99a2486920c6a6d351b1b3163">AssembleJmatSP</a> ()</td></tr>
<tr class="separator:a640d65f99a2486920c6a6d351b1b3163"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bc05dc7dba2aa52761afe81bd033a26"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a3bc05dc7dba2aa52761afe81bd033a26">CalPhiNSTA</a> ()</td></tr>
<tr class="memdesc:a3bc05dc7dba2aa52761afe81bd033a26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate d ln phi[i][j] / d n[k][j].  <a href="classMixtureComp.html#a3bc05dc7dba2aa52761afe81bd033a26">More...</a><br /></td></tr>
<tr class="separator:a3bc05dc7dba2aa52761afe81bd033a26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dd49e118650f4472cffa4e6792c391f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a3dd49e118650f4472cffa4e6792c391f">AssembleSkipMatSTA</a> ()</td></tr>
<tr class="separator:a3dd49e118650f4472cffa4e6792c391f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c1a1bca3039abf054eda4cbf11c77be"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a0c1a1bca3039abf054eda4cbf11c77be">CalStepNRsp</a> ()</td></tr>
<tr class="separator:a0c1a1bca3039abf054eda4cbf11c77be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a985a745b95690525a2d6e4462cf60c39"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a4cf987f6993b48c88ec4970ad351b100">OCP_SIN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a985a745b95690525a2d6e4462cf60c39">GetMinEigenSkip</a> () override</td></tr>
<tr class="separator:a985a745b95690525a2d6e4462cf60c39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeefcb156305678f735a32db2d9f31900"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#aeefcb156305678f735a32db2d9f31900">GetFlagSkip</a> () override</td></tr>
<tr class="separator:aeefcb156305678f735a32db2d9f31900"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a027988c9dedc60083b1a0e5a717a2d00"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a027988c9dedc60083b1a0e5a717a2d00">AllocateOthers</a> ()</td></tr>
<tr class="separator:a027988c9dedc60083b1a0e5a717a2d00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ff5eb07a2ed632bb5e9d37f79cc5314"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a1ff5eb07a2ed632bb5e9d37f79cc5314">IdentifyPhase</a> ()</td></tr>
<tr class="separator:a1ff5eb07a2ed632bb5e9d37f79cc5314"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04a0d98d3277d79d1403dff71ba21fd5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a04a0d98d3277d79d1403dff71ba21fd5">CopyPhase</a> ()</td></tr>
<tr class="memdesc:a04a0d98d3277d79d1403dff71ba21fd5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy the basic properties from <a class="el" href="classMixtureComp.html">MixtureComp</a> to <a class="el" href="classMixture.html">Mixture</a>.  <a href="classMixtureComp.html#a04a0d98d3277d79d1403dff71ba21fd5">More...</a><br /></td></tr>
<tr class="separator:a04a0d98d3277d79d1403dff71ba21fd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0afbf9d388e1cb3c083425241d544c1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a0afbf9d388e1cb3c083425241d544c1e">CalViscosity</a> ()</td></tr>
<tr class="separator:a0afbf9d388e1cb3c083425241d544c1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8284d308859a96e688dda9dd062eb01a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a8284d308859a96e688dda9dd062eb01a">CalViscoLBC</a> ()</td></tr>
<tr class="separator:a8284d308859a96e688dda9dd062eb01a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a390579d6774a59017d35cf5598d6fff9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a390579d6774a59017d35cf5598d6fff9">CalViscoHZYT</a> ()</td></tr>
<tr class="separator:a390579d6774a59017d35cf5598d6fff9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2079290edef7fae31b859cad26a259e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a2079290edef7fae31b859cad26a259e5">CalFugXAll</a> ()</td></tr>
<tr class="separator:a2079290edef7fae31b859cad26a259e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6604988c8a20ac550b7074c42519a7e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#ac6604988c8a20ac550b7074c42519a7e">CalFugPAll</a> (const bool &amp;Zpflag=true)</td></tr>
<tr class="separator:ac6604988c8a20ac550b7074c42519a7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92eb12c7dea79d828ca9509e3b74dad9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a92eb12c7dea79d828ca9509e3b74dad9">CalVjpVfpVfx_partial</a> ()</td></tr>
<tr class="separator:a92eb12c7dea79d828ca9509e3b74dad9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aede2f5ff82886ab8c4eaa50cae38db58"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#aede2f5ff82886ab8c4eaa50cae38db58">CalXiPNX_partial</a> ()</td></tr>
<tr class="separator:aede2f5ff82886ab8c4eaa50cae38db58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20b38142c7c8a72a559ce378bbdbd7bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a20b38142c7c8a72a559ce378bbdbd7bf">CalRhoPX_partial</a> ()</td></tr>
<tr class="separator:a20b38142c7c8a72a559ce378bbdbd7bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1d23e53eb9495234ece1ebb10b2bfb0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#ab1d23e53eb9495234ece1ebb10b2bfb0">CalMuPX_partial</a> ()</td></tr>
<tr class="separator:ab1d23e53eb9495234ece1ebb10b2bfb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7725f788ea20a8bce074225b2c4ff5e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#ae7725f788ea20a8bce074225b2c4ff5e">CalMuPXLBC_partial</a> ()</td></tr>
<tr class="separator:ae7725f788ea20a8bce074225b2c4ff5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b99df6280ef508b3235a2c26eb82786"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a6b99df6280ef508b3235a2c26eb82786">CalXiRhoMuPN_pfullx</a> ()</td></tr>
<tr class="separator:a6b99df6280ef508b3235a2c26eb82786"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab311195bc18414e89a5920a954e666d9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#ab311195bc18414e89a5920a954e666d9">CaldXsdXpAPI04</a> ()</td></tr>
<tr class="separator:ab311195bc18414e89a5920a954e666d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0daaaeb530bf08cf4bc3e3c636b40598"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a0daaaeb530bf08cf4bc3e3c636b40598">CaldXsdXp04</a> ()</td></tr>
<tr class="separator:a0daaaeb530bf08cf4bc3e3c636b40598"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5117679ee95b8f6f7249ca68eb27a40d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a5117679ee95b8f6f7249ca68eb27a40d">CalRhoPNX_full</a> ()</td></tr>
<tr class="separator:a5117679ee95b8f6f7249ca68eb27a40d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c26de0e39d9d43eec4802584716949c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a1c26de0e39d9d43eec4802584716949c">CalXiPNX_full01</a> ()</td></tr>
<tr class="separator:a1c26de0e39d9d43eec4802584716949c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8479f5bf57a96798edf3f43f177b6a68"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a8479f5bf57a96798edf3f43f177b6a68">CalRhoPNX_full01</a> ()</td></tr>
<tr class="separator:a8479f5bf57a96798edf3f43f177b6a68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a047adebf53621e07b094577d4602845f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a047adebf53621e07b094577d4602845f">CalMuPX_full01</a> ()</td></tr>
<tr class="separator:a047adebf53621e07b094577d4602845f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecc1c0421ddc7a1f278c8f1cb6cfadca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#aecc1c0421ddc7a1f278c8f1cb6cfadca">CalMuPXLBC_full01</a> ()</td></tr>
<tr class="separator:aecc1c0421ddc7a1f278c8f1cb6cfadca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4102e505fed09c22992bb396e374fc1b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a4102e505fed09c22992bb396e374fc1b">CalVfiVfp_full01</a> ()</td></tr>
<tr class="separator:a4102e505fed09c22992bb396e374fc1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64097813d71ccb9956776c2f90134868"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a64097813d71ccb9956776c2f90134868">AssembleMatVfiVfp_full01</a> ()</td></tr>
<tr class="separator:a64097813d71ccb9956776c2f90134868"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fcbf792581a6948b80bda3c44fd91e6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a2fcbf792581a6948b80bda3c44fd91e6">AssembleRhsVfiVfp_full01</a> ()</td></tr>
<tr class="separator:a2fcbf792581a6948b80bda3c44fd91e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17f7fcd72f74d0f4d4d55fd43bb7ada5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a17f7fcd72f74d0f4d4d55fd43bb7ada5">CaldXsdXp01</a> ()</td></tr>
<tr class="separator:a17f7fcd72f74d0f4d4d55fd43bb7ada5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc3c918dc9130bc37733353454ffdfc1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#acc3c918dc9130bc37733353454ffdfc1">CaldXsdXpAPI01</a> ()</td></tr>
<tr class="separator:acc3c918dc9130bc37733353454ffdfc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae61259c59afd5f6ef26031effd4edde9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#ae61259c59afd5f6ef26031effd4edde9">CalXiPNX_full02</a> ()</td></tr>
<tr class="separator:ae61259c59afd5f6ef26031effd4edde9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af60440b9460dc6b5869cad5073ee2f1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#af60440b9460dc6b5869cad5073ee2f1e">CalVfiVfp_full02</a> ()</td></tr>
<tr class="separator:af60440b9460dc6b5869cad5073ee2f1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abedeb45e0c308d0c0d40ed743386dae5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#abedeb45e0c308d0c0d40ed743386dae5">AssembleMatVfiVfp_full02</a> ()</td></tr>
<tr class="separator:abedeb45e0c308d0c0d40ed743386dae5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add42fde1eeb1627d96941d0b403a7156"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#add42fde1eeb1627d96941d0b403a7156">AssembleRhsVfiVfp_full02</a> ()</td></tr>
<tr class="separator:add42fde1eeb1627d96941d0b403a7156"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3c4aa2542bbaf9457b9c6cffd9280b0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#af3c4aa2542bbaf9457b9c6cffd9280b0">CaldXsdXpAPI02</a> ()</td></tr>
<tr class="separator:af3c4aa2542bbaf9457b9c6cffd9280b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1247d1fb3678ac56310ce3903adb59fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a1247d1fb3678ac56310ce3903adb59fd">CaldXsdXpAPI02p</a> ()</td></tr>
<tr class="separator:a1247d1fb3678ac56310ce3903adb59fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab263d25ffebf757a675a0c5f1618d8eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#ab263d25ffebf757a675a0c5f1618d8eb">CalVjpVfpVfn_partial</a> ()</td></tr>
<tr class="separator:ab263d25ffebf757a675a0c5f1618d8eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b13597e186e95f3a6d04e9ec66c5be4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a5b13597e186e95f3a6d04e9ec66c5be4">CalXiPn_partial</a> ()</td></tr>
<tr class="separator:a5b13597e186e95f3a6d04e9ec66c5be4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe3177be549a25a5f58cba7bf0f93570"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#abe3177be549a25a5f58cba7bf0f93570">CalRhoPn_partial</a> ()</td></tr>
<tr class="separator:abe3177be549a25a5f58cba7bf0f93570"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0600fcf66e345cfe09a5a25f3cc3f1ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a0600fcf66e345cfe09a5a25f3cc3f1ef">CalMuPn_partial</a> ()</td></tr>
<tr class="separator:a0600fcf66e345cfe09a5a25f3cc3f1ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75f4f76d912c685293d7b9bb832f0205"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a75f4f76d912c685293d7b9bb832f0205">CalMuPnLBC_partial</a> ()</td></tr>
<tr class="separator:a75f4f76d912c685293d7b9bb832f0205"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a927078c03d7e4ce30dbe7d18bf162e11"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a927078c03d7e4ce30dbe7d18bf162e11">CalXiRhoMuPN_pfullxn</a> (const bool &amp;xflag=true)</td></tr>
<tr class="separator:a927078c03d7e4ce30dbe7d18bf162e11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa7d8e0920be4128fa6c6cf5fb01442a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#afa7d8e0920be4128fa6c6cf5fb01442a">CaldXsdXpAPI03</a> ()</td></tr>
<tr class="separator:afa7d8e0920be4128fa6c6cf5fb01442a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59d27f5908fc283823162fb3bcf58f6c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a59d27f5908fc283823162fb3bcf58f6c">CaldXsdXp03</a> ()</td></tr>
<tr class="separator:a59d27f5908fc283823162fb3bcf58f6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3aaa2777134d609ce1199d47ed8a642"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#ad3aaa2777134d609ce1199d47ed8a642">CalVfiVfp_full03</a> ()</td></tr>
<tr class="separator:ad3aaa2777134d609ce1199d47ed8a642"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0d0999fd19e0591de65bd95a5418893"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#ae0d0999fd19e0591de65bd95a5418893">CalKeyDerx</a> ()</td></tr>
<tr class="separator:ae0d0999fd19e0591de65bd95a5418893"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a219ceb9357f6b962932a932f8445464d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixtureComp.html#a219ceb9357f6b962932a932f8445464d">CalKeyDern</a> ()</td></tr>
<tr class="separator:a219ceb9357f6b962932a932f8445464d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classMixture"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classMixture')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classMixture.html">Mixture</a></td></tr>
<tr class="memitem:af9cd3ebf3d96509594d15bc1891ad801 inherit pub_methods_classMixture"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#af9cd3ebf3d96509594d15bc1891ad801">Allocate</a> ()</td></tr>
<tr class="memdesc:af9cd3ebf3d96509594d15bc1891ad801 inherit pub_methods_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate memory for common variables for basic class.  <a href="classMixture.html#af9cd3ebf3d96509594d15bc1891ad801">More...</a><br /></td></tr>
<tr class="separator:af9cd3ebf3d96509594d15bc1891ad801 inherit pub_methods_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1cc670487cbc5f7e7e90ed086911780 inherit pub_methods_classMixture"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#af1cc670487cbc5f7e7e90ed086911780">SetPVTW</a> ()</td></tr>
<tr class="separator:af1cc670487cbc5f7e7e90ed086911780 inherit pub_methods_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb753547a2e6c1d098e2a3fde0b8a9ad inherit pub_methods_classMixture"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#adb753547a2e6c1d098e2a3fde0b8a9ad">GetType</a> () const</td></tr>
<tr class="memdesc:adb753547a2e6c1d098e2a3fde0b8a9ad inherit pub_methods_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">return type of mixture.  <a href="classMixture.html#adb753547a2e6c1d098e2a3fde0b8a9ad">More...</a><br /></td></tr>
<tr class="separator:adb753547a2e6c1d098e2a3fde0b8a9ad inherit pub_methods_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab489a57e4a8a95a8b4f50975ee177d7f inherit pub_methods_classMixture"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#ab489a57e4a8a95a8b4f50975ee177d7f">IsEmpty_PVDG</a> () const</td></tr>
<tr class="memdesc:ab489a57e4a8a95a8b4f50975ee177d7f inherit pub_methods_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether Table PVDG is empty, it will only be used in black oil model.  <a href="classMixture.html#ab489a57e4a8a95a8b4f50975ee177d7f">More...</a><br /></td></tr>
<tr class="separator:ab489a57e4a8a95a8b4f50975ee177d7f inherit pub_methods_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35f1e56ebe2fa3275c508ac6ebf86cba inherit pub_methods_classMixture"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a35f1e56ebe2fa3275c508ac6ebf86cba">InitFlash</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pbbin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Tin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *Sjin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Vpore, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *Ziin)=0</td></tr>
<tr class="memdesc:a35f1e56ebe2fa3275c508ac6ebf86cba inherit pub_methods_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">flash calculation with saturation of phases.  <a href="classMixture.html#a35f1e56ebe2fa3275c508ac6ebf86cba">More...</a><br /></td></tr>
<tr class="separator:a35f1e56ebe2fa3275c508ac6ebf86cba inherit pub_methods_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a371b85cd655c15088e1a82cf89db059d inherit pub_methods_classMixture"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a371b85cd655c15088e1a82cf89db059d">Flash</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Tin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *Niin, const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;ftype, const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;lastNP, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *lastKs)=0</td></tr>
<tr class="memdesc:a371b85cd655c15088e1a82cf89db059d inherit pub_methods_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flash calculation with moles of components.  <a href="classMixture.html#a371b85cd655c15088e1a82cf89db059d">More...</a><br /></td></tr>
<tr class="separator:a371b85cd655c15088e1a82cf89db059d inherit pub_methods_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d5ffc780d16baf60a3bafaa971abf87 inherit pub_methods_classMixture"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a8d5ffc780d16baf60a3bafaa971abf87">FlashDeriv</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Tin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *Niin, const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;ftype, const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;lastNP, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *lastKs)=0</td></tr>
<tr class="memdesc:a8d5ffc780d16baf60a3bafaa971abf87 inherit pub_methods_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flash calculation with moles of components and Calculate the derivative.  <a href="classMixture.html#a8d5ffc780d16baf60a3bafaa971abf87">More...</a><br /></td></tr>
<tr class="separator:a8d5ffc780d16baf60a3bafaa971abf87 inherit pub_methods_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ad6f03ad8524049546a6d35f8fd7376 inherit pub_methods_classMixture"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a9ad6f03ad8524049546a6d35f8fd7376">FlashDeriv_n</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Tin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *Niin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *Sjin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *xijin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *njin, const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;ftype, const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> *phaseExistin, const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;lastNP, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *lastKs)=0</td></tr>
<tr class="separator:a9ad6f03ad8524049546a6d35f8fd7376 inherit pub_methods_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac4ca8c6f7eeddb4b51ef075f49ec6bb inherit pub_methods_classMixture"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#aac4ca8c6f7eeddb4b51ef075f49ec6bb">XiPhase</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Tin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *Ziin)=0</td></tr>
<tr class="separator:aac4ca8c6f7eeddb4b51ef075f49ec6bb inherit pub_methods_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf1be0ad34ced8062a5d4da2deb54d8e inherit pub_methods_classMixture"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#adf1be0ad34ced8062a5d4da2deb54d8e">RhoPhase</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Tin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *Ziin)=0</td></tr>
<tr class="memdesc:adf1be0ad34ced8062a5d4da2deb54d8e inherit pub_methods_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">return mass density of phase.  <a href="classMixture.html#adf1be0ad34ced8062a5d4da2deb54d8e">More...</a><br /></td></tr>
<tr class="separator:adf1be0ad34ced8062a5d4da2deb54d8e inherit pub_methods_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b03229a8c9a74f7cc02f7e1bc9f29bd inherit pub_methods_classMixture"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a4b03229a8c9a74f7cc02f7e1bc9f29bd">GammaPhaseO</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pbbin)=0</td></tr>
<tr class="memdesc:a4b03229a8c9a74f7cc02f7e1bc9f29bd inherit pub_methods_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">return gamma of oil phase, gamma equals to mass density times gravity factor.  <a href="classMixture.html#a4b03229a8c9a74f7cc02f7e1bc9f29bd">More...</a><br /></td></tr>
<tr class="separator:a4b03229a8c9a74f7cc02f7e1bc9f29bd inherit pub_methods_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01d078d68a0a09d1cbb7f69a92090a56 inherit pub_methods_classMixture"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a01d078d68a0a09d1cbb7f69a92090a56">GammaPhaseW</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pin)=0</td></tr>
<tr class="memdesc:a01d078d68a0a09d1cbb7f69a92090a56 inherit pub_methods_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">return gamma of water phase, gamma equals to mass density times gravity factor.  <a href="classMixture.html#a01d078d68a0a09d1cbb7f69a92090a56">More...</a><br /></td></tr>
<tr class="separator:a01d078d68a0a09d1cbb7f69a92090a56 inherit pub_methods_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9de9ed64d5f446edba28cbc109ab8f62 inherit pub_methods_classMixture"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a9de9ed64d5f446edba28cbc109ab8f62">GammaPhaseG</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pin)=0</td></tr>
<tr class="memdesc:a9de9ed64d5f446edba28cbc109ab8f62 inherit pub_methods_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">return gamma of gas phase, gamma equals to mass density times gravity factor.  <a href="classMixture.html#a9de9ed64d5f446edba28cbc109ab8f62">More...</a><br /></td></tr>
<tr class="separator:a9de9ed64d5f446edba28cbc109ab8f62 inherit pub_methods_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a489c10ddf83a8856fb492476bdc10c37 inherit pub_methods_classMixture"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a489c10ddf83a8856fb492476bdc10c37">GammaPhaseOG</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Pin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;Tin, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *Ziin)=0</td></tr>
<tr class="separator:a489c10ddf83a8856fb492476bdc10c37 inherit pub_methods_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaab2d76696ec295ba643032353883031 inherit pub_methods_classMixture"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#aaab2d76696ec295ba643032353883031">CheckNi</a> (const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *<a class="el" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>)</td></tr>
<tr class="separator:aaab2d76696ec295ba643032353883031 inherit pub_methods_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65fe500c5800c533331e296464c1af2c inherit pub_methods_classMixture"><td class="memItemLeft" align="right" valign="top"><a id="a65fe500c5800c533331e296464c1af2c" name="a65fe500c5800c533331e296464c1af2c"></a>
virtual <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>&#160;</td><td class="memItemRight" valign="bottom"><b>GetFtype</b> ()=0</td></tr>
<tr class="separator:a65fe500c5800c533331e296464c1af2c inherit pub_methods_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a524db8feb4749f3583fd8664a57b59a4 inherit pub_methods_classMixture"><td class="memItemLeft" align="right" valign="top"><a id="a524db8feb4749f3583fd8664a57b59a4" name="a524db8feb4749f3583fd8664a57b59a4"></a>
virtual <a class="el" href="OCPConst_8hpp.html#a4cf987f6993b48c88ec4970ad351b100">OCP_SIN</a>&#160;</td><td class="memItemRight" valign="bottom"><b>GetMinEigenSkip</b> ()=0</td></tr>
<tr class="separator:a524db8feb4749f3583fd8664a57b59a4 inherit pub_methods_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad54b6d8750bcb9e1586f052b91ab84e0 inherit pub_methods_classMixture"><td class="memItemLeft" align="right" valign="top"><a id="ad54b6d8750bcb9e1586f052b91ab84e0" name="ad54b6d8750bcb9e1586f052b91ab84e0"></a>
virtual bool&#160;</td><td class="memItemRight" valign="bottom"><b>GetFlagSkip</b> ()=0</td></tr>
<tr class="separator:ad54b6d8750bcb9e1586f052b91ab84e0 inherit pub_methods_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24c3ccfb5f2afeee4241c836dda34297 inherit pub_methods_classMixture"><td class="memItemLeft" align="right" valign="top"><a id="a24c3ccfb5f2afeee4241c836dda34297" name="a24c3ccfb5f2afeee4241c836dda34297"></a>
virtual <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><b>GetSurTen</b> ()=0</td></tr>
<tr class="separator:a24c3ccfb5f2afeee4241c836dda34297 inherit pub_methods_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8f9d946334b948b26a9a09ca3c0b6c9 inherit pub_methods_classMixture"><td class="memItemLeft" align="right" valign="top"><a id="ab8f9d946334b948b26a9a09ca3c0b6c9" name="ab8f9d946334b948b26a9a09ca3c0b6c9"></a>
virtual <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><b>GetErrorPEC</b> ()=0</td></tr>
<tr class="separator:ab8f9d946334b948b26a9a09ca3c0b6c9 inherit pub_methods_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03b87933ec276ea4491a6c826fc30417 inherit pub_methods_classMixture"><td class="memItemLeft" align="right" valign="top"><a id="a03b87933ec276ea4491a6c826fc30417" name="a03b87933ec276ea4491a6c826fc30417"></a>
virtual <a class="el" href="OCPConst_8hpp.html#af7bad630928e2d245f39e3dc63ab3d93">OCP_ULL</a>&#160;</td><td class="memItemRight" valign="bottom"><b>GetSSMSTAiters</b> ()=0</td></tr>
<tr class="separator:a03b87933ec276ea4491a6c826fc30417 inherit pub_methods_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a582af03e87e82e0506da797e64da605d inherit pub_methods_classMixture"><td class="memItemLeft" align="right" valign="top"><a id="a582af03e87e82e0506da797e64da605d" name="a582af03e87e82e0506da797e64da605d"></a>
virtual <a class="el" href="OCPConst_8hpp.html#af7bad630928e2d245f39e3dc63ab3d93">OCP_ULL</a>&#160;</td><td class="memItemRight" valign="bottom"><b>GetNRSTAiters</b> ()=0</td></tr>
<tr class="separator:a582af03e87e82e0506da797e64da605d inherit pub_methods_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f61a3dbad865042e5423a5de72c41ce inherit pub_methods_classMixture"><td class="memItemLeft" align="right" valign="top"><a id="a7f61a3dbad865042e5423a5de72c41ce" name="a7f61a3dbad865042e5423a5de72c41ce"></a>
virtual <a class="el" href="OCPConst_8hpp.html#af7bad630928e2d245f39e3dc63ab3d93">OCP_ULL</a>&#160;</td><td class="memItemRight" valign="bottom"><b>GetSSMSPiters</b> ()=0</td></tr>
<tr class="separator:a7f61a3dbad865042e5423a5de72c41ce inherit pub_methods_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7c4cc31e15cef9015786d773fcfee8a inherit pub_methods_classMixture"><td class="memItemLeft" align="right" valign="top"><a id="aa7c4cc31e15cef9015786d773fcfee8a" name="aa7c4cc31e15cef9015786d773fcfee8a"></a>
virtual <a class="el" href="OCPConst_8hpp.html#af7bad630928e2d245f39e3dc63ab3d93">OCP_ULL</a>&#160;</td><td class="memItemRight" valign="bottom"><b>GetNRSPiters</b> ()=0</td></tr>
<tr class="separator:aa7c4cc31e15cef9015786d773fcfee8a inherit pub_methods_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classMixture"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classMixture')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classMixture.html">Mixture</a></td></tr>
<tr class="memitem:aed7f515dd957ccf0a6fec5ed94c83370 inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#aed7f515dd957ccf0a6fec5ed94c83370">mixtureType</a></td></tr>
<tr class="separator:aed7f515dd957ccf0a6fec5ed94c83370 inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33b6d34ba499a57d9923d5316b652efc inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a></td></tr>
<tr class="memdesc:a33b6d34ba499a57d9923d5316b652efc inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">num of phases.  <a href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">More...</a><br /></td></tr>
<tr class="separator:a33b6d34ba499a57d9923d5316b652efc inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13babfd95b6ec1687fb5e479e5a01707 inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a></td></tr>
<tr class="memdesc:a13babfd95b6ec1687fb5e479e5a01707 inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">num of components.  <a href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">More...</a><br /></td></tr>
<tr class="separator:a13babfd95b6ec1687fb5e479e5a01707 inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2de2ed104e4a8b5569c80d852c6fec9f inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a2de2ed104e4a8b5569c80d852c6fec9f">P</a></td></tr>
<tr class="memdesc:a2de2ed104e4a8b5569c80d852c6fec9f inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">pressure when flash calculation.  <a href="classMixture.html#a2de2ed104e4a8b5569c80d852c6fec9f">More...</a><br /></td></tr>
<tr class="separator:a2de2ed104e4a8b5569c80d852c6fec9f inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a50911ba85e0261ad76fac190e1c1b2 inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a6a50911ba85e0261ad76fac190e1c1b2">T</a></td></tr>
<tr class="memdesc:a6a50911ba85e0261ad76fac190e1c1b2 inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">temperature when flash calculation.  <a href="classMixture.html#a6a50911ba85e0261ad76fac190e1c1b2">More...</a><br /></td></tr>
<tr class="separator:a6a50911ba85e0261ad76fac190e1c1b2 inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa73863601ffb8962b26415352b41bffa inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a></td></tr>
<tr class="memdesc:aa73863601ffb8962b26415352b41bffa inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">moles of component: numCom  <a href="classMixture.html#aa73863601ffb8962b26415352b41bffa">More...</a><br /></td></tr>
<tr class="separator:aa73863601ffb8962b26415352b41bffa inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a1b7838c46e07a94c3a95ae9b37e511 inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">phaseExist</a></td></tr>
<tr class="memdesc:a1a1b7838c46e07a94c3a95ae9b37e511 inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">existence of phase: numPhase  <a href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">More...</a><br /></td></tr>
<tr class="separator:a1a1b7838c46e07a94c3a95ae9b37e511 inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a763d1e12b91ae451b2df175cbc45ef84 inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">S</a></td></tr>
<tr class="memdesc:a763d1e12b91ae451b2df175cbc45ef84 inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">saturation of phase: numPhase  <a href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">More...</a><br /></td></tr>
<tr class="separator:a763d1e12b91ae451b2df175cbc45ef84 inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16c6595220dc0a04cfa960d44f3016c7 inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a16c6595220dc0a04cfa960d44f3016c7">rho</a></td></tr>
<tr class="memdesc:a16c6595220dc0a04cfa960d44f3016c7 inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">mass density of phase: numPhase  <a href="classMixture.html#a16c6595220dc0a04cfa960d44f3016c7">More...</a><br /></td></tr>
<tr class="separator:a16c6595220dc0a04cfa960d44f3016c7 inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afad5616464982e92b25adba0c84f4eb5 inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a></td></tr>
<tr class="memdesc:afad5616464982e92b25adba0c84f4eb5 inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">molar density of phase: numPhase  <a href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">More...</a><br /></td></tr>
<tr class="separator:afad5616464982e92b25adba0c84f4eb5 inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9958b097000a344df9bfbdc845db850c inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a9958b097000a344df9bfbdc845db850c">xij</a></td></tr>
<tr class="separator:a9958b097000a344df9bfbdc845db850c inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0d6fa9514fce1774cc277826d304061 inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#aa0d6fa9514fce1774cc277826d304061">nj</a></td></tr>
<tr class="memdesc:aa0d6fa9514fce1774cc277826d304061 inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">mole number of phase j  <a href="classMixture.html#aa0d6fa9514fce1774cc277826d304061">More...</a><br /></td></tr>
<tr class="separator:aa0d6fa9514fce1774cc277826d304061 inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a170e493a88e391f9afe0896181d76786 inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a170e493a88e391f9afe0896181d76786">mu</a></td></tr>
<tr class="memdesc:a170e493a88e391f9afe0896181d76786 inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">viscosity of phase: numPhase  <a href="classMixture.html#a170e493a88e391f9afe0896181d76786">More...</a><br /></td></tr>
<tr class="separator:a170e493a88e391f9afe0896181d76786 inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7463b9517217397b77d51012f4367a28 inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a></td></tr>
<tr class="memdesc:a7463b9517217397b77d51012f4367a28 inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">volume of phase: numPhase;  <a href="classMixture.html#a7463b9517217397b77d51012f4367a28">More...</a><br /></td></tr>
<tr class="separator:a7463b9517217397b77d51012f4367a28 inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8a687cfb963101e8fdddb1467fa2c1f inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a></td></tr>
<tr class="memdesc:ad8a687cfb963101e8fdddb1467fa2c1f inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">volume of total fluids.  <a href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">More...</a><br /></td></tr>
<tr class="separator:ad8a687cfb963101e8fdddb1467fa2c1f inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d5376ba600228135d16bbd76d4b38de inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a9d5376ba600228135d16bbd76d4b38de">Nt</a></td></tr>
<tr class="memdesc:a9d5376ba600228135d16bbd76d4b38de inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total moles of Components.  <a href="classMixture.html#a9d5376ba600228135d16bbd76d4b38de">More...</a><br /></td></tr>
<tr class="separator:a9d5376ba600228135d16bbd76d4b38de inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a382c30078dd1579e7f375ad2f60e2f44 inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a></td></tr>
<tr class="memdesc:a382c30078dd1579e7f375ad2f60e2f44 inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">dvj / dNi, used in 2 hydrocarbon phase in EOS; or dvj / dnij  <a href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">More...</a><br /></td></tr>
<tr class="separator:a382c30078dd1579e7f375ad2f60e2f44 inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a334d229b6dbbc015a9e7de974f08c76d inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">vjp</a></td></tr>
<tr class="memdesc:a334d229b6dbbc015a9e7de974f08c76d inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">dvj / dp, used in 2 hydrocarbon phase in EOS  <a href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">More...</a><br /></td></tr>
<tr class="separator:a334d229b6dbbc015a9e7de974f08c76d inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf4f5e549cc50a366951dba65d196198 inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a></td></tr>
<tr class="separator:adf4f5e549cc50a366951dba65d196198 inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4dd3e54d542aca8eccdcbd208a38504 inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a></td></tr>
<tr class="separator:ab4dd3e54d542aca8eccdcbd208a38504 inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1531b7594246b0b03bdb7d974800ca4 inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#ae1531b7594246b0b03bdb7d974800ca4">muP</a></td></tr>
<tr class="memdesc:ae1531b7594246b0b03bdb7d974800ca4 inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">d mu / dP: numPhase  <a href="classMixture.html#ae1531b7594246b0b03bdb7d974800ca4">More...</a><br /></td></tr>
<tr class="separator:ae1531b7594246b0b03bdb7d974800ca4 inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad86bd94527d09c2afcf767ce6e3a8a71 inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a></td></tr>
<tr class="memdesc:ad86bd94527d09c2afcf767ce6e3a8a71 inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">d xi / dP: numphase  <a href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">More...</a><br /></td></tr>
<tr class="separator:ad86bd94527d09c2afcf767ce6e3a8a71 inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a42129a94c1ba7c92c9577f0eb0234f inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a0a42129a94c1ba7c92c9577f0eb0234f">rhoP</a></td></tr>
<tr class="memdesc:a0a42129a94c1ba7c92c9577f0eb0234f inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">d rho / dP: numphase  <a href="classMixture.html#a0a42129a94c1ba7c92c9577f0eb0234f">More...</a><br /></td></tr>
<tr class="separator:a0a42129a94c1ba7c92c9577f0eb0234f inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7897e0172e682f205e6c58688368c12e inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a7897e0172e682f205e6c58688368c12e">muN</a></td></tr>
<tr class="memdesc:a7897e0172e682f205e6c58688368c12e inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">d mu[j] / d N[i]: numphase * numCom  <a href="classMixture.html#a7897e0172e682f205e6c58688368c12e">More...</a><br /></td></tr>
<tr class="separator:a7897e0172e682f205e6c58688368c12e inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3476f1a61b94f0b58c00a90643e1861a inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a3476f1a61b94f0b58c00a90643e1861a">xiN</a></td></tr>
<tr class="memdesc:a3476f1a61b94f0b58c00a90643e1861a inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">d xi[j] / d N[i]: numphase * numCom  <a href="classMixture.html#a3476f1a61b94f0b58c00a90643e1861a">More...</a><br /></td></tr>
<tr class="separator:a3476f1a61b94f0b58c00a90643e1861a inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9e2798ac8ab094b3a17cff16111f70b inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#ad9e2798ac8ab094b3a17cff16111f70b">rhoN</a></td></tr>
<tr class="memdesc:ad9e2798ac8ab094b3a17cff16111f70b inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">d rho[j] / d N[i]: numphase * numCom  <a href="classMixture.html#ad9e2798ac8ab094b3a17cff16111f70b">More...</a><br /></td></tr>
<tr class="separator:ad9e2798ac8ab094b3a17cff16111f70b inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae63dab2d31711b0246096c5c128f2080 inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#ae63dab2d31711b0246096c5c128f2080">mux</a></td></tr>
<tr class="memdesc:ae63dab2d31711b0246096c5c128f2080 inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">d mu[j] / d x[i][j]: numphase * numCom  <a href="classMixture.html#ae63dab2d31711b0246096c5c128f2080">More...</a><br /></td></tr>
<tr class="separator:ae63dab2d31711b0246096c5c128f2080 inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f517560e2ec30f08afca9f6dc3ff71c inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a3f517560e2ec30f08afca9f6dc3ff71c">xix</a></td></tr>
<tr class="memdesc:a3f517560e2ec30f08afca9f6dc3ff71c inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">d xi[j] / d x[i][j]: numphase * numCom  <a href="classMixture.html#a3f517560e2ec30f08afca9f6dc3ff71c">More...</a><br /></td></tr>
<tr class="separator:a3f517560e2ec30f08afca9f6dc3ff71c inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62615d0052ef8b34c3894e728951c06e inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a62615d0052ef8b34c3894e728951c06e">rhox</a></td></tr>
<tr class="memdesc:a62615d0052ef8b34c3894e728951c06e inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">d rho[j] / d x[i][j]: numphase * numCom  <a href="classMixture.html#a62615d0052ef8b34c3894e728951c06e">More...</a><br /></td></tr>
<tr class="separator:a62615d0052ef8b34c3894e728951c06e inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15908a1b8da8390dd9e8d7c2bd822bf4 inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a></td></tr>
<tr class="memdesc:a15908a1b8da8390dd9e8d7c2bd822bf4 inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">the derivates of second variables wrt. primary variables  <a href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">More...</a><br /></td></tr>
<tr class="separator:a15908a1b8da8390dd9e8d7c2bd822bf4 inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12f16b1b3d45f0052be513f14d323835 inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a12f16b1b3d45f0052be513f14d323835">pEnumCom</a></td></tr>
<tr class="memdesc:a12f16b1b3d45f0052be513f14d323835 inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">see pEnumCom in bulk  <a href="classMixture.html#a12f16b1b3d45f0052be513f14d323835">More...</a><br /></td></tr>
<tr class="separator:a12f16b1b3d45f0052be513f14d323835 inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6c518e1735459e4da660fe989fbcf1d inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#ae6c518e1735459e4da660fe989fbcf1d">res</a></td></tr>
<tr class="memdesc:ae6c518e1735459e4da660fe989fbcf1d inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">residual of a set of equations  <a href="classMixture.html#ae6c518e1735459e4da660fe989fbcf1d">More...</a><br /></td></tr>
<tr class="separator:ae6c518e1735459e4da660fe989fbcf1d inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06e0f35248973da46366c82943f6a085 inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#a06e0f35248973da46366c82943f6a085">resPc</a></td></tr>
<tr class="memdesc:a06e0f35248973da46366c82943f6a085 inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">a precalculated value  <a href="classMixture.html#a06e0f35248973da46366c82943f6a085">More...</a><br /></td></tr>
<tr class="separator:a06e0f35248973da46366c82943f6a085 inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad49e1236014cca81fa4faedf12806bb0 inherit pro_attribs_classMixture"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMixture.html#ad49e1236014cca81fa4faedf12806bb0">keyDer</a></td></tr>
<tr class="memdesc:ad49e1236014cca81fa4faedf12806bb0 inherit pro_attribs_classMixture"><td class="mdescLeft">&#160;</td><td class="mdescRight">d (xij*xi/mu) / dP or dNk  <a href="classMixture.html#ad49e1236014cca81fa4faedf12806bb0">More...</a><br /></td></tr>
<tr class="separator:ad49e1236014cca81fa4faedf12806bb0 inherit pro_attribs_classMixture"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="MixtureComp_8hpp_source.html#l00127">127</a> of file <a class="el" href="MixtureComp_8hpp_source.html">MixtureComp.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="af080189da9d935e1bd77264f20980a5c" name="af080189da9d935e1bd77264f20980a5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af080189da9d935e1bd77264f20980a5c">&#9670;&#160;</a></span>MixtureComp() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MixtureComp::MixtureComp </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classParamReservoir.html">ParamReservoir</a> &amp;&#160;</td>
          <td class="paramname"><em>rs_param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8hpp_source.html#l00151">151</a> of file <a class="el" href="MixtureComp_8hpp_source.html">MixtureComp.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  151</span>                                                              :<a class="code hl_class" href="classMixtureComp.html">MixtureComp</a>(rs_param.<a class="code hl_variable" href="classParamReservoir.html#aff3d0f65d7a1faedf1eaa87b415395e0">EoSp</a>, i) {</div>
<div class="line"><span class="lineno">  152</span>        <a class="code hl_variable" href="classMixture.html#aed7f515dd957ccf0a6fec5ed94c83370">mixtureType</a> = <a class="code hl_variable" href="OCPConst_8hpp.html#a23f681c0d9e8d413e68ed087126a742d">EOS_PVTW</a>;</div>
<div class="line"><span class="lineno">  153</span>        <span class="keywordflow">if</span> (rs_param.<a class="code hl_variable" href="classParamReservoir.html#ac4e0d956c14d0332dd70d799b9b4dab2">PVTW_T</a>.<a class="code hl_variable" href="classTableSet.html#a5d0077031b988faa104e3f19ce0c9393">data</a>.size() != 0) {</div>
<div class="line"><span class="lineno">  154</span>            PVTW.<a class="code hl_function" href="classOCPTable.html#a7ecb972ce9d42e0a05f5031984414335">Setup</a>(rs_param.<a class="code hl_variable" href="classParamReservoir.html#ac4e0d956c14d0332dd70d799b9b4dab2">PVTW_T</a>.<a class="code hl_variable" href="classTableSet.html#a5d0077031b988faa104e3f19ce0c9393">data</a>[i]);</div>
<div class="line"><span class="lineno">  155</span>            <span class="keywordflow">if</span> (rs_param.<a class="code hl_variable" href="classParamReservoir.html#abd537e664cfcaf4c70ff6331f2a8a92a">gravity</a>.<a class="code hl_variable" href="classType__A__r.html#ad80646ea05402588ed3027527dc4ebcf">activity</a>)</div>
<div class="line"><span class="lineno">  156</span>                std_RhoW = <a class="code hl_variable" href="OCPConst_8hpp.html#a538f927b5893c9896717163bb2a798ee">RHOW_STD</a> * rs_param.<a class="code hl_variable" href="classParamReservoir.html#abd537e664cfcaf4c70ff6331f2a8a92a">gravity</a>.<a class="code hl_variable" href="classType__A__r.html#a502de94cb0d66c8e6dd941c5759335f4">data</a>[1];</div>
<div class="line"><span class="lineno">  157</span>            <span class="keywordflow">if</span> (rs_param.<a class="code hl_variable" href="classParamReservoir.html#a5c17baa4bc0875a9b986e5b557c5f06e">density</a>.<a class="code hl_variable" href="classType__A__r.html#ad80646ea05402588ed3027527dc4ebcf">activity</a>)</div>
<div class="line"><span class="lineno">  158</span>                std_RhoW = <a class="code hl_variable" href="OCPConst_8hpp.html#a538f927b5893c9896717163bb2a798ee">RHOW_STD</a>;</div>
<div class="line"><span class="lineno">  159</span>            std_GammaW = <a class="code hl_variable" href="OCPConst_8hpp.html#a340b34fe6fb4d1bc8b7544ed32eee7e8">GRAVITY_FACTOR</a> * std_RhoW;</div>
<div class="line"><span class="lineno">  160</span>            data.resize(5);</div>
<div class="line"><span class="lineno">  161</span>            cdata.resize(5);</div>
<div class="line"><span class="lineno">  162</span>        }</div>
<div class="line"><span class="lineno">  163</span>    };</div>
<div class="ttc" id="aOCPConst_8hpp_html_a23f681c0d9e8d413e68ed087126a742d"><div class="ttname"><a href="OCPConst_8hpp.html#a23f681c0d9e8d413e68ed087126a742d">EOS_PVTW</a></div><div class="ttdeci">const USI EOS_PVTW</div><div class="ttdoc">Mixture model = equation-of-state.</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00089">OCPConst.hpp:89</a></div></div>
<div class="ttc" id="aOCPConst_8hpp_html_a340b34fe6fb4d1bc8b7544ed32eee7e8"><div class="ttname"><a href="OCPConst_8hpp.html#a340b34fe6fb4d1bc8b7544ed32eee7e8">GRAVITY_FACTOR</a></div><div class="ttdeci">const OCP_DBL GRAVITY_FACTOR</div><div class="ttdoc">0.00694444 ft2 psi / lb</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00052">OCPConst.hpp:52</a></div></div>
<div class="ttc" id="aOCPConst_8hpp_html_a538f927b5893c9896717163bb2a798ee"><div class="ttname"><a href="OCPConst_8hpp.html#a538f927b5893c9896717163bb2a798ee">RHOW_STD</a></div><div class="ttdeci">const OCP_DBL RHOW_STD</div><div class="ttdoc">Water density in lb / ft3.</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00053">OCPConst.hpp:53</a></div></div>
<div class="ttc" id="aclassMixtureComp_html"><div class="ttname"><a href="classMixtureComp.html">MixtureComp</a></div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00127">MixtureComp.hpp:128</a></div></div>
<div class="ttc" id="aclassMixture_html_aed7f515dd957ccf0a6fec5ed94c83370"><div class="ttname"><a href="classMixture.html#aed7f515dd957ccf0a6fec5ed94c83370">Mixture::mixtureType</a></div><div class="ttdeci">USI mixtureType</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00141">Mixture.hpp:141</a></div></div>
<div class="ttc" id="aclassOCPTable_html_a7ecb972ce9d42e0a05f5031984414335"><div class="ttname"><a href="classOCPTable.html#a7ecb972ce9d42e0a05f5031984414335">OCPTable::Setup</a></div><div class="ttdeci">void Setup(const vector&lt; vector&lt; OCP_DBL &gt; &gt; &amp;src)</div><div class="ttdoc">Setup tables from existing data of table.</div><div class="ttdef"><b>Definition:</b> <a href="OCPTable_8cpp_source.html#l00025">OCPTable.cpp:25</a></div></div>
<div class="ttc" id="aclassParamReservoir_html_a5c17baa4bc0875a9b986e5b557c5f06e"><div class="ttname"><a href="classParamReservoir.html#a5c17baa4bc0875a9b986e5b557c5f06e">ParamReservoir::density</a></div><div class="ttdeci">Type_A_r&lt; OCP_DBL &gt; density</div><div class="ttdoc">Density of oil, water, gas in standard conditions.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00177">ParamReservoir.hpp:177</a></div></div>
<div class="ttc" id="aclassParamReservoir_html_abd537e664cfcaf4c70ff6331f2a8a92a"><div class="ttname"><a href="classParamReservoir.html#abd537e664cfcaf4c70ff6331f2a8a92a">ParamReservoir::gravity</a></div><div class="ttdeci">Type_A_r&lt; OCP_DBL &gt; gravity</div><div class="ttdoc">Gravity of oil, water, gas in standard conditions.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00178">ParamReservoir.hpp:178</a></div></div>
<div class="ttc" id="aclassParamReservoir_html_ac4e0d956c14d0332dd70d799b9b4dab2"><div class="ttname"><a href="classParamReservoir.html#ac4e0d956c14d0332dd70d799b9b4dab2">ParamReservoir::PVTW_T</a></div><div class="ttdeci">TableSet PVTW_T</div><div class="ttdoc">Table set of PVTW.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00214">ParamReservoir.hpp:214</a></div></div>
<div class="ttc" id="aclassParamReservoir_html_aff3d0f65d7a1faedf1eaa87b415395e0"><div class="ttname"><a href="classParamReservoir.html#aff3d0f65d7a1faedf1eaa87b415395e0">ParamReservoir::EoSp</a></div><div class="ttdeci">EoSparam EoSp</div><div class="ttdoc">Initial component composition, used in compositional models.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00190">ParamReservoir.hpp:190</a></div></div>
<div class="ttc" id="aclassTableSet_html_a5d0077031b988faa104e3f19ce0c9393"><div class="ttname"><a href="classTableSet.html#a5d0077031b988faa104e3f19ce0c9393">TableSet::data</a></div><div class="ttdeci">vector&lt; vector&lt; vector&lt; OCP_DBL &gt; &gt; &gt; data</div><div class="ttdoc">All table with the same name.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00035">ParamReservoir.hpp:35</a></div></div>
<div class="ttc" id="aclassType__A__r_html_a502de94cb0d66c8e6dd941c5759335f4"><div class="ttname"><a href="classType__A__r.html#a502de94cb0d66c8e6dd941c5759335f4">Type_A_r::data</a></div><div class="ttdeci">vector&lt; T &gt; data</div><div class="ttdoc">Data of param.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00061">ParamReservoir.hpp:61</a></div></div>
<div class="ttc" id="aclassType__A__r_html_ad80646ea05402588ed3027527dc4ebcf"><div class="ttname"><a href="classType__A__r.html#ad80646ea05402588ed3027527dc4ebcf">Type_A_r::activity</a></div><div class="ttdeci">bool activity</div><div class="ttdoc">If false, this param is not given.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00060">ParamReservoir.hpp:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7672ff008a1e0f3e95ca2d121e5b3d70" name="a7672ff008a1e0f3e95ca2d121e5b3d70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7672ff008a1e0f3e95ca2d121e5b3d70">&#9670;&#160;</a></span>MixtureComp() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MixtureComp::MixtureComp </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classEoSparam.html">EoSparam</a> &amp;&#160;</td>
          <td class="paramname"><em>param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00028">28</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   29</span>{</div>
<div class="line"><span class="lineno">   30</span>    <span class="comment">// if Water don&#39;t exist?</span></div>
<div class="line"><span class="lineno">   31</span>    <span class="comment">// for Mixture class</span></div>
<div class="line"><span class="lineno">   32</span>    <a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> = param.<a class="code hl_variable" href="classEoSparam.html#adb24104a3840764c3029c9e12bfaf523">numPhase</a> + 1;</div>
<div class="line"><span class="lineno">   33</span>    <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>   = param.<a class="code hl_variable" href="classEoSparam.html#ac32614584342aeb1a744c9b2dc434e9e">numComp</a> + 1;</div>
<div class="line"><span class="lineno">   34</span>    <a class="code hl_function" href="classMixture.html#af9cd3ebf3d96509594d15bc1891ad801">Allocate</a>();</div>
<div class="line"><span class="lineno">   35</span> </div>
<div class="line"><span class="lineno">   36</span>    <span class="comment">// for MixtureComp class</span></div>
<div class="line"><span class="lineno">   37</span>    NC    = param.<a class="code hl_variable" href="classEoSparam.html#ac32614584342aeb1a744c9b2dc434e9e">numComp</a>;</div>
<div class="line"><span class="lineno">   38</span>    NPmax = param.<a class="code hl_variable" href="classEoSparam.html#adb24104a3840764c3029c9e12bfaf523">numPhase</a>;</div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   40</span>    zi.resize(NC);</div>
<div class="line"><span class="lineno">   41</span> </div>
<div class="line"><span class="lineno">   42</span>    <span class="comment">// comp.resize(NC);</span></div>
<div class="line"><span class="lineno">   43</span>    <span class="comment">// for (USI i = 0; i &lt; NC; i++) {</span></div>
<div class="line"><span class="lineno">   44</span>    <span class="comment">//  comp[i] = COMP(param.COM[i]);</span></div>
<div class="line"><span class="lineno">   45</span>    <span class="comment">//}</span></div>
<div class="line"><span class="lineno">   46</span> </div>
<div class="line"><span class="lineno">   47</span>    Cname = param.<a class="code hl_variable" href="classEoSparam.html#ab6b87a806eecbd4542f9076835d5ecce">Cname</a>;</div>
<div class="line"><span class="lineno">   48</span>    <span class="keywordflow">if</span> (param.<a class="code hl_variable" href="classEoSparam.html#afddc879be80be5e6123f25ce0d00d5a2">Tc</a>.<a class="code hl_variable" href="classType__A__r.html#ad80646ea05402588ed3027527dc4ebcf">activity</a>)</div>
<div class="line"><span class="lineno">   49</span>        Tc = param.<a class="code hl_variable" href="classEoSparam.html#afddc879be80be5e6123f25ce0d00d5a2">Tc</a>.<a class="code hl_variable" href="classType__A__r.html#a502de94cb0d66c8e6dd941c5759335f4">data</a>[tar];</div>
<div class="line"><span class="lineno">   50</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   51</span>        <a class="code hl_define" href="UtilError_8hpp.html#aecfc13af45c4bb869301d5ce54cba0af">OCP_ABORT</a>(<span class="stringliteral">&quot;TCRIT hasn&#39;t been input!&quot;</span>);</div>
<div class="line"><span class="lineno">   52</span>    <span class="keywordflow">if</span> (param.<a class="code hl_variable" href="classEoSparam.html#adf2bd4e34d7aabea9749f2d14ccc8d7d">Pc</a>.<a class="code hl_variable" href="classType__A__r.html#ad80646ea05402588ed3027527dc4ebcf">activity</a>)</div>
<div class="line"><span class="lineno">   53</span>        Pc = param.<a class="code hl_variable" href="classEoSparam.html#adf2bd4e34d7aabea9749f2d14ccc8d7d">Pc</a>.<a class="code hl_variable" href="classType__A__r.html#a502de94cb0d66c8e6dd941c5759335f4">data</a>[tar];</div>
<div class="line"><span class="lineno">   54</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   55</span>        <a class="code hl_define" href="UtilError_8hpp.html#aecfc13af45c4bb869301d5ce54cba0af">OCP_ABORT</a>(<span class="stringliteral">&quot;PCRIT hasn&#39;t been input!&quot;</span>);</div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>    <span class="keywordflow">if</span> (param.<a class="code hl_variable" href="classEoSparam.html#aec0108be6fff3bf486fa630aa1c30acc">Vc</a>.<a class="code hl_variable" href="classType__A__r.html#ad80646ea05402588ed3027527dc4ebcf">activity</a>)</div>
<div class="line"><span class="lineno">   58</span>        Vc = param.<a class="code hl_variable" href="classEoSparam.html#aec0108be6fff3bf486fa630aa1c30acc">Vc</a>.<a class="code hl_variable" href="classType__A__r.html#a502de94cb0d66c8e6dd941c5759335f4">data</a>[tar];</div>
<div class="line"><span class="lineno">   59</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (param.<a class="code hl_variable" href="classEoSparam.html#aff7813ba74d19a812cbdb0ee4dbb53d0">Zc</a>.<a class="code hl_variable" href="classType__A__r.html#ad80646ea05402588ed3027527dc4ebcf">activity</a>) {</div>
<div class="line"><span class="lineno">   60</span>        Zc = param.<a class="code hl_variable" href="classEoSparam.html#aff7813ba74d19a812cbdb0ee4dbb53d0">Zc</a>.<a class="code hl_variable" href="classType__A__r.html#a502de94cb0d66c8e6dd941c5759335f4">data</a>[tar];</div>
<div class="line"><span class="lineno">   61</span>        Vc.resize(NC);</div>
<div class="line"><span class="lineno">   62</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno">   63</span>            Vc[i] = 10.73159 * Zc[i] * Tc[i] / Pc[i];</div>
<div class="line"><span class="lineno">   64</span>        }</div>
<div class="line"><span class="lineno">   65</span>    } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   66</span>        <a class="code hl_define" href="UtilError_8hpp.html#aecfc13af45c4bb869301d5ce54cba0af">OCP_ABORT</a>(<span class="stringliteral">&quot;VCRIT or ZCRIT hasn&#39;t been input!&quot;</span>);</div>
<div class="line"><span class="lineno">   67</span> </div>
<div class="line"><span class="lineno">   68</span>    <span class="keywordflow">if</span> (param.<a class="code hl_variable" href="classEoSparam.html#a6586430dc581b86c09bc09f9bec8b4ae">MW</a>.<a class="code hl_variable" href="classType__A__r.html#ad80646ea05402588ed3027527dc4ebcf">activity</a>)</div>
<div class="line"><span class="lineno">   69</span>        MWC = param.<a class="code hl_variable" href="classEoSparam.html#a6586430dc581b86c09bc09f9bec8b4ae">MW</a>.<a class="code hl_variable" href="classType__A__r.html#a502de94cb0d66c8e6dd941c5759335f4">data</a>[tar];</div>
<div class="line"><span class="lineno">   70</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   71</span>        <a class="code hl_define" href="UtilError_8hpp.html#aecfc13af45c4bb869301d5ce54cba0af">OCP_ABORT</a>(<span class="stringliteral">&quot;MW hasn&#39;t been input!&quot;</span>);</div>
<div class="line"><span class="lineno">   72</span>    <span class="keywordflow">if</span> (param.<a class="code hl_variable" href="classEoSparam.html#a7101c47459b4ac23500a749bc1e19dc6">Acf</a>.<a class="code hl_variable" href="classType__A__r.html#ad80646ea05402588ed3027527dc4ebcf">activity</a>)</div>
<div class="line"><span class="lineno">   73</span>        Acf = param.<a class="code hl_variable" href="classEoSparam.html#a7101c47459b4ac23500a749bc1e19dc6">Acf</a>.<a class="code hl_variable" href="classType__A__r.html#a502de94cb0d66c8e6dd941c5759335f4">data</a>[tar];</div>
<div class="line"><span class="lineno">   74</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   75</span>        <a class="code hl_define" href="UtilError_8hpp.html#aecfc13af45c4bb869301d5ce54cba0af">OCP_ABORT</a>(<span class="stringliteral">&quot;ACF hasn&#39;t been input!&quot;</span>);</div>
<div class="line"><span class="lineno">   76</span>    <span class="keywordflow">if</span> (param.<a class="code hl_variable" href="classEoSparam.html#aed55338b604ee04e2ffc79d8afc1564d">OmegaA</a>.<a class="code hl_variable" href="classType__A__r.html#ad80646ea05402588ed3027527dc4ebcf">activity</a>)</div>
<div class="line"><span class="lineno">   77</span>        OmegaA = param.<a class="code hl_variable" href="classEoSparam.html#aed55338b604ee04e2ffc79d8afc1564d">OmegaA</a>.<a class="code hl_variable" href="classType__A__r.html#a502de94cb0d66c8e6dd941c5759335f4">data</a>[tar];</div>
<div class="line"><span class="lineno">   78</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   79</span>        OmegaA.resize(NC, 0.457235529);</div>
<div class="line"><span class="lineno">   80</span>    <span class="keywordflow">if</span> (param.<a class="code hl_variable" href="classEoSparam.html#abfc19f509f4d937055770dca5ae1cedd">OmegaB</a>.<a class="code hl_variable" href="classType__A__r.html#ad80646ea05402588ed3027527dc4ebcf">activity</a>)</div>
<div class="line"><span class="lineno">   81</span>        OmegaB = param.<a class="code hl_variable" href="classEoSparam.html#abfc19f509f4d937055770dca5ae1cedd">OmegaB</a>.<a class="code hl_variable" href="classType__A__r.html#a502de94cb0d66c8e6dd941c5759335f4">data</a>[tar];</div>
<div class="line"><span class="lineno">   82</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   83</span>        OmegaB.resize(NC, 0.077796074);</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>    <span class="keywordflow">if</span> (param.<a class="code hl_variable" href="classEoSparam.html#a32dde331b2c24e97c401cb18c18d88ad">Vshift</a>.<a class="code hl_variable" href="classType__A__r.html#ad80646ea05402588ed3027527dc4ebcf">activity</a>) {</div>
<div class="line"><span class="lineno">   86</span>        Vshift = param.<a class="code hl_variable" href="classEoSparam.html#a32dde331b2c24e97c401cb18c18d88ad">Vshift</a>.<a class="code hl_variable" href="classType__A__r.html#a502de94cb0d66c8e6dd941c5759335f4">data</a>[tar];</div>
<div class="line"><span class="lineno">   87</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++)</div>
<div class="line"><span class="lineno">   88</span>            Vshift[i] *= (<a class="code hl_variable" href="OCPConst_8hpp.html#acf2d5c7d361941d6394ac1c9dc3e5628">GAS_CONSTANT</a> * OmegaB[i] *  Tc[i] / Pc[i]);</div>
<div class="line"><span class="lineno">   89</span>    }      </div>
<div class="line"><span class="lineno">   90</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   91</span>        Vshift.resize(NC, 0);</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>    ParachorAct = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   94</span>    <span class="keywordflow">if</span> (param.<a class="code hl_variable" href="classEoSparam.html#afe436eaa0c42ae62bead2938106cb03c">Parachor</a>.<a class="code hl_variable" href="classType__A__r.html#ad80646ea05402588ed3027527dc4ebcf">activity</a>)</div>
<div class="line"><span class="lineno">   95</span>        Parachor = param.<a class="code hl_variable" href="classEoSparam.html#afe436eaa0c42ae62bead2938106cb03c">Parachor</a>.<a class="code hl_variable" href="classType__A__r.html#a502de94cb0d66c8e6dd941c5759335f4">data</a>[tar];</div>
<div class="line"><span class="lineno">   96</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   97</span>        ParachorAct = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>    <span class="keywordflow">if</span> (param.<a class="code hl_variable" href="classEoSparam.html#a2fe64de34c52f5a0e5d9683164a504d4">Vcvis</a>.<a class="code hl_variable" href="classType__A__r.html#ad80646ea05402588ed3027527dc4ebcf">activity</a>)</div>
<div class="line"><span class="lineno">  100</span>        Vcvis = param.<a class="code hl_variable" href="classEoSparam.html#a2fe64de34c52f5a0e5d9683164a504d4">Vcvis</a>.<a class="code hl_variable" href="classType__A__r.html#a502de94cb0d66c8e6dd941c5759335f4">data</a>[tar];</div>
<div class="line"><span class="lineno">  101</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (param.<a class="code hl_variable" href="classEoSparam.html#a0b954cca9f1d5e4a2ef54e141d7b3f3b">Zcvis</a>.<a class="code hl_variable" href="classType__A__r.html#ad80646ea05402588ed3027527dc4ebcf">activity</a>) {</div>
<div class="line"><span class="lineno">  102</span>        Zcvis = param.<a class="code hl_variable" href="classEoSparam.html#a0b954cca9f1d5e4a2ef54e141d7b3f3b">Zcvis</a>.<a class="code hl_variable" href="classType__A__r.html#a502de94cb0d66c8e6dd941c5759335f4">data</a>[tar];</div>
<div class="line"><span class="lineno">  103</span>        Vcvis.resize(NC);</div>
<div class="line"><span class="lineno">  104</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno">  105</span>            Vcvis[i] = <a class="code hl_variable" href="OCPConst_8hpp.html#acf2d5c7d361941d6394ac1c9dc3e5628">GAS_CONSTANT</a> * Zcvis[i] * Tc[i] / Pc[i];</div>
<div class="line"><span class="lineno">  106</span>        }</div>
<div class="line"><span class="lineno">  107</span>    } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  108</span>        Vcvis = Vc;</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>    LBCcoef = param.<a class="code hl_variable" href="classEoSparam.html#a5d8e7433a262600bb3a456eaa5c2a985">LBCcoef</a>;</div>
<div class="line"><span class="lineno">  111</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; lbc : LBCcoef) {</div>
<div class="line"><span class="lineno">  112</span>        lbc *= 10;</div>
<div class="line"><span class="lineno">  113</span>    }</div>
<div class="line"><span class="lineno">  114</span> </div>
<div class="line"><span class="lineno">  115</span>    miscible = param.<a class="code hl_variable" href="classEoSparam.html#affd2338845c0778f142a399f48302217">miscible</a>;</div>
<div class="line"><span class="lineno">  116</span>    <span class="keywordflow">if</span> (miscible &amp;&amp; !ParachorAct) {</div>
<div class="line"><span class="lineno">  117</span>        <a class="code hl_define" href="UtilError_8hpp.html#aecfc13af45c4bb869301d5ce54cba0af">OCP_ABORT</a>(<span class="stringliteral">&quot;PARACHOR has not been Input!&quot;</span>);</div>
<div class="line"><span class="lineno">  118</span>    }</div>
<div class="line"><span class="lineno">  119</span>    </div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>    CallId();</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> len   = NC * NC;</div>
<div class="line"><span class="lineno">  124</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> count = 0;</div>
<div class="line"><span class="lineno">  125</span>    BIC.resize(len, 0);</div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span>    <span class="keywordflow">if</span> (param.<a class="code hl_variable" href="classEoSparam.html#afb68cce409462e42baf65dbe909b8c4f">BIC</a>[tar].size() != len) {</div>
<div class="line"><span class="lineno">  128</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> iter = 0;</div>
<div class="line"><span class="lineno">  129</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 1; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno">  130</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; i; j++) {</div>
<div class="line"><span class="lineno">  131</span>                BIC[i * NC + j] = param.<a class="code hl_variable" href="classEoSparam.html#afb68cce409462e42baf65dbe909b8c4f">BIC</a>[tar][iter];</div>
<div class="line"><span class="lineno">  132</span>                BIC[j * NC + i] = BIC[i * NC + j];</div>
<div class="line"><span class="lineno">  133</span>                iter++;</div>
<div class="line"><span class="lineno">  134</span>            }</div>
<div class="line"><span class="lineno">  135</span>        }</div>
<div class="line"><span class="lineno">  136</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  137</span>        BIC = param.<a class="code hl_variable" href="classEoSparam.html#afb68cce409462e42baf65dbe909b8c4f">BIC</a>[tar];</div>
<div class="line"><span class="lineno">  138</span>    }</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno">  141</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NC; j++) {</div>
<div class="line"><span class="lineno">  142</span>            cout &lt;&lt; setw(10) &lt;&lt; BIC[i * NC + j] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>;</div>
<div class="line"><span class="lineno">  143</span>        }</div>
<div class="line"><span class="lineno">  144</span>        cout &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  145</span>    }</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span>    EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#afa9aa64d939ebc09cafa04db1952cebb">maxIt</a> = stoi(param.<a class="code hl_variable" href="classEoSparam.html#aa23ca2b1bd8af5c87a524cdbebd3c62e">SSMparamSTA</a>[0]);</div>
<div class="line"><span class="lineno">  148</span>    EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#acc0160e5384f8789fab7c7764fd23bd0">tol</a>   = stod(param.<a class="code hl_variable" href="classEoSparam.html#aa23ca2b1bd8af5c87a524cdbebd3c62e">SSMparamSTA</a>[1]);</div>
<div class="line"><span class="lineno">  149</span>    EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#a35963a0398ba071ce0a6edf969afae88">eYt</a>   = stod(param.<a class="code hl_variable" href="classEoSparam.html#aa23ca2b1bd8af5c87a524cdbebd3c62e">SSMparamSTA</a>[2]);</div>
<div class="line"><span class="lineno">  150</span>    EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#a65bf34c5fc93f81627061f04196ebb24">tol2</a>  = EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#acc0160e5384f8789fab7c7764fd23bd0">tol</a> * EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#acc0160e5384f8789fab7c7764fd23bd0">tol</a>;</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>    EoSctrl.NRsta.<a class="code hl_variable" href="classNRparamSTA.html#aaaf5fa953901b9331260f4ff2991ea15">maxIt</a> = stoi(param.<a class="code hl_variable" href="classEoSparam.html#a6b9b860dd9a84876cb18a6cec4dafcd7">NRparamSTA</a>[0]);</div>
<div class="line"><span class="lineno">  153</span>    EoSctrl.NRsta.<a class="code hl_variable" href="classNRparamSTA.html#a50dd883c925b1698481f4ef7c89b2102">tol</a>   = stod(param.<a class="code hl_variable" href="classEoSparam.html#a6b9b860dd9a84876cb18a6cec4dafcd7">NRparamSTA</a>[1]);</div>
<div class="line"><span class="lineno">  154</span>    EoSctrl.NRsta.<a class="code hl_variable" href="classNRparamSTA.html#ad1cd583ade36171543c53c5b437e6c13">tol2</a>  = EoSctrl.NRsta.<a class="code hl_variable" href="classNRparamSTA.html#a50dd883c925b1698481f4ef7c89b2102">tol</a> * EoSctrl.NRsta.<a class="code hl_variable" href="classNRparamSTA.html#a50dd883c925b1698481f4ef7c89b2102">tol</a>;</div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span>    EoSctrl.SSMsp.<a class="code hl_variable" href="classSSMparamSP.html#aa2f90176c63acb15ab0add7739ad4748">maxIt</a> = stoi(param.<a class="code hl_variable" href="classEoSparam.html#a38b599b87145109a3a3ab7897ff75914">SSMparamSP</a>[0]);</div>
<div class="line"><span class="lineno">  157</span>    EoSctrl.SSMsp.<a class="code hl_variable" href="classSSMparamSP.html#a2ac40bec493cba1386a27517c0f79ec1">tol</a>   = stod(param.<a class="code hl_variable" href="classEoSparam.html#a38b599b87145109a3a3ab7897ff75914">SSMparamSP</a>[1]);</div>
<div class="line"><span class="lineno">  158</span>    EoSctrl.SSMsp.<a class="code hl_variable" href="classSSMparamSP.html#a68a0b481abc1d5564b374b9abcb3d0d6">tol2</a>  = EoSctrl.SSMsp.<a class="code hl_variable" href="classSSMparamSP.html#a2ac40bec493cba1386a27517c0f79ec1">tol</a> * EoSctrl.SSMsp.<a class="code hl_variable" href="classSSMparamSP.html#a2ac40bec493cba1386a27517c0f79ec1">tol</a>;</div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>    EoSctrl.NRsp.<a class="code hl_variable" href="classNRparamSP.html#a92666e91c5347674e32907ed26f7f29e">maxIt</a> = stoi(param.<a class="code hl_variable" href="classEoSparam.html#aa88c927456e0a871f7bd4a029b914904">NRparamSP</a>[0]);</div>
<div class="line"><span class="lineno">  161</span>    EoSctrl.NRsp.<a class="code hl_variable" href="classNRparamSP.html#ab370afbdbd3c29bc56bc841b5884157e">tol</a>   = stod(param.<a class="code hl_variable" href="classEoSparam.html#aa88c927456e0a871f7bd4a029b914904">NRparamSP</a>[1]);</div>
<div class="line"><span class="lineno">  162</span>    EoSctrl.NRsp.<a class="code hl_variable" href="classNRparamSP.html#a8bda4ca724c4ad3a38f58f1bc2321d70">tol2</a>  = EoSctrl.NRsp.<a class="code hl_variable" href="classNRparamSP.html#ab370afbdbd3c29bc56bc841b5884157e">tol</a> * EoSctrl.NRsp.<a class="code hl_variable" href="classNRparamSP.html#ab370afbdbd3c29bc56bc841b5884157e">tol</a>;</div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>    EoSctrl.RR.<a class="code hl_variable" href="classRRparam.html#a280d832a8525124b2c589abbf329b566">maxIt</a> = stoi(param.<a class="code hl_variable" href="classEoSparam.html#a32a781a0d699cc144e9f73944b5a1a5b">RRparam</a>[0]);</div>
<div class="line"><span class="lineno">  165</span>    EoSctrl.RR.<a class="code hl_variable" href="classRRparam.html#af38c3b481183d18bb91b4a722ec84254">tol</a>   = stod(param.<a class="code hl_variable" href="classEoSparam.html#a32a781a0d699cc144e9f73944b5a1a5b">RRparam</a>[1]);</div>
<div class="line"><span class="lineno">  166</span>    EoSctrl.RR.<a class="code hl_variable" href="classRRparam.html#a1505e7ba89a5df48bfc79035b78a3f22">tol2</a>  = EoSctrl.RR.<a class="code hl_variable" href="classRRparam.html#af38c3b481183d18bb91b4a722ec84254">tol</a> * EoSctrl.RR.<a class="code hl_variable" href="classRRparam.html#af38c3b481183d18bb91b4a722ec84254">tol</a>;</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>    AllocateEoS();</div>
<div class="line"><span class="lineno">  169</span>    AllocatePhase();</div>
<div class="line"><span class="lineno">  170</span>    AllocateMethod();</div>
<div class="line"><span class="lineno">  171</span>    AllocateOthers();</div>
<div class="line"><span class="lineno">  172</span>}</div>
<div class="ttc" id="aOCPConst_8hpp_html_a24bc11890ea853a38fd9d6b843633b1b"><div class="ttname"><a href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a></div><div class="ttdeci">unsigned int USI</div><div class="ttdoc">Generic unsigned integer.</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00022">OCPConst.hpp:22</a></div></div>
<div class="ttc" id="aOCPConst_8hpp_html_acf2d5c7d361941d6394ac1c9dc3e5628"><div class="ttname"><a href="OCPConst_8hpp.html#acf2d5c7d361941d6394ac1c9dc3e5628">GAS_CONSTANT</a></div><div class="ttdeci">const OCP_DBL GAS_CONSTANT</div><div class="ttdoc">Gas Constant.</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00035">OCPConst.hpp:35</a></div></div>
<div class="ttc" id="aUtilError_8hpp_html_aecfc13af45c4bb869301d5ce54cba0af"><div class="ttname"><a href="UtilError_8hpp.html#aecfc13af45c4bb869301d5ce54cba0af">OCP_ABORT</a></div><div class="ttdeci">#define OCP_ABORT(msg)</div><div class="ttdoc">Abort if critical error happens.</div><div class="ttdef"><b>Definition:</b> <a href="UtilError_8hpp_source.html#l00047">UtilError.hpp:47</a></div></div>
<div class="ttc" id="aclassEoSparam_html_a0b954cca9f1d5e4a2ef54e141d7b3f3b"><div class="ttname"><a href="classEoSparam.html#a0b954cca9f1d5e4a2ef54e141d7b3f3b">EoSparam::Zcvis</a></div><div class="ttdeci">Type_A_r&lt; vector&lt; OCP_DBL &gt; &gt; Zcvis</div><div class="ttdoc">Critical Z-factor used for viscosity calculations only.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00116">ParamReservoir.hpp:116</a></div></div>
<div class="ttc" id="aclassEoSparam_html_a2fe64de34c52f5a0e5d9683164a504d4"><div class="ttname"><a href="classEoSparam.html#a2fe64de34c52f5a0e5d9683164a504d4">EoSparam::Vcvis</a></div><div class="ttdeci">Type_A_r&lt; vector&lt; OCP_DBL &gt; &gt; Vcvis</div><div class="ttdoc">Critical volume used for viscosity calculations only.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00115">ParamReservoir.hpp:115</a></div></div>
<div class="ttc" id="aclassEoSparam_html_a32a781a0d699cc144e9f73944b5a1a5b"><div class="ttname"><a href="classEoSparam.html#a32a781a0d699cc144e9f73944b5a1a5b">EoSparam::RRparam</a></div><div class="ttdeci">vector&lt; string &gt; RRparam</div><div class="ttdoc">Params for Solving Rachford-Rice equations.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00126">ParamReservoir.hpp:126</a></div></div>
<div class="ttc" id="aclassEoSparam_html_a32dde331b2c24e97c401cb18c18d88ad"><div class="ttname"><a href="classEoSparam.html#a32dde331b2c24e97c401cb18c18d88ad">EoSparam::Vshift</a></div><div class="ttdeci">Type_A_r&lt; vector&lt; OCP_DBL &gt; &gt; Vshift</div><div class="ttdoc">Volume shift of hydrocarbon components.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00112">ParamReservoir.hpp:112</a></div></div>
<div class="ttc" id="aclassEoSparam_html_a38b599b87145109a3a3ab7897ff75914"><div class="ttname"><a href="classEoSparam.html#a38b599b87145109a3a3ab7897ff75914">EoSparam::SSMparamSP</a></div><div class="ttdeci">vector&lt; string &gt; SSMparamSP</div><div class="ttdoc">Params for Solving Phase Spliting with SSM.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00124">ParamReservoir.hpp:124</a></div></div>
<div class="ttc" id="aclassEoSparam_html_a5d8e7433a262600bb3a456eaa5c2a985"><div class="ttname"><a href="classEoSparam.html#a5d8e7433a262600bb3a456eaa5c2a985">EoSparam::LBCcoef</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; LBCcoef</div><div class="ttdoc">LBC coefficients for viscosity calculation.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00117">ParamReservoir.hpp:117</a></div></div>
<div class="ttc" id="aclassEoSparam_html_a6586430dc581b86c09bc09f9bec8b4ae"><div class="ttname"><a href="classEoSparam.html#a6586430dc581b86c09bc09f9bec8b4ae">EoSparam::MW</a></div><div class="ttdeci">Type_A_r&lt; vector&lt; OCP_DBL &gt; &gt; MW</div><div class="ttdoc">Molecular Weight of hydrocarbon components.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00108">ParamReservoir.hpp:108</a></div></div>
<div class="ttc" id="aclassEoSparam_html_a6b9b860dd9a84876cb18a6cec4dafcd7"><div class="ttname"><a href="classEoSparam.html#a6b9b860dd9a84876cb18a6cec4dafcd7">EoSparam::NRparamSTA</a></div><div class="ttdeci">vector&lt; string &gt; NRparamSTA</div><div class="ttdoc">Params for Solving Phase Spliting with NR.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00123">ParamReservoir.hpp:123</a></div></div>
<div class="ttc" id="aclassEoSparam_html_a7101c47459b4ac23500a749bc1e19dc6"><div class="ttname"><a href="classEoSparam.html#a7101c47459b4ac23500a749bc1e19dc6">EoSparam::Acf</a></div><div class="ttdeci">Type_A_r&lt; vector&lt; OCP_DBL &gt; &gt; Acf</div><div class="ttdoc">Acentric factor of hydrocarbon components.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00109">ParamReservoir.hpp:109</a></div></div>
<div class="ttc" id="aclassEoSparam_html_aa23ca2b1bd8af5c87a524cdbebd3c62e"><div class="ttname"><a href="classEoSparam.html#aa23ca2b1bd8af5c87a524cdbebd3c62e">EoSparam::SSMparamSTA</a></div><div class="ttdeci">vector&lt; string &gt; SSMparamSTA</div><div class="ttdoc">Params for Solving Phase Spliting with SSM.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00122">ParamReservoir.hpp:122</a></div></div>
<div class="ttc" id="aclassEoSparam_html_aa88c927456e0a871f7bd4a029b914904"><div class="ttname"><a href="classEoSparam.html#aa88c927456e0a871f7bd4a029b914904">EoSparam::NRparamSP</a></div><div class="ttdeci">vector&lt; string &gt; NRparamSP</div><div class="ttdoc">Params for Solving Phase Spliting with NR.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00125">ParamReservoir.hpp:125</a></div></div>
<div class="ttc" id="aclassEoSparam_html_ab6b87a806eecbd4542f9076835d5ecce"><div class="ttname"><a href="classEoSparam.html#ab6b87a806eecbd4542f9076835d5ecce">EoSparam::Cname</a></div><div class="ttdeci">vector&lt; string &gt; Cname</div><div class="ttdoc">Name of hydrocarbon components.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00103">ParamReservoir.hpp:103</a></div></div>
<div class="ttc" id="aclassEoSparam_html_abfc19f509f4d937055770dca5ae1cedd"><div class="ttname"><a href="classEoSparam.html#abfc19f509f4d937055770dca5ae1cedd">EoSparam::OmegaB</a></div><div class="ttdeci">Type_A_r&lt; vector&lt; OCP_DBL &gt; &gt; OmegaB</div><div class="ttdoc">OMEGA_B of hydrocarbon components.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00111">ParamReservoir.hpp:111</a></div></div>
<div class="ttc" id="aclassEoSparam_html_ac32614584342aeb1a744c9b2dc434e9e"><div class="ttname"><a href="classEoSparam.html#ac32614584342aeb1a744c9b2dc434e9e">EoSparam::numComp</a></div><div class="ttdeci">USI numComp</div><div class="ttdoc">num of components, water is excluded.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00098">ParamReservoir.hpp:98</a></div></div>
<div class="ttc" id="aclassEoSparam_html_adb24104a3840764c3029c9e12bfaf523"><div class="ttname"><a href="classEoSparam.html#adb24104a3840764c3029c9e12bfaf523">EoSparam::numPhase</a></div><div class="ttdeci">USI numPhase</div><div class="ttdoc">num of phase, water is excluded.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00099">ParamReservoir.hpp:99</a></div></div>
<div class="ttc" id="aclassEoSparam_html_adf2bd4e34d7aabea9749f2d14ccc8d7d"><div class="ttname"><a href="classEoSparam.html#adf2bd4e34d7aabea9749f2d14ccc8d7d">EoSparam::Pc</a></div><div class="ttdeci">Type_A_r&lt; vector&lt; OCP_DBL &gt; &gt; Pc</div><div class="ttdoc">Critical pressure of hydrocarbon components.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00105">ParamReservoir.hpp:105</a></div></div>
<div class="ttc" id="aclassEoSparam_html_aec0108be6fff3bf486fa630aa1c30acc"><div class="ttname"><a href="classEoSparam.html#aec0108be6fff3bf486fa630aa1c30acc">EoSparam::Vc</a></div><div class="ttdeci">Type_A_r&lt; vector&lt; OCP_DBL &gt; &gt; Vc</div><div class="ttdoc">Critical volume of hydrocarbon components.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00106">ParamReservoir.hpp:106</a></div></div>
<div class="ttc" id="aclassEoSparam_html_aed55338b604ee04e2ffc79d8afc1564d"><div class="ttname"><a href="classEoSparam.html#aed55338b604ee04e2ffc79d8afc1564d">EoSparam::OmegaA</a></div><div class="ttdeci">Type_A_r&lt; vector&lt; OCP_DBL &gt; &gt; OmegaA</div><div class="ttdoc">OMEGA_A of hydrocarbon components.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00110">ParamReservoir.hpp:110</a></div></div>
<div class="ttc" id="aclassEoSparam_html_afb68cce409462e42baf65dbe909b8c4f"><div class="ttname"><a href="classEoSparam.html#afb68cce409462e42baf65dbe909b8c4f">EoSparam::BIC</a></div><div class="ttdeci">vector&lt; vector&lt; OCP_DBL &gt; &gt; BIC</div><div class="ttdoc">Binary interaction.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00118">ParamReservoir.hpp:118</a></div></div>
<div class="ttc" id="aclassEoSparam_html_afddc879be80be5e6123f25ce0d00d5a2"><div class="ttname"><a href="classEoSparam.html#afddc879be80be5e6123f25ce0d00d5a2">EoSparam::Tc</a></div><div class="ttdeci">Type_A_r&lt; vector&lt; OCP_DBL &gt; &gt; Tc</div><div class="ttdoc">Critical temperature of hydrocarbon components.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00104">ParamReservoir.hpp:104</a></div></div>
<div class="ttc" id="aclassEoSparam_html_afe436eaa0c42ae62bead2938106cb03c"><div class="ttname"><a href="classEoSparam.html#afe436eaa0c42ae62bead2938106cb03c">EoSparam::Parachor</a></div><div class="ttdeci">Type_A_r&lt; vector&lt; OCP_DBL &gt; &gt; Parachor</div><div class="ttdoc">PARACHOR of hydrocarbon components.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00113">ParamReservoir.hpp:113</a></div></div>
<div class="ttc" id="aclassEoSparam_html_aff7813ba74d19a812cbdb0ee4dbb53d0"><div class="ttname"><a href="classEoSparam.html#aff7813ba74d19a812cbdb0ee4dbb53d0">EoSparam::Zc</a></div><div class="ttdeci">Type_A_r&lt; vector&lt; OCP_DBL &gt; &gt; Zc</div><div class="ttdoc">Critical Z-factor of hydrocarbon components.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00107">ParamReservoir.hpp:107</a></div></div>
<div class="ttc" id="aclassEoSparam_html_affd2338845c0778f142a399f48302217"><div class="ttname"><a href="classEoSparam.html#affd2338845c0778f142a399f48302217">EoSparam::miscible</a></div><div class="ttdeci">bool miscible</div><div class="ttdoc">Miscible treatment of hydrocarbons, used in compositional Model.</div><div class="ttdef"><b>Definition:</b> <a href="ParamReservoir_8hpp_source.html#l00120">ParamReservoir.hpp:120</a></div></div>
<div class="ttc" id="aclassMixture_html_a13babfd95b6ec1687fb5e479e5a01707"><div class="ttname"><a href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">Mixture::numCom</a></div><div class="ttdeci">USI numCom</div><div class="ttdoc">num of components.</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00145">Mixture.hpp:145</a></div></div>
<div class="ttc" id="aclassMixture_html_a33b6d34ba499a57d9923d5316b652efc"><div class="ttname"><a href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">Mixture::numPhase</a></div><div class="ttdeci">USI numPhase</div><div class="ttdoc">num of phases.</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00144">Mixture.hpp:144</a></div></div>
<div class="ttc" id="aclassMixture_html_af9cd3ebf3d96509594d15bc1891ad801"><div class="ttname"><a href="classMixture.html#af9cd3ebf3d96509594d15bc1891ad801">Mixture::Allocate</a></div><div class="ttdeci">void Allocate()</div><div class="ttdoc">Allocate memory for common variables for basic class.</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00038">Mixture.hpp:38</a></div></div>
<div class="ttc" id="aclassNRparamSP_html_a8bda4ca724c4ad3a38f58f1bc2321d70"><div class="ttname"><a href="classNRparamSP.html#a8bda4ca724c4ad3a38f58f1bc2321d70">NRparamSP::tol2</a></div><div class="ttdeci">OCP_DBL tol2</div><div class="ttdoc">tol*tol</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00078">MixtureComp.hpp:78</a></div></div>
<div class="ttc" id="aclassNRparamSP_html_a92666e91c5347674e32907ed26f7f29e"><div class="ttname"><a href="classNRparamSP.html#a92666e91c5347674e32907ed26f7f29e">NRparamSP::maxIt</a></div><div class="ttdeci">USI maxIt</div><div class="ttdoc">Max Iteration.</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00076">MixtureComp.hpp:76</a></div></div>
<div class="ttc" id="aclassNRparamSP_html_ab370afbdbd3c29bc56bc841b5884157e"><div class="ttname"><a href="classNRparamSP.html#ab370afbdbd3c29bc56bc841b5884157e">NRparamSP::tol</a></div><div class="ttdeci">OCP_DBL tol</div><div class="ttdoc">Tolerance.</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00077">MixtureComp.hpp:77</a></div></div>
<div class="ttc" id="aclassNRparamSTA_html_a50dd883c925b1698481f4ef7c89b2102"><div class="ttname"><a href="classNRparamSTA.html#a50dd883c925b1698481f4ef7c89b2102">NRparamSTA::tol</a></div><div class="ttdeci">OCP_DBL tol</div><div class="ttdoc">Tolerance.</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00049">MixtureComp.hpp:49</a></div></div>
<div class="ttc" id="aclassNRparamSTA_html_aaaf5fa953901b9331260f4ff2991ea15"><div class="ttname"><a href="classNRparamSTA.html#aaaf5fa953901b9331260f4ff2991ea15">NRparamSTA::maxIt</a></div><div class="ttdeci">USI maxIt</div><div class="ttdoc">Max Iteration.</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00048">MixtureComp.hpp:48</a></div></div>
<div class="ttc" id="aclassNRparamSTA_html_ad1cd583ade36171543c53c5b437e6c13"><div class="ttname"><a href="classNRparamSTA.html#ad1cd583ade36171543c53c5b437e6c13">NRparamSTA::tol2</a></div><div class="ttdeci">OCP_DBL tol2</div><div class="ttdoc">tol*tol</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00050">MixtureComp.hpp:50</a></div></div>
<div class="ttc" id="aclassRRparam_html_a1505e7ba89a5df48bfc79035b78a3f22"><div class="ttname"><a href="classRRparam.html#a1505e7ba89a5df48bfc79035b78a3f22">RRparam::tol2</a></div><div class="ttdeci">OCP_DBL tol2</div><div class="ttdoc">tol*tol</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00091">MixtureComp.hpp:91</a></div></div>
<div class="ttc" id="aclassRRparam_html_a280d832a8525124b2c589abbf329b566"><div class="ttname"><a href="classRRparam.html#a280d832a8525124b2c589abbf329b566">RRparam::maxIt</a></div><div class="ttdeci">USI maxIt</div><div class="ttdoc">Max Iteration.</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00089">MixtureComp.hpp:89</a></div></div>
<div class="ttc" id="aclassRRparam_html_af38c3b481183d18bb91b4a722ec84254"><div class="ttname"><a href="classRRparam.html#af38c3b481183d18bb91b4a722ec84254">RRparam::tol</a></div><div class="ttdeci">OCP_DBL tol</div><div class="ttdoc">Tolerance.</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00090">MixtureComp.hpp:90</a></div></div>
<div class="ttc" id="aclassSSMparamSP_html_a2ac40bec493cba1386a27517c0f79ec1"><div class="ttname"><a href="classSSMparamSP.html#a2ac40bec493cba1386a27517c0f79ec1">SSMparamSP::tol</a></div><div class="ttdeci">OCP_DBL tol</div><div class="ttdoc">Tolerance.</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00063">MixtureComp.hpp:63</a></div></div>
<div class="ttc" id="aclassSSMparamSP_html_a68a0b481abc1d5564b374b9abcb3d0d6"><div class="ttname"><a href="classSSMparamSP.html#a68a0b481abc1d5564b374b9abcb3d0d6">SSMparamSP::tol2</a></div><div class="ttdeci">OCP_DBL tol2</div><div class="ttdoc">tol*tol</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00064">MixtureComp.hpp:64</a></div></div>
<div class="ttc" id="aclassSSMparamSP_html_aa2f90176c63acb15ab0add7739ad4748"><div class="ttname"><a href="classSSMparamSP.html#aa2f90176c63acb15ab0add7739ad4748">SSMparamSP::maxIt</a></div><div class="ttdeci">USI maxIt</div><div class="ttdoc">Max Iteration.</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00062">MixtureComp.hpp:62</a></div></div>
<div class="ttc" id="aclassSSMparamSTA_html_a35963a0398ba071ce0a6edf969afae88"><div class="ttname"><a href="classSSMparamSTA.html#a35963a0398ba071ce0a6edf969afae88">SSMparamSTA::eYt</a></div><div class="ttdeci">OCP_DBL eYt</div><div class="ttdoc">if Yt &gt; 1 + eYt, then single phase is unstable</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00035">MixtureComp.hpp:35</a></div></div>
<div class="ttc" id="aclassSSMparamSTA_html_a65bf34c5fc93f81627061f04196ebb24"><div class="ttname"><a href="classSSMparamSTA.html#a65bf34c5fc93f81627061f04196ebb24">SSMparamSTA::tol2</a></div><div class="ttdeci">OCP_DBL tol2</div><div class="ttdoc">tol*tol</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00036">MixtureComp.hpp:36</a></div></div>
<div class="ttc" id="aclassSSMparamSTA_html_acc0160e5384f8789fab7c7764fd23bd0"><div class="ttname"><a href="classSSMparamSTA.html#acc0160e5384f8789fab7c7764fd23bd0">SSMparamSTA::tol</a></div><div class="ttdeci">OCP_DBL tol</div><div class="ttdoc">Tolerance.</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00032">MixtureComp.hpp:32</a></div></div>
<div class="ttc" id="aclassSSMparamSTA_html_afa9aa64d939ebc09cafa04db1952cebb"><div class="ttname"><a href="classSSMparamSTA.html#afa9aa64d939ebc09cafa04db1952cebb">SSMparamSTA::maxIt</a></div><div class="ttdeci">USI maxIt</div><div class="ttdoc">Max Iteration.</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00031">MixtureComp.hpp:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a496c46d32bf4d6d96f9f8f7b2ed5f445" name="a496c46d32bf4d6d96f9f8f7b2ed5f445"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a496c46d32bf4d6d96f9f8f7b2ed5f445">&#9670;&#160;</a></span>AllocateEoS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::AllocateEoS </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00582">582</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  583</span>{</div>
<div class="line"><span class="lineno">  584</span>    <span class="comment">// Allocate Memoery for EoS variables</span></div>
<div class="line"><span class="lineno">  585</span>    Ai.resize(NC);</div>
<div class="line"><span class="lineno">  586</span>    Bi.resize(NC);</div>
<div class="line"><span class="lineno">  587</span>    Aj.resize(NPmax);</div>
<div class="line"><span class="lineno">  588</span>    Bj.resize(NPmax);</div>
<div class="line"><span class="lineno">  589</span>    Zj.resize(NPmax);</div>
<div class="line"><span class="lineno">  590</span>    Ztmp.resize(3);</div>
<div class="line"><span class="lineno">  591</span>    delta1P2 = delta1 + delta2;</div>
<div class="line"><span class="lineno">  592</span>    delta1M2 = delta1 - delta2;</div>
<div class="line"><span class="lineno">  593</span>    delta1T2 = delta1 * delta2;</div>
<div class="line"><span class="lineno">  594</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a76e85d017d79f90f730876dfb5346357" name="a76e85d017d79f90f730876dfb5346357"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76e85d017d79f90f730876dfb5346357">&#9670;&#160;</a></span>AllocateMethod()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::AllocateMethod </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00930">930</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  931</span>{</div>
<div class="line"><span class="lineno">  932</span>    Kw.resize(4);</div>
<div class="line"><span class="lineno">  933</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; 4; i++) {</div>
<div class="line"><span class="lineno">  934</span>        Kw[i].resize(NC);</div>
<div class="line"><span class="lineno">  935</span>    }</div>
<div class="line"><span class="lineno">  936</span>    Ks.resize(NPmax - 1);</div>
<div class="line"><span class="lineno">  937</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NPmax - 1; i++) {</div>
<div class="line"><span class="lineno">  938</span>        Ks[i].resize(NC);</div>
<div class="line"><span class="lineno">  939</span>    }</div>
<div class="line"><span class="lineno">  940</span>    phiSta.resize(NC);</div>
<div class="line"><span class="lineno">  941</span>    fugSta.resize(NC);</div>
<div class="line"><span class="lineno">  942</span> </div>
<div class="line"><span class="lineno">  943</span>    Y.resize(NC);</div>
<div class="line"><span class="lineno">  944</span>    di.resize(NC);</div>
<div class="line"><span class="lineno">  945</span>    resSTA.resize(NC);</div>
<div class="line"><span class="lineno">  946</span> </div>
<div class="line"><span class="lineno">  947</span>    JmatSTA.resize(NC * NC);</div>
<div class="line"><span class="lineno">  948</span>    Ax.resize(NC);</div>
<div class="line"><span class="lineno">  949</span>    Bx.resize(NC);</div>
<div class="line"><span class="lineno">  950</span>    Zx.resize(NC);</div>
<div class="line"><span class="lineno">  951</span>    phiN.resize(NC * NC);</div>
<div class="line"><span class="lineno">  952</span>    skipMatSTA.resize(NC * NC);</div>
<div class="line"><span class="lineno">  953</span>    eigenSkip.resize(NC);</div>
<div class="line"><span class="lineno">  954</span>    leigenWork = 2 * NC + 1;</div>
<div class="line"><span class="lineno">  955</span>    eigenWork.resize(leigenWork);</div>
<div class="line"><span class="lineno">  956</span>    lKs.resize(NC);</div>
<div class="line"><span class="lineno">  957</span> </div>
<div class="line"><span class="lineno">  958</span>    tmpRR.resize(NC);</div>
<div class="line"><span class="lineno">  959</span>    resRR.resize(NPmax - 1);</div>
<div class="line"><span class="lineno">  960</span>    resSP.resize(NC * NPmax);</div>
<div class="line"><span class="lineno">  961</span>    JmatSP.resize(NC * NC * NPmax * NPmax);</div>
<div class="line"><span class="lineno">  962</span>    fugX.resize(NPmax);</div>
<div class="line"><span class="lineno">  963</span>    fugN.resize(NPmax);</div>
<div class="line"><span class="lineno">  964</span>    Zn.resize(NPmax);</div>
<div class="line"><span class="lineno">  965</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NPmax; j++) {</div>
<div class="line"><span class="lineno">  966</span>        fugX[j].resize(NC * NC);</div>
<div class="line"><span class="lineno">  967</span>        fugN[j].resize(NC * NC);</div>
<div class="line"><span class="lineno">  968</span>        Zn[j].resize(NC);</div>
<div class="line"><span class="lineno">  969</span>    }</div>
<div class="line"><span class="lineno">  970</span>    An.resize(NC);</div>
<div class="line"><span class="lineno">  971</span>    Bn.resize(NC);</div>
<div class="line"><span class="lineno">  972</span>    pivot.resize((NC + 1) * NPmax, 1);</div>
<div class="line"><span class="lineno">  973</span>    lJmatWork = NC * (NPmax - 1);</div>
<div class="line"><span class="lineno">  974</span>    JmatWork.resize(lJmatWork);</div>
<div class="line"><span class="lineno">  975</span> </div>
<div class="line"><span class="lineno">  976</span>    pivot.resize(NPmax * NC + <a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a>, 1);</div>
<div class="line"><span class="lineno">  977</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a027988c9dedc60083b1a0e5a717a2d00" name="a027988c9dedc60083b1a0e5a717a2d00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a027988c9dedc60083b1a0e5a717a2d00">&#9670;&#160;</a></span>AllocateOthers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::AllocateOthers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l02090">2090</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2091</span>{</div>
<div class="line"><span class="lineno"> 2092</span>    sqrtMWi.resize(NC);</div>
<div class="line"><span class="lineno"> 2093</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) sqrtMWi[i] = sqrt(MWC[i]);</div>
<div class="line"><span class="lineno"> 2094</span>    muC.resize(NPmax);</div>
<div class="line"><span class="lineno"> 2095</span>    muAux.resize(NPmax);</div>
<div class="line"><span class="lineno"> 2096</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NPmax; i++) {</div>
<div class="line"><span class="lineno"> 2097</span>        muAux[i].resize(5);</div>
<div class="line"><span class="lineno"> 2098</span>    }</div>
<div class="line"><span class="lineno"> 2099</span>    muAux1I.resize(NC);</div>
<div class="line"><span class="lineno"> 2100</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 2101</span>        muAux1I[i] = 5.4402 * pow(Tc[i], 1.0 / 6) / pow(Pc[i], 2.0 / 3);</div>
<div class="line"><span class="lineno"> 2102</span>    }</div>
<div class="line"><span class="lineno"> 2103</span>    fugP.resize(NPmax);</div>
<div class="line"><span class="lineno"> 2104</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NPmax; j++) {</div>
<div class="line"><span class="lineno"> 2105</span>        fugP[j].resize(NC);</div>
<div class="line"><span class="lineno"> 2106</span>    }</div>
<div class="line"><span class="lineno"> 2107</span>    Zp.resize(NPmax);</div>
<div class="line"><span class="lineno"> 2108</span>    JmatDer.resize(NPmax * NPmax * (NC + 1) * (NC + 1));</div>
<div class="line"><span class="lineno"> 2109</span>    JmatTmp = JmatDer;</div>
<div class="line"><span class="lineno"> 2110</span>    rhsDer.resize(NPmax * (NC + 1) * (NC + 1));</div>
<div class="line"><span class="lineno"> 2111</span>    xixC.resize(NPmax * NC);</div>
<div class="line"><span class="lineno"> 2112</span>    xiPC.resize(NPmax);</div>
<div class="line"><span class="lineno"> 2113</span>    xiNC.resize(NPmax * NC);</div>
<div class="line"><span class="lineno"> 2114</span> </div>
<div class="line"><span class="lineno"> 2115</span>    <span class="comment">// new</span></div>
<div class="line"><span class="lineno"> 2116</span>    JmatDer.resize((<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> + NPmax * NC) * (<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> + NPmax * NC));</div>
<div class="line"><span class="lineno"> 2117</span>    JmatTmp = JmatDer;</div>
<div class="line"><span class="lineno"> 2118</span>    rhsDer.resize((<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> + NPmax * NC) * (<a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + 1 + 1));</div>
<div class="line"><span class="lineno"> 2119</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aedc16a2403548e2e9887435e78526fd1" name="aedc16a2403548e2e9887435e78526fd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedc16a2403548e2e9887435e78526fd1">&#9670;&#160;</a></span>AllocatePhase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::AllocatePhase </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00678">678</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  679</span>{</div>
<div class="line"><span class="lineno">  680</span>    <span class="comment">// Allocate Memoery for Phase variables</span></div>
<div class="line"><span class="lineno">  681</span>    vC.resize(NPmax);</div>
<div class="line"><span class="lineno">  682</span>    nu.resize(NPmax);</div>
<div class="line"><span class="lineno">  683</span>    xiC.resize(NPmax);</div>
<div class="line"><span class="lineno">  684</span>    rhoC.resize(NPmax);</div>
<div class="line"><span class="lineno">  685</span>    MW.resize(NPmax);</div>
<div class="line"><span class="lineno">  686</span>    phaseLabel.resize(NPmax);</div>
<div class="line"><span class="lineno">  687</span>    x.resize(NPmax);</div>
<div class="line"><span class="lineno">  688</span>    phi.resize(NPmax);</div>
<div class="line"><span class="lineno">  689</span>    fug.resize(NPmax);</div>
<div class="line"><span class="lineno">  690</span>    n.resize(NPmax);</div>
<div class="line"><span class="lineno">  691</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NPmax; j++) {</div>
<div class="line"><span class="lineno">  692</span>        x[j].resize(NC);</div>
<div class="line"><span class="lineno">  693</span>        phi[j].resize(NC);</div>
<div class="line"><span class="lineno">  694</span>        fug[j].resize(NC);</div>
<div class="line"><span class="lineno">  695</span>        n[j].resize(NC);</div>
<div class="line"><span class="lineno">  696</span>    }</div>
<div class="line"><span class="lineno">  697</span>    ln = n;</div>
<div class="line"><span class="lineno">  698</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a640d65f99a2486920c6a6d351b1b3163" name="a640d65f99a2486920c6a6d351b1b3163"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a640d65f99a2486920c6a6d351b1b3163">&#9670;&#160;</a></span>AssembleJmatSP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::AssembleJmatSP </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l01938">1938</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1939</span>{</div>
<div class="line"><span class="lineno"> 1940</span>    <span class="comment">// Dim: (NP-1)*NC</span></div>
<div class="line"><span class="lineno"> 1941</span>    <span class="comment">// Attention that fugNj is sysmetric</span></div>
<div class="line"><span class="lineno"> 1942</span>    fill(JmatSP.begin(), JmatSP.end(), 0);</div>
<div class="line"><span class="lineno"> 1943</span> </div>
<div class="line"><span class="lineno"> 1944</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>*       Jtmp = &amp;JmatSP[0];</div>
<div class="line"><span class="lineno"> 1945</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* fugNp;</div>
<div class="line"><span class="lineno"> 1946</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* fugNj;</div>
<div class="line"><span class="lineno"> 1947</span> </div>
<div class="line"><span class="lineno"> 1948</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP - 1; j++) {</div>
<div class="line"><span class="lineno"> 1949</span>        fugNp = &amp;fugN[NP - 1][0];</div>
<div class="line"><span class="lineno"> 1950</span>        fugNj = &amp;fugN[j][0];</div>
<div class="line"><span class="lineno"> 1951</span> </div>
<div class="line"><span class="lineno"> 1952</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1953</span>            <span class="comment">// ith components</span></div>
<div class="line"><span class="lineno"> 1954</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 1955</span>                <span class="comment">// kth fugacity</span></div>
<div class="line"><span class="lineno"> 1956</span>                Jtmp[k] = fugNj[k] + fugNp[k];</div>
<div class="line"><span class="lineno"> 1957</span>            }</div>
<div class="line"><span class="lineno"> 1958</span>            Jtmp += NC * (NP - 1);</div>
<div class="line"><span class="lineno"> 1959</span>            fugNp += NC;</div>
<div class="line"><span class="lineno"> 1960</span>            fugNj += NC;</div>
<div class="line"><span class="lineno"> 1961</span>        }</div>
<div class="line"><span class="lineno"> 1962</span>        Jtmp += NC;</div>
<div class="line"><span class="lineno"> 1963</span>    }</div>
<div class="line"><span class="lineno"> 1964</span> </div>
<div class="line"><span class="lineno"> 1965</span>    <span class="comment">//cout &lt;&lt; endl &lt;&lt; &quot;Jmat&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1966</span>    <span class="comment">//for (USI i = 0; i &lt; NC; i++) {</span></div>
<div class="line"><span class="lineno"> 1967</span>    <span class="comment">//    for (USI j = 0; j &lt; NC; j++) {</span></div>
<div class="line"><span class="lineno"> 1968</span>    <span class="comment">//        cout &lt;&lt; scientific &lt;&lt; setprecision(6) &lt;&lt; JmatSP[i * NC + j] &lt;&lt; &quot;   &quot;;</span></div>
<div class="line"><span class="lineno"> 1969</span>    <span class="comment">//    }</span></div>
<div class="line"><span class="lineno"> 1970</span>    <span class="comment">//    cout &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1971</span>    <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 1972</span>}</div>
<div class="ttc" id="aOCPConst_8hpp_html_a2c355586809161c6f4c3a35ebfa7cb1f"><div class="ttname"><a href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a></div><div class="ttdeci">double OCP_DBL</div><div class="ttdoc">Double precision.</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00026">OCPConst.hpp:26</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a46d5104d01845446c66f5829902dfc4b" name="a46d5104d01845446c66f5829902dfc4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46d5104d01845446c66f5829902dfc4b">&#9670;&#160;</a></span>AssembleJmatSTA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::AssembleJmatSTA </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l01480">1480</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1481</span>{</div>
<div class="line"><span class="lineno"> 1482</span>    vector&lt;OCP_DBL&gt;&amp; fugx = fugX[0];</div>
<div class="line"><span class="lineno"> 1483</span>    fill(JmatSTA.begin(), JmatSTA.end(), 0.0);</div>
<div class="line"><span class="lineno"> 1484</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp;</div>
<div class="line"><span class="lineno"> 1485</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1486</span> </div>
<div class="line"><span class="lineno"> 1487</span>        tmp = 0;</div>
<div class="line"><span class="lineno"> 1488</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 1489</span>            tmp += Y[k] * fugx[i * NC + k];</div>
<div class="line"><span class="lineno"> 1490</span>        }</div>
<div class="line"><span class="lineno"> 1491</span> </div>
<div class="line"><span class="lineno"> 1492</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NC; j++) {</div>
<div class="line"><span class="lineno"> 1493</span>            <span class="comment">// Symmetric</span></div>
<div class="line"><span class="lineno"> 1494</span>            <span class="comment">// JmatSTA[i * NC + j] = (fugx[i * NC + j] - tmp + delta(i, j) / Y[i]) / Yt;</span></div>
<div class="line"><span class="lineno"> 1495</span>            JmatSTA[i * NC + j] = (fugx[i * NC + j] - tmp + 1) / Yt;</div>
<div class="line"><span class="lineno"> 1496</span>        }</div>
<div class="line"><span class="lineno"> 1497</span>    }</div>
<div class="line"><span class="lineno"> 1498</span>    <span class="comment">// cout &lt;&lt; &quot;JmatSTA&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1499</span>    <span class="comment">// for (USI i = 0; i &lt; NC; i++) {</span></div>
<div class="line"><span class="lineno"> 1500</span>    <span class="comment">//  for (USI k = 0; k &lt; NC; k++) {</span></div>
<div class="line"><span class="lineno"> 1501</span>    <span class="comment">//      cout &lt;&lt; JmatSTA[k * NC + i] &lt;&lt; &quot;      &quot;;</span></div>
<div class="line"><span class="lineno"> 1502</span>    <span class="comment">//  }</span></div>
<div class="line"><span class="lineno"> 1503</span>    <span class="comment">//  cout &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1504</span>    <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 1505</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a64097813d71ccb9956776c2f90134868" name="a64097813d71ccb9956776c2f90134868"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64097813d71ccb9956776c2f90134868">&#9670;&#160;</a></span>AssembleMatVfiVfp_full01()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::AssembleMatVfiVfp_full01 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l03688">3688</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3689</span>{</div>
<div class="line"><span class="lineno"> 3690</span>    fill(JmatDer.begin(), JmatDer.end(), 0.0);</div>
<div class="line"><span class="lineno"> 3691</span>    <span class="comment">// Attention 1: JmatDer should be sorted by column</span></div>
<div class="line"><span class="lineno"> 3692</span>    <span class="comment">// Attention 2: d ln fij / d nkj is symetric for each j;</span></div>
<div class="line"><span class="lineno"> 3693</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* bId = &amp;JmatDer[0];</div>
<div class="line"><span class="lineno"> 3694</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP - 1; j++) {</div>
<div class="line"><span class="lineno"> 3695</span>        <span class="comment">// for jth phase</span></div>
<div class="line"><span class="lineno"> 3696</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* fugNj = &amp;fugN[j][0];</div>
<div class="line"><span class="lineno"> 3697</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3698</span>            <span class="comment">// for ith components</span></div>
<div class="line"><span class="lineno"> 3699</span>            <a class="code hl_function" href="DenseMat_8hpp.html#ae3d6d69eb9175bc2ed3414c44bde7a8d">Dcopy</a>(NC, bId, fugNj);</div>
<div class="line"><span class="lineno"> 3700</span>            bId += (NP - 1 - j) * NC;</div>
<div class="line"><span class="lineno"> 3701</span>            bId[i] = 1.0;</div>
<div class="line"><span class="lineno"> 3702</span>            bId += (1 + j) * NC;</div>
<div class="line"><span class="lineno"> 3703</span>            fugNj += NC;</div>
<div class="line"><span class="lineno"> 3704</span>        }</div>
<div class="line"><span class="lineno"> 3705</span>        bId += NC;</div>
<div class="line"><span class="lineno"> 3706</span>    }</div>
<div class="line"><span class="lineno"> 3707</span>    <span class="comment">// NP - 1 phase</span></div>
<div class="line"><span class="lineno"> 3708</span>    bId            = &amp;JmatDer[(NP - 1) * (NP * NC * NC)];</div>
<div class="line"><span class="lineno"> 3709</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* fugNj = &amp;fugN[NP - 1][0];</div>
<div class="line"><span class="lineno"> 3710</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3711</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP - 1; j++) {</div>
<div class="line"><span class="lineno"> 3712</span>            <a class="code hl_function" href="DenseMat_8hpp.html#ae3d6d69eb9175bc2ed3414c44bde7a8d">Dcopy</a>(NC, bId, fugNj);</div>
<div class="line"><span class="lineno"> 3713</span>            bId += NC;</div>
<div class="line"><span class="lineno"> 3714</span>        }</div>
<div class="line"><span class="lineno"> 3715</span>        <a class="code hl_function" href="DenseMat_8hpp.html#a3fb701e3ab34443119b7b2ba7a2bc6c7">Dscalar</a>((NP - 1) * NC, -1.0, bId - (NP - 1) * NC);</div>
<div class="line"><span class="lineno"> 3716</span>        fugNj += NC;</div>
<div class="line"><span class="lineno"> 3717</span>        bId[i] = 1.0;</div>
<div class="line"><span class="lineno"> 3718</span>        bId += NC;</div>
<div class="line"><span class="lineno"> 3719</span>    }</div>
<div class="line"><span class="lineno"> 3720</span>}</div>
<div class="ttc" id="aDenseMat_8hpp_html_a3fb701e3ab34443119b7b2ba7a2bc6c7"><div class="ttname"><a href="DenseMat_8hpp.html#a3fb701e3ab34443119b7b2ba7a2bc6c7">Dscalar</a></div><div class="ttdeci">void Dscalar(const int &amp;n, const double &amp;alpha, double *x)</div><div class="ttdoc">Scales a vector by a constant.</div><div class="ttdef"><b>Definition:</b> <a href="DenseMat_8cpp_source.html#l00062">DenseMat.cpp:62</a></div></div>
<div class="ttc" id="aDenseMat_8hpp_html_ae3d6d69eb9175bc2ed3414c44bde7a8d"><div class="ttname"><a href="DenseMat_8hpp.html#ae3d6d69eb9175bc2ed3414c44bde7a8d">Dcopy</a></div><div class="ttdeci">void Dcopy(const int &amp;N, double *dst, const double *src)</div><div class="ttdoc">Calculate the minimal eigenvalue for sysmetric matrix with mkl lapack.</div><div class="ttdef"><b>Definition:</b> <a href="DenseMat_8cpp_source.html#l00037">DenseMat.cpp:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abedeb45e0c308d0c0d40ed743386dae5" name="abedeb45e0c308d0c0d40ed743386dae5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abedeb45e0c308d0c0d40ed743386dae5">&#9670;&#160;</a></span>AssembleMatVfiVfp_full02()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::AssembleMatVfiVfp_full02 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l03829">3829</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3830</span>{</div>
<div class="line"><span class="lineno"> 3831</span>    <span class="comment">// NP = 2</span></div>
<div class="line"><span class="lineno"> 3832</span>    fill(JmatDer.begin(), JmatDer.end(), 0.0);</div>
<div class="line"><span class="lineno"> 3833</span>    <span class="comment">// Attention 1: JmatDer should be sorted by column</span></div>
<div class="line"><span class="lineno"> 3834</span>    <span class="comment">// Attention 2: d ln fij / d nkj is symetric for each j;</span></div>
<div class="line"><span class="lineno"> 3835</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* tmpMat = &amp;JmatDer[0];</div>
<div class="line"><span class="lineno"> 3836</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3837</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 3838</span>            tmpMat[m] = fugN[0][i * NC + m] + fugN[1][i * NC + m];</div>
<div class="line"><span class="lineno"> 3839</span>        }</div>
<div class="line"><span class="lineno"> 3840</span>        tmpMat += NC;</div>
<div class="line"><span class="lineno"> 3841</span>    }</div>
<div class="line"><span class="lineno"> 3842</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2fcbf792581a6948b80bda3c44fd91e6" name="a2fcbf792581a6948b80bda3c44fd91e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fcbf792581a6948b80bda3c44fd91e6">&#9670;&#160;</a></span>AssembleRhsVfiVfp_full01()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::AssembleRhsVfiVfp_full01 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l03722">3722</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3723</span>{</div>
<div class="line"><span class="lineno"> 3724</span>    fill(rhsDer.begin(), rhsDer.end(), 0.0);</div>
<div class="line"><span class="lineno"> 3725</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* rhstmp = &amp;rhsDer[0];</div>
<div class="line"><span class="lineno"> 3726</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 3727</span>        <span class="comment">// d Nk</span></div>
<div class="line"><span class="lineno"> 3728</span>        rhstmp[NC * (NP - 1) + k] = 1;</div>
<div class="line"><span class="lineno"> 3729</span>        rhstmp += NP * NC;</div>
<div class="line"><span class="lineno"> 3730</span>    }</div>
<div class="line"><span class="lineno"> 3731</span>    <span class="comment">// d P</span></div>
<div class="line"><span class="lineno"> 3732</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 3733</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3734</span>            rhstmp[j * NC + i] = fugP[NP - 1][i] - fugP[j][i];</div>
<div class="line"><span class="lineno"> 3735</span>        }</div>
<div class="line"><span class="lineno"> 3736</span>    }</div>
<div class="line"><span class="lineno"> 3737</span> </div>
<div class="line"><span class="lineno"> 3738</span> </div>
<div class="line"><span class="lineno"> 3739</span><span class="preprocessor">#ifdef OCP_NANCHECK</span></div>
<div class="line"><span class="lineno"> 3740</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="DenseMat_8hpp.html#a56bc3abd4d498e5055b3da3a58d45bad">CheckNan</a>(rhsDer.size(), &amp;rhsDer[0])) {</div>
<div class="line"><span class="lineno"> 3741</span>        <a class="code hl_define" href="UtilError_8hpp.html#aecfc13af45c4bb869301d5ce54cba0af">OCP_ABORT</a>(<span class="stringliteral">&quot;INF or NAN in rhsDer !&quot;</span>);</div>
<div class="line"><span class="lineno"> 3742</span>    }</div>
<div class="line"><span class="lineno"> 3743</span><span class="preprocessor">#endif </span><span class="comment">// NANCHECK</span></div>
<div class="line"><span class="lineno"> 3744</span>}</div>
<div class="ttc" id="aDenseMat_8hpp_html_a56bc3abd4d498e5055b3da3a58d45bad"><div class="ttname"><a href="DenseMat_8hpp.html#a56bc3abd4d498e5055b3da3a58d45bad">CheckNan</a></div><div class="ttdeci">bool CheckNan(const int &amp;N, const T *x)</div><div class="ttdoc">check NaN</div><div class="ttdef"><b>Definition:</b> <a href="DenseMat_8hpp_source.html#l00132">DenseMat.hpp:132</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="add42fde1eeb1627d96941d0b403a7156" name="add42fde1eeb1627d96941d0b403a7156"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add42fde1eeb1627d96941d0b403a7156">&#9670;&#160;</a></span>AssembleRhsVfiVfp_full02()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::AssembleRhsVfiVfp_full02 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l03844">3844</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3845</span>{</div>
<div class="line"><span class="lineno"> 3846</span>    <span class="comment">// NP = 2</span></div>
<div class="line"><span class="lineno"> 3847</span>    fill(rhsDer.begin(), rhsDer.end(), 0.0);</div>
<div class="line"><span class="lineno"> 3848</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* rhstmp = &amp;rhsDer[0];</div>
<div class="line"><span class="lineno"> 3849</span> </div>
<div class="line"><span class="lineno"> 3850</span>    <span class="comment">// dP</span></div>
<div class="line"><span class="lineno"> 3851</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3852</span>        rhstmp[i] = fugP[1][i] - fugP[0][i];</div>
<div class="line"><span class="lineno"> 3853</span>    }</div>
<div class="line"><span class="lineno"> 3854</span>    rhstmp += NC;</div>
<div class="line"><span class="lineno"> 3855</span> </div>
<div class="line"><span class="lineno"> 3856</span>    <span class="comment">// dNk</span></div>
<div class="line"><span class="lineno"> 3857</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 3858</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3859</span>            rhstmp[i] = fugN[1][k * NC + i]; <span class="comment">// d lnfij / d nkj = d lnfkj / d nij</span></div>
<div class="line"><span class="lineno"> 3860</span>        }</div>
<div class="line"><span class="lineno"> 3861</span>        rhstmp += NC;</div>
<div class="line"><span class="lineno"> 3862</span>    }</div>
<div class="line"><span class="lineno"> 3863</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3dd49e118650f4472cffa4e6792c391f" name="a3dd49e118650f4472cffa4e6792c391f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dd49e118650f4472cffa4e6792c391f">&#9670;&#160;</a></span>AssembleSkipMatSTA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::AssembleSkipMatSTA </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l02047">2047</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2048</span>{</div>
<div class="line"><span class="lineno"> 2049</span>    <span class="comment">// Sysmetric Matrix</span></div>
<div class="line"><span class="lineno"> 2050</span>    <span class="comment">// stored by colum</span></div>
<div class="line"><span class="lineno"> 2051</span>    vector&lt;OCP_DBL&gt;&amp; xj = x[0];</div>
<div class="line"><span class="lineno"> 2052</span> </div>
<div class="line"><span class="lineno"> 2053</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 2054</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt;= i; j++) {</div>
<div class="line"><span class="lineno"> 2055</span>            skipMatSTA[i * NC + j] = delta(i, j) + sqrt(xj[i] * xj[j]) * phiN[i * NC + j];</div>
<div class="line"><span class="lineno"> 2056</span>            skipMatSTA[j * NC + i] = skipMatSTA[i * NC + j];</div>
<div class="line"><span class="lineno"> 2057</span>        }</div>
<div class="line"><span class="lineno"> 2058</span>    }</div>
<div class="line"><span class="lineno"> 2059</span> </div>
<div class="line"><span class="lineno"> 2060</span><span class="comment">/*    cout &lt;&lt; endl &lt;&lt; &quot;skipMatSTA&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 2061</span><span class="comment">    for (USI i = 0; i &lt; NC; i++) {</span></div>
<div class="line"><span class="lineno"> 2062</span><span class="comment">        for (USI j = 0; j &lt; NC; j++) {</span></div>
<div class="line"><span class="lineno"> 2063</span><span class="comment">            cout &lt;&lt; skipMatSTA[i * NC + j] &lt;&lt; &quot;   &quot;;</span></div>
<div class="line"><span class="lineno"> 2064</span><span class="comment">        }</span></div>
<div class="line"><span class="lineno"> 2065</span><span class="comment">        cout &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 2066</span><span class="comment">    } */</span>  </div>
<div class="line"><span class="lineno"> 2067</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9b47df0743c6168668e73968079c3905" name="a9b47df0743c6168668e73968079c3905"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b47df0743c6168668e73968079c3905">&#9670;&#160;</a></span>CalAiBi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalAiBi </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00623">623</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  624</span>{</div>
<div class="line"><span class="lineno">  625</span>    <span class="comment">// Calculate Ai, Bi</span></div>
<div class="line"><span class="lineno">  626</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> acf, mwi;</div>
<div class="line"><span class="lineno">  627</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pri, Tri;</div>
<div class="line"><span class="lineno">  628</span> </div>
<div class="line"><span class="lineno">  629</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno">  630</span>        acf = Acf[i];</div>
<div class="line"><span class="lineno">  631</span>        <span class="comment">// PR</span></div>
<div class="line"><span class="lineno">  632</span>        <span class="keywordflow">if</span> (acf &lt;= 0.49) {</div>
<div class="line"><span class="lineno">  633</span>            mwi = 0.37464 + 1.54226 * acf - 0.26992 * pow(acf, 2);</div>
<div class="line"><span class="lineno">  634</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  635</span>            mwi = 0.379642 + 1.48503 * acf - 0.164423 * pow(acf, 2) +</div>
<div class="line"><span class="lineno">  636</span>                  0.016667 * pow(acf, 3);</div>
<div class="line"><span class="lineno">  637</span>        }</div>
<div class="line"><span class="lineno">  638</span> </div>
<div class="line"><span class="lineno">  639</span>        Pri   = P / Pc[i];</div>
<div class="line"><span class="lineno">  640</span>        Tri   = T / Tc[i];</div>
<div class="line"><span class="lineno">  641</span>        Ai[i] = OmegaA[i] * Pri / pow(Tri, 2) * pow((1 + mwi * (1 - sqrt(Tri))), 2);     </div>
<div class="line"><span class="lineno">  642</span>        Bi[i] = OmegaB[i] * Pri / Tri;</div>
<div class="line"><span class="lineno">  643</span>    }</div>
<div class="line"><span class="lineno">  644</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aba437bbb9722708be4a0eb9c5347822b" name="aba437bbb9722708be4a0eb9c5347822b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba437bbb9722708be4a0eb9c5347822b">&#9670;&#160;</a></span>CalAjBj() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalAjBj </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>AjT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>BjT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *&#160;</td>
          <td class="paramname"><em>xj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00662">662</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  663</span>{</div>
<div class="line"><span class="lineno">  664</span>    AjT = 0;</div>
<div class="line"><span class="lineno">  665</span>    BjT = 0;</div>
<div class="line"><span class="lineno">  666</span> </div>
<div class="line"><span class="lineno">  667</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i1 = 0; i1 &lt; NC; i1++) {</div>
<div class="line"><span class="lineno">  668</span>        BjT += Bi[i1] * xj[i1];</div>
<div class="line"><span class="lineno">  669</span>        AjT += xj[i1] * xj[i1] * Ai[i1] * (1 - BIC[i1 * NC + i1]);</div>
<div class="line"><span class="lineno">  670</span> </div>
<div class="line"><span class="lineno">  671</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i2 = 0; i2 &lt; i1; i2++) {</div>
<div class="line"><span class="lineno">  672</span>            AjT +=</div>
<div class="line"><span class="lineno">  673</span>                2 * xj[i1] * xj[i2] * sqrt(Ai[i1] * Ai[i2]) * (1 - BIC[i1 * NC + i2]);</div>
<div class="line"><span class="lineno">  674</span>        }</div>
<div class="line"><span class="lineno">  675</span>    }</div>
<div class="line"><span class="lineno">  676</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9c5e169880545f9b5443f7e664d0073e" name="a9c5e169880545f9b5443f7e664d0073e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c5e169880545f9b5443f7e664d0073e">&#9670;&#160;</a></span>CalAjBj() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalAjBj </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>AjT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>BjT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>xj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00646">646</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  647</span>{</div>
<div class="line"><span class="lineno">  648</span>    AjT = 0;</div>
<div class="line"><span class="lineno">  649</span>    BjT = 0;</div>
<div class="line"><span class="lineno">  650</span> </div>
<div class="line"><span class="lineno">  651</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i1 = 0; i1 &lt; NC; i1++) {</div>
<div class="line"><span class="lineno">  652</span>        BjT += Bi[i1] * xj[i1];</div>
<div class="line"><span class="lineno">  653</span>        AjT += xj[i1] * xj[i1] * Ai[i1] * (1 - BIC[i1 * NC + i1]);</div>
<div class="line"><span class="lineno">  654</span> </div>
<div class="line"><span class="lineno">  655</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i2 = 0; i2 &lt; i1; i2++) {</div>
<div class="line"><span class="lineno">  656</span>            AjT +=</div>
<div class="line"><span class="lineno">  657</span>                2 * xj[i1] * xj[i2] * sqrt(Ai[i1] * Ai[i2]) * (1 - BIC[i1 * NC + i2]);</div>
<div class="line"><span class="lineno">  658</span>        }</div>
<div class="line"><span class="lineno">  659</span>    }</div>
<div class="line"><span class="lineno">  660</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a17f7fcd72f74d0f4d4d55fd43bb7ada5" name="a17f7fcd72f74d0f4d4d55fd43bb7ada5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17f7fcd72f74d0f4d4d55fd43bb7ada5">&#9670;&#160;</a></span>CaldXsdXp01()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CaldXsdXp01 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l03865">3865</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3866</span>{</div>
<div class="line"><span class="lineno"> 3867</span> </div>
<div class="line"><span class="lineno"> 3868</span>    <span class="comment">// NP &gt; 1 in this function</span></div>
<div class="line"><span class="lineno"> 3869</span>    <span class="comment">// only hydrocarbon was considered</span></div>
<div class="line"><span class="lineno"> 3870</span>    <span class="comment">// if water exists, vf, vfp, and S should be updated</span></div>
<div class="line"><span class="lineno"> 3871</span>    <span class="comment">// CalVfiVfp_full01() and CalXiPNX_full01() should be called before</span></div>
<div class="line"><span class="lineno"> 3872</span>    </div>
<div class="line"><span class="lineno"> 3873</span> </div>
<div class="line"><span class="lineno"> 3874</span>    fill(JmatTmp.begin(), JmatTmp.end(), 0.0);</div>
<div class="line"><span class="lineno"> 3875</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* MTmp = &amp;JmatTmp[0];</div>
<div class="line"><span class="lineno"> 3876</span> </div>
<div class="line"><span class="lineno"> 3877</span>    <span class="comment">// dF / dXs</span></div>
<div class="line"><span class="lineno"> 3878</span>    <span class="comment">// dFn / dXs</span></div>
<div class="line"><span class="lineno"> 3879</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3880</span>        <span class="comment">// dFn / dSm</span></div>
<div class="line"><span class="lineno"> 3881</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NP; m++) {</div>
<div class="line"><span class="lineno"> 3882</span>            MTmp[m] = <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> * xiC[m] * x[m][i];</div>
<div class="line"><span class="lineno"> 3883</span>        }</div>
<div class="line"><span class="lineno"> 3884</span>        MTmp += NP;</div>
<div class="line"><span class="lineno"> 3885</span>        <span class="comment">// dFn / dxnm</span></div>
<div class="line"><span class="lineno"> 3886</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NP; m++) {</div>
<div class="line"><span class="lineno"> 3887</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> n = 0; n &lt; NC; n++) {</div>
<div class="line"><span class="lineno"> 3888</span>                MTmp[n] =</div>
<div class="line"><span class="lineno"> 3889</span>                    <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> * <a class="code hl_variable" href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">S</a>[m] * (xixC[m * NC + n] * x[m][i] + delta(i, n) * xiC[m]);</div>
<div class="line"><span class="lineno"> 3890</span>            }</div>
<div class="line"><span class="lineno"> 3891</span>            MTmp += NC;</div>
<div class="line"><span class="lineno"> 3892</span>        }</div>
<div class="line"><span class="lineno"> 3893</span>    }</div>
<div class="line"><span class="lineno"> 3894</span>    <span class="comment">// dFx / dXs</span></div>
<div class="line"><span class="lineno"> 3895</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 3896</span>        <span class="comment">// dFx / dSm</span></div>
<div class="line"><span class="lineno"> 3897</span>        MTmp += NP;</div>
<div class="line"><span class="lineno"> 3898</span>        <span class="comment">// dFx / dxnm, m = j</span></div>
<div class="line"><span class="lineno"> 3899</span>        MTmp += j * NC;</div>
<div class="line"><span class="lineno"> 3900</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> n = 0; n &lt; NC; n++) {</div>
<div class="line"><span class="lineno"> 3901</span>            MTmp[n] = 1.0;</div>
<div class="line"><span class="lineno"> 3902</span>        }</div>
<div class="line"><span class="lineno"> 3903</span>        MTmp += (NP - j) * NC;</div>
<div class="line"><span class="lineno"> 3904</span>    }</div>
<div class="line"><span class="lineno"> 3905</span>    <span class="comment">// dFf / dXs</span></div>
<div class="line"><span class="lineno"> 3906</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP - 1; j++) {</div>
<div class="line"><span class="lineno"> 3907</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* fugXJ  = &amp;fugX[j][0];</div>
<div class="line"><span class="lineno"> 3908</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* fugXNP = &amp;fugX[NP - 1][0];</div>
<div class="line"><span class="lineno"> 3909</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3910</span>            <span class="comment">// dFf / dSm</span></div>
<div class="line"><span class="lineno"> 3911</span>            MTmp += NP;</div>
<div class="line"><span class="lineno"> 3912</span>            <span class="comment">// dFf / dxnm, m = j or m = np-1</span></div>
<div class="line"><span class="lineno"> 3913</span>            <span class="comment">// m = j</span></div>
<div class="line"><span class="lineno"> 3914</span>            MTmp += j * NC;</div>
<div class="line"><span class="lineno"> 3915</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> n = 0; n &lt; NC; n++) {</div>
<div class="line"><span class="lineno"> 3916</span>                MTmp[n] = fugXJ[n];</div>
<div class="line"><span class="lineno"> 3917</span>            }</div>
<div class="line"><span class="lineno"> 3918</span>            fugXJ += NC;</div>
<div class="line"><span class="lineno"> 3919</span>            <span class="comment">// m = np-1</span></div>
<div class="line"><span class="lineno"> 3920</span>            MTmp += (NP - 1 - j) * NC;</div>
<div class="line"><span class="lineno"> 3921</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> n = 0; n &lt; NC; n++) {</div>
<div class="line"><span class="lineno"> 3922</span>                MTmp[n] = -fugXNP[n];</div>
<div class="line"><span class="lineno"> 3923</span>            }</div>
<div class="line"><span class="lineno"> 3924</span>            fugXNP += NC;</div>
<div class="line"><span class="lineno"> 3925</span>            MTmp += NC;</div>
<div class="line"><span class="lineno"> 3926</span>        }</div>
<div class="line"><span class="lineno"> 3927</span>    }</div>
<div class="line"><span class="lineno"> 3928</span> </div>
<div class="line"><span class="lineno"> 3929</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> row01 = NP * (NC + 1);</div>
<div class="line"><span class="lineno"> 3930</span>    <span class="comment">// USI col01 = row01;</span></div>
<div class="line"><span class="lineno"> 3931</span>    <span class="comment">// cout &lt;&lt; &quot;FsXs&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 3932</span>    <span class="comment">// for (USI i = 0; i &lt; row01; i++) {</span></div>
<div class="line"><span class="lineno"> 3933</span>    <span class="comment">//  for (USI j = 0; j &lt; col01; j++) {</span></div>
<div class="line"><span class="lineno"> 3934</span>    <span class="comment">//      cout &lt;&lt; JmatTmp[i * row01 + j] &lt;&lt; &quot;   &quot;;</span></div>
<div class="line"><span class="lineno"> 3935</span>    <span class="comment">//  }</span></div>
<div class="line"><span class="lineno"> 3936</span>    <span class="comment">//  cout &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 3937</span>    <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 3938</span> </div>
<div class="line"><span class="lineno"> 3939</span>    <span class="comment">// Transpose JmatTmp</span></div>
<div class="line"><span class="lineno"> 3940</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> dim = NP * (NC + 1);</div>
<div class="line"><span class="lineno"> 3941</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; dim; i++) {</div>
<div class="line"><span class="lineno"> 3942</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; dim; j++) {</div>
<div class="line"><span class="lineno"> 3943</span>            JmatDer[i * dim + j] = JmatTmp[j * dim + i];</div>
<div class="line"><span class="lineno"> 3944</span>        }</div>
<div class="line"><span class="lineno"> 3945</span>    }</div>
<div class="line"><span class="lineno"> 3946</span> </div>
<div class="line"><span class="lineno"> 3947</span>    <span class="comment">// dF / dXp</span></div>
<div class="line"><span class="lineno"> 3948</span>    <span class="comment">// d fij / dP have been calculated in CalVfiVfp_full01() before</span></div>
<div class="line"><span class="lineno"> 3949</span>    fill(JmatTmp.begin(), JmatTmp.end(), 0.0);</div>
<div class="line"><span class="lineno"> 3950</span>    MTmp = &amp;JmatTmp[0];</div>
<div class="line"><span class="lineno"> 3951</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp01;</div>
<div class="line"><span class="lineno"> 3952</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp02;</div>
<div class="line"><span class="lineno"> 3953</span>    <span class="comment">// dFn / dXp</span></div>
<div class="line"><span class="lineno"> 3954</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3955</span>        <span class="comment">// dFn / dP</span></div>
<div class="line"><span class="lineno"> 3956</span>        tmp01 = 0;</div>
<div class="line"><span class="lineno"> 3957</span>        tmp02 = 0;</div>
<div class="line"><span class="lineno"> 3958</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 3959</span>            tmp01 += <a class="code hl_variable" href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">S</a>[j] * x[j][i] * xiPC[j];</div>
<div class="line"><span class="lineno"> 3960</span>            tmp02 += <a class="code hl_variable" href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">S</a>[j] * x[j][i] * xiC[j];</div>
<div class="line"><span class="lineno"> 3961</span>        }</div>
<div class="line"><span class="lineno"> 3962</span>        MTmp[0] = -(<a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> * tmp01 + <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> * tmp02); <span class="comment">// in OCP</span></div>
<div class="line"><span class="lineno"> 3963</span>        <span class="comment">// MTmp[0] = -(vf * tmp01); // in PennSim</span></div>
<div class="line"><span class="lineno"> 3964</span>        MTmp += 1;</div>
<div class="line"><span class="lineno"> 3965</span>        <span class="comment">// dFn / dNk</span></div>
<div class="line"><span class="lineno"> 3966</span>        <span class="comment">// in OCP</span></div>
<div class="line"><span class="lineno"> 3967</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 3968</span>            tmp01 = 0;</div>
<div class="line"><span class="lineno"> 3969</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 3970</span>                tmp01 += <a class="code hl_variable" href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">S</a>[j] * x[j][i] * xiNC[j * NC + k];</div>
<div class="line"><span class="lineno"> 3971</span>            }</div>
<div class="line"><span class="lineno"> 3972</span>            MTmp[k] = -(<a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> * tmp01 + <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[k] * tmp02 - delta(i, k));</div>
<div class="line"><span class="lineno"> 3973</span>        }</div>
<div class="line"><span class="lineno"> 3974</span>        <span class="comment">// in PennSim</span></div>
<div class="line"><span class="lineno"> 3975</span>        <span class="comment">// MTmp[i] = 1.0;</span></div>
<div class="line"><span class="lineno"> 3976</span>        MTmp += NC;</div>
<div class="line"><span class="lineno"> 3977</span>    }</div>
<div class="line"><span class="lineno"> 3978</span> </div>
<div class="line"><span class="lineno"> 3979</span>    <span class="comment">// dFx / dXp</span></div>
<div class="line"><span class="lineno"> 3980</span>    MTmp += NP * (NC + 1);</div>
<div class="line"><span class="lineno"> 3981</span> </div>
<div class="line"><span class="lineno"> 3982</span>    <span class="comment">// dFf / dXp</span></div>
<div class="line"><span class="lineno"> 3983</span>    <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; fugPNP = fugP[NP - 1];</div>
<div class="line"><span class="lineno"> 3984</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP - 1; j++) {</div>
<div class="line"><span class="lineno"> 3985</span>        <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; fugPj = fugP[j];</div>
<div class="line"><span class="lineno"> 3986</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3987</span>            <span class="comment">// dFf / dP</span></div>
<div class="line"><span class="lineno"> 3988</span>            MTmp[0] = -(fugPj[i] - fugPNP[i]);</div>
<div class="line"><span class="lineno"> 3989</span>            MTmp += (NC + 1);</div>
<div class="line"><span class="lineno"> 3990</span>        }</div>
<div class="line"><span class="lineno"> 3991</span>    }</div>
<div class="line"><span class="lineno"> 3992</span> </div>
<div class="line"><span class="lineno"> 3993</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> row02 = NP * (NC + 1);</div>
<div class="line"><span class="lineno"> 3994</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> col02 = NC + 1;</div>
<div class="line"><span class="lineno"> 3995</span>    <span class="comment">// cout &lt;&lt; &quot;FsXp&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 3996</span>    <span class="comment">// for (USI i = 0; i &lt; row02; i++) {</span></div>
<div class="line"><span class="lineno"> 3997</span>    <span class="comment">//  for (USI j = 0; j &lt; col02; j++) {</span></div>
<div class="line"><span class="lineno"> 3998</span>    <span class="comment">//      cout &lt;&lt; JmatTmp[i * col02 + j] &lt;&lt; &quot;   &quot;;</span></div>
<div class="line"><span class="lineno"> 3999</span>    <span class="comment">//  }</span></div>
<div class="line"><span class="lineno"> 4000</span>    <span class="comment">//  cout &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 4001</span>    <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 4002</span> </div>
<div class="line"><span class="lineno"> 4003</span>    <span class="comment">// Transpose JmatTmp</span></div>
<div class="line"><span class="lineno"> 4004</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> nrhs = NC + 1;</div>
<div class="line"><span class="lineno"> 4005</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> nrow = (NC + 1) * NP;</div>
<div class="line"><span class="lineno"> 4006</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; nrhs; i++) {</div>
<div class="line"><span class="lineno"> 4007</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; nrow; j++) {</div>
<div class="line"><span class="lineno"> 4008</span>            rhsDer[i * nrow + j] = JmatTmp[j * nrhs + i];</div>
<div class="line"><span class="lineno"> 4009</span>        }</div>
<div class="line"><span class="lineno"> 4010</span>    }</div>
<div class="line"><span class="lineno"> 4011</span>    <a class="code hl_function" href="DenseMat_8hpp.html#a53e50e45a55d95a5c3251a476b7e1173">LUSolve</a>(NC + 1, (NC + 1) * NP, &amp;JmatDer[0], &amp;rhsDer[0], &amp;pivot[0]);</div>
<div class="line"><span class="lineno"> 4012</span>    <span class="comment">// now in rhsDer: dXs / dP, dXs / dNk</span></div>
<div class="line"><span class="lineno"> 4013</span>    <span class="comment">// print solution</span></div>
<div class="line"><span class="lineno"> 4014</span>    <span class="comment">// cout &lt;&lt; &quot;Solution&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 4015</span>    <span class="comment">// for (USI i = 0; i &lt; nrhs; i++) {</span></div>
<div class="line"><span class="lineno"> 4016</span>    <span class="comment">//  for (USI j = 0; j &lt; nrow; j++) {</span></div>
<div class="line"><span class="lineno"> 4017</span>    <span class="comment">//      cout &lt;&lt; rhsDer[i * nrow + j] &lt;&lt; &quot;    &quot;;</span></div>
<div class="line"><span class="lineno"> 4018</span>    <span class="comment">//  }</span></div>
<div class="line"><span class="lineno"> 4019</span>    <span class="comment">//  cout &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 4020</span>    <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 4021</span>}</div>
<div class="ttc" id="aDenseMat_8hpp_html_a53e50e45a55d95a5c3251a476b7e1173"><div class="ttname"><a href="DenseMat_8hpp.html#a53e50e45a55d95a5c3251a476b7e1173">LUSolve</a></div><div class="ttdeci">void LUSolve(const int &amp;nrhs, const int &amp;N, double *A, double *b, int *pivot)</div><div class="ttdoc">Calls dgesv to solve the linear system for general matrices.</div><div class="ttdef"><b>Definition:</b> <a href="DenseMat_8cpp_source.html#l00186">DenseMat.cpp:186</a></div></div>
<div class="ttc" id="aclassMixture_html_a763d1e12b91ae451b2df175cbc45ef84"><div class="ttname"><a href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">Mixture::S</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; S</div><div class="ttdoc">saturation of phase: numPhase</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00151">Mixture.hpp:151</a></div></div>
<div class="ttc" id="aclassMixture_html_ab4dd3e54d542aca8eccdcbd208a38504"><div class="ttname"><a href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">Mixture::vfi</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; vfi</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00170">Mixture.hpp:170</a></div></div>
<div class="ttc" id="aclassMixture_html_ad8a687cfb963101e8fdddb1467fa2c1f"><div class="ttname"><a href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">Mixture::vf</a></div><div class="ttdeci">OCP_DBL vf</div><div class="ttdoc">volume of total fluids.</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00160">Mixture.hpp:160</a></div></div>
<div class="ttc" id="aclassMixture_html_adf4f5e549cc50a366951dba65d196198"><div class="ttname"><a href="classMixture.html#adf4f5e549cc50a366951dba65d196198">Mixture::vfp</a></div><div class="ttdeci">OCP_DBL vfp</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00168">Mixture.hpp:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a59d27f5908fc283823162fb3bcf58f6c" name="a59d27f5908fc283823162fb3bcf58f6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59d27f5908fc283823162fb3bcf58f6c">&#9670;&#160;</a></span>CaldXsdXp03()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CaldXsdXp03 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l04480">4480</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4481</span>{</div>
<div class="line"><span class="lineno"> 4482</span>    <span class="comment">// p : P, Ni</span></div>
<div class="line"><span class="lineno"> 4483</span>    <span class="comment">// s : S, nij</span></div>
<div class="line"><span class="lineno"> 4484</span>    </div>
<div class="line"><span class="lineno"> 4485</span>    fill(JmatTmp.begin(), JmatTmp.end(), 0.0);</div>
<div class="line"><span class="lineno"> 4486</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* MTmp = &amp;JmatTmp[0];</div>
<div class="line"><span class="lineno"> 4487</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> dim = NP + 1 + NP * NC;</div>
<div class="line"><span class="lineno"> 4488</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> vf2 = <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> * <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a>;</div>
<div class="line"><span class="lineno"> 4489</span>    <span class="comment">// -dF / ds</span></div>
<div class="line"><span class="lineno"> 4490</span> </div>
<div class="line"><span class="lineno"> 4491</span>    <span class="comment">// -dFf / ds</span></div>
<div class="line"><span class="lineno"> 4492</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP - 1; j++) {</div>
<div class="line"><span class="lineno"> 4493</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* fugNJ = &amp;fugN[j][0];</div>
<div class="line"><span class="lineno"> 4494</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* fugNNP = &amp;fugN[NP - 1][0];</div>
<div class="line"><span class="lineno"> 4495</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 4496</span>            <span class="comment">// -dFf / dS = 0</span></div>
<div class="line"><span class="lineno"> 4497</span>            MTmp += (NP + 1);</div>
<div class="line"><span class="lineno"> 4498</span>            <span class="comment">// -dFf / dnij</span></div>
<div class="line"><span class="lineno"> 4499</span>            MTmp += j * NC;</div>
<div class="line"><span class="lineno"> 4500</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 4501</span>                MTmp[k] = -fugNJ[k];</div>
<div class="line"><span class="lineno"> 4502</span>            }</div>
<div class="line"><span class="lineno"> 4503</span>            fugNJ += NC;</div>
<div class="line"><span class="lineno"> 4504</span>            <span class="comment">// np-1 phase</span></div>
<div class="line"><span class="lineno"> 4505</span>            MTmp += (NP - 1 - j) * NC;</div>
<div class="line"><span class="lineno"> 4506</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 4507</span>                MTmp[k] = fugNNP[k];</div>
<div class="line"><span class="lineno"> 4508</span>            }</div>
<div class="line"><span class="lineno"> 4509</span>            fugNNP += NC;</div>
<div class="line"><span class="lineno"> 4510</span>            MTmp += NC;</div>
<div class="line"><span class="lineno"> 4511</span>        }</div>
<div class="line"><span class="lineno"> 4512</span>    }</div>
<div class="line"><span class="lineno"> 4513</span>    <span class="comment">// -dFn / ds</span></div>
<div class="line"><span class="lineno"> 4514</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 4515</span>        <span class="comment">// -dFn / dS = 0</span></div>
<div class="line"><span class="lineno"> 4516</span>        MTmp += (NP + 1);</div>
<div class="line"><span class="lineno"> 4517</span>        <span class="comment">// -dFn / dnij</span></div>
<div class="line"><span class="lineno"> 4518</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 4519</span>            MTmp[i] = 1;</div>
<div class="line"><span class="lineno"> 4520</span>            MTmp += NC;</div>
<div class="line"><span class="lineno"> 4521</span>        }</div>
<div class="line"><span class="lineno"> 4522</span>    }</div>
<div class="line"><span class="lineno"> 4523</span>    <span class="comment">// -dFs / ds  ---- Hydroncarbon</span></div>
<div class="line"><span class="lineno"> 4524</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 4525</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1 = phaseLabel[j];</div>
<div class="line"><span class="lineno"> 4526</span>        <span class="comment">// -dFs / dS</span></div>
<div class="line"><span class="lineno"> 4527</span>        MTmp[j] = -1;</div>
<div class="line"><span class="lineno"> 4528</span>        MTmp += (NP + 1);</div>
<div class="line"><span class="lineno"> 4529</span>        <span class="comment">// -dFs / dnkm</span></div>
<div class="line"><span class="lineno"> 4530</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NP; m++) {</div>
<div class="line"><span class="lineno"> 4531</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m1 = phaseLabel[m];</div>
<div class="line"><span class="lineno"> 4532</span>            <span class="keywordflow">if</span> (m1 == j1) {</div>
<div class="line"><span class="lineno"> 4533</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 4534</span>                    MTmp[k] = <a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[j1][k] * (<a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> - <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[j1]) / vf2;</div>
<div class="line"><span class="lineno"> 4535</span>                }</div>
<div class="line"><span class="lineno"> 4536</span>            }</div>
<div class="line"><span class="lineno"> 4537</span>            <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno"> 4538</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 4539</span>                    MTmp[k] = -<a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[m1][k] * <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[j1] / vf2;</div>
<div class="line"><span class="lineno"> 4540</span>                }                </div>
<div class="line"><span class="lineno"> 4541</span>            }</div>
<div class="line"><span class="lineno"> 4542</span>            MTmp += NC;</div>
<div class="line"><span class="lineno"> 4543</span>        }</div>
<div class="line"><span class="lineno"> 4544</span>    }</div>
<div class="line"><span class="lineno"> 4545</span>    <span class="comment">// -dFsw / ds</span></div>
<div class="line"><span class="lineno"> 4546</span>    <span class="comment">// -dFsw / dSw</span></div>
<div class="line"><span class="lineno"> 4547</span>    MTmp[NP] = -1;</div>
<div class="line"><span class="lineno"> 4548</span>    MTmp += (NP + 1);</div>
<div class="line"><span class="lineno"> 4549</span>    <span class="comment">// -dFsw / dnkm</span></div>
<div class="line"><span class="lineno"> 4550</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NP; m++) {</div>
<div class="line"><span class="lineno"> 4551</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m1 = phaseLabel[m];</div>
<div class="line"><span class="lineno"> 4552</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 4553</span>            MTmp[k] = -<a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[m1][k] * <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a>-1] / vf2;</div>
<div class="line"><span class="lineno"> 4554</span>        }</div>
<div class="line"><span class="lineno"> 4555</span>        MTmp += NC;</div>
<div class="line"><span class="lineno"> 4556</span>    }</div>
<div class="line"><span class="lineno"> 4557</span> </div>
<div class="line"><span class="lineno"> 4558</span>    <span class="comment">//cout &lt;&lt; &quot;dFdS&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 4559</span>    <span class="comment">//cout &lt;&lt; scientific &lt;&lt; setprecision(1);</span></div>
<div class="line"><span class="lineno"> 4560</span>    <span class="comment">//for (USI i = 0; i &lt; dim; i++) {</span></div>
<div class="line"><span class="lineno"> 4561</span>    <span class="comment">//    for (USI j = 0; j &lt; dim; j++)</span></div>
<div class="line"><span class="lineno"> 4562</span>    <span class="comment">//        cout &lt;&lt; JmatTmp[i * dim + j] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><span class="lineno"> 4563</span>    <span class="comment">//    cout &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 4564</span>    <span class="comment">//    if (i == dim - 4)</span></div>
<div class="line"><span class="lineno"> 4565</span>    <span class="comment">//        cout &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 4566</span>    <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 4567</span>    <span class="comment">//cout &lt;&lt; phaseLabel[0] &lt;&lt; &quot;   &quot; &lt;&lt; phaseLabel[1] &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 4568</span> </div>
<div class="line"><span class="lineno"> 4569</span>    <span class="comment">// Transpose JmatTmp</span></div>
<div class="line"><span class="lineno"> 4570</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; dim; i++) {</div>
<div class="line"><span class="lineno"> 4571</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; dim; j++) {</div>
<div class="line"><span class="lineno"> 4572</span>            JmatDer[i * dim + j] = JmatTmp[j * dim + i];</div>
<div class="line"><span class="lineno"> 4573</span>        }</div>
<div class="line"><span class="lineno"> 4574</span>    }</div>
<div class="line"><span class="lineno"> 4575</span> </div>
<div class="line"><span class="lineno"> 4576</span>    fill(JmatTmp.begin(), JmatTmp.end(), 0.0);</div>
<div class="line"><span class="lineno"> 4577</span>    MTmp = &amp;JmatTmp[0];</div>
<div class="line"><span class="lineno"> 4578</span> </div>
<div class="line"><span class="lineno"> 4579</span>    <span class="comment">// dF / dp</span></div>
<div class="line"><span class="lineno"> 4580</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> ncol2 = <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + 1;</div>
<div class="line"><span class="lineno"> 4581</span>    <span class="comment">// dFf / dp</span></div>
<div class="line"><span class="lineno"> 4582</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP - 1; j++) {</div>
<div class="line"><span class="lineno"> 4583</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 4584</span>            MTmp[0] = fugP[j][i] - fugP[NP - 1][i];</div>
<div class="line"><span class="lineno"> 4585</span>            MTmp += ncol2;</div>
<div class="line"><span class="lineno"> 4586</span>        }</div>
<div class="line"><span class="lineno"> 4587</span>    }</div>
<div class="line"><span class="lineno"> 4588</span>    <span class="comment">// dFn / dp</span></div>
<div class="line"><span class="lineno"> 4589</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 4590</span>        MTmp++;</div>
<div class="line"><span class="lineno"> 4591</span>        MTmp[i] = 1;</div>
<div class="line"><span class="lineno"> 4592</span>        MTmp += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4593</span>    }</div>
<div class="line"><span class="lineno"> 4594</span>    <span class="comment">// dFs / dp   ---- Hydroncarbon</span></div>
<div class="line"><span class="lineno"> 4595</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 4596</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1 = phaseLabel[j];</div>
<div class="line"><span class="lineno"> 4597</span>        <span class="comment">// dFs / dP</span></div>
<div class="line"><span class="lineno"> 4598</span>        MTmp[0] = (<a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> * <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[j1] - <a class="code hl_variable" href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">vjp</a>[j1] * <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a>) / vf2;</div>
<div class="line"><span class="lineno"> 4599</span>        <span class="comment">// dFs / dNh </span></div>
<div class="line"><span class="lineno"> 4600</span>        MTmp += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4601</span>        <span class="comment">// dFs / dNw</span></div>
<div class="line"><span class="lineno"> 4602</span>        MTmp[0] = <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[<a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> - 1] * <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[j1] / vf2;</div>
<div class="line"><span class="lineno"> 4603</span>        MTmp++;</div>
<div class="line"><span class="lineno"> 4604</span>    }</div>
<div class="line"><span class="lineno"> 4605</span>    <span class="comment">// dFsw / dp</span></div>
<div class="line"><span class="lineno"> 4606</span>    <span class="comment">// dFsw / dP</span></div>
<div class="line"><span class="lineno"> 4607</span>    MTmp[0] = (<a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> * <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1] - <a class="code hl_variable" href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">vjp</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1] * <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a>) / vf2;</div>
<div class="line"><span class="lineno"> 4608</span>    <span class="comment">// dFsw / dNh</span></div>
<div class="line"><span class="lineno"> 4609</span>    MTmp += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4610</span>    <span class="comment">// dFsw / dNw</span></div>
<div class="line"><span class="lineno"> 4611</span>    MTmp[0] = <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[<a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> - 1] * (<a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1] - <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a>) / vf2;</div>
<div class="line"><span class="lineno"> 4612</span>    MTmp++;</div>
<div class="line"><span class="lineno"> 4613</span> </div>
<div class="line"><span class="lineno"> 4614</span>    <span class="comment">//cout &lt;&lt; &quot;dFdp&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 4615</span>    <span class="comment">//cout &lt;&lt; scientific &lt;&lt; setprecision(3);</span></div>
<div class="line"><span class="lineno"> 4616</span>    <span class="comment">//for (USI i = 0; i &lt; dim; i++) {</span></div>
<div class="line"><span class="lineno"> 4617</span>    <span class="comment">//    for (USI j = 0; j &lt; numCom+1; j++)</span></div>
<div class="line"><span class="lineno"> 4618</span>    <span class="comment">//        cout &lt;&lt; JmatTmp[i * (numCom + 1) + j] &lt;&lt; &quot;   &quot;;</span></div>
<div class="line"><span class="lineno"> 4619</span>    <span class="comment">//    cout &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 4620</span>    <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 4621</span> </div>
<div class="line"><span class="lineno"> 4622</span>    <span class="comment">// Transpose JmatTmp</span></div>
<div class="line"><span class="lineno"> 4623</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> nrhs = <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + 1;</div>
<div class="line"><span class="lineno"> 4624</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> nrow = NP * NC + NP + 1;</div>
<div class="line"><span class="lineno"> 4625</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; nrhs; i++) {</div>
<div class="line"><span class="lineno"> 4626</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; nrow; j++) {</div>
<div class="line"><span class="lineno"> 4627</span>            rhsDer[i * nrow + j] = JmatTmp[j * nrhs + i];</div>
<div class="line"><span class="lineno"> 4628</span>        }</div>
<div class="line"><span class="lineno"> 4629</span>    }</div>
<div class="line"><span class="lineno"> 4630</span> </div>
<div class="line"><span class="lineno"> 4631</span>    <span class="comment">// Calculate res</span></div>
<div class="line"><span class="lineno"> 4632</span>    <span class="comment">// resF</span></div>
<div class="line"><span class="lineno"> 4633</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* myRes = &amp;rhsDer[nrhs * nrow];</div>
<div class="line"><span class="lineno"> 4634</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP - 1; j++) {</div>
<div class="line"><span class="lineno"> 4635</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* fugJ = &amp;fug[j][0];</div>
<div class="line"><span class="lineno"> 4636</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* fugNP = &amp;fug[NP - 1][0];</div>
<div class="line"><span class="lineno"> 4637</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 4638</span>            myRes[i] = fugJ[i] - fugNP[i];</div>
<div class="line"><span class="lineno"> 4639</span>        }</div>
<div class="line"><span class="lineno"> 4640</span>        myRes += NC;</div>
<div class="line"><span class="lineno"> 4641</span>    }</div>
<div class="line"><span class="lineno"> 4642</span>    <span class="comment">// resN</span></div>
<div class="line"><span class="lineno"> 4643</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 4644</span>        myRes[i] = <a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[i];</div>
<div class="line"><span class="lineno"> 4645</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 4646</span>            myRes[i] -= x[j][i] * nu[j];</div>
<div class="line"><span class="lineno"> 4647</span>        }</div>
<div class="line"><span class="lineno"> 4648</span>    }</div>
<div class="line"><span class="lineno"> 4649</span>    myRes += NC;</div>
<div class="line"><span class="lineno"> 4650</span>    <span class="comment">// resS</span></div>
<div class="line"><span class="lineno"> 4651</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 4652</span>        myRes[j] = <a class="code hl_variable" href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">S</a>[phaseLabel[j]] - <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[phaseLabel[j]] / <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a>;</div>
<div class="line"><span class="lineno"> 4653</span>    }</div>
<div class="line"><span class="lineno"> 4654</span>    myRes[NP] = <a class="code hl_variable" href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">S</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1] - <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1] / <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a>;</div>
<div class="line"><span class="lineno"> 4655</span> </div>
<div class="line"><span class="lineno"> 4656</span>  </div>
<div class="line"><span class="lineno"> 4657</span>    <span class="comment">//cout &lt;&lt; scientific &lt;&lt; setprecision(4);</span></div>
<div class="line"><span class="lineno"> 4658</span>    <span class="comment">//cout &lt;&lt; &quot;res0&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 4659</span>    <span class="comment">//for (USI i = 0; i &lt; nrow; i++) {</span></div>
<div class="line"><span class="lineno"> 4660</span>    <span class="comment">//    for (USI j = nrhs; j &lt; nrhs + 1; j++) {</span></div>
<div class="line"><span class="lineno"> 4661</span>    <span class="comment">//        cout &lt;&lt; setw(12) &lt;&lt; rhsDer[j * nrow + i] &lt;&lt; &quot;   &quot;;</span></div>
<div class="line"><span class="lineno"> 4662</span>    <span class="comment">//    }</span></div>
<div class="line"><span class="lineno"> 4663</span>    <span class="comment">//    cout &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 4664</span>    <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 4665</span>    <span class="comment">//cout &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 4666</span> </div>
<div class="line"><span class="lineno"> 4667</span>    <a class="code hl_function" href="DenseMat_8hpp.html#a53e50e45a55d95a5c3251a476b7e1173">LUSolve</a>(<a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + 1 + 1, nrow, &amp;JmatDer[0], &amp;rhsDer[0], &amp;pivot[0]);</div>
<div class="line"><span class="lineno"> 4668</span>}</div>
<div class="ttc" id="aclassMixture_html_a334d229b6dbbc015a9e7de974f08c76d"><div class="ttname"><a href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">Mixture::vjp</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; vjp</div><div class="ttdoc">dvj / dp, used in 2 hydrocarbon phase in EOS</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00166">Mixture.hpp:166</a></div></div>
<div class="ttc" id="aclassMixture_html_a382c30078dd1579e7f375ad2f60e2f44"><div class="ttname"><a href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">Mixture::vji</a></div><div class="ttdeci">vector&lt; vector&lt; OCP_DBL &gt; &gt; vji</div><div class="ttdoc">dvj / dNi, used in 2 hydrocarbon phase in EOS; or dvj / dnij</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00165">Mixture.hpp:165</a></div></div>
<div class="ttc" id="aclassMixture_html_a7463b9517217397b77d51012f4367a28"><div class="ttname"><a href="classMixture.html#a7463b9517217397b77d51012f4367a28">Mixture::v</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; v</div><div class="ttdoc">volume of phase: numPhase;</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00158">Mixture.hpp:158</a></div></div>
<div class="ttc" id="aclassMixture_html_aa73863601ffb8962b26415352b41bffa"><div class="ttname"><a href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Mixture::Ni</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; Ni</div><div class="ttdoc">moles of component: numCom</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00149">Mixture.hpp:149</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0daaaeb530bf08cf4bc3e3c636b40598" name="a0daaaeb530bf08cf4bc3e3c636b40598"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0daaaeb530bf08cf4bc3e3c636b40598">&#9670;&#160;</a></span>CaldXsdXp04()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CaldXsdXp04 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l02673">2673</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2674</span>{</div>
<div class="line"><span class="lineno"> 2675</span>    <span class="comment">// Wrong Now !</span></div>
<div class="line"><span class="lineno"> 2676</span> </div>
<div class="line"><span class="lineno"> 2677</span> </div>
<div class="line"><span class="lineno"> 2678</span>    fill(JmatTmp.begin(), JmatTmp.end(), 0.0);</div>
<div class="line"><span class="lineno"> 2679</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* MTmp = &amp;JmatTmp[0];</div>
<div class="line"><span class="lineno"> 2680</span> </div>
<div class="line"><span class="lineno"> 2681</span>    <span class="comment">// -dF / dXs</span></div>
<div class="line"><span class="lineno"> 2682</span>    <span class="comment">// -dFn / dXs</span></div>
<div class="line"><span class="lineno"> 2683</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> dim = NP + 1 + NP * NC;</div>
<div class="line"><span class="lineno"> 2684</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 2685</span>        <span class="comment">// -dFn / dSh</span></div>
<div class="line"><span class="lineno"> 2686</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NP; m++) {</div>
<div class="line"><span class="lineno"> 2687</span>            MTmp[m] = <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> * <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[phaseLabel[m]] * x[m][i];</div>
<div class="line"><span class="lineno"> 2688</span>        }</div>
<div class="line"><span class="lineno"> 2689</span>        MTmp += NP;</div>
<div class="line"><span class="lineno"> 2690</span>        <span class="comment">// -dFn / dSw</span></div>
<div class="line"><span class="lineno"> 2691</span>        MTmp++;</div>
<div class="line"><span class="lineno"> 2692</span>        <span class="comment">// -dFn / dxnm</span></div>
<div class="line"><span class="lineno"> 2693</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NP; m++) {</div>
<div class="line"><span class="lineno"> 2694</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m1 = phaseLabel[m];</div>
<div class="line"><span class="lineno"> 2695</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> n = 0; n &lt; NC; n++) {</div>
<div class="line"><span class="lineno"> 2696</span>                MTmp[n] =</div>
<div class="line"><span class="lineno"> 2697</span>                    <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> * <a class="code hl_variable" href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">S</a>[m1] * (<a class="code hl_variable" href="classMixture.html#a3f517560e2ec30f08afca9f6dc3ff71c">xix</a>[m1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + n] * x[m][i] + delta(i, n) * <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[m1]);</div>
<div class="line"><span class="lineno"> 2698</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 2699</span>                    MTmp[n] += <a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[m1][n] * x[m][i] * <a class="code hl_variable" href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">S</a>[phaseLabel[j]] * <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[phaseLabel[j]];</div>
<div class="line"><span class="lineno"> 2700</span>                }</div>
<div class="line"><span class="lineno"> 2701</span>            }</div>
<div class="line"><span class="lineno"> 2702</span>            MTmp += NC;</div>
<div class="line"><span class="lineno"> 2703</span>        }</div>
<div class="line"><span class="lineno"> 2704</span>    }</div>
<div class="line"><span class="lineno"> 2705</span>    <span class="comment">// -dFnw / dFs</span></div>
<div class="line"><span class="lineno"> 2706</span>    <span class="comment">// -dFnw / dSw</span></div>
<div class="line"><span class="lineno"> 2707</span>    MTmp[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1] = <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> * <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1];</div>
<div class="line"><span class="lineno"> 2708</span>    MTmp += (NP + 1);</div>
<div class="line"><span class="lineno"> 2709</span>    <span class="comment">// -dFnw / dxnm</span></div>
<div class="line"><span class="lineno"> 2710</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NP; m++) {</div>
<div class="line"><span class="lineno"> 2711</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> n = 0; n &lt; NC; n++) {</div>
<div class="line"><span class="lineno"> 2712</span>            MTmp[n] = <a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[phaseLabel[m]][n] * <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1] * <a class="code hl_variable" href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">S</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1];</div>
<div class="line"><span class="lineno"> 2713</span>        }</div>
<div class="line"><span class="lineno"> 2714</span>        MTmp += NC;</div>
<div class="line"><span class="lineno"> 2715</span>    }</div>
<div class="line"><span class="lineno"> 2716</span>    </div>
<div class="line"><span class="lineno"> 2717</span> </div>
<div class="line"><span class="lineno"> 2718</span>    <span class="comment">// -dFx / dXs</span></div>
<div class="line"><span class="lineno"> 2719</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 2720</span>        <span class="comment">// -dFx / dSm</span></div>
<div class="line"><span class="lineno"> 2721</span>        MTmp += (NP + 1);</div>
<div class="line"><span class="lineno"> 2722</span>        <span class="comment">// -dFx / dxnm, m = j</span></div>
<div class="line"><span class="lineno"> 2723</span>        MTmp += j * NC;</div>
<div class="line"><span class="lineno"> 2724</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> n = 0; n &lt; NC; n++) {</div>
<div class="line"><span class="lineno"> 2725</span>            MTmp[n] = -1.0;</div>
<div class="line"><span class="lineno"> 2726</span>        }</div>
<div class="line"><span class="lineno"> 2727</span>        MTmp += (NP - j) * NC;</div>
<div class="line"><span class="lineno"> 2728</span>    }</div>
<div class="line"><span class="lineno"> 2729</span> </div>
<div class="line"><span class="lineno"> 2730</span>    <span class="comment">// -dFf / dXs</span></div>
<div class="line"><span class="lineno"> 2731</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP - 1; j++) {</div>
<div class="line"><span class="lineno"> 2732</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* fugXJ = &amp;fugX[j][0];</div>
<div class="line"><span class="lineno"> 2733</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* fugXNP = &amp;fugX[NP - 1][0];</div>
<div class="line"><span class="lineno"> 2734</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 2735</span>            <span class="comment">// -dFf / dSm</span></div>
<div class="line"><span class="lineno"> 2736</span>            MTmp += (NP + 1);</div>
<div class="line"><span class="lineno"> 2737</span>            <span class="comment">// -dFf / dxnm, m = j or m = np-1</span></div>
<div class="line"><span class="lineno"> 2738</span>            <span class="comment">// m = j</span></div>
<div class="line"><span class="lineno"> 2739</span>            MTmp += j * NC;</div>
<div class="line"><span class="lineno"> 2740</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> n = 0; n &lt; NC; n++) {</div>
<div class="line"><span class="lineno"> 2741</span>                MTmp[n] = -fugXJ[n];</div>
<div class="line"><span class="lineno"> 2742</span>            }</div>
<div class="line"><span class="lineno"> 2743</span>            fugXJ += NC;</div>
<div class="line"><span class="lineno"> 2744</span>            <span class="comment">// m = np-1</span></div>
<div class="line"><span class="lineno"> 2745</span>            MTmp += (NP - 1 - j) * NC;</div>
<div class="line"><span class="lineno"> 2746</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> n = 0; n &lt; NC; n++) {</div>
<div class="line"><span class="lineno"> 2747</span>                MTmp[n] = fugXNP[n];</div>
<div class="line"><span class="lineno"> 2748</span>            }</div>
<div class="line"><span class="lineno"> 2749</span>            fugXNP += NC;</div>
<div class="line"><span class="lineno"> 2750</span>            MTmp += NC;</div>
<div class="line"><span class="lineno"> 2751</span>        }</div>
<div class="line"><span class="lineno"> 2752</span>    }</div>
<div class="line"><span class="lineno"> 2753</span> </div>
<div class="line"><span class="lineno"> 2754</span>    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;dFdS&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 2755</span>    cout &lt;&lt; scientific &lt;&lt; setprecision(1);</div>
<div class="line"><span class="lineno"> 2756</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; dim; i++) {</div>
<div class="line"><span class="lineno"> 2757</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; dim; j++)</div>
<div class="line"><span class="lineno"> 2758</span>            cout &lt;&lt; setw(8) &lt;&lt; JmatTmp[i * dim + j] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><span class="lineno"> 2759</span>        cout &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 2760</span>    }</div>
<div class="line"><span class="lineno"> 2761</span> </div>
<div class="line"><span class="lineno"> 2762</span>    <span class="comment">// Transpose JmatTmp</span></div>
<div class="line"><span class="lineno"> 2763</span>    </div>
<div class="line"><span class="lineno"> 2764</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; dim; i++) {</div>
<div class="line"><span class="lineno"> 2765</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; dim; j++) {</div>
<div class="line"><span class="lineno"> 2766</span>            JmatDer[i * dim + j] = JmatTmp[j * dim + i];</div>
<div class="line"><span class="lineno"> 2767</span>        }</div>
<div class="line"><span class="lineno"> 2768</span>    }</div>
<div class="line"><span class="lineno"> 2769</span> </div>
<div class="line"><span class="lineno"> 2770</span>    <span class="comment">// dF / dXp</span></div>
<div class="line"><span class="lineno"> 2771</span>    <span class="comment">// d fij / dP have been calculated in CalVfiVfp_full01() before</span></div>
<div class="line"><span class="lineno"> 2772</span>    fill(JmatTmp.begin(), JmatTmp.end(), 0.0);</div>
<div class="line"><span class="lineno"> 2773</span>    MTmp = &amp;JmatTmp[0];</div>
<div class="line"><span class="lineno"> 2774</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp01;</div>
<div class="line"><span class="lineno"> 2775</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp02;</div>
<div class="line"><span class="lineno"> 2776</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1;</div>
<div class="line"><span class="lineno"> 2777</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> nrhs = <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + 1;</div>
<div class="line"><span class="lineno"> 2778</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> nrow = dim;</div>
<div class="line"><span class="lineno"> 2779</span>    <span class="comment">// dFn / dXp</span></div>
<div class="line"><span class="lineno"> 2780</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 2781</span>        <span class="comment">// dFn / dP</span></div>
<div class="line"><span class="lineno"> 2782</span>        tmp01 = 0;</div>
<div class="line"><span class="lineno"> 2783</span>        tmp02 = 0;</div>
<div class="line"><span class="lineno"> 2784</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 2785</span>            j1 = phaseLabel[j];</div>
<div class="line"><span class="lineno"> 2786</span>            tmp01 += <a class="code hl_variable" href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">S</a>[j1] * x[j][i] * <a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[j1];</div>
<div class="line"><span class="lineno"> 2787</span>            tmp02 += <a class="code hl_variable" href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">S</a>[j1] * x[j][i] * <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j1];</div>
<div class="line"><span class="lineno"> 2788</span>        }</div>
<div class="line"><span class="lineno"> 2789</span>        MTmp[0] = -(<a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> * tmp01 + <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> * tmp02);</div>
<div class="line"><span class="lineno"> 2790</span>        MTmp += 1;</div>
<div class="line"><span class="lineno"> 2791</span>        <span class="comment">// dFn / dNk</span></div>
<div class="line"><span class="lineno"> 2792</span>        MTmp[i] = 1;</div>
<div class="line"><span class="lineno"> 2793</span>        MTmp += NC;</div>
<div class="line"><span class="lineno"> 2794</span>        <span class="comment">// dFn / dNw</span></div>
<div class="line"><span class="lineno"> 2795</span>        MTmp[0] = -<a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[<a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> - 1] * tmp02;</div>
<div class="line"><span class="lineno"> 2796</span>        MTmp++;</div>
<div class="line"><span class="lineno"> 2797</span>    }</div>
<div class="line"><span class="lineno"> 2798</span>    <span class="comment">// dFnw / dXp</span></div>
<div class="line"><span class="lineno"> 2799</span>    <span class="comment">// dFnw / dP</span></div>
<div class="line"><span class="lineno"> 2800</span>    MTmp[0] = -<a class="code hl_variable" href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">S</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1] * (<a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> * <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1] + <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> * <a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1]);</div>
<div class="line"><span class="lineno"> 2801</span>    <span class="comment">// dFnw / dNw</span></div>
<div class="line"><span class="lineno"> 2802</span>    MTmp[<a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>] = 1 - <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[<a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> - 1] * <a class="code hl_variable" href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">S</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1] * <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1];</div>
<div class="line"><span class="lineno"> 2803</span>    MTmp += nrhs;</div>
<div class="line"><span class="lineno"> 2804</span> </div>
<div class="line"><span class="lineno"> 2805</span>    <span class="comment">// dFx / dXp</span></div>
<div class="line"><span class="lineno"> 2806</span>    MTmp += NP * nrhs;</div>
<div class="line"><span class="lineno"> 2807</span> </div>
<div class="line"><span class="lineno"> 2808</span>    <span class="comment">// dFf / dXp</span></div>
<div class="line"><span class="lineno"> 2809</span>    <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; fugPNP = fugP[NP - 1];</div>
<div class="line"><span class="lineno"> 2810</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP - 1; j++) {</div>
<div class="line"><span class="lineno"> 2811</span>        <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; fugPj = fugP[j];</div>
<div class="line"><span class="lineno"> 2812</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 2813</span>            <span class="comment">// dFf / dP</span></div>
<div class="line"><span class="lineno"> 2814</span>            MTmp[0] = fugPj[i] - fugPNP[i];</div>
<div class="line"><span class="lineno"> 2815</span>            MTmp += nrhs;</div>
<div class="line"><span class="lineno"> 2816</span>        }</div>
<div class="line"><span class="lineno"> 2817</span>    }</div>
<div class="line"><span class="lineno"> 2818</span> </div>
<div class="line"><span class="lineno"> 2819</span>    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;dFdp&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 2820</span>    cout &lt;&lt; scientific &lt;&lt; setprecision(3);</div>
<div class="line"><span class="lineno"> 2821</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; dim; i++) {</div>
<div class="line"><span class="lineno"> 2822</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>+1; j++)</div>
<div class="line"><span class="lineno"> 2823</span>            cout &lt;&lt; setw(10) &lt;&lt; JmatTmp[i * (<a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + 1) + j] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>;</div>
<div class="line"><span class="lineno"> 2824</span>        cout &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 2825</span>    }</div>
<div class="line"><span class="lineno"> 2826</span> </div>
<div class="line"><span class="lineno"> 2827</span> </div>
<div class="line"><span class="lineno"> 2828</span>    <span class="comment">// Transpose JmatTmp   </span></div>
<div class="line"><span class="lineno"> 2829</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; nrhs; i++) {</div>
<div class="line"><span class="lineno"> 2830</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; nrow; j++) {</div>
<div class="line"><span class="lineno"> 2831</span>            rhsDer[i * nrow + j] = JmatTmp[j * nrhs + i];</div>
<div class="line"><span class="lineno"> 2832</span>        }</div>
<div class="line"><span class="lineno"> 2833</span>    }</div>
<div class="line"><span class="lineno"> 2834</span> </div>
<div class="line"><span class="lineno"> 2835</span>    <a class="code hl_function" href="DenseMat_8hpp.html#a53e50e45a55d95a5c3251a476b7e1173">LUSolve</a>(nrhs, dim, &amp;JmatDer[0], &amp;rhsDer[0], &amp;pivot[0]);</div>
<div class="line"><span class="lineno"> 2836</span> </div>
<div class="line"><span class="lineno"> 2837</span> </div>
<div class="line"><span class="lineno"> 2838</span>    cout &lt;&lt; setprecision(6);</div>
<div class="line"><span class="lineno"> 2839</span>    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;dXsdXp&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 2840</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; nrow; i++) {</div>
<div class="line"><span class="lineno"> 2841</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; nrhs; j++) {</div>
<div class="line"><span class="lineno"> 2842</span>            cout &lt;&lt; setw(13) &lt;&lt; rhsDer[j * nrow + i] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>;</div>
<div class="line"><span class="lineno"> 2843</span>        }</div>
<div class="line"><span class="lineno"> 2844</span>        cout &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 2845</span>    }</div>
<div class="line"><span class="lineno"> 2846</span>    cout &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 2847</span>}</div>
<div class="ttc" id="aclassMixture_html_a3f517560e2ec30f08afca9f6dc3ff71c"><div class="ttname"><a href="classMixture.html#a3f517560e2ec30f08afca9f6dc3ff71c">Mixture::xix</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; xix</div><div class="ttdoc">d xi[j] / d x[i][j]: numphase * numCom</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00180">Mixture.hpp:180</a></div></div>
<div class="ttc" id="aclassMixture_html_ad86bd94527d09c2afcf767ce6e3a8a71"><div class="ttname"><a href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">Mixture::xiP</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; xiP</div><div class="ttdoc">d xi / dP: numphase</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00174">Mixture.hpp:174</a></div></div>
<div class="ttc" id="aclassMixture_html_afad5616464982e92b25adba0c84f4eb5"><div class="ttname"><a href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">Mixture::xi</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; xi</div><div class="ttdoc">molar density of phase: numPhase</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00153">Mixture.hpp:153</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acc3c918dc9130bc37733353454ffdfc1" name="acc3c918dc9130bc37733353454ffdfc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc3c918dc9130bc37733353454ffdfc1">&#9670;&#160;</a></span>CaldXsdXpAPI01()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CaldXsdXpAPI01 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l04023">4023</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4024</span>{</div>
<div class="line"><span class="lineno"> 4025</span>    <span class="comment">// Calculate derivates for hydrocarbon phase and components</span></div>
<div class="line"><span class="lineno"> 4026</span>    <span class="comment">// if water exists, vf, vfp, and S should be updated</span></div>
<div class="line"><span class="lineno"> 4027</span>    fill(<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>.begin(), <a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>.end(), 0.0);</div>
<div class="line"><span class="lineno"> 4028</span>    </div>
<div class="line"><span class="lineno"> 4029</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> vw = <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1];</div>
<div class="line"><span class="lineno"> 4030</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> vwp = <a class="code hl_variable" href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">vjp</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1];</div>
<div class="line"><span class="lineno"> 4031</span> </div>
<div class="line"><span class="lineno"> 4032</span>    <span class="keywordflow">if</span> (NP == 1) {</div>
<div class="line"><span class="lineno"> 4033</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     bId = (<a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + 1) * phaseLabel[0];</div>
<div class="line"><span class="lineno"> 4034</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp = <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> * <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a>;</div>
<div class="line"><span class="lineno"> 4035</span>        <span class="comment">// only dSj / dP, dSj / dNk ---- hydrocarbon phase</span></div>
<div class="line"><span class="lineno"> 4036</span>        <a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[bId] = (<a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> * vw - <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> * vwp) / tmp;</div>
<div class="line"><span class="lineno"> 4037</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 4038</span>            <a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[bId + k + 1] = (<a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[k] * vw) / tmp;</div>
<div class="line"><span class="lineno"> 4039</span>        }</div>
<div class="line"><span class="lineno"> 4040</span>        <span class="comment">// dxij / dNk --- new</span></div>
<div class="line"><span class="lineno"> 4041</span>        bId = (<a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + 1) * (<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> + <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> * phaseLabel[0]) + 1;</div>
<div class="line"><span class="lineno"> 4042</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 4043</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 4044</span>                <a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[bId + k] = (delta(i, k) * Nh - <a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[i]) / (Nh * Nh);</div>
<div class="line"><span class="lineno"> 4045</span>            }</div>
<div class="line"><span class="lineno"> 4046</span>            bId += (<a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + 1);</div>
<div class="line"><span class="lineno"> 4047</span>        }</div>
<div class="line"><span class="lineno"> 4048</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4049</span>        <span class="comment">// NP &gt; 1</span></div>
<div class="line"><span class="lineno"> 4050</span>        <span class="comment">// Calculate Saturation</span></div>
<div class="line"><span class="lineno"> 4051</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 4052</span>            <a class="code hl_variable" href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">S</a>[j] = vC[j] / <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a>;</div>
<div class="line"><span class="lineno"> 4053</span>        }</div>
<div class="line"><span class="lineno"> 4054</span>        CalFugXAll();</div>
<div class="line"><span class="lineno"> 4055</span>        CaldXsdXp01();</div>
<div class="line"><span class="lineno"> 4056</span>        <span class="comment">// copy from rhsDer to dXsdXp</span></div>
<div class="line"><span class="lineno"> 4057</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>*       DTmp;</div>
<div class="line"><span class="lineno"> 4058</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* STmp;</div>
<div class="line"><span class="lineno"> 4059</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>            nrow  = NP * (NC + 1); <span class="comment">// row num of rhsDer</span></div>
<div class="line"><span class="lineno"> 4060</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>            ncol  = NC + 1;        <span class="comment">// col num of rhsDer</span></div>
<div class="line"><span class="lineno"> 4061</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>            ncol2 = <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + 1;    <span class="comment">// col num of dXsdXp</span></div>
<div class="line"><span class="lineno"> 4062</span>        <span class="comment">// Saturation</span></div>
<div class="line"><span class="lineno"> 4063</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 4064</span>            STmp = &amp;rhsDer[j];</div>
<div class="line"><span class="lineno"> 4065</span>            DTmp = &amp;<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[phaseLabel[j] * ncol2];</div>
<div class="line"><span class="lineno"> 4066</span>            <span class="comment">// dS / dP</span></div>
<div class="line"><span class="lineno"> 4067</span>            DTmp[0] = STmp[0];</div>
<div class="line"><span class="lineno"> 4068</span>            <span class="comment">// dS / dNk</span></div>
<div class="line"><span class="lineno"> 4069</span>            DTmp++;</div>
<div class="line"><span class="lineno"> 4070</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 4071</span>                STmp += nrow;</div>
<div class="line"><span class="lineno"> 4072</span>                DTmp[k] = STmp[0];</div>
<div class="line"><span class="lineno"> 4073</span>            }</div>
<div class="line"><span class="lineno"> 4074</span>            <span class="comment">// water is excluded</span></div>
<div class="line"><span class="lineno"> 4075</span>        }</div>
<div class="line"><span class="lineno"> 4076</span>        <span class="comment">// xij ---- mole fraction of component i in phase j</span></div>
<div class="line"><span class="lineno"> 4077</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* DbId = &amp;<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> * ncol2];</div>
<div class="line"><span class="lineno"> 4078</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 4079</span>            DTmp = DbId + phaseLabel[j] * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> * ncol2;</div>
<div class="line"><span class="lineno"> 4080</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 4081</span>                STmp = &amp;rhsDer[NP + j * NC + i];</div>
<div class="line"><span class="lineno"> 4082</span>                <span class="comment">// dxij / dP</span></div>
<div class="line"><span class="lineno"> 4083</span>                DTmp[0] = STmp[0];</div>
<div class="line"><span class="lineno"> 4084</span>                <span class="comment">// dxij / dNk</span></div>
<div class="line"><span class="lineno"> 4085</span>                DTmp++;</div>
<div class="line"><span class="lineno"> 4086</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 4087</span>                    STmp += nrow;</div>
<div class="line"><span class="lineno"> 4088</span>                    DTmp[k] = STmp[0];</div>
<div class="line"><span class="lineno"> 4089</span>                }</div>
<div class="line"><span class="lineno"> 4090</span>                DTmp += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4091</span>                <span class="comment">// water is excluded</span></div>
<div class="line"><span class="lineno"> 4092</span>            }</div>
<div class="line"><span class="lineno"> 4093</span>        }</div>
<div class="line"><span class="lineno"> 4094</span>    }</div>
<div class="line"><span class="lineno"> 4095</span>    <span class="comment">// Correct Sj</span></div>
<div class="line"><span class="lineno"> 4096</span>    CalSaturation();</div>
<div class="line"><span class="lineno"> 4097</span> </div>
<div class="line"><span class="lineno"> 4098</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> Wpid = <a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1;</div>
<div class="line"><span class="lineno"> 4099</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> Wcid = <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> - 1;</div>
<div class="line"><span class="lineno"> 4100</span> </div>
<div class="line"><span class="lineno"> 4101</span>    <span class="comment">// Calculate water derivatives</span></div>
<div class="line"><span class="lineno"> 4102</span>    <span class="comment">// only dSj / dNw, dSw / dP , dSw / dNk needs to be considered</span></div>
<div class="line"><span class="lineno"> 4103</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> ncol = 1 + <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4104</span>    <span class="comment">// dSj / dNw</span></div>
<div class="line"><span class="lineno"> 4105</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 4106</span>        <a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[(phaseLabel[j] + 1) * ncol - 1] = -<a class="code hl_variable" href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">S</a>[phaseLabel[j]] * <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[Wcid] / <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a>;</div>
<div class="line"><span class="lineno"> 4107</span>    }</div>
<div class="line"><span class="lineno"> 4108</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* Dtmp = &amp;<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[Wpid * ncol];</div>
<div class="line"><span class="lineno"> 4109</span>    <span class="comment">// dSw / dP</span></div>
<div class="line"><span class="lineno"> 4110</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> vf2 = <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> * <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a>;</div>
<div class="line"><span class="lineno"> 4111</span>    Dtmp[0] = (vwp * <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> - vw * <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a>) / vf2;</div>
<div class="line"><span class="lineno"> 4112</span>    Dtmp++;</div>
<div class="line"><span class="lineno"> 4113</span>    <span class="comment">// dSw / d Nk</span></div>
<div class="line"><span class="lineno"> 4114</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 4115</span>        Dtmp[k] = -vw * <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[k] / vf2;</div>
<div class="line"><span class="lineno"> 4116</span>    }</div>
<div class="line"><span class="lineno"> 4117</span>    <span class="comment">// dSw / d Nw</span></div>
<div class="line"><span class="lineno"> 4118</span>    Dtmp[NC] = (<a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[Wcid] * <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> - vw * <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[Wcid]) / vf2;</div>
<div class="line"><span class="lineno"> 4119</span>}</div>
<div class="ttc" id="aclassMixture_html_a15908a1b8da8390dd9e8d7c2bd822bf4"><div class="ttname"><a href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">Mixture::dXsdXp</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; dXsdXp</div><div class="ttdoc">the derivates of second variables wrt. primary variables</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00183">Mixture.hpp:183</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af3c4aa2542bbaf9457b9c6cffd9280b0" name="af3c4aa2542bbaf9457b9c6cffd9280b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3c4aa2542bbaf9457b9c6cffd9280b0">&#9670;&#160;</a></span>CaldXsdXpAPI02()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CaldXsdXpAPI02 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l04121">4121</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4122</span>{</div>
<div class="line"><span class="lineno"> 4123</span>    <span class="comment">// Attention!</span></div>
<div class="line"><span class="lineno"> 4124</span>    <span class="comment">// NP = 1 or NP = 2</span></div>
<div class="line"><span class="lineno"> 4125</span>    </div>
<div class="line"><span class="lineno"> 4126</span>    <span class="comment">// dS / dP</span></div>
<div class="line"><span class="lineno"> 4127</span>    <span class="comment">// S = Sj, xij</span></div>
<div class="line"><span class="lineno"> 4128</span>    <span class="comment">// P = P, Ni</span></div>
<div class="line"><span class="lineno"> 4129</span>    <span class="comment">// water is included</span></div>
<div class="line"><span class="lineno"> 4130</span>    fill(<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>.begin(), <a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>.end(), 0);</div>
<div class="line"><span class="lineno"> 4131</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> ncol = <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + 1;</div>
<div class="line"><span class="lineno"> 4132</span>    </div>
<div class="line"><span class="lineno"> 4133</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> vf2 = <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> * <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a>;</div>
<div class="line"><span class="lineno"> 4134</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> vwp = <a class="code hl_variable" href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">vjp</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1];</div>
<div class="line"><span class="lineno"> 4135</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> vw = <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1];</div>
<div class="line"><span class="lineno"> 4136</span> </div>
<div class="line"><span class="lineno"> 4137</span>    <span class="keywordflow">if</span> (NP == 1) {</div>
<div class="line"><span class="lineno"> 4138</span>        <span class="comment">// when NP = 1, vfi = vhi, vfp = vhp + vwp, h = hydrocarbon    </span></div>
<div class="line"><span class="lineno"> 4139</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j0 = phaseLabel[0];</div>
<div class="line"><span class="lineno"> 4140</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* bId = &amp;<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[j0 * ncol];</div>
<div class="line"><span class="lineno"> 4141</span>        <span class="comment">// dS / dP</span></div>
<div class="line"><span class="lineno"> 4142</span>        bId[0] = ((<a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> - vwp) * <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> - <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> * <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[j0]) / vf2;</div>
<div class="line"><span class="lineno"> 4143</span>        bId++;</div>
<div class="line"><span class="lineno"> 4144</span>        <span class="comment">// dSh / dNm</span></div>
<div class="line"><span class="lineno"> 4145</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 4146</span>            bId[m] = <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[m] * vw / vf2;</div>
<div class="line"><span class="lineno"> 4147</span>        }</div>
<div class="line"><span class="lineno"> 4148</span>        bId += NC;</div>
<div class="line"><span class="lineno"> 4149</span>        <span class="comment">// dSh / dNw</span></div>
<div class="line"><span class="lineno"> 4150</span>        bId[0] = -<a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[<a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> - 1] * <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[j0] / vf2;</div>
<div class="line"><span class="lineno"> 4151</span>        <span class="comment">// dSw / dP, dNm</span></div>
<div class="line"><span class="lineno"> 4152</span>        bId = &amp;<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[(<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1) * ncol];</div>
<div class="line"><span class="lineno"> 4153</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; ncol; m++) {</div>
<div class="line"><span class="lineno"> 4154</span>            bId[m] = -<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[j0 * ncol + m];</div>
<div class="line"><span class="lineno"> 4155</span>        }</div>
<div class="line"><span class="lineno"> 4156</span>        <span class="comment">// dxij / dNm</span></div>
<div class="line"><span class="lineno"> 4157</span>        bId = &amp;<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[(<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> + j0 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>) * ncol + 1];       </div>
<div class="line"><span class="lineno"> 4158</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 4159</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 4160</span>                bId[m] = (delta(i, m) * Nh - <a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[i]) / (Nh * Nh);</div>
<div class="line"><span class="lineno"> 4161</span>            }</div>
<div class="line"><span class="lineno"> 4162</span>            bId += ncol;</div>
<div class="line"><span class="lineno"> 4163</span>        }</div>
<div class="line"><span class="lineno"> 4164</span>    }</div>
<div class="line"><span class="lineno"> 4165</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4166</span>        <span class="comment">// NP = 2   </span></div>
<div class="line"><span class="lineno"> 4167</span>        <span class="comment">// dSj / dP, dSj / dNm</span></div>
<div class="line"><span class="lineno"> 4168</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* bId;</div>
<div class="line"><span class="lineno"> 4169</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; 2; j++) {</div>
<div class="line"><span class="lineno"> 4170</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1 = phaseLabel[j];</div>
<div class="line"><span class="lineno"> 4171</span>            bId = &amp;<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[j1 * ncol];</div>
<div class="line"><span class="lineno"> 4172</span>            <span class="comment">// dSj / dP</span></div>
<div class="line"><span class="lineno"> 4173</span>            bId[0] = (<a class="code hl_variable" href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">vjp</a>[j1] * <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> - <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> * <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[j1]) / vf2;</div>
<div class="line"><span class="lineno"> 4174</span>            bId++;</div>
<div class="line"><span class="lineno"> 4175</span>            <span class="comment">// dSj / dNm</span></div>
<div class="line"><span class="lineno"> 4176</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>; m++) {</div>
<div class="line"><span class="lineno"> 4177</span>                bId[m] = (<a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[j1][m] * <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> - <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[m] * <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[j1]) / vf2;</div>
<div class="line"><span class="lineno"> 4178</span>            }</div>
<div class="line"><span class="lineno"> 4179</span>        }</div>
<div class="line"><span class="lineno"> 4180</span>        <span class="comment">// dSw / dP, dSw / dNm</span></div>
<div class="line"><span class="lineno"> 4181</span>        bId = &amp;<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[(<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1) * ncol];</div>
<div class="line"><span class="lineno"> 4182</span>        <span class="comment">// dSw / dP</span></div>
<div class="line"><span class="lineno"> 4183</span>        bId[0] = (vwp * <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> - <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> * vw) / vf2;</div>
<div class="line"><span class="lineno"> 4184</span>        bId++;</div>
<div class="line"><span class="lineno"> 4185</span>        <span class="comment">// dSw / dNm</span></div>
<div class="line"><span class="lineno"> 4186</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>; m++) {</div>
<div class="line"><span class="lineno"> 4187</span>            bId[m] = (<a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[(<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1)][m] * <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> - <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[m] * vw) / vf2;</div>
<div class="line"><span class="lineno"> 4188</span>        }</div>
<div class="line"><span class="lineno"> 4189</span>        bId += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4190</span> </div>
<div class="line"><span class="lineno"> 4191</span>        <span class="comment">// dxij / dP, dxij / dNm      </span></div>
<div class="line"><span class="lineno"> 4192</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j0 = phaseLabel[0];</div>
<div class="line"><span class="lineno"> 4193</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1 = phaseLabel[1];</div>
<div class="line"><span class="lineno"> 4194</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* dnkjdNP = &amp;rhsDer[0];</div>
<div class="line"><span class="lineno"> 4195</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* bId1 = bId + j0 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> * ncol;</div>
<div class="line"><span class="lineno"> 4196</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* bId2 = bId + j1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> * ncol;</div>
<div class="line"><span class="lineno"> 4197</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> njDerSum = 0;</div>
<div class="line"><span class="lineno"> 4198</span>        <span class="comment">// dxij / dP</span></div>
<div class="line"><span class="lineno"> 4199</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++)</div>
<div class="line"><span class="lineno"> 4200</span>            njDerSum += dnkjdNP[i];</div>
<div class="line"><span class="lineno"> 4201</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 4202</span>            bId1[0] = (dnkjdNP[i] * nu[0] - njDerSum * Nh * n[0][i]) / (nu[0] * nu[0]);</div>
<div class="line"><span class="lineno"> 4203</span>            bId2[0] = (-dnkjdNP[i] * nu[1] + njDerSum * Nh * n[1][i]) / (nu[1] * nu[1]);</div>
<div class="line"><span class="lineno"> 4204</span>            bId1 += ncol;</div>
<div class="line"><span class="lineno"> 4205</span>            bId2 += ncol;</div>
<div class="line"><span class="lineno"> 4206</span>        }</div>
<div class="line"><span class="lineno"> 4207</span>        dnkjdNP += NC;</div>
<div class="line"><span class="lineno"> 4208</span>        <span class="comment">// dxij / dNm</span></div>
<div class="line"><span class="lineno"> 4209</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 4210</span>            njDerSum = 0;</div>
<div class="line"><span class="lineno"> 4211</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++)</div>
<div class="line"><span class="lineno"> 4212</span>                njDerSum += dnkjdNP[i];</div>
<div class="line"><span class="lineno"> 4213</span>            bId1 = bId + j0 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> * ncol + m + 1;</div>
<div class="line"><span class="lineno"> 4214</span>            bId2 = bId + j1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> * ncol + m + 1;</div>
<div class="line"><span class="lineno"> 4215</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 4216</span>                bId1[0] = (dnkjdNP[i] * nu[0] - njDerSum * Nh * n[0][i]) / (nu[0] * nu[0]);</div>
<div class="line"><span class="lineno"> 4217</span>                bId2[0] = ((delta(i, m) - dnkjdNP[i]) * nu[1] - (1 - njDerSum) * Nh * n[1][i]) / (nu[1] * nu[1]);</div>
<div class="line"><span class="lineno"> 4218</span>                bId1 += ncol;</div>
<div class="line"><span class="lineno"> 4219</span>                bId2 += ncol;</div>
<div class="line"><span class="lineno"> 4220</span>            }</div>
<div class="line"><span class="lineno"> 4221</span>            dnkjdNP += NC;</div>
<div class="line"><span class="lineno"> 4222</span>        }</div>
<div class="line"><span class="lineno"> 4223</span>    }</div>
<div class="line"><span class="lineno"> 4224</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1247d1fb3678ac56310ce3903adb59fd" name="a1247d1fb3678ac56310ce3903adb59fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1247d1fb3678ac56310ce3903adb59fd">&#9670;&#160;</a></span>CaldXsdXpAPI02p()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CaldXsdXpAPI02p </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l04227">4227</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4228</span>{</div>
<div class="line"><span class="lineno"> 4229</span>    <span class="comment">// Attention!</span></div>
<div class="line"><span class="lineno"> 4230</span>    <span class="comment">// NP = 1 or NP = 2</span></div>
<div class="line"><span class="lineno"> 4231</span> </div>
<div class="line"><span class="lineno"> 4232</span>    <span class="comment">// water not in oil or gas; hydroncarbon not in water</span></div>
<div class="line"><span class="lineno"> 4233</span>    <span class="comment">// inexist phase will bot be stored</span></div>
<div class="line"><span class="lineno"> 4234</span>    <span class="comment">// only hydrocarbon phases, hydrocarbon components, water phase will be stored</span></div>
<div class="line"><span class="lineno"> 4235</span>    </div>
<div class="line"><span class="lineno"> 4236</span>    <span class="comment">// dS / dP</span></div>
<div class="line"><span class="lineno"> 4237</span>    <span class="comment">// S = Sj, xij</span></div>
<div class="line"><span class="lineno"> 4238</span>    <span class="comment">// P = P, Ni</span></div>
<div class="line"><span class="lineno"> 4239</span>    <span class="comment">// water is included</span></div>
<div class="line"><span class="lineno"> 4240</span>    fill(<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>.begin(), <a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>.end(), 0);</div>
<div class="line"><span class="lineno"> 4241</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> ncol = <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + 1;</div>
<div class="line"><span class="lineno"> 4242</span> </div>
<div class="line"><span class="lineno"> 4243</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> vf2 = <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> * <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a>;</div>
<div class="line"><span class="lineno"> 4244</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> vwp = <a class="code hl_variable" href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">vjp</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1];</div>
<div class="line"><span class="lineno"> 4245</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> vw = <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1];</div>
<div class="line"><span class="lineno"> 4246</span> </div>
<div class="line"><span class="lineno"> 4247</span>    <span class="keywordflow">if</span> (NP == 1) {</div>
<div class="line"><span class="lineno"> 4248</span>        <span class="comment">// when NP = 1, vfi = vhi, vfp = vhp + vwp, h = hydrocarbon </span></div>
<div class="line"><span class="lineno"> 4249</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1 = phaseLabel[0];</div>
<div class="line"><span class="lineno"> 4250</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* bId = &amp;<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[0];</div>
<div class="line"><span class="lineno"> 4251</span>        <span class="comment">// dS / dP</span></div>
<div class="line"><span class="lineno"> 4252</span>        bId[0] = ((<a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> - vwp) * <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> - <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> * <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[j1]) / vf2;</div>
<div class="line"><span class="lineno"> 4253</span>        bId++;</div>
<div class="line"><span class="lineno"> 4254</span>        <span class="comment">// dSh / dNm</span></div>
<div class="line"><span class="lineno"> 4255</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 4256</span>            bId[m] = <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[m] * vw / vf2;</div>
<div class="line"><span class="lineno"> 4257</span>        }</div>
<div class="line"><span class="lineno"> 4258</span>        bId += NC;</div>
<div class="line"><span class="lineno"> 4259</span>        <span class="comment">// dSh / dNw</span></div>
<div class="line"><span class="lineno"> 4260</span>        bId[0] = -<a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[<a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> - 1] * <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[j1] / vf2;</div>
<div class="line"><span class="lineno"> 4261</span>        bId++;</div>
<div class="line"><span class="lineno"> 4262</span>        <span class="comment">// dSw / dP, dNm</span></div>
<div class="line"><span class="lineno"> 4263</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; ncol; m++) {</div>
<div class="line"><span class="lineno"> 4264</span>            bId[m] = -<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[m];</div>
<div class="line"><span class="lineno"> 4265</span>        }</div>
<div class="line"><span class="lineno"> 4266</span>        bId += ncol + 1;</div>
<div class="line"><span class="lineno"> 4267</span>        <span class="comment">// dxij / dNm</span></div>
<div class="line"><span class="lineno"> 4268</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 4269</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 4270</span>                bId[m] = (delta(i, m) * Nh - <a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[i]) / (Nh * Nh);</div>
<div class="line"><span class="lineno"> 4271</span>            }</div>
<div class="line"><span class="lineno"> 4272</span>            bId += ncol;</div>
<div class="line"><span class="lineno"> 4273</span>        }</div>
<div class="line"><span class="lineno"> 4274</span>    }</div>
<div class="line"><span class="lineno"> 4275</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4276</span>        <span class="comment">// NP = 2   </span></div>
<div class="line"><span class="lineno"> 4277</span>        <span class="comment">// dSj / dP, dSj / dNm</span></div>
<div class="line"><span class="lineno"> 4278</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* bId;</div>
<div class="line"><span class="lineno"> 4279</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; 2; j++) {</div>
<div class="line"><span class="lineno"> 4280</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1 = phaseLabel[j];</div>
<div class="line"><span class="lineno"> 4281</span>            bId = &amp;<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[j1 * ncol];</div>
<div class="line"><span class="lineno"> 4282</span>            <span class="comment">// dSj / dP</span></div>
<div class="line"><span class="lineno"> 4283</span>            bId[0] = (<a class="code hl_variable" href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">vjp</a>[j1] * <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> - <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> * <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[j1]) / vf2;</div>
<div class="line"><span class="lineno"> 4284</span>            bId++;</div>
<div class="line"><span class="lineno"> 4285</span>            <span class="comment">// dSj / dNm</span></div>
<div class="line"><span class="lineno"> 4286</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>; m++) {</div>
<div class="line"><span class="lineno"> 4287</span>                bId[m] = (<a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[j1][m] * <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> - <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[m] * <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[j1]) / vf2;</div>
<div class="line"><span class="lineno"> 4288</span>            }</div>
<div class="line"><span class="lineno"> 4289</span>        }</div>
<div class="line"><span class="lineno"> 4290</span>        <span class="comment">// dSw / dP, dSw / dNm</span></div>
<div class="line"><span class="lineno"> 4291</span>        bId = &amp;<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[(<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1) * ncol];</div>
<div class="line"><span class="lineno"> 4292</span>        <span class="comment">// dSw / dP</span></div>
<div class="line"><span class="lineno"> 4293</span>        bId[0] = (vwp * <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> - <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> * vw) / vf2;</div>
<div class="line"><span class="lineno"> 4294</span>        bId++;</div>
<div class="line"><span class="lineno"> 4295</span>        <span class="comment">// dSw / dNm</span></div>
<div class="line"><span class="lineno"> 4296</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>; m++) {</div>
<div class="line"><span class="lineno"> 4297</span>            bId[m] = (<a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[(<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1)][m] * <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> - <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[m] * vw) / vf2;</div>
<div class="line"><span class="lineno"> 4298</span>        }</div>
<div class="line"><span class="lineno"> 4299</span>        bId += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4300</span> </div>
<div class="line"><span class="lineno"> 4301</span>        <span class="comment">// dxij / dP, dxij / dNm      </span></div>
<div class="line"><span class="lineno"> 4302</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j0 = phaseLabel[0];</div>
<div class="line"><span class="lineno"> 4303</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1 = phaseLabel[1];</div>
<div class="line"><span class="lineno"> 4304</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* dnkjdNP = &amp;rhsDer[0];</div>
<div class="line"><span class="lineno"> 4305</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* bId1 = bId + j0 * NC * ncol;</div>
<div class="line"><span class="lineno"> 4306</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* bId2 = bId + j1 * NC * ncol;</div>
<div class="line"><span class="lineno"> 4307</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> njDerSum = 0;</div>
<div class="line"><span class="lineno"> 4308</span>        <span class="comment">// dxij / dP</span></div>
<div class="line"><span class="lineno"> 4309</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++)</div>
<div class="line"><span class="lineno"> 4310</span>            njDerSum += dnkjdNP[i];</div>
<div class="line"><span class="lineno"> 4311</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 4312</span>            bId1[0] = (dnkjdNP[i] * nu[0] - njDerSum * Nh * n[0][i]) / (nu[0] * nu[0]);</div>
<div class="line"><span class="lineno"> 4313</span>            bId2[0] = (-dnkjdNP[i] * nu[1] + njDerSum * Nh * n[1][i]) / (nu[1] * nu[1]);</div>
<div class="line"><span class="lineno"> 4314</span>            bId1 += ncol;</div>
<div class="line"><span class="lineno"> 4315</span>            bId2 += ncol;</div>
<div class="line"><span class="lineno"> 4316</span>        }</div>
<div class="line"><span class="lineno"> 4317</span>        dnkjdNP += NC;</div>
<div class="line"><span class="lineno"> 4318</span>        <span class="comment">// dxij / dNm</span></div>
<div class="line"><span class="lineno"> 4319</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 4320</span>            njDerSum = 0;</div>
<div class="line"><span class="lineno"> 4321</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++)</div>
<div class="line"><span class="lineno"> 4322</span>                njDerSum += dnkjdNP[i];</div>
<div class="line"><span class="lineno"> 4323</span>            bId1 = bId + j0 * NC * ncol + m + 1;</div>
<div class="line"><span class="lineno"> 4324</span>            bId2 = bId + j1 * NC * ncol + m + 1;</div>
<div class="line"><span class="lineno"> 4325</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 4326</span>                bId1[0] = (dnkjdNP[i] * nu[0] - njDerSum * Nh * n[0][i]) / (nu[0] * nu[0]);</div>
<div class="line"><span class="lineno"> 4327</span>                bId2[0] = ((delta(i, m) - dnkjdNP[i]) * nu[1] - (1 - njDerSum) * Nh * n[1][i]) / (nu[1] * nu[1]);</div>
<div class="line"><span class="lineno"> 4328</span>                bId1 += ncol;</div>
<div class="line"><span class="lineno"> 4329</span>                bId2 += ncol;</div>
<div class="line"><span class="lineno"> 4330</span>            }</div>
<div class="line"><span class="lineno"> 4331</span>            dnkjdNP += NC;</div>
<div class="line"><span class="lineno"> 4332</span>        }</div>
<div class="line"><span class="lineno"> 4333</span>    }</div>
<div class="line"><span class="lineno"> 4334</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afa7d8e0920be4128fa6c6cf5fb01442a" name="afa7d8e0920be4128fa6c6cf5fb01442a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa7d8e0920be4128fa6c6cf5fb01442a">&#9670;&#160;</a></span>CaldXsdXpAPI03()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CaldXsdXpAPI03 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l04337">4337</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4338</span>{</div>
<div class="line"><span class="lineno"> 4339</span>    <span class="comment">// p : P, Ni</span></div>
<div class="line"><span class="lineno"> 4340</span>    <span class="comment">// s : S, nij</span></div>
<div class="line"><span class="lineno"> 4341</span>    <span class="comment">// water not in oil or gas; hydroncarbon not in water</span></div>
<div class="line"><span class="lineno"> 4342</span>    <span class="comment">// inexist phase will bot be stored</span></div>
<div class="line"><span class="lineno"> 4343</span>    <span class="comment">// only hydrocarbon phases, hydrocarbon components, water phase will be stored</span></div>
<div class="line"><span class="lineno"> 4344</span> </div>
<div class="line"><span class="lineno"> 4345</span>    <span class="comment">// water is included</span></div>
<div class="line"><span class="lineno"> 4346</span>    fill(<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>.begin(), <a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>.end(), 0.0);</div>
<div class="line"><span class="lineno"> 4347</span>    fill(<a class="code hl_variable" href="classMixture.html#ae6c518e1735459e4da660fe989fbcf1d">res</a>.begin(), <a class="code hl_variable" href="classMixture.html#ae6c518e1735459e4da660fe989fbcf1d">res</a>.end(), 0.0);</div>
<div class="line"><span class="lineno"> 4348</span>    <a class="code hl_variable" href="classMixture.html#a06e0f35248973da46366c82943f6a085">resPc</a> = 0;</div>
<div class="line"><span class="lineno"> 4349</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> ncol = <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + 1;</div>
<div class="line"><span class="lineno"> 4350</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> vf2 = <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> * <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a>;</div>
<div class="line"><span class="lineno"> 4351</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> vwp = <a class="code hl_variable" href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">vjp</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1];</div>
<div class="line"><span class="lineno"> 4352</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> vw = <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1];</div>
<div class="line"><span class="lineno"> 4353</span> </div>
<div class="line"><span class="lineno"> 4354</span>    <span class="keywordflow">if</span> (NP == 1) {</div>
<div class="line"><span class="lineno"> 4355</span>        <span class="comment">// when NP = 1, vfi = vhi, vfp = vhp + vwp, h = hydrocarbon   </span></div>
<div class="line"><span class="lineno"> 4356</span>        <span class="comment">// and vfi = vji</span></div>
<div class="line"><span class="lineno"> 4357</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j0 = phaseLabel[0];</div>
<div class="line"><span class="lineno"> 4358</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* bId = &amp;<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[0];</div>
<div class="line"><span class="lineno"> 4359</span>        <span class="comment">// dS / dP</span></div>
<div class="line"><span class="lineno"> 4360</span>        bId[0] = ((<a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> - vwp) * <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> - <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> * <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[j0]) / vf2;</div>
<div class="line"><span class="lineno"> 4361</span>        bId++;</div>
<div class="line"><span class="lineno"> 4362</span>        <span class="comment">// dSh / dNm</span></div>
<div class="line"><span class="lineno"> 4363</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 4364</span>            bId[m] = <a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[j0][m] * vw / vf2;</div>
<div class="line"><span class="lineno"> 4365</span>        }</div>
<div class="line"><span class="lineno"> 4366</span>        bId += NC;</div>
<div class="line"><span class="lineno"> 4367</span>        <span class="comment">// dSh / dNw</span></div>
<div class="line"><span class="lineno"> 4368</span>        bId[0] = -<a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[<a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> - 1] * <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[j0] / vf2;</div>
<div class="line"><span class="lineno"> 4369</span>        bId++;</div>
<div class="line"><span class="lineno"> 4370</span>        <span class="comment">// dSw / dP, dNm     </span></div>
<div class="line"><span class="lineno"> 4371</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; ncol; m++) {</div>
<div class="line"><span class="lineno"> 4372</span>            bId[m] = -<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[m];</div>
<div class="line"><span class="lineno"> 4373</span>        }</div>
<div class="line"><span class="lineno"> 4374</span> </div>
<div class="line"><span class="lineno"> 4375</span>        <span class="comment">// dnij / dNm</span></div>
<div class="line"><span class="lineno"> 4376</span>        bId = &amp;<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[2 * ncol + 1];</div>
<div class="line"><span class="lineno"> 4377</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 4378</span>            bId[i] = 1;</div>
<div class="line"><span class="lineno"> 4379</span>            bId += ncol;</div>
<div class="line"><span class="lineno"> 4380</span>        }</div>
<div class="line"><span class="lineno"> 4381</span>        <span class="comment">// res = 0</span></div>
<div class="line"><span class="lineno"> 4382</span> </div>
<div class="line"><span class="lineno"> 4383</span>    }</div>
<div class="line"><span class="lineno"> 4384</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4385</span>        CalFugNAll(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4386</span>        CalFugPAll(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4387</span>        CaldXsdXp03();</div>
<div class="line"><span class="lineno"> 4388</span> </div>
<div class="line"><span class="lineno"> 4389</span>        <span class="comment">// Assemble dXsdXp</span></div>
<div class="line"><span class="lineno"> 4390</span>        <span class="comment">// // inexist phase will bot be stored</span></div>
<div class="line"><span class="lineno"> 4391</span>        <span class="comment">// no d xiw / dP, d xiw / dNk</span></div>
<div class="line"><span class="lineno"> 4392</span>        <span class="comment">// no d xwj / dP, d xwj / dNk</span></div>
<div class="line"><span class="lineno"> 4393</span> </div>
<div class="line"><span class="lineno"> 4394</span>        vector&lt;USI&gt; sIndex(<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a>, 0); <span class="comment">// store index</span></div>
<div class="line"><span class="lineno"> 4395</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; <a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1; j++) {</div>
<div class="line"><span class="lineno"> 4396</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">phaseExist</a>[j]) {</div>
<div class="line"><span class="lineno"> 4397</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1 = j + 1; j1 &lt; <a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a>; j1++) {</div>
<div class="line"><span class="lineno"> 4398</span>                    sIndex[j1]++;</div>
<div class="line"><span class="lineno"> 4399</span>                }</div>
<div class="line"><span class="lineno"> 4400</span>            }</div>
<div class="line"><span class="lineno"> 4401</span>        }</div>
<div class="line"><span class="lineno"> 4402</span>     </div>
<div class="line"><span class="lineno"> 4403</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* STmp = &amp;rhsDer[0];</div>
<div class="line"><span class="lineno"> 4404</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> nrhs = <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + 1;</div>
<div class="line"><span class="lineno"> 4405</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> wNP = NP + 1;</div>
<div class="line"><span class="lineno"> 4406</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> nrow = wNP + NP * NC;</div>
<div class="line"><span class="lineno"> 4407</span>        </div>
<div class="line"><span class="lineno"> 4408</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> bId;</div>
<div class="line"><span class="lineno"> 4409</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; nrhs; i++) {</div>
<div class="line"><span class="lineno"> 4410</span>            <span class="comment">// Sh</span></div>
<div class="line"><span class="lineno"> 4411</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 4412</span>                <a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[sIndex[phaseLabel[j]] * nrhs + i] = STmp[j];</div>
<div class="line"><span class="lineno"> 4413</span>            }</div>
<div class="line"><span class="lineno"> 4414</span>            STmp += NP;</div>
<div class="line"><span class="lineno"> 4415</span>            <span class="comment">// Sw</span></div>
<div class="line"><span class="lineno"> 4416</span>            <a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[NP * nrhs + i] = STmp[0];</div>
<div class="line"><span class="lineno"> 4417</span>            STmp++;</div>
<div class="line"><span class="lineno"> 4418</span>            <span class="comment">// nij</span></div>
<div class="line"><span class="lineno"> 4419</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 4420</span>                bId = wNP + sIndex[phaseLabel[j]] * NC;</div>
<div class="line"><span class="lineno"> 4421</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 4422</span>                    <a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[(bId + k) * nrhs + i] = STmp[k];</div>
<div class="line"><span class="lineno"> 4423</span>                }             </div>
<div class="line"><span class="lineno"> 4424</span>                STmp += NC;</div>
<div class="line"><span class="lineno"> 4425</span>            }</div>
<div class="line"><span class="lineno"> 4426</span>        }</div>
<div class="line"><span class="lineno"> 4427</span> </div>
<div class="line"><span class="lineno"> 4428</span>        <span class="comment">// res</span></div>
<div class="line"><span class="lineno"> 4429</span>        <span class="comment">// Sh</span></div>
<div class="line"><span class="lineno"> 4430</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 4431</span>            <a class="code hl_variable" href="classMixture.html#ae6c518e1735459e4da660fe989fbcf1d">res</a>[sIndex[phaseLabel[j]]] = STmp[j];</div>
<div class="line"><span class="lineno"> 4432</span>        }</div>
<div class="line"><span class="lineno"> 4433</span>        STmp += NP;</div>
<div class="line"><span class="lineno"> 4434</span>        <span class="comment">// Sw</span></div>
<div class="line"><span class="lineno"> 4435</span>        <a class="code hl_variable" href="classMixture.html#ae6c518e1735459e4da660fe989fbcf1d">res</a>[NP] = STmp[0];</div>
<div class="line"><span class="lineno"> 4436</span>        STmp++;</div>
<div class="line"><span class="lineno"> 4437</span>        <span class="comment">// nij</span></div>
<div class="line"><span class="lineno"> 4438</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 4439</span>            bId = wNP + sIndex[phaseLabel[j]] * NC;</div>
<div class="line"><span class="lineno"> 4440</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 4441</span>                <a class="code hl_variable" href="classMixture.html#ae6c518e1735459e4da660fe989fbcf1d">res</a>[bId + k] = STmp[k];</div>
<div class="line"><span class="lineno"> 4442</span>            }</div>
<div class="line"><span class="lineno"> 4443</span>            STmp += NC;</div>
<div class="line"><span class="lineno"> 4444</span>        }</div>
<div class="line"><span class="lineno"> 4445</span> </div>
<div class="line"><span class="lineno"> 4446</span> </div>
<div class="line"><span class="lineno"> 4447</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* myres = &amp;<a class="code hl_variable" href="classMixture.html#ae6c518e1735459e4da660fe989fbcf1d">res</a>[NP + 1];        </div>
<div class="line"><span class="lineno"> 4448</span>        <span class="comment">// precalculate a value</span></div>
<div class="line"><span class="lineno"> 4449</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 4450</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1 = phaseLabel[j];</div>
<div class="line"><span class="lineno"> 4451</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 4452</span>                <a class="code hl_variable" href="classMixture.html#a06e0f35248973da46366c82943f6a085">resPc</a> += <a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[j1][i] * myres[i];</div>
<div class="line"><span class="lineno"> 4453</span>            }</div>
<div class="line"><span class="lineno"> 4454</span>            myres += NC;</div>
<div class="line"><span class="lineno"> 4455</span>        }</div>
<div class="line"><span class="lineno"> 4456</span> </div>
<div class="line"><span class="lineno"> 4457</span>        <span class="comment">//resPc = 0;</span></div>
<div class="line"><span class="lineno"> 4458</span>        <span class="comment">//fill(res.begin(), res.end(), 0.0);</span></div>
<div class="line"><span class="lineno"> 4459</span> </div>
<div class="line"><span class="lineno"> 4460</span>        <span class="comment">//cout &lt;&lt; &quot;res1&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 4461</span>        <span class="comment">//for (USI i = 0; i &lt; nrow; i++) {</span></div>
<div class="line"><span class="lineno"> 4462</span>        <span class="comment">//    for (USI j = nrhs; j &lt; nrhs + 1; j++) {</span></div>
<div class="line"><span class="lineno"> 4463</span>        <span class="comment">//        cout &lt;&lt; setw(12) &lt;&lt; rhsDer[j * nrow + i] &lt;&lt; &quot;   &quot;;</span></div>
<div class="line"><span class="lineno"> 4464</span>        <span class="comment">//    }</span></div>
<div class="line"><span class="lineno"> 4465</span>        <span class="comment">//    cout &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 4466</span>        <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 4467</span>        <span class="comment">//cout &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 4468</span>        <span class="comment">//cout &lt;&lt; &quot;resPc = &quot; &lt;&lt; resPc &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 4469</span>    }</div>
<div class="line"><span class="lineno"> 4470</span>    </div>
<div class="line"><span class="lineno"> 4471</span><span class="preprocessor">#ifdef OCP_NANCHECK</span></div>
<div class="line"><span class="lineno"> 4472</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="DenseMat_8hpp.html#a56bc3abd4d498e5055b3da3a58d45bad">CheckNan</a>(<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>.size(), &amp;<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[0]))</div>
<div class="line"><span class="lineno"> 4473</span>    {</div>
<div class="line"><span class="lineno"> 4474</span>        <a class="code hl_define" href="UtilError_8hpp.html#aecfc13af45c4bb869301d5ce54cba0af">OCP_ABORT</a>(<span class="stringliteral">&quot;INF or INF in bmat !&quot;</span>);</div>
<div class="line"><span class="lineno"> 4475</span>    }</div>
<div class="line"><span class="lineno"> 4476</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4477</span>}</div>
<div class="ttc" id="aclassMixture_html_a06e0f35248973da46366c82943f6a085"><div class="ttname"><a href="classMixture.html#a06e0f35248973da46366c82943f6a085">Mixture::resPc</a></div><div class="ttdeci">OCP_DBL resPc</div><div class="ttdoc">a precalculated value</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00186">Mixture.hpp:186</a></div></div>
<div class="ttc" id="aclassMixture_html_a1a1b7838c46e07a94c3a95ae9b37e511"><div class="ttname"><a href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">Mixture::phaseExist</a></div><div class="ttdeci">vector&lt; bool &gt; phaseExist</div><div class="ttdoc">existence of phase: numPhase</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00150">Mixture.hpp:150</a></div></div>
<div class="ttc" id="aclassMixture_html_ae6c518e1735459e4da660fe989fbcf1d"><div class="ttname"><a href="classMixture.html#ae6c518e1735459e4da660fe989fbcf1d">Mixture::res</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; res</div><div class="ttdoc">residual of a set of equations</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00185">Mixture.hpp:185</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab311195bc18414e89a5920a954e666d9" name="ab311195bc18414e89a5920a954e666d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab311195bc18414e89a5920a954e666d9">&#9670;&#160;</a></span>CaldXsdXpAPI04()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CaldXsdXpAPI04 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l02615">2615</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2616</span>{</div>
<div class="line"><span class="lineno"> 2617</span>    <span class="comment">// Wrong Now !</span></div>
<div class="line"><span class="lineno"> 2618</span> </div>
<div class="line"><span class="lineno"> 2619</span>    <span class="comment">// water not in oil or gas; hydroncarbon not in water</span></div>
<div class="line"><span class="lineno"> 2620</span>    <span class="comment">// inexist phase will bot be stored</span></div>
<div class="line"><span class="lineno"> 2621</span>    <span class="comment">// only hydrocarbon phases, hydrocarbon components, water phase will be stored</span></div>
<div class="line"><span class="lineno"> 2622</span> </div>
<div class="line"><span class="lineno"> 2623</span>    <span class="comment">// dS / dP</span></div>
<div class="line"><span class="lineno"> 2624</span>    <span class="comment">// S = Sj, xij</span></div>
<div class="line"><span class="lineno"> 2625</span>    <span class="comment">// P = P, Ni</span></div>
<div class="line"><span class="lineno"> 2626</span>    <span class="comment">// water is included</span></div>
<div class="line"><span class="lineno"> 2627</span>    fill(<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>.begin(), <a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>.end(), 0.0);</div>
<div class="line"><span class="lineno"> 2628</span>    fill(<a class="code hl_variable" href="classMixture.html#ae6c518e1735459e4da660fe989fbcf1d">res</a>.begin(), <a class="code hl_variable" href="classMixture.html#ae6c518e1735459e4da660fe989fbcf1d">res</a>.end(), 0.0);</div>
<div class="line"><span class="lineno"> 2629</span>    <a class="code hl_variable" href="classMixture.html#a06e0f35248973da46366c82943f6a085">resPc</a> = 0;</div>
<div class="line"><span class="lineno"> 2630</span> </div>
<div class="line"><span class="lineno"> 2631</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> ncol = <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + 1;</div>
<div class="line"><span class="lineno"> 2632</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> vf2 = <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> * <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a>;</div>
<div class="line"><span class="lineno"> 2633</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> vwp = <a class="code hl_variable" href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">vjp</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1];</div>
<div class="line"><span class="lineno"> 2634</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> vw = <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1];</div>
<div class="line"><span class="lineno"> 2635</span> </div>
<div class="line"><span class="lineno"> 2636</span>    <span class="keywordflow">if</span> (NP == 1) {</div>
<div class="line"><span class="lineno"> 2637</span>        <span class="comment">// when NP = 1, vfi = vhi, vfp = vhp + vwp, h = hydrocarbon </span></div>
<div class="line"><span class="lineno"> 2638</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1 = phaseLabel[0];</div>
<div class="line"><span class="lineno"> 2639</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* bId = &amp;<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[0];</div>
<div class="line"><span class="lineno"> 2640</span>        <span class="comment">// dS / dP</span></div>
<div class="line"><span class="lineno"> 2641</span>        bId[0] = ((<a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> - vwp) * <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> - <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> * <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[j1]) / vf2;</div>
<div class="line"><span class="lineno"> 2642</span>        bId++;</div>
<div class="line"><span class="lineno"> 2643</span>        <span class="comment">// dSh / dNm</span></div>
<div class="line"><span class="lineno"> 2644</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 2645</span>            bId[m] = <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[m] * vw / vf2;</div>
<div class="line"><span class="lineno"> 2646</span>        }</div>
<div class="line"><span class="lineno"> 2647</span>        bId += NC;</div>
<div class="line"><span class="lineno"> 2648</span>        <span class="comment">// dSh / dNw</span></div>
<div class="line"><span class="lineno"> 2649</span>        bId[0] = -<a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[<a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> - 1] * <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[j1] / vf2;</div>
<div class="line"><span class="lineno"> 2650</span>        bId++;</div>
<div class="line"><span class="lineno"> 2651</span>        <span class="comment">// dSw / dP, dNm</span></div>
<div class="line"><span class="lineno"> 2652</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; ncol; m++) {</div>
<div class="line"><span class="lineno"> 2653</span>            bId[m] = -<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[m];</div>
<div class="line"><span class="lineno"> 2654</span>        }</div>
<div class="line"><span class="lineno"> 2655</span>        bId += ncol + 1;</div>
<div class="line"><span class="lineno"> 2656</span>        <span class="comment">// dxij / dNm</span></div>
<div class="line"><span class="lineno"> 2657</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 2658</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 2659</span>                bId[m] = (delta(i, m) * Nh - <a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[i]) / (Nh * Nh);</div>
<div class="line"><span class="lineno"> 2660</span>            }</div>
<div class="line"><span class="lineno"> 2661</span>            bId += ncol;</div>
<div class="line"><span class="lineno"> 2662</span>        }</div>
<div class="line"><span class="lineno"> 2663</span>        <span class="comment">// res = 0</span></div>
<div class="line"><span class="lineno"> 2664</span>    }</div>
<div class="line"><span class="lineno"> 2665</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2666</span>        CalFugXAll();</div>
<div class="line"><span class="lineno"> 2667</span>        CalFugPAll(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2668</span>        CaldXsdXp04();</div>
<div class="line"><span class="lineno"> 2669</span>    }</div>
<div class="line"><span class="lineno"> 2670</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aee4085190c90fb9e76260cbe032425bd" name="aee4085190c90fb9e76260cbe032425bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee4085190c90fb9e76260cbe032425bd">&#9670;&#160;</a></span>CalFlash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalFlash </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>Pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>Tin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *&#160;</td>
          <td class="paramname"><em>Niin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00466">466</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  467</span>{</div>
<div class="line"><span class="lineno">  468</span>    setPT(Pin, Tin);</div>
<div class="line"><span class="lineno">  469</span>    setNi(Niin);</div>
<div class="line"><span class="lineno">  470</span> </div>
<div class="line"><span class="lineno">  471</span>    nu[0] = 1;</div>
<div class="line"><span class="lineno">  472</span>    nu[1] = 0;</div>
<div class="line"><span class="lineno">  473</span>    <span class="comment">// Water is excluded</span></div>
<div class="line"><span class="lineno">  474</span>    Nh = <a class="code hl_function" href="DenseMat_8hpp.html#accb44af625653de07f0a8dba403348d1">Dnorm1</a>(NC, &amp;<a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[0]);</div>
<div class="line"><span class="lineno">  475</span>    setZi();</div>
<div class="line"><span class="lineno">  476</span>    PhaseEquilibrium();</div>
<div class="line"><span class="lineno">  477</span>    <span class="comment">// Next, nu represents moles of phase instead of molar fraction of phase</span></div>
<div class="line"><span class="lineno">  478</span>    <a class="code hl_function" href="DenseMat_8hpp.html#a3fb701e3ab34443119b7b2ba7a2bc6c7">Dscalar</a>(NP, Nh, &amp;nu[0]);</div>
<div class="line"><span class="lineno">  479</span>    CalMW();</div>
<div class="line"><span class="lineno">  480</span>    CalVfXiRho();</div>
<div class="line"><span class="lineno">  481</span>    CalViscosity();</div>
<div class="line"><span class="lineno">  482</span>    CalSurfaceTension();</div>
<div class="line"><span class="lineno">  483</span>    IdentifyPhase();</div>
<div class="line"><span class="lineno">  484</span>    <a class="code hl_function" href="classMixtureComp.html#a04a0d98d3277d79d1403dff71ba21fd5">CopyPhase</a>();</div>
<div class="line"><span class="lineno">  485</span>}</div>
<div class="ttc" id="aDenseMat_8hpp_html_accb44af625653de07f0a8dba403348d1"><div class="ttname"><a href="DenseMat_8hpp.html#accb44af625653de07f0a8dba403348d1">Dnorm1</a></div><div class="ttdeci">double Dnorm1(const int &amp;N, double *x)</div><div class="ttdoc">Computes the L1-norm of a vector.</div><div class="ttdef"><b>Definition:</b> <a href="DenseMat_8cpp_source.html#l00050">DenseMat.cpp:50</a></div></div>
<div class="ttc" id="aclassMixtureComp_html_a04a0d98d3277d79d1403dff71ba21fd5"><div class="ttname"><a href="classMixtureComp.html#a04a0d98d3277d79d1403dff71ba21fd5">MixtureComp::CopyPhase</a></div><div class="ttdeci">void CopyPhase()</div><div class="ttdoc">Copy the basic properties from MixtureComp to Mixture.</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8cpp_source.html#l02155">MixtureComp.cpp:2155</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6e8ea10ee7ec790969a57d8a327ec22" name="ae6e8ea10ee7ec790969a57d8a327ec22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6e8ea10ee7ec790969a57d8a327ec22">&#9670;&#160;</a></span>CalFugNAll()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalFugNAll </td>
          <td>(</td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>Znflag</em> = <code>true</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l01842">1842</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1843</span>{</div>
<div class="line"><span class="lineno"> 1844</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> C, D, E, G;</div>
<div class="line"><span class="lineno"> 1845</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Cnk, Dnk, Enk, Gnk;</div>
<div class="line"><span class="lineno"> 1846</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp, aik;</div>
<div class="line"><span class="lineno"> 1847</span> </div>
<div class="line"><span class="lineno"> 1848</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 1849</span>        <span class="comment">// j th phase</span></div>
<div class="line"><span class="lineno"> 1850</span>        vector&lt;OCP_DBL&gt;&amp;       fugn = fugN[j];</div>
<div class="line"><span class="lineno"> 1851</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&amp;         aj   = Aj[j];</div>
<div class="line"><span class="lineno"> 1852</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&amp;         bj   = Bj[j];</div>
<div class="line"><span class="lineno"> 1853</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&amp;         zj   = Zj[j];</div>
<div class="line"><span class="lineno"> 1854</span>        <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; xj   = x[j];</div>
<div class="line"><span class="lineno"> 1855</span>        vector&lt;OCP_DBL&gt;&amp;       Znj  = Zn[j];</div>
<div class="line"><span class="lineno"> 1856</span> </div>
<div class="line"><span class="lineno"> 1857</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1858</span>            tmp = 0;</div>
<div class="line"><span class="lineno"> 1859</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 1860</span>                tmp += (1 - BIC[i * NC + m]) * sqrt(Ai[i] * Ai[m]) * xj[m];</div>
<div class="line"><span class="lineno"> 1861</span>            }</div>
<div class="line"><span class="lineno"> 1862</span>            An[i] = 2 / nu[j] * (tmp - aj);</div>
<div class="line"><span class="lineno"> 1863</span>            Bn[i] = 1 / nu[j] * (Bi[i] - bj);</div>
<div class="line"><span class="lineno"> 1864</span>            <span class="keywordflow">if</span> (Znflag) {</div>
<div class="line"><span class="lineno"> 1865</span>                Znj[i] =</div>
<div class="line"><span class="lineno"> 1866</span>                    ((bj - zj) * An[i] +</div>
<div class="line"><span class="lineno"> 1867</span>                        ((aj + delta1 * delta2 * (3 * bj * bj + 2 * bj)) +</div>
<div class="line"><span class="lineno"> 1868</span>                            ((delta1 + delta2) * (2 * bj + 1) - 2 * delta1 * delta2 * bj) * zj -</div>
<div class="line"><span class="lineno"> 1869</span>                            (delta1 + delta2 - 1) * zj * zj) *</div>
<div class="line"><span class="lineno"> 1870</span>                        Bn[i]) /</div>
<div class="line"><span class="lineno"> 1871</span>                    (3 * zj * zj + 2 * ((delta1 + delta2 - 1) * bj - 1) * zj +</div>
<div class="line"><span class="lineno"> 1872</span>                        (aj + delta1 * delta2 * bj * bj - (delta1 + delta2) * bj * (bj + 1)));</div>
<div class="line"><span class="lineno"> 1873</span>            }     </div>
<div class="line"><span class="lineno"> 1874</span>        }</div>
<div class="line"><span class="lineno"> 1875</span> </div>
<div class="line"><span class="lineno"> 1876</span>        G = (zj + delta1 * bj) / (zj + delta2 * bj);</div>
<div class="line"><span class="lineno"> 1877</span> </div>
<div class="line"><span class="lineno"> 1878</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1879</span>            <span class="comment">// i th fugacity</span></div>
<div class="line"><span class="lineno"> 1880</span>            C = xj[i] * P / (zj - bj);</div>
<div class="line"><span class="lineno"> 1881</span>            <span class="comment">// D = Bi[i] / bj * (zj - 1);</span></div>
<div class="line"><span class="lineno"> 1882</span>            tmp = 0;</div>
<div class="line"><span class="lineno"> 1883</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 1884</span>                tmp += (1 - BIC[i * NC + k]) * sqrt(Ai[i] * Ai[k]) * xj[k];</div>
<div class="line"><span class="lineno"> 1885</span>            }</div>
<div class="line"><span class="lineno"> 1886</span>            E = -aj / ((delta1 - delta2) * bj) * (2 * tmp / aj - Bi[i] / bj);</div>
<div class="line"><span class="lineno"> 1887</span> </div>
<div class="line"><span class="lineno"> 1888</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt;= i; k++) {</div>
<div class="line"><span class="lineno"> 1889</span>                <span class="comment">// k th components</span></div>
<div class="line"><span class="lineno"> 1890</span> </div>
<div class="line"><span class="lineno"> 1891</span>                aik = (1 - BIC[i * NC + k]) * sqrt(Ai[i] * Ai[k]);</div>
<div class="line"><span class="lineno"> 1892</span> </div>
<div class="line"><span class="lineno"> 1893</span>                Cnk = P / (zj - bj) / (zj - bj) *</div>
<div class="line"><span class="lineno"> 1894</span>                      ((zj - bj) / nu[j] * (delta(i, k) - xj[i]) -</div>
<div class="line"><span class="lineno"> 1895</span>                       xj[i] * (Znj[k] - Bn[k]));</div>
<div class="line"><span class="lineno"> 1896</span>                Dnk = Bi[i] / bj * (Znj[k] - (Bi[k] - bj) * (zj - 1) / (nu[j] * bj));</div>
<div class="line"><span class="lineno"> 1897</span>                Gnk = (delta1 - delta2) / ((zj + delta2 * bj) * (zj + delta2 * bj)) *</div>
<div class="line"><span class="lineno"> 1898</span>                      (Bn[k] * zj - Znj[k] * bj);</div>
<div class="line"><span class="lineno"> 1899</span>                <span class="comment">/*Enk = 1 / ((delta1 - delta2) * bj * bj) * (An[k] * bj - Bn[k] * aj) *</span></div>
<div class="line"><span class="lineno"> 1900</span><span class="comment">                   (Bi[i] / bj - 2 * tmp / aj)</span></div>
<div class="line"><span class="lineno"> 1901</span><span class="comment">                    + aj / ((delta1 - delta2) * bj) * (-Bi[i] / (bj * bj) * Bn[k] - 2 /</span></div>
<div class="line"><span class="lineno"> 1902</span><span class="comment">                   (aj * aj) * (aj * (aik - tmp) / nu[j] - An[k] * tmp));*/</span></div>
<div class="line"><span class="lineno"> 1903</span>                Enk = -1 / (delta1 - delta2) / (bj * bj) *</div>
<div class="line"><span class="lineno"> 1904</span>                      (2 * (bj * aik / nu[j] + Bn[k] * (Bi[i] * aj / bj - tmp)) -</div>
<div class="line"><span class="lineno"> 1905</span>                       An[k] * Bi[i] - aj * Bi[i] / nu[j]);</div>
<div class="line"><span class="lineno"> 1906</span>                Enk -= E / nu[j];</div>
<div class="line"><span class="lineno"> 1907</span>                fugn[i * NC + k] = 1 / C * Cnk + Dnk + Enk * log(G) + E / G * Gnk;</div>
<div class="line"><span class="lineno"> 1908</span>                fugn[k * NC + i] = fugn[i * NC + k];</div>
<div class="line"><span class="lineno"> 1909</span>                <span class="comment">/*cout &lt;&lt; &quot;fnn[&quot; &lt;&lt; j &lt;&lt; &quot;][&quot; &lt;&lt; i &lt;&lt; &quot;][&quot; &lt;&lt; k &lt;&lt; &quot;] = &quot; &lt;&lt; fugn[i * NC</span></div>
<div class="line"><span class="lineno"> 1910</span><span class="comment">                + k]; cout &lt;&lt; endl;*/</span></div>
<div class="line"><span class="lineno"> 1911</span>            }</div>
<div class="line"><span class="lineno"> 1912</span>        }</div>
<div class="line"><span class="lineno"> 1913</span>    }</div>
<div class="line"><span class="lineno"> 1914</span>    <span class="comment">// PrintFugN();</span></div>
<div class="line"><span class="lineno"> 1915</span><span class="preprocessor">#ifdef OCP_NANCHECK</span></div>
<div class="line"><span class="lineno"> 1916</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 1917</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="DenseMat_8hpp.html#a56bc3abd4d498e5055b3da3a58d45bad">CheckNan</a>(fugN[j].size(), &amp;fugN[j][0]))</div>
<div class="line"><span class="lineno"> 1918</span>        {</div>
<div class="line"><span class="lineno"> 1919</span>            <a class="code hl_define" href="UtilError_8hpp.html#aecfc13af45c4bb869301d5ce54cba0af">OCP_ABORT</a>(<span class="stringliteral">&quot;INF or NAN in fugN !&quot;</span>);</div>
<div class="line"><span class="lineno"> 1920</span>        }</div>
<div class="line"><span class="lineno"> 1921</span>    }</div>
<div class="line"><span class="lineno"> 1922</span><span class="preprocessor">#endif </span><span class="comment">// NANCHECK</span></div>
<div class="line"><span class="lineno"> 1923</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac6604988c8a20ac550b7074c42519a7e" name="ac6604988c8a20ac550b7074c42519a7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6604988c8a20ac550b7074c42519a7e">&#9670;&#160;</a></span>CalFugPAll()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalFugPAll </td>
          <td>(</td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>Zpflag</em> = <code>true</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l02308">2308</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2309</span>{</div>
<div class="line"><span class="lineno"> 2310</span> </div>
<div class="line"><span class="lineno"> 2311</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> C, D, E, G;</div>
<div class="line"><span class="lineno"> 2312</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Cp, Dp, Ep, Gp;</div>
<div class="line"><span class="lineno"> 2313</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp;</div>
<div class="line"><span class="lineno"> 2314</span> </div>
<div class="line"><span class="lineno"> 2315</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 2316</span> </div>
<div class="line"><span class="lineno"> 2317</span>        vector&lt;OCP_DBL&gt;&amp; fugp = fugP[j];</div>
<div class="line"><span class="lineno"> 2318</span>        vector&lt;OCP_DBL&gt;&amp; xj   = x[j];</div>
<div class="line"><span class="lineno"> 2319</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&amp;         aj   = Aj[j];</div>
<div class="line"><span class="lineno"> 2320</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&amp;         bj   = Bj[j];</div>
<div class="line"><span class="lineno"> 2321</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&amp;         zj   = Zj[j];</div>
<div class="line"><span class="lineno"> 2322</span> </div>
<div class="line"><span class="lineno"> 2323</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Ap = aj / P;</div>
<div class="line"><span class="lineno"> 2324</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Bp = bj / P;</div>
<div class="line"><span class="lineno"> 2325</span>        <span class="keywordflow">if</span> (Zpflag) {</div>
<div class="line"><span class="lineno"> 2326</span>            Zp[j] = ((bj - zj) * Ap +</div>
<div class="line"><span class="lineno"> 2327</span>                ((aj + delta1 * delta2 * (3 * bj * bj + 2 * bj)) +</div>
<div class="line"><span class="lineno"> 2328</span>                    ((delta1 + delta2) * (2 * bj + 1) - 2 * delta1 * delta2 * bj) * zj -</div>
<div class="line"><span class="lineno"> 2329</span>                    (delta1 + delta2 - 1) * zj * zj) *</div>
<div class="line"><span class="lineno"> 2330</span>                Bp) /</div>
<div class="line"><span class="lineno"> 2331</span>                (3 * zj * zj + 2 * ((delta1 + delta2 - 1) * bj - 1) * zj +</div>
<div class="line"><span class="lineno"> 2332</span>                    (aj + delta1 * delta2 * bj * bj - (delta1 + delta2) * bj * (bj + 1)));</div>
<div class="line"><span class="lineno"> 2333</span>        }</div>
<div class="line"><span class="lineno"> 2334</span>        </div>
<div class="line"><span class="lineno"> 2335</span>        G  = (zj + delta1 * bj) / (zj + delta2 * bj);</div>
<div class="line"><span class="lineno"> 2336</span>        Gp = (delta1 - delta2) / ((zj + delta2 * bj) * (zj + delta2 * bj)) *</div>
<div class="line"><span class="lineno"> 2337</span>             (Bp * zj - Zp[j] * bj);</div>
<div class="line"><span class="lineno"> 2338</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 2339</span> </div>
<div class="line"><span class="lineno"> 2340</span>            C = P / (zj - bj);</div>
<div class="line"><span class="lineno"> 2341</span>            <span class="comment">// D = Bi[i] / bj * (zj - 1);</span></div>
<div class="line"><span class="lineno"> 2342</span> </div>
<div class="line"><span class="lineno"> 2343</span>            tmp = 0;</div>
<div class="line"><span class="lineno"> 2344</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 2345</span>                tmp += (1 - BIC[i * NC + m]) * sqrt(Ai[i] * Ai[m]) * xj[m];</div>
<div class="line"><span class="lineno"> 2346</span>            }</div>
<div class="line"><span class="lineno"> 2347</span> </div>
<div class="line"><span class="lineno"> 2348</span>            E = -aj / ((delta1 - delta2) * bj) * (2 * tmp / aj - Bi[i] / bj);</div>
<div class="line"><span class="lineno"> 2349</span> </div>
<div class="line"><span class="lineno"> 2350</span>            Cp = ((zj - bj) - P * (Zp[j] - Bp)) / ((zj - bj) * (zj - bj));</div>
<div class="line"><span class="lineno"> 2351</span>            Dp = Bi[i] / bj * Zp[j];</div>
<div class="line"><span class="lineno"> 2352</span>            <span class="comment">// Ep = 0;</span></div>
<div class="line"><span class="lineno"> 2353</span> </div>
<div class="line"><span class="lineno"> 2354</span>            <span class="comment">// Attention that if xj[i] = 0, then fugp[i] = nan</span></div>
<div class="line"><span class="lineno"> 2355</span>            <span class="comment">// but Cp also contains xj[i], so eliminate it first</span></div>
<div class="line"><span class="lineno"> 2356</span>            fugp[i] = Cp / C  + Dp + E / G * Gp;</div>
<div class="line"><span class="lineno"> 2357</span>        }</div>
<div class="line"><span class="lineno"> 2358</span>    }</div>
<div class="line"><span class="lineno"> 2359</span> </div>
<div class="line"><span class="lineno"> 2360</span><span class="preprocessor">#ifdef OCP_NANCHECK</span></div>
<div class="line"><span class="lineno"> 2361</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 2362</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="DenseMat_8hpp.html#a56bc3abd4d498e5055b3da3a58d45bad">CheckNan</a>(fugP[j].size(), &amp;fugP[j][0])) </div>
<div class="line"><span class="lineno"> 2363</span>        {</div>
<div class="line"><span class="lineno"> 2364</span>            <a class="code hl_define" href="UtilError_8hpp.html#aecfc13af45c4bb869301d5ce54cba0af">OCP_ABORT</a>(<span class="stringliteral">&quot;INF or NAN in fugP !&quot;</span>);</div>
<div class="line"><span class="lineno"> 2365</span>        }</div>
<div class="line"><span class="lineno"> 2366</span>    }</div>
<div class="line"><span class="lineno"> 2367</span><span class="preprocessor">#endif </span><span class="comment">// NANCHECK</span></div>
<div class="line"><span class="lineno"> 2368</span> </div>
<div class="line"><span class="lineno"> 2369</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abc183093d6853b068232fb49130e9875" name="abc183093d6853b068232fb49130e9875"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc183093d6853b068232fb49130e9875">&#9670;&#160;</a></span>CalFugPhi() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalFugPhi </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *&#160;</td>
          <td class="paramname"><em>fugT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *&#160;</td>
          <td class="paramname"><em>xj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00779">779</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  780</span>{</div>
<div class="line"><span class="lineno">  781</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> aj, bj, zj;</div>
<div class="line"><span class="lineno">  782</span>    CalAjBj(aj, bj, xj);</div>
<div class="line"><span class="lineno">  783</span>    SolEoS(zj, aj, bj);</div>
<div class="line"><span class="lineno">  784</span> </div>
<div class="line"><span class="lineno">  785</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> m1    = delta1;</div>
<div class="line"><span class="lineno">  786</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> m2    = delta2;</div>
<div class="line"><span class="lineno">  787</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> m1Mm2 = delta1M2;</div>
<div class="line"><span class="lineno">  788</span> </div>
<div class="line"><span class="lineno">  789</span>    <span class="comment">// OCP_DBL tmp01 = log(zj - bj);</span></div>
<div class="line"><span class="lineno">  790</span>    <span class="comment">// OCP_DBL tmp02 = aj / (m1Mm2) / bj * log((zj + m1 * bj) / (zj + m2 * bj));</span></div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp;</div>
<div class="line"><span class="lineno">  793</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno">  794</span>        tmp = 0;</div>
<div class="line"><span class="lineno">  795</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno">  796</span>            tmp += 2 * (1 - BIC[i * NC + k]) * sqrt(Ai[i] * Ai[k]) * xj[k];</div>
<div class="line"><span class="lineno">  797</span>        }</div>
<div class="line"><span class="lineno">  798</span>        tmp     = exp(Bi[i] / bj * (zj - 1) - log(zj - bj) -</div>
<div class="line"><span class="lineno">  799</span>                  aj / (m1Mm2) / bj * (tmp / aj - Bi[i] / bj) *</div>
<div class="line"><span class="lineno">  800</span>                      log((zj + m1 * bj) / (zj + m2 * bj)));</div>
<div class="line"><span class="lineno">  801</span>        fugT[i] = tmp * xj[i] * P;</div>
<div class="line"><span class="lineno">  802</span>    }</div>
<div class="line"><span class="lineno">  803</span> </div>
<div class="line"><span class="lineno">  804</span>    Asta = aj;</div>
<div class="line"><span class="lineno">  805</span>    Bsta = bj;</div>
<div class="line"><span class="lineno">  806</span>    Zsta = zj;</div>
<div class="line"><span class="lineno">  807</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae2b087325e999f18ebbe772cb4b60fe3" name="ae2b087325e999f18ebbe772cb4b60fe3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2b087325e999f18ebbe772cb4b60fe3">&#9670;&#160;</a></span>CalFugPhi() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalFugPhi </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *&#160;</td>
          <td class="paramname"><em>phiT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *&#160;</td>
          <td class="paramname"><em>fugT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *&#160;</td>
          <td class="paramname"><em>xj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00741">741</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  742</span>{</div>
<div class="line"><span class="lineno">  743</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> aj, bj, zj;</div>
<div class="line"><span class="lineno">  744</span>    CalAjBj(aj, bj, xj);</div>
<div class="line"><span class="lineno">  745</span>    SolEoS(zj, aj, bj);</div>
<div class="line"><span class="lineno">  746</span> </div>
<div class="line"><span class="lineno">  747</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> m1    = delta1;</div>
<div class="line"><span class="lineno">  748</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> m2    = delta2;</div>
<div class="line"><span class="lineno">  749</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> m1Mm2 = delta1M2;</div>
<div class="line"><span class="lineno">  750</span> </div>
<div class="line"><span class="lineno">  751</span>    <span class="comment">// OCP_DBL tmp01 = log(zj - bj);</span></div>
<div class="line"><span class="lineno">  752</span>    <span class="comment">// OCP_DBL tmp02 = aj / (m1Mm2) / bj * log((zj + m1 * bj) / (zj + m2 * bj));</span></div>
<div class="line"><span class="lineno">  753</span> </div>
<div class="line"><span class="lineno">  754</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp;</div>
<div class="line"><span class="lineno">  755</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno">  756</span>        tmp = 0;</div>
<div class="line"><span class="lineno">  757</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno">  758</span>            tmp += 2 * (1 - BIC[i * NC + k]) * sqrt(Ai[i] * Ai[k]) * xj[k];</div>
<div class="line"><span class="lineno">  759</span>        }</div>
<div class="line"><span class="lineno">  760</span>        phiT[i] = exp(Bi[i] / bj * (zj - 1) - log(zj - bj) -</div>
<div class="line"><span class="lineno">  761</span>                      aj / (m1Mm2) / bj * (tmp / aj - Bi[i] / bj) *</div>
<div class="line"><span class="lineno">  762</span>                          log((zj + m1 * bj) / (zj + m2 * bj)));</div>
<div class="line"><span class="lineno">  763</span>        fugT[i] = phiT[i] * xj[i] * P;</div>
<div class="line"><span class="lineno">  764</span>    }</div>
<div class="line"><span class="lineno">  765</span>    <span class="comment">// for (USI i = 0; i &lt; NC; i++) {</span></div>
<div class="line"><span class="lineno">  766</span>    <span class="comment">//    tmp = 0;</span></div>
<div class="line"><span class="lineno">  767</span>    <span class="comment">//    for (int k = 0; k &lt; NC; k++) {</span></div>
<div class="line"><span class="lineno">  768</span>    <span class="comment">//        tmp += 2 * (1 - BIC[i * NC + k]) * sqrt(Ai[i] * Ai[k]) * xj[k];</span></div>
<div class="line"><span class="lineno">  769</span>    <span class="comment">//    }</span></div>
<div class="line"><span class="lineno">  770</span>    <span class="comment">//    phiT[i] = exp(Bi[i] / bj * (zj - 1) - tmp01 - tmp02 * (tmp / aj - Bi[i] /</span></div>
<div class="line"><span class="lineno">  771</span>    <span class="comment">//    bj)); fugT[i] = phiT[i] * xj[i] * P;</span></div>
<div class="line"><span class="lineno">  772</span>    <span class="comment">//}</span></div>
<div class="line"><span class="lineno">  773</span> </div>
<div class="line"><span class="lineno">  774</span>    Asta = aj;</div>
<div class="line"><span class="lineno">  775</span>    Bsta = bj;</div>
<div class="line"><span class="lineno">  776</span>    Zsta = zj;</div>
<div class="line"><span class="lineno">  777</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aca505498f0e30fab090ae40701504406" name="aca505498f0e30fab090ae40701504406"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca505498f0e30fab090ae40701504406">&#9670;&#160;</a></span>CalFugPhi() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalFugPhi </td>
          <td>(</td>
          <td class="paramtype">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>phiT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>fugT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>xj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00700">700</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  702</span>{</div>
<div class="line"><span class="lineno">  703</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> aj, bj, zj;</div>
<div class="line"><span class="lineno">  704</span>    CalAjBj(aj, bj, xj);</div>
<div class="line"><span class="lineno">  705</span>    SolEoS(zj, aj, bj);</div>
<div class="line"><span class="lineno">  706</span> </div>
<div class="line"><span class="lineno">  707</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> m1 = delta1;</div>
<div class="line"><span class="lineno">  708</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> m2 = delta2;</div>
<div class="line"><span class="lineno">  709</span>    <span class="comment">// const OCP_DBL m1Mm2 = delta1M2;</span></div>
<div class="line"><span class="lineno">  710</span> </div>
<div class="line"><span class="lineno">  711</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp;</div>
<div class="line"><span class="lineno">  712</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno">  713</span>        tmp = 0;</div>
<div class="line"><span class="lineno">  714</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno">  715</span>            tmp += 2 * (1 - BIC[i * NC + k]) * sqrt(Ai[i] * Ai[k]) * xj[k];</div>
<div class="line"><span class="lineno">  716</span>        }</div>
<div class="line"><span class="lineno">  717</span>        phiT[i] = exp(Bi[i] / bj * (zj - 1) - log(zj - bj) -</div>
<div class="line"><span class="lineno">  718</span>                      aj / (m1 - m2) / bj * (tmp / aj - Bi[i] / bj) *</div>
<div class="line"><span class="lineno">  719</span>                          log((zj + m1 * bj) / (zj + m2 * bj)));</div>
<div class="line"><span class="lineno">  720</span>        fugT[i] = phiT[i] * xj[i] * P;</div>
<div class="line"><span class="lineno">  721</span>    }</div>
<div class="line"><span class="lineno">  722</span> </div>
<div class="line"><span class="lineno">  723</span>    <span class="comment">//   OCP_DBL       tmp01 = log(zj - bj);</span></div>
<div class="line"><span class="lineno">  724</span>    <span class="comment">//   OCP_DBL       tmp02 = aj / (m1Mm2) / bj * log((zj + m1 * bj) / (zj + m2 * bj));</span></div>
<div class="line"><span class="lineno">  725</span> </div>
<div class="line"><span class="lineno">  726</span>    <span class="comment">// for (USI i = 0; i &lt; NC; i++) {</span></div>
<div class="line"><span class="lineno">  727</span>    <span class="comment">//  tmp = 0;</span></div>
<div class="line"><span class="lineno">  728</span>    <span class="comment">//  for (int k = 0; k &lt; NC; k++) {</span></div>
<div class="line"><span class="lineno">  729</span>    <span class="comment">//      tmp += 2 * (1 - BIC[i * NC + k]) * sqrt(Ai[i] * Ai[k]) * xj[k];</span></div>
<div class="line"><span class="lineno">  730</span>    <span class="comment">//  }</span></div>
<div class="line"><span class="lineno">  731</span>    <span class="comment">//       phiT[i] = exp(Bi[i] / bj * (zj - 1) - tmp01 - tmp02 * (tmp / aj - Bi[i] /</span></div>
<div class="line"><span class="lineno">  732</span>    <span class="comment">//       bj));</span></div>
<div class="line"><span class="lineno">  733</span>    <span class="comment">//  fugT[i] = phiT[i] * xj[i] * P;</span></div>
<div class="line"><span class="lineno">  734</span>    <span class="comment">//}</span></div>
<div class="line"><span class="lineno">  735</span> </div>
<div class="line"><span class="lineno">  736</span>    Asta = aj;</div>
<div class="line"><span class="lineno">  737</span>    Bsta = bj;</div>
<div class="line"><span class="lineno">  738</span>    Zsta = zj;</div>
<div class="line"><span class="lineno">  739</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a395d2a6c288d939192573fe997aacefa" name="a395d2a6c288d939192573fe997aacefa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a395d2a6c288d939192573fe997aacefa">&#9670;&#160;</a></span>CalFugPhiAll()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalFugPhiAll </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00809">809</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  810</span>{</div>
<div class="line"><span class="lineno">  811</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>       tmp;<span class="comment">// , tmp01, tmp02;</span></div>
<div class="line"><span class="lineno">  812</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> m1    = delta1;</div>
<div class="line"><span class="lineno">  813</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> m2    = delta2;</div>
<div class="line"><span class="lineno">  814</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> m1Mm2 = delta1M2;</div>
<div class="line"><span class="lineno">  815</span> </div>
<div class="line"><span class="lineno">  816</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno">  817</span>        <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; xj   = x[j];</div>
<div class="line"><span class="lineno">  818</span>        vector&lt;OCP_DBL&gt;&amp;       phiT = phi[j];</div>
<div class="line"><span class="lineno">  819</span>        vector&lt;OCP_DBL&gt;&amp;       fugT = fug[j];</div>
<div class="line"><span class="lineno">  820</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&amp;               aj   = Aj[j];</div>
<div class="line"><span class="lineno">  821</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&amp;               bj   = Bj[j];</div>
<div class="line"><span class="lineno">  822</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&amp;               zj   = Zj[j];</div>
<div class="line"><span class="lineno">  823</span> </div>
<div class="line"><span class="lineno">  824</span>        CalAjBj(aj, bj, xj);</div>
<div class="line"><span class="lineno">  825</span>        SolEoS(zj, aj, bj);</div>
<div class="line"><span class="lineno">  826</span> </div>
<div class="line"><span class="lineno">  827</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno">  828</span>            tmp = 0;</div>
<div class="line"><span class="lineno">  829</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno">  830</span>                tmp += 2 * (1 - BIC[i * NC + k]) * sqrt(Ai[i] * Ai[k]) * xj[k];</div>
<div class="line"><span class="lineno">  831</span>            }</div>
<div class="line"><span class="lineno">  832</span>            phiT[i] = exp(Bi[i] / bj * (zj - 1) - log(zj - bj) -</div>
<div class="line"><span class="lineno">  833</span>                          aj / (m1Mm2) / bj * (tmp / aj - Bi[i] / bj) *</div>
<div class="line"><span class="lineno">  834</span>                              log((zj + m1 * bj) / (zj + m2 * bj)));</div>
<div class="line"><span class="lineno">  835</span>            fugT[i] = phiT[i] * xj[i] * P;</div>
<div class="line"><span class="lineno">  836</span>        }</div>
<div class="line"><span class="lineno">  837</span> </div>
<div class="line"><span class="lineno">  838</span>        <span class="comment">// tmp01 = log(zj - bj);</span></div>
<div class="line"><span class="lineno">  839</span>        <span class="comment">// tmp02 = aj / (m1Mm2) / bj * log((zj + m1 * bj) / (zj + m2 * bj));</span></div>
<div class="line"><span class="lineno">  840</span>        <span class="comment">// for (USI i = 0; i &lt; NC; i++) {</span></div>
<div class="line"><span class="lineno">  841</span>        <span class="comment">//  tmp = 0;</span></div>
<div class="line"><span class="lineno">  842</span>        <span class="comment">//  for (int k = 0; k &lt; NC; k++) {</span></div>
<div class="line"><span class="lineno">  843</span>        <span class="comment">//      tmp += 2 * (1 - BIC[i * NC + k]) * sqrt(Ai[i] * Ai[k]) * xj[k];</span></div>
<div class="line"><span class="lineno">  844</span>        <span class="comment">//  }</span></div>
<div class="line"><span class="lineno">  845</span>        <span class="comment">//          phiT[i] =</span></div>
<div class="line"><span class="lineno">  846</span>        <span class="comment">//              exp(Bi[i] / bj * (zj - 1) - tmp01 - tmp02 * (tmp / aj - Bi[i] /</span></div>
<div class="line"><span class="lineno">  847</span>        <span class="comment">//              bj));</span></div>
<div class="line"><span class="lineno">  848</span>        <span class="comment">//  fugT[i] = phiT[i] * xj[i] * P;</span></div>
<div class="line"><span class="lineno">  849</span>        <span class="comment">//}</span></div>
<div class="line"><span class="lineno">  850</span>    }</div>
<div class="line"><span class="lineno">  851</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2079290edef7fae31b859cad26a259e5" name="a2079290edef7fae31b859cad26a259e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2079290edef7fae31b859cad26a259e5">&#9670;&#160;</a></span>CalFugXAll()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalFugXAll </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l02237">2237</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2238</span>{</div>
<div class="line"><span class="lineno"> 2239</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 2240</span> </div>
<div class="line"><span class="lineno"> 2241</span>        vector&lt;OCP_DBL&gt;&amp; fugx = fugX[j];</div>
<div class="line"><span class="lineno"> 2242</span>        vector&lt;OCP_DBL&gt;&amp; xj   = x[j];</div>
<div class="line"><span class="lineno"> 2243</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>          aj   = Aj[j];</div>
<div class="line"><span class="lineno"> 2244</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>          bj   = Bj[j];</div>
<div class="line"><span class="lineno"> 2245</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>          zj   = Zj[j];</div>
<div class="line"><span class="lineno"> 2246</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>          tmp  = 0;</div>
<div class="line"><span class="lineno"> 2247</span> </div>
<div class="line"><span class="lineno"> 2248</span>        Bx = Bi;</div>
<div class="line"><span class="lineno"> 2249</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 2250</span>            tmp = 0;</div>
<div class="line"><span class="lineno"> 2251</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 2252</span>                tmp += xj[k] * (1 - BIC[i * NC + k]) * sqrt(Ai[i] * Ai[k]);</div>
<div class="line"><span class="lineno"> 2253</span>            }</div>
<div class="line"><span class="lineno"> 2254</span>            Ax[i] = 2 * tmp;</div>
<div class="line"><span class="lineno"> 2255</span>            Zx[i] =</div>
<div class="line"><span class="lineno"> 2256</span>                ((bj - zj) * Ax[i] +</div>
<div class="line"><span class="lineno"> 2257</span>                 ((aj + delta1 * delta2 * (3 * bj * bj + 2 * bj)) +</div>
<div class="line"><span class="lineno"> 2258</span>                  ((delta1 + delta2) * (2 * bj + 1) - 2 * delta1 * delta2 * bj) * zj -</div>
<div class="line"><span class="lineno"> 2259</span>                  (delta1 + delta2 - 1) * zj * zj) *</div>
<div class="line"><span class="lineno"> 2260</span>                     Bx[i]) /</div>
<div class="line"><span class="lineno"> 2261</span>                (3 * zj * zj + 2 * ((delta1 + delta2 - 1) * bj - 1) * zj +</div>
<div class="line"><span class="lineno"> 2262</span>                 (aj + delta1 * delta2 * bj * bj - (delta1 + delta2) * bj * (bj + 1)));</div>
<div class="line"><span class="lineno"> 2263</span>        }</div>
<div class="line"><span class="lineno"> 2264</span> </div>
<div class="line"><span class="lineno"> 2265</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>  C, D, E, G;</div>
<div class="line"><span class="lineno"> 2266</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>  Cxk, Dxk, Exk, Gxk;</div>
<div class="line"><span class="lineno"> 2267</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>  aik;</div>
<div class="line"><span class="lineno"> 2268</span>        G = (zj + delta1 * bj) / (zj + delta2 * bj);</div>
<div class="line"><span class="lineno"> 2269</span> </div>
<div class="line"><span class="lineno"> 2270</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 2271</span>            <span class="comment">// ith fugacity</span></div>
<div class="line"><span class="lineno"> 2272</span>            C = xj[i] * P / (zj - bj);</div>
<div class="line"><span class="lineno"> 2273</span>            <span class="comment">// C = 1 / (zj - bj);</span></div>
<div class="line"><span class="lineno"> 2274</span>            <span class="comment">// D = Bx[i] * (zj - 1) / bj;</span></div>
<div class="line"><span class="lineno"> 2275</span>            E = -aj / ((delta1 - delta2) * bj) * (Ax[i] / aj - Bx[i] / bj);</div>
<div class="line"><span class="lineno"> 2276</span> </div>
<div class="line"><span class="lineno"> 2277</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 2278</span>                aik = (1 - BIC[i * NC + k]) * sqrt(Ai[i] * Ai[k]);</div>
<div class="line"><span class="lineno"> 2279</span> </div>
<div class="line"><span class="lineno"> 2280</span>                <span class="comment">// kth components</span></div>
<div class="line"><span class="lineno"> 2281</span>                Cxk = ((zj - bj) * delta(i, k) - xj[i] * (Zx[k] - Bx[k])) * P /</div>
<div class="line"><span class="lineno"> 2282</span>                      ((zj - bj) * (zj - bj));</div>
<div class="line"><span class="lineno"> 2283</span>                Dxk = Bx[i] / bj * (Zx[k] - Bx[k] * (zj - 1) / bj);</div>
<div class="line"><span class="lineno"> 2284</span>                <span class="comment">/*Exk = (Ax[k] * bj - aj * Bx[k]) / (bj * bj) * (Ax[i] / aj - Bx[i] /</span></div>
<div class="line"><span class="lineno"> 2285</span><span class="comment">                   bj) + aj / bj * (2 * (1 - BIC[i * NC + k]) * sqrt(Ai[i] * Ai[k]) / aj</span></div>
<div class="line"><span class="lineno"> 2286</span><span class="comment">                   - Ax[k] * Ax[i] / (aj * aj) + Bx[i] * Bx[k] / (bj * bj));*/</span></div>
<div class="line"><span class="lineno"> 2287</span>                Exk = (2 * (aj / bj * Bx[k] * Bx[i] + bj * aik) - Ax[i] * Bx[k] -</div>
<div class="line"><span class="lineno"> 2288</span>                       Ax[k] * Bi[i]) /</div>
<div class="line"><span class="lineno"> 2289</span>                      (bj * bj);</div>
<div class="line"><span class="lineno"> 2290</span>                Exk /= -(delta1 - delta2);</div>
<div class="line"><span class="lineno"> 2291</span>                Gxk = (delta1 - delta2) / (zj + delta2 * bj) / (zj + delta2 * bj) *</div>
<div class="line"><span class="lineno"> 2292</span>                      (zj * Bx[k] - Zx[k] * bj);</div>
<div class="line"><span class="lineno"> 2293</span>                fugx[i * NC + k] = 1 / C * Cxk + Dxk + Exk * log(G) + E / G * Gxk;</div>
<div class="line"><span class="lineno"> 2294</span>            }</div>
<div class="line"><span class="lineno"> 2295</span>        }</div>
<div class="line"><span class="lineno"> 2296</span>    }</div>
<div class="line"><span class="lineno"> 2297</span><span class="preprocessor">#ifdef OCP_NANCHECK</span></div>
<div class="line"><span class="lineno"> 2298</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 2299</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="DenseMat_8hpp.html#a56bc3abd4d498e5055b3da3a58d45bad">CheckNan</a>(fugX[j].size(), &amp;fugX[j][0]))</div>
<div class="line"><span class="lineno"> 2300</span>        {</div>
<div class="line"><span class="lineno"> 2301</span>            <a class="code hl_define" href="UtilError_8hpp.html#aecfc13af45c4bb869301d5ce54cba0af">OCP_ABORT</a>(<span class="stringliteral">&quot;INF or NAN in fugX !&quot;</span>);</div>
<div class="line"><span class="lineno"> 2302</span>        }</div>
<div class="line"><span class="lineno"> 2303</span>    }</div>
<div class="line"><span class="lineno"> 2304</span><span class="preprocessor">#endif </span><span class="comment">// NANCHECK</span></div>
<div class="line"><span class="lineno"> 2305</span>    </div>
<div class="line"><span class="lineno"> 2306</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5d21c453b68aa83741dd4778ae53dbb1" name="a5d21c453b68aa83741dd4778ae53dbb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d21c453b68aa83741dd4778ae53dbb1">&#9670;&#160;</a></span>CalFugXSTA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalFugXSTA </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate d ln(Fug) / dx for Y. </p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l01401">1401</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1402</span>{</div>
<div class="line"><span class="lineno"> 1403</span>    <span class="comment">// Y sums to be 1 now, it&#39;s actually the mole fraction of spliting phase</span></div>
<div class="line"><span class="lineno"> 1404</span>    <span class="comment">// for stability analysis</span></div>
<div class="line"><span class="lineno"> 1405</span>    vector&lt;OCP_DBL&gt;&amp; fugx = fugX[0];</div>
<div class="line"><span class="lineno"> 1406</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>          aj   = Asta;</div>
<div class="line"><span class="lineno"> 1407</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>          bj   = Bsta;</div>
<div class="line"><span class="lineno"> 1408</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>          zj   = Zsta;</div>
<div class="line"><span class="lineno"> 1409</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>          tmp  = 0;</div>
<div class="line"><span class="lineno"> 1410</span> </div>
<div class="line"><span class="lineno"> 1411</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> m1    = delta1;</div>
<div class="line"><span class="lineno"> 1412</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> m2    = delta2;</div>
<div class="line"><span class="lineno"> 1413</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> m1Pm2 = delta1P2;</div>
<div class="line"><span class="lineno"> 1414</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> m1Mm2 = delta1M2;</div>
<div class="line"><span class="lineno"> 1415</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> m1Tm2 = delta1T2;</div>
<div class="line"><span class="lineno"> 1416</span> </div>
<div class="line"><span class="lineno"> 1417</span>    Bx = Bi;</div>
<div class="line"><span class="lineno"> 1418</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1419</span>        tmp = 0;</div>
<div class="line"><span class="lineno"> 1420</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 1421</span>            tmp += Y[k] * (1 - BIC[i * NC + k]) * sqrt(Ai[i] * Ai[k]);</div>
<div class="line"><span class="lineno"> 1422</span>        }</div>
<div class="line"><span class="lineno"> 1423</span>        Ax[i] = 2 * tmp;</div>
<div class="line"><span class="lineno"> 1424</span>        Zx[i] = ((bj - zj) * Ax[i] + ((aj + m1Tm2 * (3 * bj * bj + 2 * bj)) +</div>
<div class="line"><span class="lineno"> 1425</span>                                      ((m1Pm2) * (2 * bj + 1) - 2 * m1Tm2 * bj) * zj -</div>
<div class="line"><span class="lineno"> 1426</span>                                      (m1Pm2 - 1) * zj * zj) *</div>
<div class="line"><span class="lineno"> 1427</span>                                         Bx[i]) /</div>
<div class="line"><span class="lineno"> 1428</span>                (3 * zj * zj + 2 * ((m1Pm2 - 1) * bj - 1) * zj +</div>
<div class="line"><span class="lineno"> 1429</span>                 (aj + m1Tm2 * bj * bj - (m1Pm2)*bj * (bj + 1)));</div>
<div class="line"><span class="lineno"> 1430</span>    }</div>
<div class="line"><span class="lineno"> 1431</span> </div>
<div class="line"><span class="lineno"> 1432</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>  C, D, E, G;</div>
<div class="line"><span class="lineno"> 1433</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>  Cxk, Dxk, Exk, Gxk;</div>
<div class="line"><span class="lineno"> 1434</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>  aik;</div>
<div class="line"><span class="lineno"> 1435</span>    G = (zj + m1 * bj) / (zj + m2 * bj);</div>
<div class="line"><span class="lineno"> 1436</span> </div>
<div class="line"><span class="lineno"> 1437</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1438</span> </div>
<div class="line"><span class="lineno"> 1439</span>        C = Y[i] * P / (zj - bj);</div>
<div class="line"><span class="lineno"> 1440</span>        <span class="comment">// C = 1 / (zj - bj);</span></div>
<div class="line"><span class="lineno"> 1441</span>        <span class="comment">// D = Bx[i] * (zj - 1) / bj;</span></div>
<div class="line"><span class="lineno"> 1442</span>        E = -aj / ((m1Mm2)*bj) * (Ax[i] / aj - Bx[i] / bj);</div>
<div class="line"><span class="lineno"> 1443</span> </div>
<div class="line"><span class="lineno"> 1444</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 1445</span>            aik = (1 - BIC[i * NC + k]) * sqrt(Ai[i] * Ai[k]);</div>
<div class="line"><span class="lineno"> 1446</span> </div>
<div class="line"><span class="lineno"> 1447</span>            <span class="comment">// Cxk = -Y[i] * (Zx[k] - Bx[k]) / ((zj - bj) * (zj - bj));</span></div>
<div class="line"><span class="lineno"> 1448</span>            Cxk = ((zj - bj) * delta(i, k) - Y[i] * (Zx[k] - Bx[k])) * P /</div>
<div class="line"><span class="lineno"> 1449</span>                  ((zj - bj) * (zj - bj));</div>
<div class="line"><span class="lineno"> 1450</span>            Dxk = Bx[i] / bj * (Zx[k] - Bx[k] * (zj - 1) / bj);</div>
<div class="line"><span class="lineno"> 1451</span>            <span class="comment">/*Exk = (Ax[k] * bj - aj * Bx[k]) / (bj * bj) * (Ax[i] / aj - Bx[i] / bj) +</span></div>
<div class="line"><span class="lineno"> 1452</span><span class="comment">               aj / bj * (2 * (1 - BIC[i * NC + k]) * sqrt(Ai[i] * Ai[k]) / aj -</span></div>
<div class="line"><span class="lineno"> 1453</span><span class="comment">                Ax[k] * Ax[i] / (aj * aj) + Bx[i] * Bx[k] / (bj * bj));*/</span></div>
<div class="line"><span class="lineno"> 1454</span>            Exk = (2 * (aj / bj * Bx[k] * Bx[i] + bj * aik) - Ax[i] * Bx[k] -</div>
<div class="line"><span class="lineno"> 1455</span>                   Ax[k] * Bi[i]) /</div>
<div class="line"><span class="lineno"> 1456</span>                  (bj * bj);</div>
<div class="line"><span class="lineno"> 1457</span>            Exk /= -(m1Mm2);</div>
<div class="line"><span class="lineno"> 1458</span>            Gxk = (m1Mm2) / (zj + m2 * bj) / (zj + m2 * bj) * (zj * Bx[k] - Zx[k] * bj);</div>
<div class="line"><span class="lineno"> 1459</span>            fugx[i * NC + k] = 1 / C * Cxk + Dxk + Exk * log(G) + E / G * Gxk;</div>
<div class="line"><span class="lineno"> 1460</span>        }</div>
<div class="line"><span class="lineno"> 1461</span>    }</div>
<div class="line"><span class="lineno"> 1462</span>    <span class="comment">// cout &lt;&lt; &quot;PhiX&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1463</span>    <span class="comment">// for (USI i = 0; i &lt; NC; i++) {</span></div>
<div class="line"><span class="lineno"> 1464</span>    <span class="comment">//  for (USI k = 0; k &lt; NC; k++) {</span></div>
<div class="line"><span class="lineno"> 1465</span>    <span class="comment">//      cout &lt;&lt; fugx[i * NC + k] &lt;&lt; &quot;      &quot;;</span></div>
<div class="line"><span class="lineno"> 1466</span>    <span class="comment">//  }</span></div>
<div class="line"><span class="lineno"> 1467</span>    <span class="comment">//  cout &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1468</span>    <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 1469</span> </div>
<div class="line"><span class="lineno"> 1470</span><span class="preprocessor">#ifdef OCP_NANCHECK</span></div>
<div class="line"><span class="lineno"> 1471</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 1472</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="DenseMat_8hpp.html#a56bc3abd4d498e5055b3da3a58d45bad">CheckNan</a>(fugX[j].size(), &amp;fugX[j][0]))</div>
<div class="line"><span class="lineno"> 1473</span>        {</div>
<div class="line"><span class="lineno"> 1474</span>            <a class="code hl_define" href="UtilError_8hpp.html#aecfc13af45c4bb869301d5ce54cba0af">OCP_ABORT</a>(<span class="stringliteral">&quot;INF or NAN in fugX !&quot;</span>);</div>
<div class="line"><span class="lineno"> 1475</span>        }</div>
<div class="line"><span class="lineno"> 1476</span>    }</div>
<div class="line"><span class="lineno"> 1477</span><span class="preprocessor">#endif </span><span class="comment">// NANCHECK</span></div>
<div class="line"><span class="lineno"> 1478</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="DenseMat_8hpp_source.html#l00132">CheckNan()</a>, and <a class="el" href="UtilError_8hpp_source.html#l00047">OCP_ABORT</a>.</p>

</div>
</div>
<a id="a219ceb9357f6b962932a932f8445464d" name="a219ceb9357f6b962932a932f8445464d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a219ceb9357f6b962932a932f8445464d">&#9670;&#160;</a></span>CalKeyDern()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalKeyDern </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l04758">4758</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4759</span>{</div>
<div class="line"><span class="lineno"> 4760</span>    <span class="comment">// Call CaldXsdXpAPI03 before</span></div>
<div class="line"><span class="lineno"> 4761</span>    <span class="comment">// Calculate d (xij*xi/mu) / dP or dNk</span></div>
<div class="line"><span class="lineno"> 4762</span>    <span class="comment">// no water component</span></div>
<div class="line"><span class="lineno"> 4763</span>    <span class="comment">// use dXsdXp</span></div>
<div class="line"><span class="lineno"> 4764</span>    <span class="comment">// s = S, nij, p = P, Nk</span></div>
<div class="line"><span class="lineno"> 4765</span>    <span class="comment">// xij = nij / nj</span></div>
<div class="line"><span class="lineno"> 4766</span> </div>
<div class="line"><span class="lineno"> 4767</span>    vector&lt;OCP_DBL&gt; njPN(NC + 1, 0);</div>
<div class="line"><span class="lineno"> 4768</span> </div>
<div class="line"><span class="lineno"> 4769</span>    fill(<a class="code hl_variable" href="classMixture.html#ad49e1236014cca81fa4faedf12806bb0">keyDer</a>.begin(), <a class="code hl_variable" href="classMixture.html#ad49e1236014cca81fa4faedf12806bb0">keyDer</a>.end(), 0.0);</div>
<div class="line"><span class="lineno"> 4770</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> ncol = <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + 1;   </div>
<div class="line"><span class="lineno"> 4771</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* sTmp = &amp;<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[(NP + 1) * ncol];</div>
<div class="line"><span class="lineno"> 4772</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* xiNtmp = &amp;<a class="code hl_variable" href="classMixture.html#a3476f1a61b94f0b58c00a90643e1861a">xiN</a>[0];</div>
<div class="line"><span class="lineno"> 4773</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* muNtmp = &amp;<a class="code hl_variable" href="classMixture.html#a7897e0172e682f205e6c58688368c12e">muN</a>[0];</div>
<div class="line"><span class="lineno"> 4774</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* xijtmp = &amp;<a class="code hl_variable" href="classMixture.html#a9958b097000a344df9bfbdc845db850c">xij</a>[0];</div>
<div class="line"><span class="lineno"> 4775</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* dTmp = &amp;<a class="code hl_variable" href="classMixture.html#ad49e1236014cca81fa4faedf12806bb0">keyDer</a>[0];</div>
<div class="line"><span class="lineno"> 4776</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp01, tmp02;</div>
<div class="line"><span class="lineno"> 4777</span> </div>
<div class="line"><span class="lineno"> 4778</span>    <span class="keywordflow">if</span> (NP == 1) {</div>
<div class="line"><span class="lineno"> 4779</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = phaseLabel[0];</div>
<div class="line"><span class="lineno"> 4780</span>        xiNtmp += j * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4781</span>        muNtmp += j * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4782</span>        xijtmp += j * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4783</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp = <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j] / (<a class="code hl_variable" href="classMixture.html#a170e493a88e391f9afe0896181d76786">mu</a>[j] * <a class="code hl_variable" href="classMixture.html#a170e493a88e391f9afe0896181d76786">mu</a>[j]);</div>
<div class="line"><span class="lineno"> 4784</span> </div>
<div class="line"><span class="lineno"> 4785</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 4786</span>            <span class="comment">// dP</span></div>
<div class="line"><span class="lineno"> 4787</span>            dTmp[0] = (xijtmp[i] * <a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[j]) / <a class="code hl_variable" href="classMixture.html#a170e493a88e391f9afe0896181d76786">mu</a>[j] - xijtmp[i] * <a class="code hl_variable" href="classMixture.html#ae1531b7594246b0b03bdb7d974800ca4">muP</a>[j] * tmp;</div>
<div class="line"><span class="lineno"> 4788</span>            dTmp++;</div>
<div class="line"><span class="lineno"> 4789</span>            <span class="comment">// dNk</span></div>
<div class="line"><span class="lineno"> 4790</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 4791</span>                dTmp[k] = ((delta(i, k) - xijtmp[i]) * <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j] / <a class="code hl_variable" href="classMixture.html#aa0d6fa9514fce1774cc277826d304061">nj</a>[j] + xijtmp[i] * xiNtmp[k]) / <a class="code hl_variable" href="classMixture.html#a170e493a88e391f9afe0896181d76786">mu</a>[j] - xijtmp[i] * muNtmp[k] * tmp;</div>
<div class="line"><span class="lineno"> 4792</span>            }</div>
<div class="line"><span class="lineno"> 4793</span>            dTmp += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4794</span>        }</div>
<div class="line"><span class="lineno"> 4795</span>    }</div>
<div class="line"><span class="lineno"> 4796</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4797</span>        <span class="comment">// hydrocarbon phase</span></div>
<div class="line"><span class="lineno"> 4798</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; <a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1; j++) {</div>
<div class="line"><span class="lineno"> 4799</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">phaseExist</a>[j]) {</div>
<div class="line"><span class="lineno"> 4800</span>                xiNtmp += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4801</span>                muNtmp += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4802</span>                xijtmp += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4803</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 4804</span>            }</div>
<div class="line"><span class="lineno"> 4805</span> </div>
<div class="line"><span class="lineno"> 4806</span>            fill(njPN.begin(), njPN.end(), 0.0);</div>
<div class="line"><span class="lineno"> 4807</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 4808</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC + 1; k++) {</div>
<div class="line"><span class="lineno"> 4809</span>                    njPN[k] += sTmp[k];</div>
<div class="line"><span class="lineno"> 4810</span>                }</div>
<div class="line"><span class="lineno"> 4811</span>                sTmp += ncol;</div>
<div class="line"><span class="lineno"> 4812</span>            }</div>
<div class="line"><span class="lineno"> 4813</span>            sTmp -= NC * ncol;</div>
<div class="line"><span class="lineno"> 4814</span> </div>
<div class="line"><span class="lineno"> 4815</span>            tmp01 = <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j] / (<a class="code hl_variable" href="classMixture.html#a170e493a88e391f9afe0896181d76786">mu</a>[j] * <a class="code hl_variable" href="classMixture.html#a170e493a88e391f9afe0896181d76786">mu</a>[j]);</div>
<div class="line"><span class="lineno"> 4816</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 4817</span>                tmp02 = (sTmp[0] - njPN[0] * xijtmp[i]) / <a class="code hl_variable" href="classMixture.html#aa0d6fa9514fce1774cc277826d304061">nj</a>[j];</div>
<div class="line"><span class="lineno"> 4818</span>                <span class="comment">// dP</span></div>
<div class="line"><span class="lineno"> 4819</span>                dTmp[0] = (tmp02 * <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j] + xijtmp[i] * <a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[j]) / <a class="code hl_variable" href="classMixture.html#a170e493a88e391f9afe0896181d76786">mu</a>[j] - xijtmp[i] * <a class="code hl_variable" href="classMixture.html#ae1531b7594246b0b03bdb7d974800ca4">muP</a>[j] * tmp01;</div>
<div class="line"><span class="lineno"> 4820</span>                dTmp++;</div>
<div class="line"><span class="lineno"> 4821</span>                sTmp++;</div>
<div class="line"><span class="lineno"> 4822</span>                <span class="comment">// dNk</span></div>
<div class="line"><span class="lineno"> 4823</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 4824</span>                    tmp02 = (sTmp[k] - njPN[k + 1] * xijtmp[i]) / <a class="code hl_variable" href="classMixture.html#aa0d6fa9514fce1774cc277826d304061">nj</a>[j];</div>
<div class="line"><span class="lineno"> 4825</span>                    dTmp[k] = (tmp02 * <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j] + xijtmp[i] * xiNtmp[k]) / <a class="code hl_variable" href="classMixture.html#a170e493a88e391f9afe0896181d76786">mu</a>[j] - xijtmp[i] * muNtmp[k] * tmp01;</div>
<div class="line"><span class="lineno"> 4826</span>                }</div>
<div class="line"><span class="lineno"> 4827</span>                dTmp += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4828</span>                sTmp += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4829</span>            }</div>
<div class="line"><span class="lineno"> 4830</span>            xiNtmp += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4831</span>            muNtmp += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4832</span>            xijtmp += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4833</span>        }</div>
<div class="line"><span class="lineno"> 4834</span>    }</div>
<div class="line"><span class="lineno"> 4835</span>    </div>
<div class="line"><span class="lineno"> 4836</span>    <span class="comment">// water phase</span></div>
<div class="line"><span class="lineno"> 4837</span>    <span class="comment">// dP</span></div>
<div class="line"><span class="lineno"> 4838</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> wpid = <a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1;</div>
<div class="line"><span class="lineno"> 4839</span>    <a class="code hl_variable" href="classMixture.html#ad49e1236014cca81fa4faedf12806bb0">keyDer</a>[NP * NC * ncol] = (<a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[wpid] * <a class="code hl_variable" href="classMixture.html#a170e493a88e391f9afe0896181d76786">mu</a>[wpid] - <a class="code hl_variable" href="classMixture.html#ae1531b7594246b0b03bdb7d974800ca4">muP</a>[wpid] * <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[wpid]) / (<a class="code hl_variable" href="classMixture.html#a170e493a88e391f9afe0896181d76786">mu</a>[wpid] * <a class="code hl_variable" href="classMixture.html#a170e493a88e391f9afe0896181d76786">mu</a>[wpid]);</div>
<div class="line"><span class="lineno"> 4840</span> </div>
<div class="line"><span class="lineno"> 4841</span>}</div>
<div class="ttc" id="aclassMixture_html_a170e493a88e391f9afe0896181d76786"><div class="ttname"><a href="classMixture.html#a170e493a88e391f9afe0896181d76786">Mixture::mu</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; mu</div><div class="ttdoc">viscosity of phase: numPhase</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00157">Mixture.hpp:157</a></div></div>
<div class="ttc" id="aclassMixture_html_a3476f1a61b94f0b58c00a90643e1861a"><div class="ttname"><a href="classMixture.html#a3476f1a61b94f0b58c00a90643e1861a">Mixture::xiN</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; xiN</div><div class="ttdoc">d xi[j] / d N[i]: numphase * numCom</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00177">Mixture.hpp:177</a></div></div>
<div class="ttc" id="aclassMixture_html_a7897e0172e682f205e6c58688368c12e"><div class="ttname"><a href="classMixture.html#a7897e0172e682f205e6c58688368c12e">Mixture::muN</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; muN</div><div class="ttdoc">d mu[j] / d N[i]: numphase * numCom</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00176">Mixture.hpp:176</a></div></div>
<div class="ttc" id="aclassMixture_html_a9958b097000a344df9bfbdc845db850c"><div class="ttname"><a href="classMixture.html#a9958b097000a344df9bfbdc845db850c">Mixture::xij</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; xij</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00154">Mixture.hpp:154</a></div></div>
<div class="ttc" id="aclassMixture_html_aa0d6fa9514fce1774cc277826d304061"><div class="ttname"><a href="classMixture.html#aa0d6fa9514fce1774cc277826d304061">Mixture::nj</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; nj</div><div class="ttdoc">mole number of phase j</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00156">Mixture.hpp:156</a></div></div>
<div class="ttc" id="aclassMixture_html_ad49e1236014cca81fa4faedf12806bb0"><div class="ttname"><a href="classMixture.html#ad49e1236014cca81fa4faedf12806bb0">Mixture::keyDer</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; keyDer</div><div class="ttdoc">d (xij*xi/mu) / dP or dNk</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00188">Mixture.hpp:188</a></div></div>
<div class="ttc" id="aclassMixture_html_ae1531b7594246b0b03bdb7d974800ca4"><div class="ttname"><a href="classMixture.html#ae1531b7594246b0b03bdb7d974800ca4">Mixture::muP</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; muP</div><div class="ttdoc">d mu / dP: numPhase</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00173">Mixture.hpp:173</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae0d0999fd19e0591de65bd95a5418893" name="ae0d0999fd19e0591de65bd95a5418893"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0d0999fd19e0591de65bd95a5418893">&#9670;&#160;</a></span>CalKeyDerx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalKeyDerx </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l04704">4704</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4705</span>{</div>
<div class="line"><span class="lineno"> 4706</span>    <span class="comment">// Call CaldXsdXpAPI01 or CaldXsdXpAPI02 before</span></div>
<div class="line"><span class="lineno"> 4707</span>    <span class="comment">// Calculate d (xij*xi/mu) / dP or dNk</span></div>
<div class="line"><span class="lineno"> 4708</span>    <span class="comment">// no water component</span></div>
<div class="line"><span class="lineno"> 4709</span>    <span class="comment">// use dXsdXp</span></div>
<div class="line"><span class="lineno"> 4710</span>    <span class="comment">// s = S, xij, p = P, Nk</span></div>
<div class="line"><span class="lineno"> 4711</span> </div>
<div class="line"><span class="lineno"> 4712</span>    fill(<a class="code hl_variable" href="classMixture.html#ad49e1236014cca81fa4faedf12806bb0">keyDer</a>.begin(), <a class="code hl_variable" href="classMixture.html#ad49e1236014cca81fa4faedf12806bb0">keyDer</a>.end(), 0.0);</div>
<div class="line"><span class="lineno"> 4713</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> ncol = <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + 1;</div>
<div class="line"><span class="lineno"> 4714</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp;</div>
<div class="line"><span class="lineno"> 4715</span>    </div>
<div class="line"><span class="lineno"> 4716</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* sTmp = &amp;<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> * ncol];</div>
<div class="line"><span class="lineno"> 4717</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* xiNtmp = &amp;<a class="code hl_variable" href="classMixture.html#a3476f1a61b94f0b58c00a90643e1861a">xiN</a>[0];</div>
<div class="line"><span class="lineno"> 4718</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* muNtmp = &amp;<a class="code hl_variable" href="classMixture.html#a7897e0172e682f205e6c58688368c12e">muN</a>[0];</div>
<div class="line"><span class="lineno"> 4719</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* xijtmp = &amp;<a class="code hl_variable" href="classMixture.html#a9958b097000a344df9bfbdc845db850c">xij</a>[0];</div>
<div class="line"><span class="lineno"> 4720</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* dTmp = &amp;<a class="code hl_variable" href="classMixture.html#ad49e1236014cca81fa4faedf12806bb0">keyDer</a>[0];</div>
<div class="line"><span class="lineno"> 4721</span> </div>
<div class="line"><span class="lineno"> 4722</span>    <span class="comment">// hydrocarbon phase</span></div>
<div class="line"><span class="lineno"> 4723</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; <a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1; j++) {</div>
<div class="line"><span class="lineno"> 4724</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">phaseExist</a>[j]) {</div>
<div class="line"><span class="lineno"> 4725</span>            sTmp += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> * ncol;</div>
<div class="line"><span class="lineno"> 4726</span>            xiNtmp += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4727</span>            muNtmp += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4728</span>            xijtmp += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4729</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 4730</span>        }</div>
<div class="line"><span class="lineno"> 4731</span>        tmp = <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j] / (<a class="code hl_variable" href="classMixture.html#a170e493a88e391f9afe0896181d76786">mu</a>[j] * <a class="code hl_variable" href="classMixture.html#a170e493a88e391f9afe0896181d76786">mu</a>[j]);</div>
<div class="line"><span class="lineno"> 4732</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 4733</span>            <span class="comment">// dP</span></div>
<div class="line"><span class="lineno"> 4734</span>            dTmp[0] = (sTmp[0] * <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j] + xijtmp[i] * <a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[j]) / <a class="code hl_variable" href="classMixture.html#a170e493a88e391f9afe0896181d76786">mu</a>[j] - xijtmp[i] * <a class="code hl_variable" href="classMixture.html#ae1531b7594246b0b03bdb7d974800ca4">muP</a>[j] * tmp;</div>
<div class="line"><span class="lineno"> 4735</span>            dTmp++;</div>
<div class="line"><span class="lineno"> 4736</span>            sTmp++;</div>
<div class="line"><span class="lineno"> 4737</span>            <span class="comment">// dNk</span></div>
<div class="line"><span class="lineno"> 4738</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 4739</span>                dTmp[k] = (sTmp[k] * <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j] + xijtmp[i] * xiNtmp[k]) / <a class="code hl_variable" href="classMixture.html#a170e493a88e391f9afe0896181d76786">mu</a>[j] - xijtmp[i] * muNtmp[k] * tmp;</div>
<div class="line"><span class="lineno"> 4740</span>            }</div>
<div class="line"><span class="lineno"> 4741</span>            dTmp += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4742</span>            sTmp += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4743</span>        }</div>
<div class="line"><span class="lineno"> 4744</span>        xiNtmp += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4745</span>        muNtmp += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4746</span>        xijtmp += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4747</span>        <span class="comment">// skip water components</span></div>
<div class="line"><span class="lineno"> 4748</span>        sTmp += ncol;</div>
<div class="line"><span class="lineno"> 4749</span>    }</div>
<div class="line"><span class="lineno"> 4750</span> </div>
<div class="line"><span class="lineno"> 4751</span>    <span class="comment">// water phase</span></div>
<div class="line"><span class="lineno"> 4752</span>    <span class="comment">// dP</span></div>
<div class="line"><span class="lineno"> 4753</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> wpid = <a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1;</div>
<div class="line"><span class="lineno"> 4754</span>    <a class="code hl_variable" href="classMixture.html#ad49e1236014cca81fa4faedf12806bb0">keyDer</a>[NP * NC * ncol] = (<a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[wpid] * <a class="code hl_variable" href="classMixture.html#a170e493a88e391f9afe0896181d76786">mu</a>[wpid] - <a class="code hl_variable" href="classMixture.html#ae1531b7594246b0b03bdb7d974800ca4">muP</a>[wpid] * <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[wpid]) / (<a class="code hl_variable" href="classMixture.html#a170e493a88e391f9afe0896181d76786">mu</a>[wpid] * <a class="code hl_variable" href="classMixture.html#a170e493a88e391f9afe0896181d76786">mu</a>[wpid]);</div>
<div class="line"><span class="lineno"> 4755</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8152173955656f8dcb8553a8b556379d" name="a8152173955656f8dcb8553a8b556379d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8152173955656f8dcb8553a8b556379d">&#9670;&#160;</a></span>CalKwilson()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalKwilson </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00979">979</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  980</span>{</div>
<div class="line"><span class="lineno">  981</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno">  982</span>        Kw[0][i] = (Pc[i] / P) * exp(5.373 * (1 + Acf[i]) * (1 - Tc[i] / T));</div>
<div class="line"><span class="lineno">  983</span>        Kw[1][i] = 1 / Kw[0][i];</div>
<div class="line"><span class="lineno">  984</span>        Kw[2][i] = pow(Kw[0][i], 1.0 / 3);</div>
<div class="line"><span class="lineno">  985</span>        Kw[3][i] = pow(Kw[1][i], 1.0 / 3);</div>
<div class="line"><span class="lineno">  986</span>    }</div>
<div class="line"><span class="lineno">  987</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0646e3d17992d15941ea82153f0581ca" name="a0646e3d17992d15941ea82153f0581ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0646e3d17992d15941ea82153f0581ca">&#9670;&#160;</a></span>CallId()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CallId </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00555">555</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  556</span>{</div>
<div class="line"><span class="lineno">  557</span>    lId = 0;</div>
<div class="line"><span class="lineno">  558</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 1; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno">  559</span>        <span class="keywordflow">if</span> (MWC[i] &lt; MWC[lId]) lId = i;</div>
<div class="line"><span class="lineno">  560</span>    }</div>
<div class="line"><span class="lineno">  561</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0600fcf66e345cfe09a5a25f3cc3f1ef" name="a0600fcf66e345cfe09a5a25f3cc3f1ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0600fcf66e345cfe09a5a25f3cc3f1ef">&#9670;&#160;</a></span>CalMuPn_partial()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalMuPn_partial </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l02463">2463</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2464</span>{</div>
<div class="line"><span class="lineno"> 2465</span>    CalMuPnLBC_partial();</div>
<div class="line"><span class="lineno"> 2466</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a75f4f76d912c685293d7b9bb832f0205" name="a75f4f76d912c685293d7b9bb832f0205"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75f4f76d912c685293d7b9bb832f0205">&#9670;&#160;</a></span>CalMuPnLBC_partial()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalMuPnLBC_partial </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l02469">2469</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2470</span>{</div>
<div class="line"><span class="lineno"> 2471</span>    <span class="comment">// muN = 0</span></div>
<div class="line"><span class="lineno"> 2472</span>    <span class="comment">// muP</span></div>
<div class="line"><span class="lineno"> 2473</span>    <span class="comment">// mun in mux</span></div>
<div class="line"><span class="lineno"> 2474</span> </div>
<div class="line"><span class="lineno"> 2475</span>    fill(<a class="code hl_variable" href="classMixture.html#a7897e0172e682f205e6c58688368c12e">muN</a>.begin(), <a class="code hl_variable" href="classMixture.html#a7897e0172e682f205e6c58688368c12e">muN</a>.end() - <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>, 0.0);</div>
<div class="line"><span class="lineno"> 2476</span> </div>
<div class="line"><span class="lineno"> 2477</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> val1IJ, val2IJ;</div>
<div class="line"><span class="lineno"> 2478</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> der1IJ, der2IJ, der3J, der4J, der6J, der7J, der8J;</div>
<div class="line"><span class="lineno"> 2479</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Tri, tmp;</div>
<div class="line"><span class="lineno"> 2480</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> xTj, xPj, xVj;</div>
<div class="line"><span class="lineno"> 2481</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> derxTj, derxPj, derMWj, derxVj;</div>
<div class="line"><span class="lineno"> 2482</span> </div>
<div class="line"><span class="lineno"> 2483</span>    <span class="comment">// dxij / dP = 0, d MJ / dP = 0</span></div>
<div class="line"><span class="lineno"> 2484</span>    <span class="comment">// Calculate dmuj / dP</span></div>
<div class="line"><span class="lineno"> 2485</span>    <span class="comment">// der2IJ = der3J = der4J = der6J = 0;</span></div>
<div class="line"><span class="lineno"> 2486</span> </div>
<div class="line"><span class="lineno"> 2487</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 2488</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1 = phaseLabel[j];</div>
<div class="line"><span class="lineno"> 2489</span>        <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; xj = x[j];</div>
<div class="line"><span class="lineno"> 2490</span>        <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; muAuxj = muAux[j];</div>
<div class="line"><span class="lineno"> 2491</span> </div>
<div class="line"><span class="lineno"> 2492</span>        xTj = xPj = xVj = 0;</div>
<div class="line"><span class="lineno"> 2493</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 2494</span>            xTj += xj[i] * Tc[i];</div>
<div class="line"><span class="lineno"> 2495</span>            xPj += xj[i] * Pc[i];</div>
<div class="line"><span class="lineno"> 2496</span>            xVj += xj[i] * Vcvis[i];</div>
<div class="line"><span class="lineno"> 2497</span>        }</div>
<div class="line"><span class="lineno"> 2498</span>        der7J = xVj * <a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[j1];</div>
<div class="line"><span class="lineno"> 2499</span>        <span class="keywordflow">if</span> (muAuxj[3] &lt;= 0.18 &amp;&amp; <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 2500</span>            <a class="code hl_variable" href="classMixture.html#ae1531b7594246b0b03bdb7d974800ca4">muP</a>[j1] = (2.05 * 1E-4) * der7J / muAuxj[2];</div>
<div class="line"><span class="lineno"> 2501</span>        }</div>
<div class="line"><span class="lineno"> 2502</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2503</span>            der8J = der7J * (LBCcoef[1] +</div>
<div class="line"><span class="lineno"> 2504</span>                muAuxj[3] * (2 * LBCcoef[2] +</div>
<div class="line"><span class="lineno"> 2505</span>                    muAuxj[3] * (3 * LBCcoef[3] +</div>
<div class="line"><span class="lineno"> 2506</span>                        muAuxj[3] * 4 * LBCcoef[4])));</div>
<div class="line"><span class="lineno"> 2507</span>            <a class="code hl_variable" href="classMixture.html#ae1531b7594246b0b03bdb7d974800ca4">muP</a>[j1] = (4 * 1E-4) * pow(muAuxj[4], 3) * der8J / muAuxj[2];</div>
<div class="line"><span class="lineno"> 2508</span>        }</div>
<div class="line"><span class="lineno"> 2509</span> </div>
<div class="line"><span class="lineno"> 2510</span>        <span class="comment">// Calculate dmuj / nkj</span></div>
<div class="line"><span class="lineno"> 2511</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> bId = <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> * j1;</div>
<div class="line"><span class="lineno"> 2512</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 2513</span>            derxTj = (Tc[k] - xTj) / nu[j];</div>
<div class="line"><span class="lineno"> 2514</span>            derxPj = (Pc[k] - xPj) / nu[j];</div>
<div class="line"><span class="lineno"> 2515</span>            derMWj = (MWC[k] - MW[j]) / nu[j];</div>
<div class="line"><span class="lineno"> 2516</span>            der3J = 0;</div>
<div class="line"><span class="lineno"> 2517</span>            der4J = sqrtMWi[k];</div>
<div class="line"><span class="lineno"> 2518</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 2519</span>                val1IJ = muAux1I[i] / sqrt(MW[j]);</div>
<div class="line"><span class="lineno"> 2520</span>                der1IJ = -(1 / 2) * muAux1I[i] * pow(MW[j], -1.5) * derMWj;</div>
<div class="line"><span class="lineno"> 2521</span>                Tri = T / Tc[i];</div>
<div class="line"><span class="lineno"> 2522</span>                <span class="keywordflow">if</span> (Tri &lt;= 1.5) {</div>
<div class="line"><span class="lineno"> 2523</span>                    tmp = 34 * 1E-5 * pow(Tri, 0.94);</div>
<div class="line"><span class="lineno"> 2524</span>                }</div>
<div class="line"><span class="lineno"> 2525</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2526</span>                    tmp = 17.78 * 1E-5 * pow(4.58 * Tri - 1.67, 0.625);</div>
<div class="line"><span class="lineno"> 2527</span>                }</div>
<div class="line"><span class="lineno"> 2528</span>                val2IJ = tmp / val1IJ;</div>
<div class="line"><span class="lineno"> 2529</span>                der2IJ = -tmp * der1IJ / (val1IJ * val1IJ);</div>
<div class="line"><span class="lineno"> 2530</span>                der3J += sqrtMWi[i] * (xj[i] * der2IJ + (delta(i, k) - xj[i]) * val2IJ / nu[j]);</div>
<div class="line"><span class="lineno"> 2531</span>                der4J -= xj[i] * sqrtMWi[i];</div>
<div class="line"><span class="lineno"> 2532</span>            }           </div>
<div class="line"><span class="lineno"> 2533</span>            der4J /= nu[j];</div>
<div class="line"><span class="lineno"> 2534</span>            der6J =</div>
<div class="line"><span class="lineno"> 2535</span>                5.4402 *</div>
<div class="line"><span class="lineno"> 2536</span>                (1.0 / 6 * pow(xTj, -5.0 / 6) * derxTj -</div>
<div class="line"><span class="lineno"> 2537</span>                    pow(xTj, 1.0 / 6) * (0.5 / MW[j] * derMWj + 2.0 / 3 / xPj * derxPj)) /</div>
<div class="line"><span class="lineno"> 2538</span>                (sqrt(MW[j]) * pow(xPj, 2.0 / 3));</div>
<div class="line"><span class="lineno"> 2539</span>            der7J = <a class="code hl_variable" href="classMixture.html#a3f517560e2ec30f08afca9f6dc3ff71c">xix</a>[j1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + k] * xVj + (Vcvis[k] - xVj) * <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j1] / nu[j];</div>
<div class="line"><span class="lineno"> 2540</span>            <span class="keywordflow">if</span> (muAuxj[3] &lt;= 0.18 &amp;&amp; <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 2541</span>                <a class="code hl_variable" href="classMixture.html#ae63dab2d31711b0246096c5c128f2080">mux</a>[bId + k] =</div>
<div class="line"><span class="lineno"> 2542</span>                    (der3J * muAuxj[1] - muAuxj[0] * der4J) / (muAuxj[1] * muAuxj[1]) +</div>
<div class="line"><span class="lineno"> 2543</span>                    2.05 * 1E-4 * (der7J * muAuxj[2] - muAuxj[3] * der6J) /</div>
<div class="line"><span class="lineno"> 2544</span>                    (muAuxj[2] * muAuxj[2]);</div>
<div class="line"><span class="lineno"> 2545</span>            }</div>
<div class="line"><span class="lineno"> 2546</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2547</span>                der8J =</div>
<div class="line"><span class="lineno"> 2548</span>                    der7J * (LBCcoef[1] +</div>
<div class="line"><span class="lineno"> 2549</span>                        muAuxj[3] * (2 * LBCcoef[2] +</div>
<div class="line"><span class="lineno"> 2550</span>                            muAuxj[3] * (3 * LBCcoef[3] +</div>
<div class="line"><span class="lineno"> 2551</span>                                muAuxj[3] * 4 * LBCcoef[4])));</div>
<div class="line"><span class="lineno"> 2552</span>                <a class="code hl_variable" href="classMixture.html#ae63dab2d31711b0246096c5c128f2080">mux</a>[bId + k] =</div>
<div class="line"><span class="lineno"> 2553</span>                    (der3J * muAuxj[1] - muAuxj[0] * der4J) / (muAuxj[1] * muAuxj[1]) +</div>
<div class="line"><span class="lineno"> 2554</span>                    1E-4 *</div>
<div class="line"><span class="lineno"> 2555</span>                    (4 * pow(muAuxj[4], 3) * der8J * muAuxj[2] -</div>
<div class="line"><span class="lineno"> 2556</span>                        (pow(muAuxj[4], 4) - 1) * der6J) /</div>
<div class="line"><span class="lineno"> 2557</span>                    (muAuxj[2] * muAuxj[2]);</div>
<div class="line"><span class="lineno"> 2558</span>            }</div>
<div class="line"><span class="lineno"> 2559</span>        }</div>
<div class="line"><span class="lineno"> 2560</span>    }</div>
<div class="line"><span class="lineno"> 2561</span>}</div>
<div class="ttc" id="aclassMixture_html_ae63dab2d31711b0246096c5c128f2080"><div class="ttname"><a href="classMixture.html#ae63dab2d31711b0246096c5c128f2080">Mixture::mux</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; mux</div><div class="ttdoc">d mu[j] / d x[i][j]: numphase * numCom</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00179">Mixture.hpp:179</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a047adebf53621e07b094577d4602845f" name="a047adebf53621e07b094577d4602845f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a047adebf53621e07b094577d4602845f">&#9670;&#160;</a></span>CalMuPX_full01()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalMuPX_full01 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l03337">3337</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3338</span>{</div>
<div class="line"><span class="lineno"> 3339</span>    fill(<a class="code hl_variable" href="classMixture.html#ae1531b7594246b0b03bdb7d974800ca4">muP</a>.begin(), <a class="code hl_variable" href="classMixture.html#ae1531b7594246b0b03bdb7d974800ca4">muP</a>.end() - 1, 0.0);</div>
<div class="line"><span class="lineno"> 3340</span>    fill(<a class="code hl_variable" href="classMixture.html#a7897e0172e682f205e6c58688368c12e">muN</a>.begin(), <a class="code hl_variable" href="classMixture.html#a7897e0172e682f205e6c58688368c12e">muN</a>.end() - <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>, 0.0);</div>
<div class="line"><span class="lineno"> 3341</span>    fill(<a class="code hl_variable" href="classMixture.html#ae63dab2d31711b0246096c5c128f2080">mux</a>.begin(), <a class="code hl_variable" href="classMixture.html#ae63dab2d31711b0246096c5c128f2080">mux</a>.end() - <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>, 0.0);</div>
<div class="line"><span class="lineno"> 3342</span> </div>
<div class="line"><span class="lineno"> 3343</span>    CalMuPXLBC_full01();</div>
<div class="line"><span class="lineno"> 3344</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab1d23e53eb9495234ece1ebb10b2bfb0" name="ab1d23e53eb9495234ece1ebb10b2bfb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1d23e53eb9495234ece1ebb10b2bfb0">&#9670;&#160;</a></span>CalMuPX_partial()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalMuPX_partial </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l02932">2932</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2933</span>{</div>
<div class="line"><span class="lineno"> 2934</span>    <span class="comment">//fill(muP.begin(), muP.end() - 1, 0.0);</span></div>
<div class="line"><span class="lineno"> 2935</span>    fill(<a class="code hl_variable" href="classMixture.html#a7897e0172e682f205e6c58688368c12e">muN</a>.begin(), <a class="code hl_variable" href="classMixture.html#a7897e0172e682f205e6c58688368c12e">muN</a>.end() - <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>, 0.0);</div>
<div class="line"><span class="lineno"> 2936</span>    <span class="comment">//fill(mux.begin(), mux.end() - numCom, 0.0);</span></div>
<div class="line"><span class="lineno"> 2937</span> </div>
<div class="line"><span class="lineno"> 2938</span>    CalMuPXLBC_partial();</div>
<div class="line"><span class="lineno"> 2939</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aecc1c0421ddc7a1f278c8f1cb6cfadca" name="aecc1c0421ddc7a1f278c8f1cb6cfadca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecc1c0421ddc7a1f278c8f1cb6cfadca">&#9670;&#160;</a></span>CalMuPXLBC_full01()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalMuPXLBC_full01 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l03346">3346</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3347</span>{</div>
<div class="line"><span class="lineno"> 3348</span>    <span class="comment">// CaldXsdXp01() before</span></div>
<div class="line"><span class="lineno"> 3349</span>    <span class="comment">// use rhsDer</span></div>
<div class="line"><span class="lineno"> 3350</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> val1IJ, val2IJ;</div>
<div class="line"><span class="lineno"> 3351</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> der1IJ, der2IJ, der3J, der4J, der6J, der7J, der8J;</div>
<div class="line"><span class="lineno"> 3352</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Tri, tmp;</div>
<div class="line"><span class="lineno"> 3353</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> xTj, xPj, xVj;</div>
<div class="line"><span class="lineno"> 3354</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> derxTj, derxPj, derMWj, derxVj;</div>
<div class="line"><span class="lineno"> 3355</span> </div>
<div class="line"><span class="lineno"> 3356</span>    <span class="comment">// Calculate dmuj / dxkj</span></div>
<div class="line"><span class="lineno"> 3357</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 3358</span>        <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; xj = x[j];</div>
<div class="line"><span class="lineno"> 3359</span>        <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; muAuxj = muAux[j];</div>
<div class="line"><span class="lineno"> 3360</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1 = phaseLabel[j];</div>
<div class="line"><span class="lineno"> 3361</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>              bId = <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> * j1;</div>
<div class="line"><span class="lineno"> 3362</span>        xTj = xPj = xVj = 0;</div>
<div class="line"><span class="lineno"> 3363</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3364</span>            xTj += xj[i] * Tc[i];</div>
<div class="line"><span class="lineno"> 3365</span>            xPj += xj[i] * Pc[i];</div>
<div class="line"><span class="lineno"> 3366</span>            xVj += xj[i] * Vcvis[i];</div>
<div class="line"><span class="lineno"> 3367</span>        }</div>
<div class="line"><span class="lineno"> 3368</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 3369</span>            derxTj = Tc[k];</div>
<div class="line"><span class="lineno"> 3370</span>            derxPj = Pc[k];</div>
<div class="line"><span class="lineno"> 3371</span>            derMWj = MWC[k];</div>
<div class="line"><span class="lineno"> 3372</span>            derxVj = Vcvis[k];</div>
<div class="line"><span class="lineno"> 3373</span>            der3J = 0;</div>
<div class="line"><span class="lineno"> 3374</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3375</span>                val1IJ = muAux1I[i] / sqrt(MW[j]);</div>
<div class="line"><span class="lineno"> 3376</span>                der1IJ = -(1 / 2) * muAux1I[i] * pow(MW[j], -1.5) * derMWj;</div>
<div class="line"><span class="lineno"> 3377</span>                Tri = T / Tc[i];</div>
<div class="line"><span class="lineno"> 3378</span>                <span class="keywordflow">if</span> (Tri &lt;= 1.5) {</div>
<div class="line"><span class="lineno"> 3379</span>                    tmp = 34 * 1E-5 * pow(Tri, 0.94);</div>
<div class="line"><span class="lineno"> 3380</span>                }</div>
<div class="line"><span class="lineno"> 3381</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3382</span>                    tmp = 17.78 * 1E-5 * pow(4.58 * Tri - 1.67, 0.625);</div>
<div class="line"><span class="lineno"> 3383</span>                }</div>
<div class="line"><span class="lineno"> 3384</span>                val2IJ = tmp / val1IJ;</div>
<div class="line"><span class="lineno"> 3385</span>                der2IJ = -tmp * der1IJ / (val1IJ * val1IJ);</div>
<div class="line"><span class="lineno"> 3386</span>                der3J += sqrtMWi[i] * (delta(i, k) * val2IJ + xj[i] * der2IJ);</div>
<div class="line"><span class="lineno"> 3387</span>            }</div>
<div class="line"><span class="lineno"> 3388</span>            der4J = sqrtMWi[k];</div>
<div class="line"><span class="lineno"> 3389</span>            der6J = 5.4402 *</div>
<div class="line"><span class="lineno"> 3390</span>                (1.0 / 6 * pow(xTj, -5.0 / 6) * derxTj -</div>
<div class="line"><span class="lineno"> 3391</span>                    pow(xTj, 1.0 / 6) *</div>
<div class="line"><span class="lineno"> 3392</span>                    (0.5 / MW[j] * derMWj + 2.0 / 3 / xPj * derxPj)) /</div>
<div class="line"><span class="lineno"> 3393</span>                (sqrt(MW[j]) * pow(xPj, 2.0 / 3));</div>
<div class="line"><span class="lineno"> 3394</span>            der7J = <a class="code hl_variable" href="classMixture.html#a3f517560e2ec30f08afca9f6dc3ff71c">xix</a>[bId + k] * xVj + <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j1] * derxVj;</div>
<div class="line"><span class="lineno"> 3395</span>            <span class="keywordflow">if</span> (muAuxj[3] &lt;= 0.18 &amp;&amp; <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 3396</span>                <a class="code hl_variable" href="classMixture.html#ae63dab2d31711b0246096c5c128f2080">mux</a>[bId + k] = (der3J * muAuxj[1] - muAuxj[0] * der4J) /</div>
<div class="line"><span class="lineno"> 3397</span>                    (muAuxj[1] * muAuxj[1]) +</div>
<div class="line"><span class="lineno"> 3398</span>                    2.05 * 1E-4 *</div>
<div class="line"><span class="lineno"> 3399</span>                    (der7J * muAuxj[2] - muAuxj[3] * der6J) /</div>
<div class="line"><span class="lineno"> 3400</span>                    (muAuxj[2] * muAuxj[2]);</div>
<div class="line"><span class="lineno"> 3401</span>            }</div>
<div class="line"><span class="lineno"> 3402</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3403</span>                der8J = der7J *</div>
<div class="line"><span class="lineno"> 3404</span>                    (LBCcoef[1] +</div>
<div class="line"><span class="lineno"> 3405</span>                        muAuxj[3] * (2 * LBCcoef[2] +</div>
<div class="line"><span class="lineno"> 3406</span>                            muAuxj[3] * (3 * LBCcoef[3] +</div>
<div class="line"><span class="lineno"> 3407</span>                                muAuxj[3] * 4 * LBCcoef[4])));</div>
<div class="line"><span class="lineno"> 3408</span>                <a class="code hl_variable" href="classMixture.html#ae63dab2d31711b0246096c5c128f2080">mux</a>[bId + k] = (der3J * muAuxj[1] - muAuxj[0] * der4J) /</div>
<div class="line"><span class="lineno"> 3409</span>                    (muAuxj[1] * muAuxj[1]) +</div>
<div class="line"><span class="lineno"> 3410</span>                    1E-4 *</div>
<div class="line"><span class="lineno"> 3411</span>                    (4 * pow(muAuxj[4], 3) * der8J * muAuxj[2] -</div>
<div class="line"><span class="lineno"> 3412</span>                        (pow(muAuxj[4], 4) - 1) * der6J) /</div>
<div class="line"><span class="lineno"> 3413</span>                    (muAuxj[2] * muAuxj[2]);</div>
<div class="line"><span class="lineno"> 3414</span>            }</div>
<div class="line"><span class="lineno"> 3415</span>        }</div>
<div class="line"><span class="lineno"> 3416</span>    }</div>
<div class="line"><span class="lineno"> 3417</span> </div>
<div class="line"><span class="lineno"> 3418</span>    <span class="keywordflow">if</span> (NP == 1) {</div>
<div class="line"><span class="lineno"> 3419</span>        <span class="comment">// NP = 1, then dxij / dP = 0, d MJ / dP = 0</span></div>
<div class="line"><span class="lineno"> 3420</span>        <span class="comment">// Calculate dmuj / dP</span></div>
<div class="line"><span class="lineno"> 3421</span>        <span class="comment">// der2IJ = der3J = der4J = der6J = 0;</span></div>
<div class="line"><span class="lineno"> 3422</span>        <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; xj     = x[0];</div>
<div class="line"><span class="lineno"> 3423</span>        <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; muAuxj = muAux[0];</div>
<div class="line"><span class="lineno"> 3424</span>        xTj = xPj = xVj = 0;</div>
<div class="line"><span class="lineno"> 3425</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3426</span>            xTj += xj[i] * Tc[i];</div>
<div class="line"><span class="lineno"> 3427</span>            xPj += xj[i] * Pc[i];</div>
<div class="line"><span class="lineno"> 3428</span>            xVj += xj[i] * Vcvis[i];</div>
<div class="line"><span class="lineno"> 3429</span>        }</div>
<div class="line"><span class="lineno"> 3430</span>        der7J = xVj * xiPC[0];</div>
<div class="line"><span class="lineno"> 3431</span>        <span class="keywordflow">if</span> (muAuxj[3] &lt;= 0.18 &amp;&amp; <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 3432</span>            <a class="code hl_variable" href="classMixture.html#ae1531b7594246b0b03bdb7d974800ca4">muP</a>[phaseLabel[0]] = (2.05 * 1E-4) * der7J / muAuxj[2];</div>
<div class="line"><span class="lineno"> 3433</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3434</span>            der8J              = der7J * (LBCcoef[1] +</div>
<div class="line"><span class="lineno"> 3435</span>                             muAuxj[3] * (2 * LBCcoef[2] +</div>
<div class="line"><span class="lineno"> 3436</span>                                          muAuxj[3] * (3 * LBCcoef[3] +</div>
<div class="line"><span class="lineno"> 3437</span>                                                       muAuxj[3] * 4 * LBCcoef[4])));</div>
<div class="line"><span class="lineno"> 3438</span>            <a class="code hl_variable" href="classMixture.html#ae1531b7594246b0b03bdb7d974800ca4">muP</a>[phaseLabel[0]] = (4 * 1E-4) * pow(muAuxj[4], 3) * der8J / muAuxj[2];</div>
<div class="line"><span class="lineno"> 3439</span>        }</div>
<div class="line"><span class="lineno"> 3440</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3441</span>        <span class="comment">// NP &gt; 1</span></div>
<div class="line"><span class="lineno"> 3442</span>        <span class="comment">// Calculate dmuj / dP</span></div>
<div class="line"><span class="lineno"> 3443</span>        <span class="comment">// use rhsDer (after CaldXsdXpAPI01)</span></div>
<div class="line"><span class="lineno"> 3444</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 3445</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>*         xijP   = &amp;rhsDer[NP + j * NC];</div>
<div class="line"><span class="lineno"> 3446</span>            <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; xj     = x[j];</div>
<div class="line"><span class="lineno"> 3447</span>            <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; muAuxj = muAux[j];</div>
<div class="line"><span class="lineno"> 3448</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>              j1    = phaseLabel[j];</div>
<div class="line"><span class="lineno"> 3449</span>            xTj = xPj = xVj = 0;</div>
<div class="line"><span class="lineno"> 3450</span>            derxTj = derxPj = derMWj = 0;</div>
<div class="line"><span class="lineno"> 3451</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3452</span>                xTj += xj[i] * Tc[i];</div>
<div class="line"><span class="lineno"> 3453</span>                xPj += xj[i] * Pc[i];</div>
<div class="line"><span class="lineno"> 3454</span>                xVj += xj[i] * Vcvis[i];</div>
<div class="line"><span class="lineno"> 3455</span>                derxTj += xijP[i] * Tc[i];</div>
<div class="line"><span class="lineno"> 3456</span>                derxPj += xijP[i] * Pc[i];</div>
<div class="line"><span class="lineno"> 3457</span>                derMWj += xijP[i] * MWC[i];</div>
<div class="line"><span class="lineno"> 3458</span>            }</div>
<div class="line"><span class="lineno"> 3459</span>            der3J = der4J = der7J = 0;</div>
<div class="line"><span class="lineno"> 3460</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3461</span>                val1IJ = muAux1I[i] / sqrt(MW[j]);</div>
<div class="line"><span class="lineno"> 3462</span>                der1IJ = -(1 / 2) * muAux1I[i] * pow(MW[j], -1.5) * derMWj;</div>
<div class="line"><span class="lineno"> 3463</span>                Tri    = T / Tc[i];</div>
<div class="line"><span class="lineno"> 3464</span>                <span class="keywordflow">if</span> (Tri &lt;= 1.5) {</div>
<div class="line"><span class="lineno"> 3465</span>                    tmp = 34 * 1E-5 * pow(Tri, 0.94);</div>
<div class="line"><span class="lineno"> 3466</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3467</span>                    tmp = 17.78 * 1E-5 * pow(4.58 * Tri - 1.67, 0.625);</div>
<div class="line"><span class="lineno"> 3468</span>                }</div>
<div class="line"><span class="lineno"> 3469</span>                val2IJ = tmp / val1IJ;</div>
<div class="line"><span class="lineno"> 3470</span>                der2IJ = -tmp * der1IJ / (val1IJ * val1IJ);</div>
<div class="line"><span class="lineno"> 3471</span>                der3J += sqrtMWi[i] * (xijP[i] * val2IJ + xj[i] * der2IJ);</div>
<div class="line"><span class="lineno"> 3472</span>                der4J += sqrtMWi[i] * xijP[i];</div>
<div class="line"><span class="lineno"> 3473</span>                der7J += xijP[i] * Vcvis[i];</div>
<div class="line"><span class="lineno"> 3474</span>            }</div>
<div class="line"><span class="lineno"> 3475</span>            der7J *= <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j1];</div>
<div class="line"><span class="lineno"> 3476</span>            der7J += <a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[j1] * xVj;</div>
<div class="line"><span class="lineno"> 3477</span>            der6J =</div>
<div class="line"><span class="lineno"> 3478</span>                5.4402 *</div>
<div class="line"><span class="lineno"> 3479</span>                (1.0 / 6 * pow(xTj, -5.0 / 6) * derxTj -</div>
<div class="line"><span class="lineno"> 3480</span>                 pow(xTj, 1.0 / 6) * (0.5 / MW[j] * derMWj + 2.0 / 3 / xPj * derxPj)) /</div>
<div class="line"><span class="lineno"> 3481</span>                (sqrt(MW[j]) * pow(xPj, 2.0 / 3));</div>
<div class="line"><span class="lineno"> 3482</span>            <span class="keywordflow">if</span> (muAuxj[3] &lt;= 0.18 &amp;&amp; <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 3483</span>                <a class="code hl_variable" href="classMixture.html#ae1531b7594246b0b03bdb7d974800ca4">muP</a>[j1] =</div>
<div class="line"><span class="lineno"> 3484</span>                    (der3J * muAuxj[1] - muAuxj[0] * der4J) / (muAuxj[1] * muAuxj[1]) +</div>
<div class="line"><span class="lineno"> 3485</span>                    2.05 * 1E-4 * (der7J * muAuxj[2] - muAuxj[3] * der6J) /</div>
<div class="line"><span class="lineno"> 3486</span>                        (muAuxj[2] * muAuxj[2]);</div>
<div class="line"><span class="lineno"> 3487</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3488</span>                der8J =</div>
<div class="line"><span class="lineno"> 3489</span>                    der7J * (LBCcoef[1] +</div>
<div class="line"><span class="lineno"> 3490</span>                             muAuxj[3] * (2 * LBCcoef[2] +</div>
<div class="line"><span class="lineno"> 3491</span>                                          muAuxj[3] * (3 * LBCcoef[3] +</div>
<div class="line"><span class="lineno"> 3492</span>                                                       muAuxj[3] * 4 * LBCcoef[4])));</div>
<div class="line"><span class="lineno"> 3493</span>                <a class="code hl_variable" href="classMixture.html#ae1531b7594246b0b03bdb7d974800ca4">muP</a>[j1] =</div>
<div class="line"><span class="lineno"> 3494</span>                    (der3J * muAuxj[1] - muAuxj[0] * der4J) / (muAuxj[1] * muAuxj[1]) +</div>
<div class="line"><span class="lineno"> 3495</span>                    1E-4 *</div>
<div class="line"><span class="lineno"> 3496</span>                        (4 * pow(muAuxj[4], 3) * der8J * muAuxj[2] -</div>
<div class="line"><span class="lineno"> 3497</span>                         (pow(muAuxj[4], 4) - 1) * der6J) /</div>
<div class="line"><span class="lineno"> 3498</span>                        (muAuxj[2] * muAuxj[2]);</div>
<div class="line"><span class="lineno"> 3499</span>            }</div>
<div class="line"><span class="lineno"> 3500</span>        }</div>
<div class="line"><span class="lineno"> 3501</span>    }</div>
<div class="line"><span class="lineno"> 3502</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae7725f788ea20a8bce074225b2c4ff5e" name="ae7725f788ea20a8bce074225b2c4ff5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7725f788ea20a8bce074225b2c4ff5e">&#9670;&#160;</a></span>CalMuPXLBC_partial()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalMuPXLBC_partial </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l02941">2941</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2942</span>{</div>
<div class="line"><span class="lineno"> 2943</span>    <span class="comment">// Here!</span></div>
<div class="line"><span class="lineno"> 2944</span>    <span class="comment">// dmu/dP = dmu/dP</span></div>
<div class="line"><span class="lineno"> 2945</span>    <span class="comment">// dmu/dNk = dmu/dNk = 0</span></div>
<div class="line"><span class="lineno"> 2946</span>    <span class="comment">// // dxij / dP = dxij / dNk = 0</span></div>
<div class="line"><span class="lineno"> 2947</span>    <span class="comment">// See MixtureComp::CalMuPXLBC_full01()</span></div>
<div class="line"><span class="lineno"> 2948</span> </div>
<div class="line"><span class="lineno"> 2949</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> val1IJ, val2IJ;</div>
<div class="line"><span class="lineno"> 2950</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> der1IJ, der2IJ, der3J, der4J, der6J, der7J, der8J;</div>
<div class="line"><span class="lineno"> 2951</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Tri, tmp;</div>
<div class="line"><span class="lineno"> 2952</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> xTj, xPj, xVj;</div>
<div class="line"><span class="lineno"> 2953</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> derxTj, derxPj, derMWj, derxVj;</div>
<div class="line"><span class="lineno"> 2954</span> </div>
<div class="line"><span class="lineno"> 2955</span>    <span class="comment">// dxij / dP = 0, d MJ / dP = 0</span></div>
<div class="line"><span class="lineno"> 2956</span>    <span class="comment">// Calculate dmuj / dP</span></div>
<div class="line"><span class="lineno"> 2957</span>    <span class="comment">// der2IJ = der3J = der4J = der6J = 0;</span></div>
<div class="line"><span class="lineno"> 2958</span> </div>
<div class="line"><span class="lineno"> 2959</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 2960</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1 = phaseLabel[j];</div>
<div class="line"><span class="lineno"> 2961</span>        <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; xj = x[j];</div>
<div class="line"><span class="lineno"> 2962</span>        <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; muAuxj = muAux[j];</div>
<div class="line"><span class="lineno"> 2963</span> </div>
<div class="line"><span class="lineno"> 2964</span>        xTj = xPj = xVj = 0;</div>
<div class="line"><span class="lineno"> 2965</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 2966</span>            xTj += xj[i] * Tc[i];</div>
<div class="line"><span class="lineno"> 2967</span>            xPj += xj[i] * Pc[i];</div>
<div class="line"><span class="lineno"> 2968</span>            xVj += xj[i] * Vcvis[i];</div>
<div class="line"><span class="lineno"> 2969</span>        }</div>
<div class="line"><span class="lineno"> 2970</span>        der7J = xVj * <a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[j1];</div>
<div class="line"><span class="lineno"> 2971</span>        <span class="keywordflow">if</span> (muAuxj[3] &lt;= 0.18 &amp;&amp; <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 2972</span>            <a class="code hl_variable" href="classMixture.html#ae1531b7594246b0b03bdb7d974800ca4">muP</a>[j1] = (2.05 * 1E-4) * der7J / muAuxj[2];</div>
<div class="line"><span class="lineno"> 2973</span>        }</div>
<div class="line"><span class="lineno"> 2974</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2975</span>            der8J = der7J * (LBCcoef[1] +</div>
<div class="line"><span class="lineno"> 2976</span>                muAuxj[3] * (2 * LBCcoef[2] +</div>
<div class="line"><span class="lineno"> 2977</span>                    muAuxj[3] * (3 * LBCcoef[3] +</div>
<div class="line"><span class="lineno"> 2978</span>                        muAuxj[3] * 4 * LBCcoef[4])));</div>
<div class="line"><span class="lineno"> 2979</span>            <a class="code hl_variable" href="classMixture.html#ae1531b7594246b0b03bdb7d974800ca4">muP</a>[j1] = (4 * 1E-4) * pow(muAuxj[4], 3) * der8J / muAuxj[2];</div>
<div class="line"><span class="lineno"> 2980</span>        }</div>
<div class="line"><span class="lineno"> 2981</span> </div>
<div class="line"><span class="lineno"> 2982</span>        <span class="comment">// Calculate dmuj / xkj</span></div>
<div class="line"><span class="lineno"> 2983</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> bId = <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> * j1;</div>
<div class="line"><span class="lineno"> 2984</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 2985</span>            derxTj = Tc[k];</div>
<div class="line"><span class="lineno"> 2986</span>            derxPj = Pc[k];</div>
<div class="line"><span class="lineno"> 2987</span>            derMWj = MWC[k];</div>
<div class="line"><span class="lineno"> 2988</span>            der3J = 0;</div>
<div class="line"><span class="lineno"> 2989</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 2990</span>                val1IJ = muAux1I[i] / sqrt(MW[j]);</div>
<div class="line"><span class="lineno"> 2991</span>                der1IJ = -(1 / 2) * muAux1I[i] * pow(MW[j], -1.5) * derMWj;</div>
<div class="line"><span class="lineno"> 2992</span>                Tri = T / Tc[i];</div>
<div class="line"><span class="lineno"> 2993</span>                <span class="keywordflow">if</span> (Tri &lt;= 1.5) {</div>
<div class="line"><span class="lineno"> 2994</span>                    tmp = 34 * 1E-5 * pow(Tri, 0.94);</div>
<div class="line"><span class="lineno"> 2995</span>                }</div>
<div class="line"><span class="lineno"> 2996</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2997</span>                    tmp = 17.78 * 1E-5 * pow(4.58 * Tri - 1.67, 0.625);</div>
<div class="line"><span class="lineno"> 2998</span>                }</div>
<div class="line"><span class="lineno"> 2999</span>                val2IJ = tmp / val1IJ;</div>
<div class="line"><span class="lineno"> 3000</span>                der2IJ = -tmp * der1IJ / (val1IJ * val1IJ);</div>
<div class="line"><span class="lineno"> 3001</span>                der3J +=</div>
<div class="line"><span class="lineno"> 3002</span>                    xj[i] * sqrtMWi[i] * der2IJ + delta(i, k) * sqrtMWi[k] * val2IJ;</div>
<div class="line"><span class="lineno"> 3003</span>            }</div>
<div class="line"><span class="lineno"> 3004</span>            der4J = sqrtMWi[k];</div>
<div class="line"><span class="lineno"> 3005</span>            der6J =</div>
<div class="line"><span class="lineno"> 3006</span>                5.4402 *</div>
<div class="line"><span class="lineno"> 3007</span>                (1.0 / 6 * pow(xTj, -5.0 / 6) * derxTj -</div>
<div class="line"><span class="lineno"> 3008</span>                    pow(xTj, 1.0 / 6) * (0.5 / MW[j] * derMWj + 2.0 / 3 / xPj * derxPj)) /</div>
<div class="line"><span class="lineno"> 3009</span>                (sqrt(MW[j]) * pow(xPj, 2.0 / 3));</div>
<div class="line"><span class="lineno"> 3010</span>            der7J = <a class="code hl_variable" href="classMixture.html#a3f517560e2ec30f08afca9f6dc3ff71c">xix</a>[j1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + k] * xVj + <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j1] * Vcvis[k];</div>
<div class="line"><span class="lineno"> 3011</span>            <span class="keywordflow">if</span> (muAuxj[3] &lt;= 0.18 &amp;&amp; <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 3012</span>                <a class="code hl_variable" href="classMixture.html#ae63dab2d31711b0246096c5c128f2080">mux</a>[bId + k] =</div>
<div class="line"><span class="lineno"> 3013</span>                    (der3J * muAuxj[1] - muAuxj[0] * der4J) / (muAuxj[1] * muAuxj[1]) +</div>
<div class="line"><span class="lineno"> 3014</span>                    2.05 * 1E-4 * (der7J * muAuxj[2] - muAuxj[3] * der6J) /</div>
<div class="line"><span class="lineno"> 3015</span>                    (muAuxj[2] * muAuxj[2]);</div>
<div class="line"><span class="lineno"> 3016</span>            }</div>
<div class="line"><span class="lineno"> 3017</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3018</span>                der8J =</div>
<div class="line"><span class="lineno"> 3019</span>                    der7J * (LBCcoef[1] +</div>
<div class="line"><span class="lineno"> 3020</span>                        muAuxj[3] * (2 * LBCcoef[2] +</div>
<div class="line"><span class="lineno"> 3021</span>                            muAuxj[3] * (3 * LBCcoef[3] +</div>
<div class="line"><span class="lineno"> 3022</span>                                muAuxj[3] * 4 * LBCcoef[4])));</div>
<div class="line"><span class="lineno"> 3023</span>                <a class="code hl_variable" href="classMixture.html#ae63dab2d31711b0246096c5c128f2080">mux</a>[bId + k] =</div>
<div class="line"><span class="lineno"> 3024</span>                    (der3J * muAuxj[1] - muAuxj[0] * der4J) / (muAuxj[1] * muAuxj[1]) +</div>
<div class="line"><span class="lineno"> 3025</span>                    1E-4 *</div>
<div class="line"><span class="lineno"> 3026</span>                    (4 * pow(muAuxj[4], 3) * der8J * muAuxj[2] -</div>
<div class="line"><span class="lineno"> 3027</span>                        (pow(muAuxj[4], 4) - 1) * der6J) /</div>
<div class="line"><span class="lineno"> 3028</span>                    (muAuxj[2] * muAuxj[2]);</div>
<div class="line"><span class="lineno"> 3029</span>            }</div>
<div class="line"><span class="lineno"> 3030</span>        }</div>
<div class="line"><span class="lineno"> 3031</span>    }</div>
<div class="line"><span class="lineno"> 3032</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9bfc2096a5dbf9d813382a60f16d46c1" name="a9bfc2096a5dbf9d813382a60f16d46c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bfc2096a5dbf9d813382a60f16d46c1">&#9670;&#160;</a></span>CalMW()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalMW </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00853">853</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  854</span>{</div>
<div class="line"><span class="lineno">  855</span>    <span class="comment">// Calculate Molecular Weight of phase</span></div>
<div class="line"><span class="lineno">  856</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno">  857</span>        MW[j] = 0;</div>
<div class="line"><span class="lineno">  858</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno">  859</span>            MW[j] += x[j][i] * MWC[i];</div>
<div class="line"><span class="lineno">  860</span>        }</div>
<div class="line"><span class="lineno">  861</span>    }</div>
<div class="line"><span class="lineno">  862</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3bc05dc7dba2aa52761afe81bd033a26" name="a3bc05dc7dba2aa52761afe81bd033a26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bc05dc7dba2aa52761afe81bd033a26">&#9670;&#160;</a></span>CalPhiNSTA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalPhiNSTA </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate d ln phi[i][j] / d n[k][j]. </p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l01974">1974</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1975</span>{</div>
<div class="line"><span class="lineno"> 1976</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> C, D, E, G;</div>
<div class="line"><span class="lineno"> 1977</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Cnk, Dnk, Enk, Gnk;</div>
<div class="line"><span class="lineno"> 1978</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp, aik;</div>
<div class="line"><span class="lineno"> 1979</span> </div>
<div class="line"><span class="lineno"> 1980</span>    <span class="comment">// 0 th phase</span></div>
<div class="line"><span class="lineno"> 1981</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&amp; aj = Aj[0];</div>
<div class="line"><span class="lineno"> 1982</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&amp; bj = Bj[0];</div>
<div class="line"><span class="lineno"> 1983</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&amp; zj = Zj[0];</div>
<div class="line"><span class="lineno"> 1984</span>    <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; xj = x[0];</div>
<div class="line"><span class="lineno"> 1985</span>    vector&lt;OCP_DBL&gt;&amp; Znj = Zn[0];</div>
<div class="line"><span class="lineno"> 1986</span> </div>
<div class="line"><span class="lineno"> 1987</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1988</span>        tmp = 0;</div>
<div class="line"><span class="lineno"> 1989</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 1990</span>            tmp += (1 - BIC[i * NC + m]) * sqrt(Ai[i] * Ai[m]) * xj[m];</div>
<div class="line"><span class="lineno"> 1991</span>        }</div>
<div class="line"><span class="lineno"> 1992</span>        An[i] = 2 / nu[0] * (tmp - aj);</div>
<div class="line"><span class="lineno"> 1993</span>        Bn[i] = 1 / nu[0] * (Bi[i] - bj);</div>
<div class="line"><span class="lineno"> 1994</span>        Znj[i] =</div>
<div class="line"><span class="lineno"> 1995</span>            ((bj - zj) * An[i] +</div>
<div class="line"><span class="lineno"> 1996</span>                ((aj + delta1 * delta2 * (3 * bj * bj + 2 * bj)) +</div>
<div class="line"><span class="lineno"> 1997</span>                    ((delta1 + delta2) * (2 * bj + 1) - 2 * delta1 * delta2 * bj) * zj -</div>
<div class="line"><span class="lineno"> 1998</span>                    (delta1 + delta2 - 1) * zj * zj) *</div>
<div class="line"><span class="lineno"> 1999</span>                Bn[i]) /</div>
<div class="line"><span class="lineno"> 2000</span>            (3 * zj * zj + 2 * ((delta1 + delta2 - 1) * bj - 1) * zj +</div>
<div class="line"><span class="lineno"> 2001</span>                (aj + delta1 * delta2 * bj * bj - (delta1 + delta2) * bj * (bj + 1)));</div>
<div class="line"><span class="lineno"> 2002</span>    }</div>
<div class="line"><span class="lineno"> 2003</span> </div>
<div class="line"><span class="lineno"> 2004</span>    G = (zj + delta1 * bj) / (zj + delta2 * bj);</div>
<div class="line"><span class="lineno"> 2005</span> </div>
<div class="line"><span class="lineno"> 2006</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 2007</span>        <span class="comment">// i th fugacity</span></div>
<div class="line"><span class="lineno"> 2008</span>        C = 1 / (zj - bj);</div>
<div class="line"><span class="lineno"> 2009</span>        <span class="comment">// D = Bi[i] / bj * (zj - 1);</span></div>
<div class="line"><span class="lineno"> 2010</span>        tmp = 0;</div>
<div class="line"><span class="lineno"> 2011</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 2012</span>            tmp += (1 - BIC[i * NC + k]) * sqrt(Ai[i] * Ai[k]) * xj[k];</div>
<div class="line"><span class="lineno"> 2013</span>        }</div>
<div class="line"><span class="lineno"> 2014</span>        E = -aj / ((delta1 - delta2) * bj) * (2 * tmp / aj - Bi[i] / bj);</div>
<div class="line"><span class="lineno"> 2015</span> </div>
<div class="line"><span class="lineno"> 2016</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt;= i; k++) {</div>
<div class="line"><span class="lineno"> 2017</span>            <span class="comment">// k th components</span></div>
<div class="line"><span class="lineno"> 2018</span> </div>
<div class="line"><span class="lineno"> 2019</span>            aik = (1 - BIC[i * NC + k]) * sqrt(Ai[i] * Ai[k]);</div>
<div class="line"><span class="lineno"> 2020</span> </div>
<div class="line"><span class="lineno"> 2021</span>            Cnk = (Bn[k] - Znj[k]) / ((zj - bj) * (zj - bj));</div>
<div class="line"><span class="lineno"> 2022</span>            Dnk = Bi[i] / bj * (Znj[k] - (Bi[k] - bj) * (zj - 1) / (nu[0] * bj));</div>
<div class="line"><span class="lineno"> 2023</span>            Gnk = (delta1 - delta2) / ((zj + delta2 * bj) * (zj + delta2 * bj)) *</div>
<div class="line"><span class="lineno"> 2024</span>                (Bn[k] * zj - Znj[k] * bj);</div>
<div class="line"><span class="lineno"> 2025</span>            <span class="comment">/*Enk = 1 / ((delta1 - delta2) * bj * bj) * (An[k] * bj - Bn[k] * aj) *</span></div>
<div class="line"><span class="lineno"> 2026</span><span class="comment">               (Bi[i] / bj - 2 * tmp / aj)</span></div>
<div class="line"><span class="lineno"> 2027</span><span class="comment">                + aj / ((delta1 - delta2) * bj) * (-Bi[i] / (bj * bj) * Bn[k] - 2 /</span></div>
<div class="line"><span class="lineno"> 2028</span><span class="comment">               (aj * aj) * (aj * (aik - tmp) / nu[j] - An[k] * tmp));*/</span></div>
<div class="line"><span class="lineno"> 2029</span>            Enk = -1 / (delta1 - delta2) / (bj * bj) *</div>
<div class="line"><span class="lineno"> 2030</span>                (2 * (bj * aik / nu[0] + Bn[k] * (Bi[i] * aj / bj - tmp)) -</div>
<div class="line"><span class="lineno"> 2031</span>                    An[k] * Bi[i] - aj * Bi[i] / nu[0]);</div>
<div class="line"><span class="lineno"> 2032</span>            Enk -= E / nu[0];</div>
<div class="line"><span class="lineno"> 2033</span>            phiN[i * NC + k] = 1 / C * Cnk + Dnk + Enk * log(G) + E / G * Gnk;</div>
<div class="line"><span class="lineno"> 2034</span>            phiN[k * NC + i] = phiN[i * NC + k];            </div>
<div class="line"><span class="lineno"> 2035</span>        }</div>
<div class="line"><span class="lineno"> 2036</span>    }</div>
<div class="line"><span class="lineno"> 2037</span> </div>
<div class="line"><span class="lineno"> 2038</span>    <span class="comment">//cout &lt;&lt; endl &lt;&lt; &quot;phiN&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 2039</span>    <span class="comment">//for (USI i = 0; i &lt; NC; i++) {</span></div>
<div class="line"><span class="lineno"> 2040</span>    <span class="comment">//    for (USI j = 0; j &lt; NC; j++) {</span></div>
<div class="line"><span class="lineno"> 2041</span>    <span class="comment">//        cout &lt;&lt; phiN[i * NC + j] &lt;&lt; &quot;   &quot;;</span></div>
<div class="line"><span class="lineno"> 2042</span>    <span class="comment">//    }</span></div>
<div class="line"><span class="lineno"> 2043</span>    <span class="comment">//    cout &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 2044</span>    <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 2045</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9305f861f0d2da9313b92113bc6fba6a" name="a9305f861f0d2da9313b92113bc6fba6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9305f861f0d2da9313b92113bc6fba6a">&#9670;&#160;</a></span>CalResSP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalResSP </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l01831">1831</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1832</span>{</div>
<div class="line"><span class="lineno"> 1833</span>    <span class="comment">// So it equals -res</span></div>
<div class="line"><span class="lineno"> 1834</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP - 1; j++) {</div>
<div class="line"><span class="lineno"> 1835</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1836</span>            <span class="comment">// if zi is too small, resSP[j][i] = 0?</span></div>
<div class="line"><span class="lineno"> 1837</span>            resSP[j * NC + i] = log(fug[NP - 1][i] / fug[j][i]);</div>
<div class="line"><span class="lineno"> 1838</span>        }</div>
<div class="line"><span class="lineno"> 1839</span>    }</div>
<div class="line"><span class="lineno"> 1840</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abe3177be549a25a5f58cba7bf0f93570" name="abe3177be549a25a5f58cba7bf0f93570"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe3177be549a25a5f58cba7bf0f93570">&#9670;&#160;</a></span>CalRhoPn_partial()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalRhoPn_partial </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l02445">2445</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2446</span>{</div>
<div class="line"><span class="lineno"> 2447</span>    <span class="comment">// rhoN = 0</span></div>
<div class="line"><span class="lineno"> 2448</span>    <span class="comment">// rhoP</span></div>
<div class="line"><span class="lineno"> 2449</span>    <span class="comment">// rhon(drhoj / d nij) in rhox</span></div>
<div class="line"><span class="lineno"> 2450</span>    fill(<a class="code hl_variable" href="classMixture.html#ad9e2798ac8ab094b3a17cff16111f70b">rhoN</a>.begin(), <a class="code hl_variable" href="classMixture.html#ad9e2798ac8ab094b3a17cff16111f70b">rhoN</a>.end() - <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>, 0.0);</div>
<div class="line"><span class="lineno"> 2451</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1;</div>
<div class="line"><span class="lineno"> 2452</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 2453</span>        j1 = phaseLabel[j];</div>
<div class="line"><span class="lineno"> 2454</span>        <a class="code hl_variable" href="classMixture.html#a0a42129a94c1ba7c92c9577f0eb0234f">rhoP</a>[j1] = <a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[j1] * MW[j];</div>
<div class="line"><span class="lineno"> 2455</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 2456</span>            <a class="code hl_variable" href="classMixture.html#a62615d0052ef8b34c3894e728951c06e">rhox</a>[j1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + m] = <a class="code hl_variable" href="classMixture.html#a3f517560e2ec30f08afca9f6dc3ff71c">xix</a>[j1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + m] * MW[j] </div>
<div class="line"><span class="lineno"> 2457</span>                + <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j1] / nu[j] * (MWC[m] - MW[j]);</div>
<div class="line"><span class="lineno"> 2458</span>        }</div>
<div class="line"><span class="lineno"> 2459</span>    }</div>
<div class="line"><span class="lineno"> 2460</span>}</div>
<div class="ttc" id="aclassMixture_html_a0a42129a94c1ba7c92c9577f0eb0234f"><div class="ttname"><a href="classMixture.html#a0a42129a94c1ba7c92c9577f0eb0234f">Mixture::rhoP</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; rhoP</div><div class="ttdoc">d rho / dP: numphase</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00175">Mixture.hpp:175</a></div></div>
<div class="ttc" id="aclassMixture_html_a62615d0052ef8b34c3894e728951c06e"><div class="ttname"><a href="classMixture.html#a62615d0052ef8b34c3894e728951c06e">Mixture::rhox</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; rhox</div><div class="ttdoc">d rho[j] / d x[i][j]: numphase * numCom</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00181">Mixture.hpp:181</a></div></div>
<div class="ttc" id="aclassMixture_html_ad9e2798ac8ab094b3a17cff16111f70b"><div class="ttname"><a href="classMixture.html#ad9e2798ac8ab094b3a17cff16111f70b">Mixture::rhoN</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; rhoN</div><div class="ttdoc">d rho[j] / d N[i]: numphase * numCom</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00178">Mixture.hpp:178</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5117679ee95b8f6f7249ca68eb27a40d" name="a5117679ee95b8f6f7249ca68eb27a40d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5117679ee95b8f6f7249ca68eb27a40d">&#9670;&#160;</a></span>CalRhoPNX_full()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalRhoPNX_full </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l03282">3282</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3283</span>{</div>
<div class="line"><span class="lineno"> 3284</span>    <span class="comment">// CaldXsdXpAPI01() or CaldXsdXpAPI02() shoule be called before</span></div>
<div class="line"><span class="lineno"> 3285</span>    <span class="comment">// Using dXsdXp</span></div>
<div class="line"><span class="lineno"> 3286</span>    <span class="comment">// Cal rhoP, rhoX</span></div>
<div class="line"><span class="lineno"> 3287</span>    <span class="comment">// Water has been calculated</span></div>
<div class="line"><span class="lineno"> 3288</span>    <span class="comment">// fill(rhox.begin(), rhox.end() - numCom, 0.0);</span></div>
<div class="line"><span class="lineno"> 3289</span>    <span class="comment">// fill(rhoP.begin(), rhoP.end() - 1, 0.0);</span></div>
<div class="line"><span class="lineno"> 3290</span> </div>
<div class="line"><span class="lineno"> 3291</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1, bId;</div>
<div class="line"><span class="lineno"> 3292</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp = 0;</div>
<div class="line"><span class="lineno"> 3293</span>    <span class="keywordflow">if</span> (NP == 1) {      </div>
<div class="line"><span class="lineno"> 3294</span>        j1 = phaseLabel[0];</div>
<div class="line"><span class="lineno"> 3295</span>        bId = j1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 3296</span>        <a class="code hl_variable" href="classMixture.html#a0a42129a94c1ba7c92c9577f0eb0234f">rhoP</a>[j1] = <a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[j1] * MW[0];</div>
<div class="line"><span class="lineno"> 3297</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 3298</span>            <a class="code hl_variable" href="classMixture.html#a62615d0052ef8b34c3894e728951c06e">rhox</a>[bId + m] = <a class="code hl_variable" href="classMixture.html#a3f517560e2ec30f08afca9f6dc3ff71c">xix</a>[bId + m] * MW[0] + <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j1] * MWC[m];</div>
<div class="line"><span class="lineno"> 3299</span>            <a class="code hl_variable" href="classMixture.html#ad9e2798ac8ab094b3a17cff16111f70b">rhoN</a>[bId + m] = <a class="code hl_variable" href="classMixture.html#a3476f1a61b94f0b58c00a90643e1861a">xiN</a>[bId + m] * MW[0];</div>
<div class="line"><span class="lineno"> 3300</span>            tmp = MWC[m] * Nh;</div>
<div class="line"><span class="lineno"> 3301</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3302</span>                tmp -= MWC[i] * <a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[i];</div>
<div class="line"><span class="lineno"> 3303</span>            }</div>
<div class="line"><span class="lineno"> 3304</span>            <a class="code hl_variable" href="classMixture.html#ad9e2798ac8ab094b3a17cff16111f70b">rhoN</a>[bId + m] += tmp * <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j1] / (Nh * Nh);</div>
<div class="line"><span class="lineno"> 3305</span>        }</div>
<div class="line"><span class="lineno"> 3306</span>    }</div>
<div class="line"><span class="lineno"> 3307</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3308</span>        <span class="comment">// Using dXsdXp</span></div>
<div class="line"><span class="lineno"> 3309</span>        fill(<a class="code hl_variable" href="classMixture.html#a0a42129a94c1ba7c92c9577f0eb0234f">rhoP</a>.begin(), <a class="code hl_variable" href="classMixture.html#a0a42129a94c1ba7c92c9577f0eb0234f">rhoP</a>.end() - 1, 0.0);</div>
<div class="line"><span class="lineno"> 3310</span>        fill(<a class="code hl_variable" href="classMixture.html#ad9e2798ac8ab094b3a17cff16111f70b">rhoN</a>.begin(), <a class="code hl_variable" href="classMixture.html#ad9e2798ac8ab094b3a17cff16111f70b">rhoN</a>.end() - <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>, 0.0);       </div>
<div class="line"><span class="lineno"> 3311</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> ncol = <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + 1;</div>
<div class="line"><span class="lineno"> 3312</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 3313</span>            j1 = phaseLabel[j];</div>
<div class="line"><span class="lineno"> 3314</span>            bId = j1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 3315</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* xijPN = &amp;<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[(<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> + bId) * ncol];</div>
<div class="line"><span class="lineno"> 3316</span> </div>
<div class="line"><span class="lineno"> 3317</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3318</span>                <a class="code hl_variable" href="classMixture.html#a0a42129a94c1ba7c92c9577f0eb0234f">rhoP</a>[j1] += MWC[i] * xijPN[0];</div>
<div class="line"><span class="lineno"> 3319</span>                xijPN++;</div>
<div class="line"><span class="lineno"> 3320</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 3321</span>                    <a class="code hl_variable" href="classMixture.html#ad9e2798ac8ab094b3a17cff16111f70b">rhoN</a>[bId + m] += MWC[i] * xijPN[m];</div>
<div class="line"><span class="lineno"> 3322</span>                }</div>
<div class="line"><span class="lineno"> 3323</span>                xijPN += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 3324</span> </div>
<div class="line"><span class="lineno"> 3325</span>            }</div>
<div class="line"><span class="lineno"> 3326</span>            <a class="code hl_variable" href="classMixture.html#a0a42129a94c1ba7c92c9577f0eb0234f">rhoP</a>[j1] *= <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j1];</div>
<div class="line"><span class="lineno"> 3327</span>            <a class="code hl_variable" href="classMixture.html#a0a42129a94c1ba7c92c9577f0eb0234f">rhoP</a>[j1] += <a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[j1] * MW[j];</div>
<div class="line"><span class="lineno"> 3328</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 3329</span>                <a class="code hl_variable" href="classMixture.html#ad9e2798ac8ab094b3a17cff16111f70b">rhoN</a>[bId + m] *= <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j1];</div>
<div class="line"><span class="lineno"> 3330</span>                <a class="code hl_variable" href="classMixture.html#ad9e2798ac8ab094b3a17cff16111f70b">rhoN</a>[bId + m] += <a class="code hl_variable" href="classMixture.html#a3476f1a61b94f0b58c00a90643e1861a">xiN</a>[bId + m] * MW[j];</div>
<div class="line"><span class="lineno"> 3331</span>                <a class="code hl_variable" href="classMixture.html#a62615d0052ef8b34c3894e728951c06e">rhox</a>[bId + m] = <a class="code hl_variable" href="classMixture.html#a3f517560e2ec30f08afca9f6dc3ff71c">xix</a>[bId + m] * MW[j] + <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j1] * MWC[m];</div>
<div class="line"><span class="lineno"> 3332</span>            }</div>
<div class="line"><span class="lineno"> 3333</span>        }</div>
<div class="line"><span class="lineno"> 3334</span>    }</div>
<div class="line"><span class="lineno"> 3335</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8479f5bf57a96798edf3f43f177b6a68" name="a8479f5bf57a96798edf3f43f177b6a68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8479f5bf57a96798edf3f43f177b6a68">&#9670;&#160;</a></span>CalRhoPNX_full01()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalRhoPNX_full01 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l03218">3218</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3219</span>{</div>
<div class="line"><span class="lineno"> 3220</span>    <span class="comment">// CaldXsdXp01() shoule be called before</span></div>
<div class="line"><span class="lineno"> 3221</span>    <span class="comment">// Using rhsDer</span></div>
<div class="line"><span class="lineno"> 3222</span>    <span class="comment">// Cal rhoP, rhoX</span></div>
<div class="line"><span class="lineno"> 3223</span>    <span class="comment">// Water has been calculated</span></div>
<div class="line"><span class="lineno"> 3224</span>    <span class="comment">//fill(rhox.begin(), rhox.end() - numCom, 0.0);</span></div>
<div class="line"><span class="lineno"> 3225</span>    <span class="comment">//fill(rhoP.begin(), rhoP.end() - 1, 0.0);</span></div>
<div class="line"><span class="lineno"> 3226</span> </div>
<div class="line"><span class="lineno"> 3227</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1, bId;</div>
<div class="line"><span class="lineno"> 3228</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 3229</span>        j1 = phaseLabel[j];</div>
<div class="line"><span class="lineno"> 3230</span>        bId = j1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 3231</span>        <a class="code hl_variable" href="classMixture.html#a0a42129a94c1ba7c92c9577f0eb0234f">rhoP</a>[j1] = <a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[j1] * MW[j];</div>
<div class="line"><span class="lineno"> 3232</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 3233</span>            <a class="code hl_variable" href="classMixture.html#a62615d0052ef8b34c3894e728951c06e">rhox</a>[bId + m] = <a class="code hl_variable" href="classMixture.html#a3f517560e2ec30f08afca9f6dc3ff71c">xix</a>[bId + m] * MW[j] + <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j1] * MWC[m];</div>
<div class="line"><span class="lineno"> 3234</span>        }</div>
<div class="line"><span class="lineno"> 3235</span>    }</div>
<div class="line"><span class="lineno"> 3236</span>    <span class="keywordflow">if</span> (NP == 1) {</div>
<div class="line"><span class="lineno"> 3237</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp;</div>
<div class="line"><span class="lineno"> 3238</span>        j1 = phaseLabel[0];</div>
<div class="line"><span class="lineno"> 3239</span>        bId = j1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 3240</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 3241</span>            <a class="code hl_variable" href="classMixture.html#ad9e2798ac8ab094b3a17cff16111f70b">rhoN</a>[bId + m] = <a class="code hl_variable" href="classMixture.html#a3476f1a61b94f0b58c00a90643e1861a">xiN</a>[bId + m] * MW[0];</div>
<div class="line"><span class="lineno"> 3242</span>            tmp = MWC[m] * Nh;</div>
<div class="line"><span class="lineno"> 3243</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3244</span>                tmp -= MWC[i] * <a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[i];</div>
<div class="line"><span class="lineno"> 3245</span>            }</div>
<div class="line"><span class="lineno"> 3246</span>            <a class="code hl_variable" href="classMixture.html#ad9e2798ac8ab094b3a17cff16111f70b">rhoN</a>[bId + m] += tmp * <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j1] / (Nh * Nh);</div>
<div class="line"><span class="lineno"> 3247</span>        }</div>
<div class="line"><span class="lineno"> 3248</span>    }</div>
<div class="line"><span class="lineno"> 3249</span>    <span class="keywordflow">if</span> (NP &gt; 1) {</div>
<div class="line"><span class="lineno"> 3250</span>        <span class="comment">// correct rhoP</span></div>
<div class="line"><span class="lineno"> 3251</span>        <span class="comment">// use rhsDer, see CaldXsdXp01(), attention that it only contains hydrocarbon</span></div>
<div class="line"><span class="lineno"> 3252</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>        tmp;</div>
<div class="line"><span class="lineno"> 3253</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* xijP = &amp;rhsDer[NP];</div>
<div class="line"><span class="lineno"> 3254</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 3255</span>            j1 = phaseLabel[j];</div>
<div class="line"><span class="lineno"> 3256</span>            tmp = 0;</div>
<div class="line"><span class="lineno"> 3257</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3258</span>                tmp += MWC[i] * xijP[i];</div>
<div class="line"><span class="lineno"> 3259</span>            }</div>
<div class="line"><span class="lineno"> 3260</span>            <a class="code hl_variable" href="classMixture.html#a0a42129a94c1ba7c92c9577f0eb0234f">rhoP</a>[j1] += <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j1] * tmp;</div>
<div class="line"><span class="lineno"> 3261</span>            xijP += NC;</div>
<div class="line"><span class="lineno"> 3262</span>        }</div>
<div class="line"><span class="lineno"> 3263</span>        <span class="comment">// Calculate rhoN</span></div>
<div class="line"><span class="lineno"> 3264</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* xijN = xijP;</div>
<div class="line"><span class="lineno"> 3265</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 3266</span>            xijN += NP;</div>
<div class="line"><span class="lineno"> 3267</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 3268</span>                j1 = phaseLabel[j];</div>
<div class="line"><span class="lineno"> 3269</span>                bId = j1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 3270</span>                <a class="code hl_variable" href="classMixture.html#ad9e2798ac8ab094b3a17cff16111f70b">rhoN</a>[bId + m] = <a class="code hl_variable" href="classMixture.html#a3476f1a61b94f0b58c00a90643e1861a">xiN</a>[bId + m] * MW[j];</div>
<div class="line"><span class="lineno"> 3271</span>                tmp = 0;</div>
<div class="line"><span class="lineno"> 3272</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3273</span>                    tmp += MWC[i] * xijN[i];</div>
<div class="line"><span class="lineno"> 3274</span>                }</div>
<div class="line"><span class="lineno"> 3275</span>                <a class="code hl_variable" href="classMixture.html#ad9e2798ac8ab094b3a17cff16111f70b">rhoN</a>[bId + m] += tmp * <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j1];</div>
<div class="line"><span class="lineno"> 3276</span>                xijN += NC;</div>
<div class="line"><span class="lineno"> 3277</span>            }</div>
<div class="line"><span class="lineno"> 3278</span>        }</div>
<div class="line"><span class="lineno"> 3279</span>    }</div>
<div class="line"><span class="lineno"> 3280</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a20b38142c7c8a72a559ce378bbdbd7bf" name="a20b38142c7c8a72a559ce378bbdbd7bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20b38142c7c8a72a559ce378bbdbd7bf">&#9670;&#160;</a></span>CalRhoPX_partial()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalRhoPX_partial </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l02909">2909</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2910</span>{</div>
<div class="line"><span class="lineno"> 2911</span>    <span class="comment">// Here!</span></div>
<div class="line"><span class="lineno"> 2912</span>    <span class="comment">// drho/dP = drho/dP</span></div>
<div class="line"><span class="lineno"> 2913</span>    <span class="comment">// drho/dNk = drho/dNk = 0</span></div>
<div class="line"><span class="lineno"> 2914</span>    <span class="comment">// dxij / dP = dxij / dNk = 0</span></div>
<div class="line"><span class="lineno"> 2915</span>    <span class="comment">// See MixtureComp::CalRhoPNX_full()</span></div>
<div class="line"><span class="lineno"> 2916</span> </div>
<div class="line"><span class="lineno"> 2917</span>    <span class="comment">//fill(rhox.begin(), rhox.end() - numCom, 0.0);</span></div>
<div class="line"><span class="lineno"> 2918</span>    fill(<a class="code hl_variable" href="classMixture.html#ad9e2798ac8ab094b3a17cff16111f70b">rhoN</a>.begin(), <a class="code hl_variable" href="classMixture.html#ad9e2798ac8ab094b3a17cff16111f70b">rhoN</a>.end() - <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>, 0.0);</div>
<div class="line"><span class="lineno"> 2919</span>    <span class="comment">//fill(rhoP.begin(), rhoP.end() - 1, 0.0);</span></div>
<div class="line"><span class="lineno"> 2920</span> </div>
<div class="line"><span class="lineno"> 2921</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1;</div>
<div class="line"><span class="lineno"> 2922</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 2923</span>        j1 = phaseLabel[j];</div>
<div class="line"><span class="lineno"> 2924</span>        <a class="code hl_variable" href="classMixture.html#a0a42129a94c1ba7c92c9577f0eb0234f">rhoP</a>[j1] = <a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[j1] * MW[j];</div>
<div class="line"><span class="lineno"> 2925</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 2926</span>            <a class="code hl_variable" href="classMixture.html#a62615d0052ef8b34c3894e728951c06e">rhox</a>[j1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + i] = <a class="code hl_variable" href="classMixture.html#a3f517560e2ec30f08afca9f6dc3ff71c">xix</a>[j1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + i] * MW[j] + <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j1] * MWC[i];</div>
<div class="line"><span class="lineno"> 2927</span>        }</div>
<div class="line"><span class="lineno"> 2928</span>    }</div>
<div class="line"><span class="lineno"> 2929</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4336e1a8a5051b6031e7ccc5fdda9a1a" name="a4336e1a8a5051b6031e7ccc5fdda9a1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4336e1a8a5051b6031e7ccc5fdda9a1a">&#9670;&#160;</a></span>CalSaturation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalSaturation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00883">883</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  884</span>{</div>
<div class="line"><span class="lineno">  885</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; <a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a>; j++) {</div>
<div class="line"><span class="lineno">  886</span>        <a class="code hl_variable" href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">S</a>[j] = 0;</div>
<div class="line"><span class="lineno">  887</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">phaseExist</a>[j]) {</div>
<div class="line"><span class="lineno">  888</span>            <a class="code hl_variable" href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">S</a>[j] = <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[j] / <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a>;</div>
<div class="line"><span class="lineno">  889</span>        }</div>
<div class="line"><span class="lineno">  890</span>    }</div>
<div class="line"><span class="lineno">  891</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0c1a1bca3039abf054eda4cbf11c77be" name="a0c1a1bca3039abf054eda4cbf11c77be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c1a1bca3039abf054eda4cbf11c77be">&#9670;&#160;</a></span>CalStepNRsp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> MixtureComp::CalStepNRsp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l02069">2069</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2070</span>{</div>
<div class="line"><span class="lineno"> 2071</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> alpha = 1;</div>
<div class="line"><span class="lineno"> 2072</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp;</div>
<div class="line"><span class="lineno"> 2073</span> </div>
<div class="line"><span class="lineno"> 2074</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP - 1; j++) {</div>
<div class="line"><span class="lineno"> 2075</span> </div>
<div class="line"><span class="lineno"> 2076</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* <a class="code hl_variable" href="classMixture.html#aa0d6fa9514fce1774cc277826d304061">nj</a> = &amp;n[j][0];</div>
<div class="line"><span class="lineno"> 2077</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* r  = &amp;resSP[j * NC];</div>
<div class="line"><span class="lineno"> 2078</span> </div>
<div class="line"><span class="lineno"> 2079</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 2080</span>            tmp = <a class="code hl_variable" href="classMixture.html#aa0d6fa9514fce1774cc277826d304061">nj</a>[i] + alpha * r[i];</div>
<div class="line"><span class="lineno"> 2081</span>            <span class="keywordflow">if</span> (tmp &lt; 0) {</div>
<div class="line"><span class="lineno"> 2082</span>                alpha *= 0.9 * fabs(<a class="code hl_variable" href="classMixture.html#aa0d6fa9514fce1774cc277826d304061">nj</a>[i] / r[i]);</div>
<div class="line"><span class="lineno"> 2083</span>            }</div>
<div class="line"><span class="lineno"> 2084</span>        }</div>
<div class="line"><span class="lineno"> 2085</span>    }</div>
<div class="line"><span class="lineno"> 2086</span>    <span class="keywordflow">return</span> alpha;</div>
<div class="line"><span class="lineno"> 2087</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aaf9c119f2fdb861763b6577f0be49d79" name="aaf9c119f2fdb861763b6577f0be49d79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf9c119f2fdb861763b6577f0be49d79">&#9670;&#160;</a></span>CalSurfaceTension()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalSurfaceTension </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00563">563</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  564</span>{</div>
<div class="line"><span class="lineno">  565</span>    <span class="comment">// be careful! </span></div>
<div class="line"><span class="lineno">  566</span>    <span class="comment">// phase molar densities should be converted into gm-M/cc here</span></div>
<div class="line"><span class="lineno">  567</span>    <span class="keywordflow">if</span> (miscible) {</div>
<div class="line"><span class="lineno">  568</span>        <span class="keywordflow">if</span> (NP == 1)  surTen = 100;</div>
<div class="line"><span class="lineno">  569</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  570</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> unitF = <a class="code hl_variable" href="OCPConst_8hpp.html#a77c0b69b63221a2a3784482b15e85bfd">CONV3</a> / (<a class="code hl_variable" href="OCPConst_8hpp.html#af7c3f542dfd05ecad80b6ee97eed1bab">CONV4</a> * 1E3); <span class="comment">// lbm/ft3 -&gt; gm-M/cc</span></div>
<div class="line"><span class="lineno">  571</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> b0 = xiC[0] * unitF;</div>
<div class="line"><span class="lineno">  572</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> b1 = xiC[1] * unitF;</div>
<div class="line"><span class="lineno">  573</span>            surTen = 0;</div>
<div class="line"><span class="lineno">  574</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++)</div>
<div class="line"><span class="lineno">  575</span>                surTen += Parachor[i] * (b0 * x[0][i] - b1 * x[1][i]);</div>
<div class="line"><span class="lineno">  576</span>            surTen = pow(surTen, 4.0);</div>
<div class="line"><span class="lineno">  577</span>            <span class="comment">// cout &lt;&lt; surTen &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno">  578</span>        }</div>
<div class="line"><span class="lineno">  579</span>    }</div>
<div class="line"><span class="lineno">  580</span>}</div>
<div class="ttc" id="aOCPConst_8hpp_html_a77c0b69b63221a2a3784482b15e85bfd"><div class="ttname"><a href="OCPConst_8hpp.html#a77c0b69b63221a2a3784482b15e85bfd">CONV3</a></div><div class="ttdeci">const OCP_DBL CONV3</div><div class="ttdoc">1 lb = CONV3 kg</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00061">OCPConst.hpp:61</a></div></div>
<div class="ttc" id="aOCPConst_8hpp_html_af7c3f542dfd05ecad80b6ee97eed1bab"><div class="ttname"><a href="OCPConst_8hpp.html#af7c3f542dfd05ecad80b6ee97eed1bab">CONV4</a></div><div class="ttdeci">const OCP_DBL CONV4</div><div class="ttdoc">1 ft3 = CONV4 m3</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00062">OCPConst.hpp:62</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4102e505fed09c22992bb396e374fc1b" name="a4102e505fed09c22992bb396e374fc1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4102e505fed09c22992bb396e374fc1b">&#9670;&#160;</a></span>CalVfiVfp_full01()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalVfiVfp_full01 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l03608">3608</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3609</span>{</div>
<div class="line"><span class="lineno"> 3610</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> CgTP = <a class="code hl_variable" href="OCPConst_8hpp.html#acf2d5c7d361941d6394ac1c9dc3e5628">GAS_CONSTANT</a> * T / P;</div>
<div class="line"><span class="lineno"> 3611</span> </div>
<div class="line"><span class="lineno"> 3612</span>    <span class="keywordflow">if</span> (NP == 1) {</div>
<div class="line"><span class="lineno"> 3613</span>        <span class="comment">// NP = 1</span></div>
<div class="line"><span class="lineno"> 3614</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&amp;         aj   = Aj[0];</div>
<div class="line"><span class="lineno"> 3615</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&amp;         bj   = Bj[0];</div>
<div class="line"><span class="lineno"> 3616</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&amp;         zj   = Zj[0];</div>
<div class="line"><span class="lineno"> 3617</span>        <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; xj   = x[0];</div>
<div class="line"><span class="lineno"> 3618</span>        vector&lt;OCP_DBL&gt;&amp;       Znij = Zn[0];</div>
<div class="line"><span class="lineno"> 3619</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>                tmp;</div>
<div class="line"><span class="lineno"> 3620</span> </div>
<div class="line"><span class="lineno"> 3621</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3622</span>            tmp = 0;</div>
<div class="line"><span class="lineno"> 3623</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 3624</span>                tmp += (1 - BIC[i * NC + m]) * sqrt(Ai[i] * Ai[m]) * xj[m];</div>
<div class="line"><span class="lineno"> 3625</span>            }</div>
<div class="line"><span class="lineno"> 3626</span>            An[i] = 2 / nu[0] * (tmp - aj);</div>
<div class="line"><span class="lineno"> 3627</span>            Bn[i] = 1 / nu[0] * (Bi[i] - bj);</div>
<div class="line"><span class="lineno"> 3628</span>            Znij[i] =</div>
<div class="line"><span class="lineno"> 3629</span>                ((bj - zj) * An[i] +</div>
<div class="line"><span class="lineno"> 3630</span>                 ((aj + delta1 * delta2 * (3 * bj * bj + 2 * bj)) +</div>
<div class="line"><span class="lineno"> 3631</span>                  ((delta1 + delta2) * (2 * bj + 1) - 2 * delta1 * delta2 * bj) * zj -</div>
<div class="line"><span class="lineno"> 3632</span>                  (delta1 + delta2 - 1) * zj * zj) *</div>
<div class="line"><span class="lineno"> 3633</span>                     Bn[i]) /</div>
<div class="line"><span class="lineno"> 3634</span>                (3 * zj * zj + 2 * ((delta1 + delta2 - 1) * bj - 1) * zj +</div>
<div class="line"><span class="lineno"> 3635</span>                 (aj + delta1 * delta2 * bj * bj - (delta1 + delta2) * bj * (bj + 1)));</div>
<div class="line"><span class="lineno"> 3636</span>            <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[i] = CgTP * (zj + nu[0] * Znij[i]);</div>
<div class="line"><span class="lineno"> 3637</span>        }</div>
<div class="line"><span class="lineno"> 3638</span>        Zp[0] = ((bj - zj) * aj +</div>
<div class="line"><span class="lineno"> 3639</span>                 ((aj + delta1 * delta2 * (3 * bj * bj + 2 * bj)) +</div>
<div class="line"><span class="lineno"> 3640</span>                  ((delta1 + delta2) * (2 * bj + 1) - 2 * delta1 * delta2 * bj) * zj -</div>
<div class="line"><span class="lineno"> 3641</span>                  (delta1 + delta2 - 1) * zj * zj) *</div>
<div class="line"><span class="lineno"> 3642</span>                     bj) /</div>
<div class="line"><span class="lineno"> 3643</span>                P /</div>
<div class="line"><span class="lineno"> 3644</span>                (3 * zj * zj + 2 * ((delta1 + delta2 - 1) * bj - 1) * zj +</div>
<div class="line"><span class="lineno"> 3645</span>                 (aj + delta1 * delta2 * bj * bj - (delta1 + delta2) * bj * (bj + 1)));</div>
<div class="line"><span class="lineno"> 3646</span>        <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> = CgTP * nu[0] * (Zp[0] - zj / P);</div>
<div class="line"><span class="lineno"> 3647</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3648</span>        <span class="comment">// NP &gt; 1</span></div>
<div class="line"><span class="lineno"> 3649</span>        CalFugNAll();</div>
<div class="line"><span class="lineno"> 3650</span>        CalFugPAll();</div>
<div class="line"><span class="lineno"> 3651</span>        AssembleMatVfiVfp_full01();</div>
<div class="line"><span class="lineno"> 3652</span>        AssembleRhsVfiVfp_full01();</div>
<div class="line"><span class="lineno"> 3653</span>        <a class="code hl_function" href="DenseMat_8hpp.html#a53e50e45a55d95a5c3251a476b7e1173">LUSolve</a>(NC + 1, NC * NP, &amp;JmatDer[0], &amp;rhsDer[0], &amp;pivot[0]);</div>
<div class="line"><span class="lineno"> 3654</span>        <span class="comment">// Calculate Vfi</span></div>
<div class="line"><span class="lineno"> 3655</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* dnkjdNP = &amp;rhsDer[0];</div>
<div class="line"><span class="lineno"> 3656</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3657</span>            <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[i] = 0;</div>
<div class="line"><span class="lineno"> 3658</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 3659</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 3660</span>                    <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[i] += dnkjdNP[j * NC + k] * (Zj[j] + nu[j] * Zn[j][k]);</div>
<div class="line"><span class="lineno"> 3661</span>                }</div>
<div class="line"><span class="lineno"> 3662</span>            }</div>
<div class="line"><span class="lineno"> 3663</span>            <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[i] *= CgTP;</div>
<div class="line"><span class="lineno"> 3664</span>            dnkjdNP += NP * NC;</div>
<div class="line"><span class="lineno"> 3665</span>        }</div>
<div class="line"><span class="lineno"> 3666</span>        <span class="comment">// Calculate Vfp</span></div>
<div class="line"><span class="lineno"> 3667</span>        <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> = 0;</div>
<div class="line"><span class="lineno"> 3668</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 3669</span>            <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> += nu[j] / P * (Zp[j] * P - Zj[j]);</div>
<div class="line"><span class="lineno"> 3670</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 3671</span>                <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> += dnkjdNP[j * NC + k] * (Zj[j] + nu[j] * Zn[j][k]);</div>
<div class="line"><span class="lineno"> 3672</span>            }</div>
<div class="line"><span class="lineno"> 3673</span>        }</div>
<div class="line"><span class="lineno"> 3674</span>        <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> *= CgTP;</div>
<div class="line"><span class="lineno"> 3675</span>    }</div>
<div class="line"><span class="lineno"> 3676</span> </div>
<div class="line"><span class="lineno"> 3677</span> </div>
<div class="line"><span class="lineno"> 3678</span><span class="preprocessor">#ifdef OCP_NANCHECK</span></div>
<div class="line"><span class="lineno"> 3679</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="DenseMat_8hpp.html#a56bc3abd4d498e5055b3da3a58d45bad">CheckNan</a>(<a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>.size(), &amp;<a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[0])) {</div>
<div class="line"><span class="lineno"> 3680</span>        <a class="code hl_define" href="UtilError_8hpp.html#aecfc13af45c4bb869301d5ce54cba0af">OCP_ABORT</a>(<span class="stringliteral">&quot;INF or NAN in vfi !&quot;</span>);</div>
<div class="line"><span class="lineno"> 3681</span>    }</div>
<div class="line"><span class="lineno"> 3682</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="DenseMat_8hpp.html#a56bc3abd4d498e5055b3da3a58d45bad">CheckNan</a>(1, &amp;<a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a>)) {</div>
<div class="line"><span class="lineno"> 3683</span>        <a class="code hl_define" href="UtilError_8hpp.html#aecfc13af45c4bb869301d5ce54cba0af">OCP_ABORT</a>(<span class="stringliteral">&quot;INF or NAN in vfp !&quot;</span>);</div>
<div class="line"><span class="lineno"> 3684</span>    }</div>
<div class="line"><span class="lineno"> 3685</span><span class="preprocessor">#endif </span><span class="comment">// NANCHECK</span></div>
<div class="line"><span class="lineno"> 3686</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af60440b9460dc6b5869cad5073ee2f1e" name="af60440b9460dc6b5869cad5073ee2f1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af60440b9460dc6b5869cad5073ee2f1e">&#9670;&#160;</a></span>CalVfiVfp_full02()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalVfiVfp_full02 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l03746">3746</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3747</span>{</div>
<div class="line"><span class="lineno"> 3748</span>    <span class="comment">// Attention!</span></div>
<div class="line"><span class="lineno"> 3749</span>    <span class="comment">// NP = 1 or NP = 2</span></div>
<div class="line"><span class="lineno"> 3750</span> </div>
<div class="line"><span class="lineno"> 3751</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> CgTP = <a class="code hl_variable" href="OCPConst_8hpp.html#acf2d5c7d361941d6394ac1c9dc3e5628">GAS_CONSTANT</a> * T / P;</div>
<div class="line"><span class="lineno"> 3752</span> </div>
<div class="line"><span class="lineno"> 3753</span>    <span class="keywordflow">if</span> (NP == 1) {</div>
<div class="line"><span class="lineno"> 3754</span>        <span class="comment">// NP = 1</span></div>
<div class="line"><span class="lineno"> 3755</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&amp; aj = Aj[0];</div>
<div class="line"><span class="lineno"> 3756</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&amp; bj = Bj[0];</div>
<div class="line"><span class="lineno"> 3757</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&amp; zj = Zj[0];</div>
<div class="line"><span class="lineno"> 3758</span>        <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; xj = x[0];</div>
<div class="line"><span class="lineno"> 3759</span>        vector&lt;OCP_DBL&gt;&amp; Znij = Zn[0];</div>
<div class="line"><span class="lineno"> 3760</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>                tmp;</div>
<div class="line"><span class="lineno"> 3761</span> </div>
<div class="line"><span class="lineno"> 3762</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3763</span>            tmp = 0;</div>
<div class="line"><span class="lineno"> 3764</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 3765</span>                tmp += (1 - BIC[i * NC + m]) * sqrt(Ai[i] * Ai[m]) * xj[m];</div>
<div class="line"><span class="lineno"> 3766</span>            }</div>
<div class="line"><span class="lineno"> 3767</span>            An[i] = 2 / nu[0] * (tmp - aj);</div>
<div class="line"><span class="lineno"> 3768</span>            Bn[i] = 1 / nu[0] * (Bi[i] - bj);</div>
<div class="line"><span class="lineno"> 3769</span>            Znij[i] =</div>
<div class="line"><span class="lineno"> 3770</span>                ((bj - zj) * An[i] +</div>
<div class="line"><span class="lineno"> 3771</span>                    ((aj + delta1 * delta2 * (3 * bj * bj + 2 * bj)) +</div>
<div class="line"><span class="lineno"> 3772</span>                        ((delta1 + delta2) * (2 * bj + 1) - 2 * delta1 * delta2 * bj) * zj -</div>
<div class="line"><span class="lineno"> 3773</span>                        (delta1 + delta2 - 1) * zj * zj) *</div>
<div class="line"><span class="lineno"> 3774</span>                    Bn[i]) /</div>
<div class="line"><span class="lineno"> 3775</span>                (3 * zj * zj + 2 * ((delta1 + delta2 - 1) * bj - 1) * zj +</div>
<div class="line"><span class="lineno"> 3776</span>                    (aj + delta1 * delta2 * bj * bj - (delta1 + delta2) * bj * (bj + 1)));</div>
<div class="line"><span class="lineno"> 3777</span>            <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[i] = CgTP * (zj + nu[0] * Znij[i]);</div>
<div class="line"><span class="lineno"> 3778</span>        }</div>
<div class="line"><span class="lineno"> 3779</span>        Zp[0] = ((bj - zj) * aj +</div>
<div class="line"><span class="lineno"> 3780</span>            ((aj + delta1 * delta2 * (3 * bj * bj + 2 * bj)) +</div>
<div class="line"><span class="lineno"> 3781</span>                ((delta1 + delta2) * (2 * bj + 1) - 2 * delta1 * delta2 * bj) * zj -</div>
<div class="line"><span class="lineno"> 3782</span>                (delta1 + delta2 - 1) * zj * zj) *</div>
<div class="line"><span class="lineno"> 3783</span>            bj) /</div>
<div class="line"><span class="lineno"> 3784</span>            P /</div>
<div class="line"><span class="lineno"> 3785</span>            (3 * zj * zj + 2 * ((delta1 + delta2 - 1) * bj - 1) * zj +</div>
<div class="line"><span class="lineno"> 3786</span>                (aj + delta1 * delta2 * bj * bj - (delta1 + delta2) * bj * (bj + 1)));</div>
<div class="line"><span class="lineno"> 3787</span>        <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> = CgTP * nu[0] * (Zp[0] - zj / P);</div>
<div class="line"><span class="lineno"> 3788</span>    }</div>
<div class="line"><span class="lineno"> 3789</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3790</span>        <span class="comment">// NP = 2,  IF NP &gt; 2  -&gt;  WRONG!</span></div>
<div class="line"><span class="lineno"> 3791</span>        CalFugNAll();</div>
<div class="line"><span class="lineno"> 3792</span>        CalFugPAll();</div>
<div class="line"><span class="lineno"> 3793</span>        AssembleMatVfiVfp_full02();</div>
<div class="line"><span class="lineno"> 3794</span>        AssembleRhsVfiVfp_full02();</div>
<div class="line"><span class="lineno"> 3795</span>        <a class="code hl_function" href="DenseMat_8hpp.html#a53e50e45a55d95a5c3251a476b7e1173">LUSolve</a>(NC + 1, NC, &amp;JmatDer[0], &amp;rhsDer[0], &amp;pivot[0]);</div>
<div class="line"><span class="lineno"> 3796</span>        <span class="comment">// now d nm0 / dP(dNk) has been available</span></div>
<div class="line"><span class="lineno"> 3797</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* dnkjdNP = &amp;rhsDer[0];</div>
<div class="line"><span class="lineno"> 3798</span>        <span class="comment">// Calculate Vfp</span></div>
<div class="line"><span class="lineno"> 3799</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j0 = phaseLabel[0];</div>
<div class="line"><span class="lineno"> 3800</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1 = phaseLabel[1];</div>
<div class="line"><span class="lineno"> 3801</span>        <a class="code hl_variable" href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">vjp</a>[j0] = nu[0] * (Zp[0] - Zj[0] / P);</div>
<div class="line"><span class="lineno"> 3802</span>        <a class="code hl_variable" href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">vjp</a>[j1] = nu[1] * (Zp[1] - Zj[1] / P);</div>
<div class="line"><span class="lineno"> 3803</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 3804</span>            <a class="code hl_variable" href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">vjp</a>[j0] += (Zj[0] + nu[0] * Zn[0][k]) * dnkjdNP[k];</div>
<div class="line"><span class="lineno"> 3805</span>            <a class="code hl_variable" href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">vjp</a>[j1] -= (Zj[1] + nu[1] * Zn[1][k]) * dnkjdNP[k];</div>
<div class="line"><span class="lineno"> 3806</span>        }</div>
<div class="line"><span class="lineno"> 3807</span>        <a class="code hl_variable" href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">vjp</a>[j0] *= CgTP;</div>
<div class="line"><span class="lineno"> 3808</span>        <a class="code hl_variable" href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">vjp</a>[j1] *= CgTP;</div>
<div class="line"><span class="lineno"> 3809</span>        <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> = <a class="code hl_variable" href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">vjp</a>[j0] + <a class="code hl_variable" href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">vjp</a>[j1];</div>
<div class="line"><span class="lineno"> 3810</span>        dnkjdNP += NC;</div>
<div class="line"><span class="lineno"> 3811</span> </div>
<div class="line"><span class="lineno"> 3812</span>        <span class="comment">// Calculate Vfi </span></div>
<div class="line"><span class="lineno"> 3813</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3814</span>            <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[i] = 0;</div>
<div class="line"><span class="lineno"> 3815</span>            <a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[j0][i] = 0;</div>
<div class="line"><span class="lineno"> 3816</span>            <a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[j1][i] = 0;</div>
<div class="line"><span class="lineno"> 3817</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 3818</span>                <a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[j0][i] += (Zj[0] + nu[0] * Zn[0][k]) * dnkjdNP[k];</div>
<div class="line"><span class="lineno"> 3819</span>                <a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[j1][i] += (Zj[1] + nu[1] * Zn[1][k]) * (delta(i, k) - dnkjdNP[k]);</div>
<div class="line"><span class="lineno"> 3820</span>            }</div>
<div class="line"><span class="lineno"> 3821</span>            <a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[j0][i] *= CgTP;</div>
<div class="line"><span class="lineno"> 3822</span>            <a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[j1][i] *= CgTP;</div>
<div class="line"><span class="lineno"> 3823</span>            <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[i] = <a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[j0][i] + <a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[j1][i];</div>
<div class="line"><span class="lineno"> 3824</span>            dnkjdNP += NC;</div>
<div class="line"><span class="lineno"> 3825</span>        }</div>
<div class="line"><span class="lineno"> 3826</span>    }</div>
<div class="line"><span class="lineno"> 3827</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad3aaa2777134d609ce1199d47ed8a642" name="ad3aaa2777134d609ce1199d47ed8a642"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3aaa2777134d609ce1199d47ed8a642">&#9670;&#160;</a></span>CalVfiVfp_full03()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalVfiVfp_full03 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l04670">4670</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4671</span>{</div>
<div class="line"><span class="lineno"> 4672</span>    <span class="comment">// Call CaldXsdXpAPI03() before</span></div>
<div class="line"><span class="lineno"> 4673</span>    <span class="comment">// use dXsdXp: s = Sj,nij; p = P,Ni</span></div>
<div class="line"><span class="lineno"> 4674</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1;</div>
<div class="line"><span class="lineno"> 4675</span>    <span class="keywordflow">if</span> (NP == 1) {</div>
<div class="line"><span class="lineno"> 4676</span>        <span class="comment">// vfp = vfp; vfi = vji</span></div>
<div class="line"><span class="lineno"> 4677</span>        j1 = phaseLabel[0];</div>
<div class="line"><span class="lineno"> 4678</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 4679</span>            <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[i] = <a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[j1][i];</div>
<div class="line"><span class="lineno"> 4680</span>        }</div>
<div class="line"><span class="lineno"> 4681</span>    }</div>
<div class="line"><span class="lineno"> 4682</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4683</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> ncol = <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + 1;</div>
<div class="line"><span class="lineno"> 4684</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* nijPN = &amp;<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[(NP + 1) * ncol];</div>
<div class="line"><span class="lineno"> 4685</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; <a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a>-1; j++) {</div>
<div class="line"><span class="lineno"> 4686</span> </div>
<div class="line"><span class="lineno"> 4687</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">phaseExist</a>[j])  <span class="comment">// skip</span></div>
<div class="line"><span class="lineno"> 4688</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 4689</span> </div>
<div class="line"><span class="lineno"> 4690</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 4691</span>                <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> += <a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[j][i] * nijPN[0];</div>
<div class="line"><span class="lineno"> 4692</span>                nijPN++;</div>
<div class="line"><span class="lineno"> 4693</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 4694</span>                    <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[m] += <a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[j][i] * nijPN[m];</div>
<div class="line"><span class="lineno"> 4695</span>                }</div>
<div class="line"><span class="lineno"> 4696</span>                nijPN += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 4697</span>            }</div>
<div class="line"><span class="lineno"> 4698</span>            <span class="comment">// don&#39;t skip water, no water in dXsdXp here.</span></div>
<div class="line"><span class="lineno"> 4699</span>        }</div>
<div class="line"><span class="lineno"> 4700</span>    }</div>
<div class="line"><span class="lineno"> 4701</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7eb5d509caa1f2addcdc49458f6badd1" name="a7eb5d509caa1f2addcdc49458f6badd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eb5d509caa1f2addcdc49458f6badd1">&#9670;&#160;</a></span>CalVfXiRho()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalVfXiRho </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00864">864</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  865</span>{</div>
<div class="line"><span class="lineno">  866</span>    <span class="comment">// Attention that nu is moles of phase instead of molar fraction of phase now</span></div>
<div class="line"><span class="lineno">  867</span>    <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> = 0;</div>
<div class="line"><span class="lineno">  868</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp;</div>
<div class="line"><span class="lineno">  869</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno">  870</span> </div>
<div class="line"><span class="lineno">  871</span>        vector&lt;OCP_DBL&gt;&amp; xj = x[j];</div>
<div class="line"><span class="lineno">  872</span>        tmp                 = Zj[j] * <a class="code hl_variable" href="OCPConst_8hpp.html#acf2d5c7d361941d6394ac1c9dc3e5628">GAS_CONSTANT</a> * T / P;</div>
<div class="line"><span class="lineno">  873</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno">  874</span>            tmp -= xj[i] * Vshift[i];</div>
<div class="line"><span class="lineno">  875</span>        }</div>
<div class="line"><span class="lineno">  876</span>        vC[j] = tmp * nu[j];</div>
<div class="line"><span class="lineno">  877</span>        <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> += vC[j];</div>
<div class="line"><span class="lineno">  878</span>        xiC[j]  = 1 / tmp;</div>
<div class="line"><span class="lineno">  879</span>        rhoC[j] = MW[j] * xiC[j];</div>
<div class="line"><span class="lineno">  880</span>    }</div>
<div class="line"><span class="lineno">  881</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a390579d6774a59017d35cf5598d6fff9" name="a390579d6774a59017d35cf5598d6fff9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a390579d6774a59017d35cf5598d6fff9">&#9670;&#160;</a></span>CalViscoHZYT()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalViscoHZYT </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l02235">2235</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2235</span>{}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8284d308859a96e688dda9dd062eb01a" name="a8284d308859a96e688dda9dd062eb01a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8284d308859a96e688dda9dd062eb01a">&#9670;&#160;</a></span>CalViscoLBC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalViscoLBC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l02171">2171</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2172</span>{</div>
<div class="line"><span class="lineno"> 2173</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp;</div>
<div class="line"><span class="lineno"> 2174</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Tri;</div>
<div class="line"><span class="lineno"> 2175</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> xijT;</div>
<div class="line"><span class="lineno"> 2176</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> xijP;</div>
<div class="line"><span class="lineno"> 2177</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> xijV;</div>
<div class="line"><span class="lineno"> 2178</span> </div>
<div class="line"><span class="lineno"> 2179</span>    <span class="comment">// test</span></div>
<div class="line"><span class="lineno"> 2180</span>    <span class="comment">//T = 750;</span></div>
<div class="line"><span class="lineno"> 2181</span>    <span class="comment">//P = 4867.594;</span></div>
<div class="line"><span class="lineno"> 2182</span>    <span class="comment">//x[0][0] = 0.657538;</span></div>
<div class="line"><span class="lineno"> 2183</span>    <span class="comment">//x[0][1] = 0.014955;</span></div>
<div class="line"><span class="lineno"> 2184</span>    <span class="comment">//x[0][2] = 0.003126;</span></div>
<div class="line"><span class="lineno"> 2185</span>    <span class="comment">//x[0][3] = 0.008749;</span></div>
<div class="line"><span class="lineno"> 2186</span>    <span class="comment">//x[0][4] = 0.008200;</span></div>
<div class="line"><span class="lineno"> 2187</span>    <span class="comment">//x[0][5] = 0.017913;</span></div>
<div class="line"><span class="lineno"> 2188</span>    <span class="comment">//x[0][6] = 0.035430;</span></div>
<div class="line"><span class="lineno"> 2189</span>    <span class="comment">//x[0][7] = 0.254089;</span></div>
<div class="line"><span class="lineno"> 2190</span>    <span class="comment">//CalAiBi();</span></div>
<div class="line"><span class="lineno"> 2191</span>    <span class="comment">//CalAjBj(Aj[0], Bj[0], x[0]);</span></div>
<div class="line"><span class="lineno"> 2192</span>    <span class="comment">//SolEoS(Zj[0], Aj[0], Bj[0]);</span></div>
<div class="line"><span class="lineno"> 2193</span>    <span class="comment">//CalMW();</span></div>
<div class="line"><span class="lineno"> 2194</span>    <span class="comment">//CalVfXiRho();</span></div>
<div class="line"><span class="lineno"> 2195</span>    <span class="comment">//test</span></div>
<div class="line"><span class="lineno"> 2196</span> </div>
<div class="line"><span class="lineno"> 2197</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 2198</span>        <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; xj  = x[j];</div>
<div class="line"><span class="lineno"> 2199</span>        vector&lt;OCP_DBL&gt;&amp;       muA = muAux[j];</div>
<div class="line"><span class="lineno"> 2200</span>        fill(muA.begin(), muA.end(), 0.0);</div>
<div class="line"><span class="lineno"> 2201</span>        xijT = 0;</div>
<div class="line"><span class="lineno"> 2202</span>        xijP = 0;</div>
<div class="line"><span class="lineno"> 2203</span>        xijV = 0;</div>
<div class="line"><span class="lineno"> 2204</span> </div>
<div class="line"><span class="lineno"> 2205</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 2206</span>            tmp = 5.4402 * pow(Tc[i], 1.0 / 6) / sqrt(MW[j]) / pow(Pc[i], 2.0 / 3);</div>
<div class="line"><span class="lineno"> 2207</span>            <span class="comment">// tmp = muAux1I[i] / sqrt(MW[j]);</span></div>
<div class="line"><span class="lineno"> 2208</span>            Tri = T / Tc[i];</div>
<div class="line"><span class="lineno"> 2209</span>            <span class="keywordflow">if</span> (Tri &lt;= 1.5) {</div>
<div class="line"><span class="lineno"> 2210</span>                tmp = 34 * 1E-5 * pow(Tri, 0.94) / tmp;</div>
<div class="line"><span class="lineno"> 2211</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2212</span>                tmp = 17.78 * 1E-5 * pow((4.58 * Tri - 1.67), 0.625) / tmp;</div>
<div class="line"><span class="lineno"> 2213</span>            }</div>
<div class="line"><span class="lineno"> 2214</span>            muA[0] += xj[i] * sqrt(MWC[i]) * tmp;</div>
<div class="line"><span class="lineno"> 2215</span>            muA[1] += xj[i] * sqrt(MWC[i]);</div>
<div class="line"><span class="lineno"> 2216</span>            xijT += xj[i] * Tc[i];</div>
<div class="line"><span class="lineno"> 2217</span>            xijP += xj[i] * Pc[i];</div>
<div class="line"><span class="lineno"> 2218</span>            xijV += xj[i] * Vcvis[i];</div>
<div class="line"><span class="lineno"> 2219</span>        }</div>
<div class="line"><span class="lineno"> 2220</span>        muA[2] = 5.4402 * pow(xijT, 1.0 / 6) / sqrt(MW[j]) / pow(xijP, 2.0 / 3);</div>
<div class="line"><span class="lineno"> 2221</span>        muA[3] = xiC[j] * xijV;</div>
<div class="line"><span class="lineno"> 2222</span> </div>
<div class="line"><span class="lineno"> 2223</span>        <span class="keywordflow">if</span> (muA[3] &lt;= 0.18 &amp;&amp; <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 2224</span>            muC[j] = muA[0] / muA[1] + 2.05 * 1E-4 * muA[3] / muA[2];</div>
<div class="line"><span class="lineno"> 2225</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2226</span>            muA[4] = muA[3] * (muA[3] * (muA[3] * (LBCcoef[4] * muA[3] + LBCcoef[3]) +</div>
<div class="line"><span class="lineno"> 2227</span>                                         LBCcoef[2]) +</div>
<div class="line"><span class="lineno"> 2228</span>                               LBCcoef[1]) +</div>
<div class="line"><span class="lineno"> 2229</span>                     LBCcoef[0];</div>
<div class="line"><span class="lineno"> 2230</span>            muC[j] = muA[0] / muA[1] + 1E-4 * (pow(muA[4], 4) - 1) / muA[2];</div>
<div class="line"><span class="lineno"> 2231</span>        }</div>
<div class="line"><span class="lineno"> 2232</span>    }</div>
<div class="line"><span class="lineno"> 2233</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0afbf9d388e1cb3c083425241d544c1e" name="a0afbf9d388e1cb3c083425241d544c1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0afbf9d388e1cb3c083425241d544c1e">&#9670;&#160;</a></span>CalViscosity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalViscosity </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l02169">2169</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2169</span>{ CalViscoLBC(); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab263d25ffebf757a675a0c5f1618d8eb" name="ab263d25ffebf757a675a0c5f1618d8eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab263d25ffebf757a675a0c5f1618d8eb">&#9670;&#160;</a></span>CalVjpVfpVfn_partial()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalVjpVfpVfn_partial </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l02372">2372</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2373</span>{</div>
<div class="line"><span class="lineno"> 2374</span>    <span class="comment">// Vfi = 0</span></div>
<div class="line"><span class="lineno"> 2375</span>    <span class="comment">// Vjp, Vfp</span></div>
<div class="line"><span class="lineno"> 2376</span>    <span class="comment">// Vjn(dVj / dnij) in Vji</span></div>
<div class="line"><span class="lineno"> 2377</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> CgTP = <a class="code hl_variable" href="OCPConst_8hpp.html#acf2d5c7d361941d6394ac1c9dc3e5628">GAS_CONSTANT</a> * T / P;</div>
<div class="line"><span class="lineno"> 2378</span>    fill(<a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>.begin(), <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>.end(), 0.0);</div>
<div class="line"><span class="lineno"> 2379</span>    <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> = 0;</div>
<div class="line"><span class="lineno"> 2380</span>    </div>
<div class="line"><span class="lineno"> 2381</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 2382</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&amp; aj = Aj[j];</div>
<div class="line"><span class="lineno"> 2383</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&amp; bj = Bj[j];</div>
<div class="line"><span class="lineno"> 2384</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&amp; zj = Zj[j];</div>
<div class="line"><span class="lineno"> 2385</span>        <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; xj = x[j];</div>
<div class="line"><span class="lineno"> 2386</span>        vector&lt;OCP_DBL&gt;&amp; Znj = Zn[j];</div>
<div class="line"><span class="lineno"> 2387</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>                tmp;</div>
<div class="line"><span class="lineno"> 2388</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1 = phaseLabel[j];</div>
<div class="line"><span class="lineno"> 2389</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 2390</span>            tmp = 0;</div>
<div class="line"><span class="lineno"> 2391</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 2392</span>                tmp += (1 - BIC[i * NC + m]) * sqrt(Ai[i] * Ai[m]) * xj[m];</div>
<div class="line"><span class="lineno"> 2393</span>            }</div>
<div class="line"><span class="lineno"> 2394</span>            An[i] = 2 / nu[j] * (tmp - aj);</div>
<div class="line"><span class="lineno"> 2395</span>            Bn[i] = 1 / nu[j] * (Bi[i] - bj);</div>
<div class="line"><span class="lineno"> 2396</span>            Znj[i] =</div>
<div class="line"><span class="lineno"> 2397</span>                ((bj - zj) * An[i] +</div>
<div class="line"><span class="lineno"> 2398</span>                    ((aj + delta1 * delta2 * (3 * bj * bj + 2 * bj)) +</div>
<div class="line"><span class="lineno"> 2399</span>                        ((delta1 + delta2) * (2 * bj + 1) - 2 * delta1 * delta2 * bj) * zj -</div>
<div class="line"><span class="lineno"> 2400</span>                        (delta1 + delta2 - 1) * zj * zj) *</div>
<div class="line"><span class="lineno"> 2401</span>                    Bn[i]) /</div>
<div class="line"><span class="lineno"> 2402</span>                (3 * zj * zj + 2 * ((delta1 + delta2 - 1) * bj - 1) * zj +</div>
<div class="line"><span class="lineno"> 2403</span>                    (aj + delta1 * delta2 * bj * bj - (delta1 + delta2) * bj * (bj + 1)));</div>
<div class="line"><span class="lineno"> 2404</span>            <a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[j1][i] = CgTP * (zj + nu[j] * Znj[i]);</div>
<div class="line"><span class="lineno"> 2405</span>        }</div>
<div class="line"><span class="lineno"> 2406</span>        Zp[j] = ((bj - zj) * aj +</div>
<div class="line"><span class="lineno"> 2407</span>            ((aj + delta1 * delta2 * (3 * bj * bj + 2 * bj)) +</div>
<div class="line"><span class="lineno"> 2408</span>                ((delta1 + delta2) * (2 * bj + 1) - 2 * delta1 * delta2 * bj) * zj -</div>
<div class="line"><span class="lineno"> 2409</span>                (delta1 + delta2 - 1) * zj * zj) *</div>
<div class="line"><span class="lineno"> 2410</span>            bj) /</div>
<div class="line"><span class="lineno"> 2411</span>            P /</div>
<div class="line"><span class="lineno"> 2412</span>            (3 * zj * zj + 2 * ((delta1 + delta2 - 1) * bj - 1) * zj +</div>
<div class="line"><span class="lineno"> 2413</span>                (aj + delta1 * delta2 * bj * bj - (delta1 + delta2) * bj * (bj + 1)));</div>
<div class="line"><span class="lineno"> 2414</span>        <a class="code hl_variable" href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">vjp</a>[j1] = CgTP * nu[j] * (Zp[j] - zj / P);</div>
<div class="line"><span class="lineno"> 2415</span>        <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> += <a class="code hl_variable" href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">vjp</a>[j1];</div>
<div class="line"><span class="lineno"> 2416</span>    }</div>
<div class="line"><span class="lineno"> 2417</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a92eb12c7dea79d828ca9509e3b74dad9" name="a92eb12c7dea79d828ca9509e3b74dad9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92eb12c7dea79d828ca9509e3b74dad9">&#9670;&#160;</a></span>CalVjpVfpVfx_partial()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalVjpVfpVfx_partial </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l02564">2564</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2565</span>{</div>
<div class="line"><span class="lineno"> 2566</span>    <span class="comment">// Wrong Now !</span></div>
<div class="line"><span class="lineno"> 2567</span> </div>
<div class="line"><span class="lineno"> 2568</span>    <span class="comment">// Vfi = 0</span></div>
<div class="line"><span class="lineno"> 2569</span>    <span class="comment">// Vjp, Vfp</span></div>
<div class="line"><span class="lineno"> 2570</span>    <span class="comment">// Vjn(dVj / dxij) in Vji</span></div>
<div class="line"><span class="lineno"> 2571</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> CgTP = <a class="code hl_variable" href="OCPConst_8hpp.html#acf2d5c7d361941d6394ac1c9dc3e5628">GAS_CONSTANT</a> * T / P;</div>
<div class="line"><span class="lineno"> 2572</span>    fill(<a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>.begin(), <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>.end(), 0.0);</div>
<div class="line"><span class="lineno"> 2573</span>    <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> = 0;</div>
<div class="line"><span class="lineno"> 2574</span> </div>
<div class="line"><span class="lineno"> 2575</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 2576</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1 = phaseLabel[j];</div>
<div class="line"><span class="lineno"> 2577</span>        <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; xj = x[j];</div>
<div class="line"><span class="lineno"> 2578</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>    aj = Aj[j];</div>
<div class="line"><span class="lineno"> 2579</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>    bj = Bj[j];</div>
<div class="line"><span class="lineno"> 2580</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>    zj = Zj[j];</div>
<div class="line"><span class="lineno"> 2581</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>    tmp = 0;</div>
<div class="line"><span class="lineno"> 2582</span> </div>
<div class="line"><span class="lineno"> 2583</span>        Bx = Bi;</div>
<div class="line"><span class="lineno"> 2584</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 2585</span>            tmp = 0;</div>
<div class="line"><span class="lineno"> 2586</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 2587</span>                tmp += xj[k] * (1 - BIC[i * NC + k]) * sqrt(Ai[i] * Ai[k]);</div>
<div class="line"><span class="lineno"> 2588</span>            }</div>
<div class="line"><span class="lineno"> 2589</span>            Ax[i] = 2 * tmp;</div>
<div class="line"><span class="lineno"> 2590</span>            Zx[i] =</div>
<div class="line"><span class="lineno"> 2591</span>                ((bj - zj) * Ax[i] +</div>
<div class="line"><span class="lineno"> 2592</span>                    ((aj + delta1 * delta2 * (3 * bj * bj + 2 * bj)) +</div>
<div class="line"><span class="lineno"> 2593</span>                        ((delta1 + delta2) * (2 * bj + 1) - 2 * delta1 * delta2 * bj) * zj -</div>
<div class="line"><span class="lineno"> 2594</span>                        (delta1 + delta2 - 1) * zj * zj) *</div>
<div class="line"><span class="lineno"> 2595</span>                    Bx[i]) /</div>
<div class="line"><span class="lineno"> 2596</span>                (3 * zj * zj + 2 * ((delta1 + delta2 - 1) * bj - 1) * zj +</div>
<div class="line"><span class="lineno"> 2597</span>                    (aj + delta1 * delta2 * bj * bj - (delta1 + delta2) * bj * (bj + 1)));</div>
<div class="line"><span class="lineno"> 2598</span>            </div>
<div class="line"><span class="lineno"> 2599</span>            <a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[j1][i] = CgTP * nu[j] * Zx[i];</div>
<div class="line"><span class="lineno"> 2600</span>        }           </div>
<div class="line"><span class="lineno"> 2601</span>        Zp[j] = ((bj - zj) * aj +</div>
<div class="line"><span class="lineno"> 2602</span>            ((aj + delta1 * delta2 * (3 * bj * bj + 2 * bj)) +</div>
<div class="line"><span class="lineno"> 2603</span>                ((delta1 + delta2) * (2 * bj + 1) - 2 * delta1 * delta2 * bj) * zj -</div>
<div class="line"><span class="lineno"> 2604</span>                (delta1 + delta2 - 1) * zj * zj) *</div>
<div class="line"><span class="lineno"> 2605</span>            bj) /</div>
<div class="line"><span class="lineno"> 2606</span>            P /</div>
<div class="line"><span class="lineno"> 2607</span>            (3 * zj * zj + 2 * ((delta1 + delta2 - 1) * bj - 1) * zj +</div>
<div class="line"><span class="lineno"> 2608</span>                (aj + delta1 * delta2 * bj * bj - (delta1 + delta2) * bj * (bj + 1)));</div>
<div class="line"><span class="lineno"> 2609</span>        <a class="code hl_variable" href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">vjp</a>[j1] = CgTP * nu[j] * (Zp[j] - zj / P);</div>
<div class="line"><span class="lineno"> 2610</span>        <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> += <a class="code hl_variable" href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">vjp</a>[j1];</div>
<div class="line"><span class="lineno"> 2611</span>    }</div>
<div class="line"><span class="lineno"> 2612</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b13597e186e95f3a6d04e9ec66c5be4" name="a5b13597e186e95f3a6d04e9ec66c5be4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b13597e186e95f3a6d04e9ec66c5be4">&#9670;&#160;</a></span>CalXiPn_partial()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalXiPn_partial </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l02420">2420</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2421</span>{</div>
<div class="line"><span class="lineno"> 2422</span>    <span class="comment">// xiN = 0</span></div>
<div class="line"><span class="lineno"> 2423</span>    <span class="comment">// xiP</span></div>
<div class="line"><span class="lineno"> 2424</span>    <span class="comment">// xin(dxi_j / d nij) in xix</span></div>
<div class="line"><span class="lineno"> 2425</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> CgTP = <a class="code hl_variable" href="OCPConst_8hpp.html#acf2d5c7d361941d6394ac1c9dc3e5628">GAS_CONSTANT</a> * T / P;</div>
<div class="line"><span class="lineno"> 2426</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp;</div>
<div class="line"><span class="lineno"> 2427</span>    fill(<a class="code hl_variable" href="classMixture.html#a3476f1a61b94f0b58c00a90643e1861a">xiN</a>.begin(), <a class="code hl_variable" href="classMixture.html#a3476f1a61b94f0b58c00a90643e1861a">xiN</a>.end() - <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>, 0.0);</div>
<div class="line"><span class="lineno"> 2428</span> </div>
<div class="line"><span class="lineno"> 2429</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 2430</span>        <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; xj = x[j];</div>
<div class="line"><span class="lineno"> 2431</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>                aj = Aj[j];</div>
<div class="line"><span class="lineno"> 2432</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>                bj = Bj[j];</div>
<div class="line"><span class="lineno"> 2433</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>                zj = Zj[j];</div>
<div class="line"><span class="lineno"> 2434</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1 = phaseLabel[j];</div>
<div class="line"><span class="lineno"> 2435</span> </div>
<div class="line"><span class="lineno"> 2436</span>        tmp = -<a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j1] * <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j1] * CgTP;</div>
<div class="line"><span class="lineno"> 2437</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 2438</span>            <a class="code hl_variable" href="classMixture.html#a3f517560e2ec30f08afca9f6dc3ff71c">xix</a>[j1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + i] = tmp * Zn[j][i];</div>
<div class="line"><span class="lineno"> 2439</span>        }</div>
<div class="line"><span class="lineno"> 2440</span>        <a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[j1] = tmp * (Zp[j] - Zj[j] / P);</div>
<div class="line"><span class="lineno"> 2441</span>    }</div>
<div class="line"><span class="lineno"> 2442</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1c26de0e39d9d43eec4802584716949c" name="a1c26de0e39d9d43eec4802584716949c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c26de0e39d9d43eec4802584716949c">&#9670;&#160;</a></span>CalXiPNX_full01()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalXiPNX_full01 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l03035">3035</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3036</span>{</div>
<div class="line"><span class="lineno"> 3037</span>    <span class="comment">// call CalVfiVfp_full01() before, use rhsDer</span></div>
<div class="line"><span class="lineno"> 3038</span>    <span class="comment">// Calculate xiPC, xiNC, xixC</span></div>
<div class="line"><span class="lineno"> 3039</span>    <span class="comment">// Calculate xixC first</span></div>
<div class="line"><span class="lineno"> 3040</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> CgTP = <a class="code hl_variable" href="OCPConst_8hpp.html#acf2d5c7d361941d6394ac1c9dc3e5628">GAS_CONSTANT</a> * T / P;</div>
<div class="line"><span class="lineno"> 3041</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp;</div>
<div class="line"><span class="lineno"> 3042</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 3043</span>        <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; xj = x[j];</div>
<div class="line"><span class="lineno"> 3044</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>                aj = Aj[j];</div>
<div class="line"><span class="lineno"> 3045</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>                bj = Bj[j];</div>
<div class="line"><span class="lineno"> 3046</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>                zj = Zj[j];</div>
<div class="line"><span class="lineno"> 3047</span> </div>
<div class="line"><span class="lineno"> 3048</span>        Bx = Bi;</div>
<div class="line"><span class="lineno"> 3049</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3050</span>            tmp = 0;</div>
<div class="line"><span class="lineno"> 3051</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 3052</span>                tmp += xj[k] * (1 - BIC[i * NC + k]) * sqrt(Ai[i] * Ai[k]);</div>
<div class="line"><span class="lineno"> 3053</span>            }</div>
<div class="line"><span class="lineno"> 3054</span>            Ax[i] = 2 * tmp;</div>
<div class="line"><span class="lineno"> 3055</span>            Zx[i] =</div>
<div class="line"><span class="lineno"> 3056</span>                ((bj - zj) * Ax[i] +</div>
<div class="line"><span class="lineno"> 3057</span>                 ((aj + delta1 * delta2 * (3 * bj * bj + 2 * bj)) +</div>
<div class="line"><span class="lineno"> 3058</span>                  ((delta1 + delta2) * (2 * bj + 1) - 2 * delta1 * delta2 * bj) * zj -</div>
<div class="line"><span class="lineno"> 3059</span>                  (delta1 + delta2 - 1) * zj * zj) *</div>
<div class="line"><span class="lineno"> 3060</span>                     Bx[i]) /</div>
<div class="line"><span class="lineno"> 3061</span>                (3 * zj * zj + 2 * ((delta1 + delta2 - 1) * bj - 1) * zj +</div>
<div class="line"><span class="lineno"> 3062</span>                 (aj + delta1 * delta2 * bj * bj - (delta1 + delta2) * bj * (bj + 1)));</div>
<div class="line"><span class="lineno"> 3063</span>        }</div>
<div class="line"><span class="lineno"> 3064</span> </div>
<div class="line"><span class="lineno"> 3065</span>        tmp           = -xiC[j] * xiC[j] * CgTP;</div>
<div class="line"><span class="lineno"> 3066</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3067</span>            xixC[j * NC + i] = tmp * Zx[i];</div>
<div class="line"><span class="lineno"> 3068</span>        }</div>
<div class="line"><span class="lineno"> 3069</span>    }</div>
<div class="line"><span class="lineno"> 3070</span>    <span class="comment">// Calculate xiPC and xiNC</span></div>
<div class="line"><span class="lineno"> 3071</span>    <span class="keywordflow">if</span> (NP == 1) {</div>
<div class="line"><span class="lineno"> 3072</span>        <span class="comment">// NP = 1</span></div>
<div class="line"><span class="lineno"> 3073</span>        tmp     = -xiC[0] * xiC[0] * CgTP;</div>
<div class="line"><span class="lineno"> 3074</span>        xiPC[0] = tmp * (Zp[0] - Zj[0] / P);</div>
<div class="line"><span class="lineno"> 3075</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3076</span>            xiNC[i] = tmp * Zn[0][i];</div>
<div class="line"><span class="lineno"> 3077</span>        }</div>
<div class="line"><span class="lineno"> 3078</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3079</span>        <span class="comment">// NP &gt; 1</span></div>
<div class="line"><span class="lineno"> 3080</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* dnkjdNP = &amp;rhsDer[0];</div>
<div class="line"><span class="lineno"> 3081</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>        dertmp;</div>
<div class="line"><span class="lineno"> 3082</span> </div>
<div class="line"><span class="lineno"> 3083</span>        <span class="comment">// Calculate xiNC</span></div>
<div class="line"><span class="lineno"> 3084</span>        <span class="comment">// Now dnkjdNP reach to dnkj / dNi after CalVfiVfp_full01</span></div>
<div class="line"><span class="lineno"> 3085</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3086</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 3087</span> </div>
<div class="line"><span class="lineno"> 3088</span>                dertmp                     = 0;</div>
<div class="line"><span class="lineno"> 3089</span>                tmp                        = -xiC[j] * xiC[j] * CgTP;</div>
<div class="line"><span class="lineno"> 3090</span>                <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; Znj = Zn[j];</div>
<div class="line"><span class="lineno"> 3091</span> </div>
<div class="line"><span class="lineno"> 3092</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 3093</span>                    dertmp += Znj[k] * dnkjdNP[k];</div>
<div class="line"><span class="lineno"> 3094</span>                }</div>
<div class="line"><span class="lineno"> 3095</span>                xiNC[j * NC + i] = tmp * dertmp;</div>
<div class="line"><span class="lineno"> 3096</span>                dnkjdNP += NC;</div>
<div class="line"><span class="lineno"> 3097</span>            }</div>
<div class="line"><span class="lineno"> 3098</span>        }</div>
<div class="line"><span class="lineno"> 3099</span>        <span class="comment">// Calculate xiPC</span></div>
<div class="line"><span class="lineno"> 3100</span>        <span class="comment">// Now dnkjdNP reach to dnkj / dP</span></div>
<div class="line"><span class="lineno"> 3101</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 3102</span>            tmp                        = -xiC[j] * xiC[j] * CgTP;</div>
<div class="line"><span class="lineno"> 3103</span>            xiPC[j]                    = Zp[j] - Zj[j] / P;</div>
<div class="line"><span class="lineno"> 3104</span>            <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; Znj = Zn[j];</div>
<div class="line"><span class="lineno"> 3105</span> </div>
<div class="line"><span class="lineno"> 3106</span>            <span class="comment">// in OCP</span></div>
<div class="line"><span class="lineno"> 3107</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 3108</span>                xiPC[j] += Znj[k] * dnkjdNP[k];</div>
<div class="line"><span class="lineno"> 3109</span>            }</div>
<div class="line"><span class="lineno"> 3110</span>            dnkjdNP += NC;</div>
<div class="line"><span class="lineno"> 3111</span>            xiPC[j] *= tmp;</div>
<div class="line"><span class="lineno"> 3112</span>        }</div>
<div class="line"><span class="lineno"> 3113</span>    }</div>
<div class="line"><span class="lineno"> 3114</span> </div>
<div class="line"><span class="lineno"> 3115</span> </div>
<div class="line"><span class="lineno"> 3116</span>    <span class="comment">// Copoy to xiP, xix, xiN</span></div>
<div class="line"><span class="lineno"> 3117</span>    <span class="comment">//fill(xiP.begin(), xiP.end(), 0.0);</span></div>
<div class="line"><span class="lineno"> 3118</span>    <span class="comment">//fill(xix.begin(), xix.end(), 0.0);</span></div>
<div class="line"><span class="lineno"> 3119</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1;</div>
<div class="line"><span class="lineno"> 3120</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 3121</span>        j1      = phaseLabel[j];</div>
<div class="line"><span class="lineno"> 3122</span>        <a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[j1] = xiPC[j];</div>
<div class="line"><span class="lineno"> 3123</span>        <a class="code hl_function" href="DenseMat_8hpp.html#ae3d6d69eb9175bc2ed3414c44bde7a8d">Dcopy</a>(NC, &amp;<a class="code hl_variable" href="classMixture.html#a3476f1a61b94f0b58c00a90643e1861a">xiN</a>[j1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>], &amp;xiNC[j * NC]);</div>
<div class="line"><span class="lineno"> 3124</span>        <a class="code hl_function" href="DenseMat_8hpp.html#ae3d6d69eb9175bc2ed3414c44bde7a8d">Dcopy</a>(NC, &amp;<a class="code hl_variable" href="classMixture.html#a3f517560e2ec30f08afca9f6dc3ff71c">xix</a>[j1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>], &amp;xixC[j * NC]);</div>
<div class="line"><span class="lineno"> 3125</span>    }</div>
<div class="line"><span class="lineno"> 3126</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae61259c59afd5f6ef26031effd4edde9" name="ae61259c59afd5f6ef26031effd4edde9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae61259c59afd5f6ef26031effd4edde9">&#9670;&#160;</a></span>CalXiPNX_full02()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalXiPNX_full02 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l03128">3128</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3129</span>{</div>
<div class="line"><span class="lineno"> 3130</span>    <span class="comment">// Attention!</span></div>
<div class="line"><span class="lineno"> 3131</span>    <span class="comment">// NP = 1 or NP = 2</span></div>
<div class="line"><span class="lineno"> 3132</span>    </div>
<div class="line"><span class="lineno"> 3133</span>    <span class="comment">// Call CalVfiVfp_full02() before, use rhsder</span></div>
<div class="line"><span class="lineno"> 3134</span>    <span class="comment">// Calculate xiPC, xiNC, xixC</span></div>
<div class="line"><span class="lineno"> 3135</span>    <span class="comment">// Calculate xixC first</span></div>
<div class="line"><span class="lineno"> 3136</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> CgTP = <a class="code hl_variable" href="OCPConst_8hpp.html#acf2d5c7d361941d6394ac1c9dc3e5628">GAS_CONSTANT</a> * T / P;</div>
<div class="line"><span class="lineno"> 3137</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp;</div>
<div class="line"><span class="lineno"> 3138</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 3139</span>        <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; xj = x[j];</div>
<div class="line"><span class="lineno"> 3140</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>                aj = Aj[j];</div>
<div class="line"><span class="lineno"> 3141</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>                bj = Bj[j];</div>
<div class="line"><span class="lineno"> 3142</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>                zj = Zj[j];</div>
<div class="line"><span class="lineno"> 3143</span> </div>
<div class="line"><span class="lineno"> 3144</span>        Bx = Bi;</div>
<div class="line"><span class="lineno"> 3145</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3146</span>            tmp = 0;</div>
<div class="line"><span class="lineno"> 3147</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 3148</span>                tmp += xj[k] * (1 - BIC[i * NC + k]) * sqrt(Ai[i] * Ai[k]);</div>
<div class="line"><span class="lineno"> 3149</span>            }</div>
<div class="line"><span class="lineno"> 3150</span>            Ax[i] = 2 * tmp;</div>
<div class="line"><span class="lineno"> 3151</span>            Zx[i] =</div>
<div class="line"><span class="lineno"> 3152</span>                ((bj - zj) * Ax[i] +</div>
<div class="line"><span class="lineno"> 3153</span>                    ((aj + delta1 * delta2 * (3 * bj * bj + 2 * bj)) +</div>
<div class="line"><span class="lineno"> 3154</span>                        ((delta1 + delta2) * (2 * bj + 1) - 2 * delta1 * delta2 * bj) * zj -</div>
<div class="line"><span class="lineno"> 3155</span>                        (delta1 + delta2 - 1) * zj * zj) *</div>
<div class="line"><span class="lineno"> 3156</span>                    Bx[i]) /</div>
<div class="line"><span class="lineno"> 3157</span>                (3 * zj * zj + 2 * ((delta1 + delta2 - 1) * bj - 1) * zj +</div>
<div class="line"><span class="lineno"> 3158</span>                    (aj + delta1 * delta2 * bj * bj - (delta1 + delta2) * bj * (bj + 1)));</div>
<div class="line"><span class="lineno"> 3159</span>        }</div>
<div class="line"><span class="lineno"> 3160</span> </div>
<div class="line"><span class="lineno"> 3161</span>        tmp = -xiC[j] * xiC[j] * CgTP;</div>
<div class="line"><span class="lineno"> 3162</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3163</span>            xixC[j * NC + i] = tmp * Zx[i];</div>
<div class="line"><span class="lineno"> 3164</span>        }</div>
<div class="line"><span class="lineno"> 3165</span>    }</div>
<div class="line"><span class="lineno"> 3166</span> </div>
<div class="line"><span class="lineno"> 3167</span>    <span class="comment">// Calculate xiPC and xiNC</span></div>
<div class="line"><span class="lineno"> 3168</span>    <span class="keywordflow">if</span> (NP == 1) {</div>
<div class="line"><span class="lineno"> 3169</span>        <span class="comment">// NP = 1</span></div>
<div class="line"><span class="lineno"> 3170</span>        tmp = -xiC[0] * xiC[0] * CgTP;</div>
<div class="line"><span class="lineno"> 3171</span>        xiPC[0] = tmp * (Zp[0] - Zj[0] / P);</div>
<div class="line"><span class="lineno"> 3172</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3173</span>            xiNC[i] = tmp * Zn[0][i];</div>
<div class="line"><span class="lineno"> 3174</span>        }</div>
<div class="line"><span class="lineno"> 3175</span>    }</div>
<div class="line"><span class="lineno"> 3176</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3177</span>        <span class="comment">// NP = 2</span></div>
<div class="line"><span class="lineno"> 3178</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* nijPN = &amp;rhsDer[0];</div>
<div class="line"><span class="lineno"> 3179</span>        <span class="comment">// Calculate xiPC</span></div>
<div class="line"><span class="lineno"> 3180</span>        xiPC[0] = (Zp[0] - Zj[0] / P);</div>
<div class="line"><span class="lineno"> 3181</span>        xiPC[1] = (Zp[1] - Zj[1] / P);</div>
<div class="line"><span class="lineno"> 3182</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3183</span>            xiPC[0] += Zn[0][i] * nijPN[i];</div>
<div class="line"><span class="lineno"> 3184</span>            xiPC[1] -= Zn[1][i] * nijPN[i];</div>
<div class="line"><span class="lineno"> 3185</span>        }</div>
<div class="line"><span class="lineno"> 3186</span>        nijPN += NC;</div>
<div class="line"><span class="lineno"> 3187</span>        xiPC[0] *= -xiC[0] * xiC[0] * CgTP;</div>
<div class="line"><span class="lineno"> 3188</span>        xiPC[1] *= -xiC[1] * xiC[1] * CgTP;</div>
<div class="line"><span class="lineno"> 3189</span>        <span class="comment">// Calculate xiNC</span></div>
<div class="line"><span class="lineno"> 3190</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp0 = -xiC[0] * xiC[0] * CgTP;</div>
<div class="line"><span class="lineno"> 3191</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp1 = -xiC[1] * xiC[1] * CgTP;</div>
<div class="line"><span class="lineno"> 3192</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3193</span>            xiNC[i] = 0;</div>
<div class="line"><span class="lineno"> 3194</span>            xiNC[NC + i] = 0;</div>
<div class="line"><span class="lineno"> 3195</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 3196</span>                xiNC[i] += Zn[0][k] * nijPN[k];</div>
<div class="line"><span class="lineno"> 3197</span>                xiNC[NC + i] -= Zn[1][k] * nijPN[k];</div>
<div class="line"><span class="lineno"> 3198</span>            }</div>
<div class="line"><span class="lineno"> 3199</span>            xiNC[NC + i] += Zn[1][i];</div>
<div class="line"><span class="lineno"> 3200</span>            nijPN += NC;</div>
<div class="line"><span class="lineno"> 3201</span>            xiNC[i] *= tmp0;</div>
<div class="line"><span class="lineno"> 3202</span>            xiNC[NC + i] *= tmp1;</div>
<div class="line"><span class="lineno"> 3203</span>        }</div>
<div class="line"><span class="lineno"> 3204</span>    }</div>
<div class="line"><span class="lineno"> 3205</span> </div>
<div class="line"><span class="lineno"> 3206</span>    <span class="comment">// Copoy to xiP, xix, xiN</span></div>
<div class="line"><span class="lineno"> 3207</span>    <span class="comment">//fill(xiP.begin(), xiP.end(), 0.0);</span></div>
<div class="line"><span class="lineno"> 3208</span>    <span class="comment">//fill(xix.begin(), xix.end(), 0.0);</span></div>
<div class="line"><span class="lineno"> 3209</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1;</div>
<div class="line"><span class="lineno"> 3210</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 3211</span>        j1 = phaseLabel[j];</div>
<div class="line"><span class="lineno"> 3212</span>        <a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[j1] = xiPC[j];</div>
<div class="line"><span class="lineno"> 3213</span>        <a class="code hl_function" href="DenseMat_8hpp.html#ae3d6d69eb9175bc2ed3414c44bde7a8d">Dcopy</a>(NC, &amp;<a class="code hl_variable" href="classMixture.html#a3476f1a61b94f0b58c00a90643e1861a">xiN</a>[j1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>], &amp;xiNC[j * NC]);</div>
<div class="line"><span class="lineno"> 3214</span>        <a class="code hl_function" href="DenseMat_8hpp.html#ae3d6d69eb9175bc2ed3414c44bde7a8d">Dcopy</a>(NC, &amp;<a class="code hl_variable" href="classMixture.html#a3f517560e2ec30f08afca9f6dc3ff71c">xix</a>[j1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>], &amp;xixC[j * NC]);</div>
<div class="line"><span class="lineno"> 3215</span>    }</div>
<div class="line"><span class="lineno"> 3216</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aede2f5ff82886ab8c4eaa50cae38db58" name="aede2f5ff82886ab8c4eaa50cae38db58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aede2f5ff82886ab8c4eaa50cae38db58">&#9670;&#160;</a></span>CalXiPNX_partial()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalXiPNX_partial </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l02851">2851</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2852</span>{</div>
<div class="line"><span class="lineno"> 2853</span>    <span class="comment">// Here!</span></div>
<div class="line"><span class="lineno"> 2854</span>    <span class="comment">// dxi/dP = dxi/dP</span></div>
<div class="line"><span class="lineno"> 2855</span>    <span class="comment">// dxi/dNk = dxi/dNk = 0</span></div>
<div class="line"><span class="lineno"> 2856</span>    <span class="comment">// dxij / dP = dxij / dNk = 0</span></div>
<div class="line"><span class="lineno"> 2857</span>    <span class="comment">// See MixtureComp::CalXiPNX_full01()</span></div>
<div class="line"><span class="lineno"> 2858</span> </div>
<div class="line"><span class="lineno"> 2859</span>    <span class="comment">// Calculate xix and xiP</span></div>
<div class="line"><span class="lineno"> 2860</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> CgTP = <a class="code hl_variable" href="OCPConst_8hpp.html#acf2d5c7d361941d6394ac1c9dc3e5628">GAS_CONSTANT</a> * T / P;</div>
<div class="line"><span class="lineno"> 2861</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp;</div>
<div class="line"><span class="lineno"> 2862</span> </div>
<div class="line"><span class="lineno"> 2863</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 2864</span>        <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; xj = x[j];</div>
<div class="line"><span class="lineno"> 2865</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>                aj = Aj[j];</div>
<div class="line"><span class="lineno"> 2866</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>                bj = Bj[j];</div>
<div class="line"><span class="lineno"> 2867</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>                zj = Zj[j];</div>
<div class="line"><span class="lineno"> 2868</span> </div>
<div class="line"><span class="lineno"> 2869</span>        Bx = Bi;</div>
<div class="line"><span class="lineno"> 2870</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 2871</span>            tmp = 0;</div>
<div class="line"><span class="lineno"> 2872</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 2873</span>                tmp += xj[k] * (1 - BIC[i * NC + k]) * sqrt(Ai[i] * Ai[k]);</div>
<div class="line"><span class="lineno"> 2874</span>            }</div>
<div class="line"><span class="lineno"> 2875</span>            Ax[i] = 2 * tmp;</div>
<div class="line"><span class="lineno"> 2876</span>            Zx[i] =</div>
<div class="line"><span class="lineno"> 2877</span>                ((bj - zj) * Ax[i] +</div>
<div class="line"><span class="lineno"> 2878</span>                    ((aj + delta1 * delta2 * (3 * bj * bj + 2 * bj)) +</div>
<div class="line"><span class="lineno"> 2879</span>                        ((delta1 + delta2) * (2 * bj + 1) - 2 * delta1 * delta2 * bj) * zj -</div>
<div class="line"><span class="lineno"> 2880</span>                        (delta1 + delta2 - 1) * zj * zj) *</div>
<div class="line"><span class="lineno"> 2881</span>                    Bx[i]) /</div>
<div class="line"><span class="lineno"> 2882</span>                (3 * zj * zj + 2 * ((delta1 + delta2 - 1) * bj - 1) * zj +</div>
<div class="line"><span class="lineno"> 2883</span>                    (aj + delta1 * delta2 * bj * bj - (delta1 + delta2) * bj * (bj + 1)));</div>
<div class="line"><span class="lineno"> 2884</span>        }</div>
<div class="line"><span class="lineno"> 2885</span> </div>
<div class="line"><span class="lineno"> 2886</span>        tmp = -xiC[j] * xiC[j] * CgTP;</div>
<div class="line"><span class="lineno"> 2887</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 2888</span>            xixC[j * NC + i] = tmp * Zx[i];</div>
<div class="line"><span class="lineno"> 2889</span>        }</div>
<div class="line"><span class="lineno"> 2890</span>        xiPC[j] = tmp * (Zp[j] - Zj[j] / P);</div>
<div class="line"><span class="lineno"> 2891</span>    }</div>
<div class="line"><span class="lineno"> 2892</span> </div>
<div class="line"><span class="lineno"> 2893</span>    <span class="comment">// xiNC</span></div>
<div class="line"><span class="lineno"> 2894</span>    fill(xiNC.begin(), xiNC.end(), 0.0);</div>
<div class="line"><span class="lineno"> 2895</span> </div>
<div class="line"><span class="lineno"> 2896</span>    <span class="comment">// Copoy to xiP, xix</span></div>
<div class="line"><span class="lineno"> 2897</span>    <span class="comment">//fill(xiP.begin(), xiP.end(), 0.0);</span></div>
<div class="line"><span class="lineno"> 2898</span>    <span class="comment">//fill(xix.begin(), xix.end(), 0.0);</span></div>
<div class="line"><span class="lineno"> 2899</span>    fill(<a class="code hl_variable" href="classMixture.html#a3476f1a61b94f0b58c00a90643e1861a">xiN</a>.begin(), <a class="code hl_variable" href="classMixture.html#a3476f1a61b94f0b58c00a90643e1861a">xiN</a>.end(), 0.0);</div>
<div class="line"><span class="lineno"> 2900</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1;</div>
<div class="line"><span class="lineno"> 2901</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 2902</span>        j1 = phaseLabel[j];</div>
<div class="line"><span class="lineno"> 2903</span>        <a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[j1] = xiPC[j];</div>
<div class="line"><span class="lineno"> 2904</span>        <a class="code hl_function" href="DenseMat_8hpp.html#ae3d6d69eb9175bc2ed3414c44bde7a8d">Dcopy</a>(NC, &amp;<a class="code hl_variable" href="classMixture.html#a3f517560e2ec30f08afca9f6dc3ff71c">xix</a>[j1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>], &amp;xixC[j * NC]);</div>
<div class="line"><span class="lineno"> 2905</span>    }</div>
<div class="line"><span class="lineno"> 2906</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b99df6280ef508b3235a2c26eb82786" name="a6b99df6280ef508b3235a2c26eb82786"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b99df6280ef508b3235a2c26eb82786">&#9670;&#160;</a></span>CalXiRhoMuPN_pfullx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalXiRhoMuPN_pfullx </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l03505">3505</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3506</span>{</div>
<div class="line"><span class="lineno"> 3507</span>    <span class="comment">// Using dXsdXp</span></div>
<div class="line"><span class="lineno"> 3508</span>    <span class="comment">// CalXiPNX_partial(),CalRhoPX_partial(),CalMuPX_partial() have been called</span></div>
<div class="line"><span class="lineno"> 3509</span>    <span class="comment">// s: S,x; p: P,N  Call CaldXsdXpAPI01 or CaldXsdXpAPI02 before</span></div>
<div class="line"><span class="lineno"> 3510</span>    </div>
<div class="line"><span class="lineno"> 3511</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> ncol = <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + 1;</div>
<div class="line"><span class="lineno"> 3512</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* xijPN = &amp;<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> * ncol];</div>
<div class="line"><span class="lineno"> 3513</span> </div>
<div class="line"><span class="lineno"> 3514</span>    </div>
<div class="line"><span class="lineno"> 3515</span>    <span class="keywordflow">if</span> (NP == 1) {</div>
<div class="line"><span class="lineno"> 3516</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1 = phaseLabel[0];</div>
<div class="line"><span class="lineno"> 3517</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> bId = j1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 3518</span>        xijPN += bId * ncol;</div>
<div class="line"><span class="lineno"> 3519</span>    </div>
<div class="line"><span class="lineno"> 3520</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3521</span>            xijPN++;</div>
<div class="line"><span class="lineno"> 3522</span>            <span class="comment">// dN</span></div>
<div class="line"><span class="lineno"> 3523</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 3524</span>                <a class="code hl_variable" href="classMixture.html#a3476f1a61b94f0b58c00a90643e1861a">xiN</a>[bId + m] += <a class="code hl_variable" href="classMixture.html#a3f517560e2ec30f08afca9f6dc3ff71c">xix</a>[bId + i] * xijPN[m];</div>
<div class="line"><span class="lineno"> 3525</span>                <a class="code hl_variable" href="classMixture.html#ad9e2798ac8ab094b3a17cff16111f70b">rhoN</a>[bId + m] += <a class="code hl_variable" href="classMixture.html#a62615d0052ef8b34c3894e728951c06e">rhox</a>[bId + i] * xijPN[m];</div>
<div class="line"><span class="lineno"> 3526</span>                <a class="code hl_variable" href="classMixture.html#a7897e0172e682f205e6c58688368c12e">muN</a>[bId + m] += <a class="code hl_variable" href="classMixture.html#ae63dab2d31711b0246096c5c128f2080">mux</a>[bId + i] * xijPN[m];</div>
<div class="line"><span class="lineno"> 3527</span>            }</div>
<div class="line"><span class="lineno"> 3528</span>            xijPN += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;         </div>
<div class="line"><span class="lineno"> 3529</span>        }</div>
<div class="line"><span class="lineno"> 3530</span>    }</div>
<div class="line"><span class="lineno"> 3531</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3532</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; <a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1; j++) {</div>
<div class="line"><span class="lineno"> 3533</span> </div>
<div class="line"><span class="lineno"> 3534</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">phaseExist</a>[j]) {  <span class="comment">// skip</span></div>
<div class="line"><span class="lineno"> 3535</span>                xijPN += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> * ncol;</div>
<div class="line"><span class="lineno"> 3536</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3537</span>            }</div>
<div class="line"><span class="lineno"> 3538</span> </div>
<div class="line"><span class="lineno"> 3539</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> bId = j * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 3540</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3541</span>                <span class="comment">// dP</span></div>
<div class="line"><span class="lineno"> 3542</span>                <a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[j] += <a class="code hl_variable" href="classMixture.html#a3f517560e2ec30f08afca9f6dc3ff71c">xix</a>[bId + i] * xijPN[0];</div>
<div class="line"><span class="lineno"> 3543</span>                <a class="code hl_variable" href="classMixture.html#a0a42129a94c1ba7c92c9577f0eb0234f">rhoP</a>[j] += <a class="code hl_variable" href="classMixture.html#a62615d0052ef8b34c3894e728951c06e">rhox</a>[bId + i] * xijPN[0];</div>
<div class="line"><span class="lineno"> 3544</span>                <a class="code hl_variable" href="classMixture.html#ae1531b7594246b0b03bdb7d974800ca4">muP</a>[j] += <a class="code hl_variable" href="classMixture.html#ae63dab2d31711b0246096c5c128f2080">mux</a>[bId + i] * xijPN[0];</div>
<div class="line"><span class="lineno"> 3545</span>                xijPN++;</div>
<div class="line"><span class="lineno"> 3546</span>                <span class="comment">// xiN</span></div>
<div class="line"><span class="lineno"> 3547</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 3548</span>                    <a class="code hl_variable" href="classMixture.html#a3476f1a61b94f0b58c00a90643e1861a">xiN</a>[bId + m] += <a class="code hl_variable" href="classMixture.html#a3f517560e2ec30f08afca9f6dc3ff71c">xix</a>[bId + i] * xijPN[m];</div>
<div class="line"><span class="lineno"> 3549</span>                    <a class="code hl_variable" href="classMixture.html#ad9e2798ac8ab094b3a17cff16111f70b">rhoN</a>[bId + m] += <a class="code hl_variable" href="classMixture.html#a62615d0052ef8b34c3894e728951c06e">rhox</a>[bId + i] * xijPN[m];</div>
<div class="line"><span class="lineno"> 3550</span>                    <a class="code hl_variable" href="classMixture.html#a7897e0172e682f205e6c58688368c12e">muN</a>[bId + m] += <a class="code hl_variable" href="classMixture.html#ae63dab2d31711b0246096c5c128f2080">mux</a>[bId + i] * xijPN[m];</div>
<div class="line"><span class="lineno"> 3551</span>                }</div>
<div class="line"><span class="lineno"> 3552</span>                xijPN += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 3553</span>            }</div>
<div class="line"><span class="lineno"> 3554</span>            <span class="comment">// skip water component</span></div>
<div class="line"><span class="lineno"> 3555</span>            xijPN += ncol;</div>
<div class="line"><span class="lineno"> 3556</span>        }</div>
<div class="line"><span class="lineno"> 3557</span>    }</div>
<div class="line"><span class="lineno"> 3558</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a927078c03d7e4ce30dbe7d18bf162e11" name="a927078c03d7e4ce30dbe7d18bf162e11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a927078c03d7e4ce30dbe7d18bf162e11">&#9670;&#160;</a></span>CalXiRhoMuPN_pfullxn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CalXiRhoMuPN_pfullxn </td>
          <td>(</td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>xflag</em> = <code>true</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l03560">3560</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3561</span>{</div>
<div class="line"><span class="lineno"> 3562</span>    <span class="comment">// Using dXsdXp</span></div>
<div class="line"><span class="lineno"> 3563</span>    <span class="comment">// s: S,n; p: P,N  Call CaldXsdXpAPI03, CaldXsdXpAPI02p before</span></div>
<div class="line"><span class="lineno"> 3564</span>    <span class="comment">// CalXiPn_partial(); CalRhoPn_partial(); CalMuPn_partial() have been called</span></div>
<div class="line"><span class="lineno"> 3565</span> </div>
<div class="line"><span class="lineno"> 3566</span> </div>
<div class="line"><span class="lineno"> 3567</span>    <span class="keywordflow">if</span> (NP == 1 &amp;&amp; !xflag) {</div>
<div class="line"><span class="lineno"> 3568</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1 = phaseLabel[0];</div>
<div class="line"><span class="lineno"> 3569</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> bId = j1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 3570</span> </div>
<div class="line"><span class="lineno"> 3571</span>        <span class="comment">// dN</span></div>
<div class="line"><span class="lineno"> 3572</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3573</span>            <a class="code hl_variable" href="classMixture.html#a3476f1a61b94f0b58c00a90643e1861a">xiN</a>[bId + i] = <a class="code hl_variable" href="classMixture.html#a3f517560e2ec30f08afca9f6dc3ff71c">xix</a>[bId + i];</div>
<div class="line"><span class="lineno"> 3574</span>            <a class="code hl_variable" href="classMixture.html#ad9e2798ac8ab094b3a17cff16111f70b">rhoN</a>[bId + i] = <a class="code hl_variable" href="classMixture.html#a62615d0052ef8b34c3894e728951c06e">rhox</a>[bId + i];</div>
<div class="line"><span class="lineno"> 3575</span>            <a class="code hl_variable" href="classMixture.html#a7897e0172e682f205e6c58688368c12e">muN</a>[bId + i] = <a class="code hl_variable" href="classMixture.html#ae63dab2d31711b0246096c5c128f2080">mux</a>[bId + i];</div>
<div class="line"><span class="lineno"> 3576</span>        }</div>
<div class="line"><span class="lineno"> 3577</span>    }</div>
<div class="line"><span class="lineno"> 3578</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3579</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> ncol = <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + 1;</div>
<div class="line"><span class="lineno"> 3580</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>* xijPN = &amp;<a class="code hl_variable" href="classMixture.html#a15908a1b8da8390dd9e8d7c2bd822bf4">dXsdXp</a>[(NP + 1) * ncol];</div>
<div class="line"><span class="lineno"> 3581</span> </div>
<div class="line"><span class="lineno"> 3582</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; <a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1; j++) {</div>
<div class="line"><span class="lineno"> 3583</span> </div>
<div class="line"><span class="lineno"> 3584</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">phaseExist</a>[j]) <span class="comment">// skip</span></div>
<div class="line"><span class="lineno"> 3585</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3586</span> </div>
<div class="line"><span class="lineno"> 3587</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> bId = j * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 3588</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 3589</span>                <span class="comment">// dP</span></div>
<div class="line"><span class="lineno"> 3590</span>                <a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[j] += <a class="code hl_variable" href="classMixture.html#a3f517560e2ec30f08afca9f6dc3ff71c">xix</a>[bId + i] * xijPN[0];</div>
<div class="line"><span class="lineno"> 3591</span>                <a class="code hl_variable" href="classMixture.html#a0a42129a94c1ba7c92c9577f0eb0234f">rhoP</a>[j] += <a class="code hl_variable" href="classMixture.html#a62615d0052ef8b34c3894e728951c06e">rhox</a>[bId + i] * xijPN[0];</div>
<div class="line"><span class="lineno"> 3592</span>                <a class="code hl_variable" href="classMixture.html#ae1531b7594246b0b03bdb7d974800ca4">muP</a>[j] += <a class="code hl_variable" href="classMixture.html#ae63dab2d31711b0246096c5c128f2080">mux</a>[bId + i] * xijPN[0];</div>
<div class="line"><span class="lineno"> 3593</span>                xijPN++;</div>
<div class="line"><span class="lineno"> 3594</span>                <span class="comment">// xiN</span></div>
<div class="line"><span class="lineno"> 3595</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> m = 0; m &lt; NC; m++) {</div>
<div class="line"><span class="lineno"> 3596</span>                    <a class="code hl_variable" href="classMixture.html#a3476f1a61b94f0b58c00a90643e1861a">xiN</a>[bId + m] += <a class="code hl_variable" href="classMixture.html#a3f517560e2ec30f08afca9f6dc3ff71c">xix</a>[bId + i] * xijPN[m];</div>
<div class="line"><span class="lineno"> 3597</span>                    <a class="code hl_variable" href="classMixture.html#ad9e2798ac8ab094b3a17cff16111f70b">rhoN</a>[bId + m] += <a class="code hl_variable" href="classMixture.html#a62615d0052ef8b34c3894e728951c06e">rhox</a>[bId + i] * xijPN[m];</div>
<div class="line"><span class="lineno"> 3598</span>                    <a class="code hl_variable" href="classMixture.html#a7897e0172e682f205e6c58688368c12e">muN</a>[bId + m] += <a class="code hl_variable" href="classMixture.html#ae63dab2d31711b0246096c5c128f2080">mux</a>[bId + i] * xijPN[m];</div>
<div class="line"><span class="lineno"> 3599</span>                }</div>
<div class="line"><span class="lineno"> 3600</span>                xijPN += <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>;</div>
<div class="line"><span class="lineno"> 3601</span>            }</div>
<div class="line"><span class="lineno"> 3602</span>            <span class="comment">// don&#39;t skip water component</span></div>
<div class="line"><span class="lineno"> 3603</span>        }</div>
<div class="line"><span class="lineno"> 3604</span>    }</div>
<div class="line"><span class="lineno"> 3605</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3c0a25c3ddd47886b80a10e5eef7a37d" name="a3c0a25c3ddd47886b80a10e5eef7a37d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c0a25c3ddd47886b80a10e5eef7a37d">&#9670;&#160;</a></span>CheckSplit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool MixtureComp::CheckSplit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l01541">1541</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1542</span>{</div>
<div class="line"><span class="lineno"> 1543</span>    <span class="keywordflow">if</span> (NP == 2) {</div>
<div class="line"><span class="lineno"> 1544</span> </div>
<div class="line"><span class="lineno"> 1545</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp   = 0;</div>
<div class="line"><span class="lineno"> 1546</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> nuMax = max(nu[0], nu[1]);</div>
<div class="line"><span class="lineno"> 1547</span> </div>
<div class="line"><span class="lineno"> 1548</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1549</span>            tmp += (x[0][i] - x[1][i]) * (x[0][i] - x[1][i]);</div>
<div class="line"><span class="lineno"> 1550</span>        }</div>
<div class="line"><span class="lineno"> 1551</span> </div>
<div class="line"><span class="lineno"> 1552</span>        <span class="keywordflow">if</span> (nuMax &lt; 1 &amp;&amp; EoSctrl.NRsp.<a class="code hl_variable" href="classNRparamSP.html#a9c9b51d4724052f1f8d382cd33ba2b0a">conflag</a> &amp;&amp; isfinite(tmp)) {</div>
<div class="line"><span class="lineno"> 1553</span>            <span class="comment">// accept this result</span></div>
<div class="line"><span class="lineno"> 1554</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1555</span>            <span class="keywordflow">if</span> (!isfinite(tmp) || (1 - nuMax) &lt; 1E-3) {</div>
<div class="line"><span class="lineno"> 1556</span>                <span class="comment">// single phase</span></div>
<div class="line"><span class="lineno"> 1557</span>                <span class="comment">// cout &lt;&lt; &quot;-------------------------------------------&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1558</span>                <span class="comment">// cout &lt;&lt; fixed &lt;&lt; scientific &lt;&lt; setprecision(12);</span></div>
<div class="line"><span class="lineno"> 1559</span>                <span class="comment">// cout &lt;&lt; Yt &lt;&lt; &quot;   &quot; &lt;&lt; nu[0] &lt;&lt; &quot;   &quot; &lt;&lt; nu[1] &lt;&lt; &quot;   &quot;;</span></div>
<div class="line"><span class="lineno"> 1560</span>                <span class="comment">// cout &lt;&lt; sqrt(EoSctrl.SSMsp.realTol) &lt;&lt; &quot;   &quot; &lt;&lt; EoSctrl.SSMsp.conflag</span></div>
<div class="line"><span class="lineno"> 1561</span>                <span class="comment">// &lt;&lt; &quot;   &quot;; cout &lt;&lt; sqrt(EoSctrl.NRsp.realTol) &lt;&lt; &quot;   &quot; &lt;&lt;</span></div>
<div class="line"><span class="lineno"> 1562</span>                <span class="comment">// EoSctrl.NRsp.conflag &lt;&lt; endl; for (USI i = 0; i &lt; NC; i++)   cout &lt;&lt;</span></div>
<div class="line"><span class="lineno"> 1563</span>                <span class="comment">//zi[i] &lt;&lt; &quot;   &quot;; cout &lt;&lt; endl; for (USI j = 0; j &lt; NP; j++) {  for (USI</span></div>
<div class="line"><span class="lineno"> 1564</span>                <span class="comment">//i = 0; i &lt; NC; i++) {         cout &lt;&lt; x[j][i] &lt;&lt; &quot;   &quot;;</span></div>
<div class="line"><span class="lineno"> 1565</span>                <span class="comment">//  }</span></div>
<div class="line"><span class="lineno"> 1566</span>                <span class="comment">//  cout &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1567</span>                <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 1568</span>                NP    = 1;</div>
<div class="line"><span class="lineno"> 1569</span>                x[0]  = zi;</div>
<div class="line"><span class="lineno"> 1570</span>                nu[0] = 1;</div>
<div class="line"><span class="lineno"> 1571</span>                CalAjBj(Aj[0], Bj[0], x[0]);</div>
<div class="line"><span class="lineno"> 1572</span>                SolEoS(Zj[0], Aj[0], Bj[0]);</div>
<div class="line"><span class="lineno"> 1573</span> </div>
<div class="line"><span class="lineno"> 1574</span>                EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#a8edb30773a4bf5767ba6020519277d7b">conflag</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1575</span>                EoSctrl.NRsta.<a class="code hl_variable" href="classNRparamSTA.html#a3acf7b521ae923bea18cb7317773877f">conflag</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1576</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1577</span>            }</div>
<div class="line"><span class="lineno"> 1578</span>        }</div>
<div class="line"><span class="lineno"> 1579</span>    }</div>
<div class="line"><span class="lineno"> 1580</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1581</span>}</div>
<div class="ttc" id="aclassNRparamSP_html_a9c9b51d4724052f1f8d382cd33ba2b0a"><div class="ttname"><a href="classNRparamSP.html#a9c9b51d4724052f1f8d382cd33ba2b0a">NRparamSP::conflag</a></div><div class="ttdeci">bool conflag</div><div class="ttdoc">convergence flag, if converges, conflag = true</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00080">MixtureComp.hpp:80</a></div></div>
<div class="ttc" id="aclassNRparamSTA_html_a3acf7b521ae923bea18cb7317773877f"><div class="ttname"><a href="classNRparamSTA.html#a3acf7b521ae923bea18cb7317773877f">NRparamSTA::conflag</a></div><div class="ttdeci">bool conflag</div><div class="ttdoc">convergence flag, if converges, conflag = true</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00052">MixtureComp.hpp:52</a></div></div>
<div class="ttc" id="aclassSSMparamSTA_html_a8edb30773a4bf5767ba6020519277d7b"><div class="ttname"><a href="classSSMparamSTA.html#a8edb30773a4bf5767ba6020519277d7b">SSMparamSTA::conflag</a></div><div class="ttdeci">bool conflag</div><div class="ttdoc">convergence flag, if converges, conflag = true</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00038">MixtureComp.hpp:38</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a04a0d98d3277d79d1403dff71ba21fd5" name="a04a0d98d3277d79d1403dff71ba21fd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04a0d98d3277d79d1403dff71ba21fd5">&#9670;&#160;</a></span>CopyPhase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::CopyPhase </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copy the basic properties from <a class="el" href="classMixtureComp.html">MixtureComp</a> to <a class="el" href="classMixture.html">Mixture</a>. </p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l02155">2155</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2156</span>{</div>
<div class="line"><span class="lineno"> 2157</span>    <span class="comment">// copy v, x, mu, xi, rho</span></div>
<div class="line"><span class="lineno"> 2158</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 2159</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1 = phaseLabel[j];</div>
<div class="line"><span class="lineno"> 2160</span>        <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[j1]  = vC[j];</div>
<div class="line"><span class="lineno"> 2161</span>        <a class="code hl_function" href="DenseMat_8hpp.html#ae3d6d69eb9175bc2ed3414c44bde7a8d">Dcopy</a>(NC, &amp;<a class="code hl_variable" href="classMixture.html#a9958b097000a344df9bfbdc845db850c">xij</a>[j1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>], &amp;x[j][0]);</div>
<div class="line"><span class="lineno"> 2162</span>        <a class="code hl_variable" href="classMixture.html#a170e493a88e391f9afe0896181d76786">mu</a>[j1]  = muC[j];</div>
<div class="line"><span class="lineno"> 2163</span>        <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[j1]  = xiC[j];</div>
<div class="line"><span class="lineno"> 2164</span>        <a class="code hl_variable" href="classMixture.html#a16c6595220dc0a04cfa960d44f3016c7">rho</a>[j1] = rhoC[j];</div>
<div class="line"><span class="lineno"> 2165</span>        <a class="code hl_variable" href="classMixture.html#aa0d6fa9514fce1774cc277826d304061">nj</a>[j1] = nu[j];</div>
<div class="line"><span class="lineno"> 2166</span>    }</div>
<div class="line"><span class="lineno"> 2167</span>}</div>
<div class="ttc" id="aclassMixture_html_a16c6595220dc0a04cfa960d44f3016c7"><div class="ttname"><a href="classMixture.html#a16c6595220dc0a04cfa960d44f3016c7">Mixture::rho</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; rho</div><div class="ttdoc">mass density of phase: numPhase</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00152">Mixture.hpp:152</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="DenseMat_8cpp_source.html#l00037">Dcopy()</a>, <a class="el" href="Mixture_8hpp_source.html#l00157">Mixture::mu</a>, <a class="el" href="Mixture_8hpp_source.html#l00156">Mixture::nj</a>, <a class="el" href="Mixture_8hpp_source.html#l00145">Mixture::numCom</a>, <a class="el" href="Mixture_8hpp_source.html#l00152">Mixture::rho</a>, <a class="el" href="Mixture_8hpp_source.html#l00158">Mixture::v</a>, <a class="el" href="Mixture_8hpp_source.html#l00153">Mixture::xi</a>, and <a class="el" href="Mixture_8hpp_source.html#l00154">Mixture::xij</a>.</p>

</div>
</div>
<a id="a22d627ebaf3134a25502d0c56608b721" name="a22d627ebaf3134a25502d0c56608b721"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22d627ebaf3134a25502d0c56608b721">&#9670;&#160;</a></span>CubicRoot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> MixtureComp::CubicRoot </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>NTflag</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Result is stored in Ztmp. </p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l04844">4844</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4846</span>{</div>
<div class="line"><span class="lineno"> 4847</span> </div>
<div class="line"><span class="lineno"> 4848</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Q = (a * a - 3 * b) / 9;</div>
<div class="line"><span class="lineno"> 4849</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> R = (2 * a * a * a - 9 * a * b + 27 * c) / 54;</div>
<div class="line"><span class="lineno"> 4850</span> </div>
<div class="line"><span class="lineno"> 4851</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Q3 = Q * Q * Q;</div>
<div class="line"><span class="lineno"> 4852</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> M  = R * R - Q3;</div>
<div class="line"><span class="lineno"> 4853</span> </div>
<div class="line"><span class="lineno"> 4854</span>    <span class="keywordflow">if</span> (M &lt;= 0) {</div>
<div class="line"><span class="lineno"> 4855</span>        <span class="comment">// 3 real roots</span></div>
<div class="line"><span class="lineno"> 4856</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> theta = acos(R / sqrt(Q3));</div>
<div class="line"><span class="lineno"> 4857</span>        Ztmp[0]       = -2 * sqrt(Q) * cos(theta / 3) - a / 3;</div>
<div class="line"><span class="lineno"> 4858</span>        Ztmp[1]       = -2 * sqrt(Q) * cos((theta + 2 * <a class="code hl_variable" href="OCPConst_8hpp.html#adf2a24350253e533be022fb87ae13b8d">PI</a>) / 3) - a / 3;</div>
<div class="line"><span class="lineno"> 4859</span>        Ztmp[2]       = -2 * sqrt(Q) * cos((theta - 2 * <a class="code hl_variable" href="OCPConst_8hpp.html#adf2a24350253e533be022fb87ae13b8d">PI</a>) / 3) - a / 3;</div>
<div class="line"><span class="lineno"> 4860</span> </div>
<div class="line"><span class="lineno"> 4861</span>        <span class="keywordflow">if</span> (NTflag) {</div>
<div class="line"><span class="lineno"> 4862</span>            NTcubicroot(Ztmp[0], a, b, c);</div>
<div class="line"><span class="lineno"> 4863</span>            NTcubicroot(Ztmp[1], a, b, c);</div>
<div class="line"><span class="lineno"> 4864</span>            NTcubicroot(Ztmp[2], a, b, c);</div>
<div class="line"><span class="lineno"> 4865</span>        }</div>
<div class="line"><span class="lineno"> 4866</span> </div>
<div class="line"><span class="lineno"> 4867</span>        sort(Ztmp.begin(), Ztmp.end());</div>
<div class="line"><span class="lineno"> 4868</span> </div>
<div class="line"><span class="lineno"> 4869</span>        <span class="comment">// vector&lt;OCP_DBL&gt; e(3, 0);</span></div>
<div class="line"><span class="lineno"> 4870</span>        <span class="comment">// for (USI i = 0; i &lt; 3; i++) {</span></div>
<div class="line"><span class="lineno"> 4871</span>        <span class="comment">//  e[i] = Ztmp[i] * (Ztmp[i] * (Ztmp[i] + a) + b) + c;</span></div>
<div class="line"><span class="lineno"> 4872</span>        <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 4873</span>        <span class="comment">// for (USI i = 0; i &lt; 3; i++) {</span></div>
<div class="line"><span class="lineno"> 4874</span>        <span class="comment">//  cout &lt;&lt; scientific &lt;&lt; e[i] &lt;&lt; &quot;\t&quot;;</span></div>
<div class="line"><span class="lineno"> 4875</span>        <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 4876</span> </div>
<div class="line"><span class="lineno"> 4877</span>        <span class="keywordflow">return</span> 3;</div>
<div class="line"><span class="lineno"> 4878</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4879</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp1 = -R + sqrt(M);</div>
<div class="line"><span class="lineno"> 4880</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp2 = R + sqrt(M);</div>
<div class="line"><span class="lineno"> 4881</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> <a class="code hl_variable" href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">S</a>    = <a class="code hl_function" href="MixtureComp_8hpp.html#aa5bfaa4b4e31a78ae971eb274580188f">signD</a>(tmp1) * pow(fabs(tmp1), 1.0 / 3);</div>
<div class="line"><span class="lineno"> 4882</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> T    = -<a class="code hl_function" href="MixtureComp_8hpp.html#aa5bfaa4b4e31a78ae971eb274580188f">signD</a>(tmp2) * pow(fabs(tmp2), 1.0 / 3);</div>
<div class="line"><span class="lineno"> 4883</span>        Ztmp[0]      = <a class="code hl_variable" href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">S</a> + T - a / 3;</div>
<div class="line"><span class="lineno"> 4884</span> </div>
<div class="line"><span class="lineno"> 4885</span>        <span class="keywordflow">if</span> (NTflag) {</div>
<div class="line"><span class="lineno"> 4886</span>            NTcubicroot(Ztmp[0], a, b, c);</div>
<div class="line"><span class="lineno"> 4887</span>        }</div>
<div class="line"><span class="lineno"> 4888</span> </div>
<div class="line"><span class="lineno"> 4889</span>        <span class="comment">// vector&lt;OCP_DBL&gt; e(1, 0);</span></div>
<div class="line"><span class="lineno"> 4890</span>        <span class="comment">// for (USI i = 0; i &lt; 1; i++) {</span></div>
<div class="line"><span class="lineno"> 4891</span>        <span class="comment">//  e[i] = Ztmp[i] * (Ztmp[i] * (Ztmp[i] + a) + b) + c;</span></div>
<div class="line"><span class="lineno"> 4892</span>        <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 4893</span>        <span class="comment">// for (USI i = 0; i &lt; 1; i++) {</span></div>
<div class="line"><span class="lineno"> 4894</span>        <span class="comment">//  cout &lt;&lt; scientific &lt;&lt; e[i] &lt;&lt; &quot;\t&quot;;</span></div>
<div class="line"><span class="lineno"> 4895</span>        <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 4896</span> </div>
<div class="line"><span class="lineno"> 4897</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 4898</span>    }</div>
<div class="line"><span class="lineno"> 4899</span>}</div>
<div class="ttc" id="aMixtureComp_8hpp_html_aa5bfaa4b4e31a78ae971eb274580188f"><div class="ttname"><a href="MixtureComp_8hpp.html#aa5bfaa4b4e31a78ae971eb274580188f">signD</a></div><div class="ttdeci">OCP_DBL signD(const OCP_DBL &amp;d)</div><div class="ttdoc">Return the sign of double di.</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8cpp_source.html#l04902">MixtureComp.cpp:4902</a></div></div>
<div class="ttc" id="aOCPConst_8hpp_html_adf2a24350253e533be022fb87ae13b8d"><div class="ttname"><a href="OCPConst_8hpp.html#adf2a24350253e533be022fb87ae13b8d">PI</a></div><div class="ttdeci">const OCP_DBL PI</div><div class="ttdoc">Pi.</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00037">OCPConst.hpp:37</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="OCPConst_8hpp_source.html#l00037">PI</a>, <a class="el" href="Mixture_8hpp_source.html#l00151">Mixture::S</a>, and <a class="el" href="MixtureComp_8cpp_source.html#l04902">signD()</a>.</p>

</div>
</div>
<a id="a063814d8e2fe4657c3147b0f0fe26d45" name="a063814d8e2fe4657c3147b0f0fe26d45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a063814d8e2fe4657c3147b0f0fe26d45">&#9670;&#160;</a></span>FindMWmax()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> MixtureComp::FindMWmax </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00893">893</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  894</span>{</div>
<div class="line"><span class="lineno">  895</span>    <span class="comment">// find the phase id with the highest Molecular Weight</span></div>
<div class="line"><span class="lineno">  896</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     tmpId = 0;</div>
<div class="line"><span class="lineno">  897</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmpMW = MW[0];</div>
<div class="line"><span class="lineno">  898</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 1; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno">  899</span>        <span class="keywordflow">if</span> (tmpMW &lt; MW[j]) {</div>
<div class="line"><span class="lineno">  900</span>            tmpMW = MW[j];</div>
<div class="line"><span class="lineno">  901</span>            tmpId = j;</div>
<div class="line"><span class="lineno">  902</span>        }</div>
<div class="line"><span class="lineno">  903</span>    }</div>
<div class="line"><span class="lineno">  904</span>    <span class="keywordflow">return</span> tmpId;</div>
<div class="line"><span class="lineno">  905</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8db092535e37713c2f2b90002edc5dda" name="a8db092535e37713c2f2b90002edc5dda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8db092535e37713c2f2b90002edc5dda">&#9670;&#160;</a></span>Flash()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::Flash </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>Pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>Tin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *&#160;</td>
          <td class="paramname"><em>Niin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;&#160;</td>
          <td class="paramname"><em>ftype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;&#160;</td>
          <td class="paramname"><em>lastNP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *&#160;</td>
          <td class="paramname"><em>lastKs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flash calculation with moles of components. </p>

<p>Implements <a class="el" href="classMixture.html#a371b85cd655c15088e1a82cf89db059d">Mixture</a>.</p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00237">237</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  240</span>{</div>
<div class="line"><span class="lineno">  241</span>    ftype = Myftype;</div>
<div class="line"><span class="lineno">  242</span>    lNP   = lastNP;</div>
<div class="line"><span class="lineno">  243</span>    <span class="keywordflow">if</span> (lNP == 2) {</div>
<div class="line"><span class="lineno">  244</span>        <a class="code hl_function" href="DenseMat_8hpp.html#ae3d6d69eb9175bc2ed3414c44bde7a8d">Dcopy</a>(NC, &amp;lKs[0], lastKs);</div>
<div class="line"><span class="lineno">  245</span>    }</div>
<div class="line"><span class="lineno">  246</span>    </div>
<div class="line"><span class="lineno">  247</span>    CalFlash(Pin, Tin, Niin);</div>
<div class="line"><span class="lineno">  248</span>    <span class="comment">// Calculate derivates for hydrocarbon phase and components</span></div>
<div class="line"><span class="lineno">  249</span>    <span class="comment">// d vf / d Ni, d vf / d P</span></div>
<div class="line"><span class="lineno">  250</span>    <span class="comment">// CalVfiVfp_full01();</span></div>
<div class="line"><span class="lineno">  251</span>    CalVfiVfp_full02();</div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>    <span class="comment">// Water Properties</span></div>
<div class="line"><span class="lineno">  255</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> Wpid                  = <a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1;</div>
<div class="line"><span class="lineno">  256</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> Wcid                  = <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> - 1;</div>
<div class="line"><span class="lineno">  257</span>    <a class="code hl_variable" href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">phaseExist</a>[Wpid]          = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  258</span>    <a class="code hl_variable" href="classMixture.html#a9958b097000a344df9bfbdc845db850c">xij</a>[Wpid * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + Wcid] = 1.0;</div>
<div class="line"><span class="lineno">  259</span>    <a class="code hl_variable" href="classMixture.html#a9d5376ba600228135d16bbd76d4b38de">Nt</a> = Nh + <a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[Wcid];</div>
<div class="line"><span class="lineno">  260</span>    PVTW.<a class="code hl_function" href="classOCPTable.html#a047b61a09961d8a5015ba8b071320b7b">Eval_All</a>(0, P, data, cdata);</div>
<div class="line"><span class="lineno">  261</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pw0 = data[0];</div>
<div class="line"><span class="lineno">  262</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> bw0 = data[1];</div>
<div class="line"><span class="lineno">  263</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> cbw = data[2];</div>
<div class="line"><span class="lineno">  264</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> bw  = bw0 * (1 - cbw * (P - Pw0));</div>
<div class="line"><span class="lineno">  265</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> bwp = -cbw * bw0;</div>
<div class="line"><span class="lineno">  266</span>    <a class="code hl_variable" href="classMixture.html#a170e493a88e391f9afe0896181d76786">mu</a>[Wpid]    = data[3];</div>
<div class="line"><span class="lineno">  267</span>    <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[Wpid]    = 1 / (<a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a> * bw);</div>
<div class="line"><span class="lineno">  268</span>    <a class="code hl_variable" href="classMixture.html#a16c6595220dc0a04cfa960d44f3016c7">rho</a>[Wpid]   = std_RhoW / bw;</div>
<div class="line"><span class="lineno">  269</span>    <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[Wpid]     = <a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a> * <a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[Wcid] * bw;</div>
<div class="line"><span class="lineno">  270</span>    <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> += <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[Wpid];</div>
<div class="line"><span class="lineno">  271</span>    <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[Wcid] = <a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a> * bw;</div>
<div class="line"><span class="lineno">  272</span>    <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> += <a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a> * <a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[Wcid] * bwp;</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span>    <span class="comment">// Calculate Sj</span></div>
<div class="line"><span class="lineno">  275</span>    CalSaturation();</div>
<div class="line"><span class="lineno">  276</span>}</div>
<div class="ttc" id="aOCPConst_8hpp_html_a2d05bd9d04bf54565f5192d547dd415f"><div class="ttname"><a href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a></div><div class="ttdeci">const OCP_DBL CONV1</div><div class="ttdoc">1 bbl = CONV1 ft3</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00059">OCPConst.hpp:59</a></div></div>
<div class="ttc" id="aclassMixture_html_a9d5376ba600228135d16bbd76d4b38de"><div class="ttname"><a href="classMixture.html#a9d5376ba600228135d16bbd76d4b38de">Mixture::Nt</a></div><div class="ttdeci">OCP_DBL Nt</div><div class="ttdoc">Total moles of Components.</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00161">Mixture.hpp:161</a></div></div>
<div class="ttc" id="aclassOCPTable_html_a047b61a09961d8a5015ba8b071320b7b"><div class="ttname"><a href="classOCPTable.html#a047b61a09961d8a5015ba8b071320b7b">OCPTable::Eval_All</a></div><div class="ttdeci">USI Eval_All(const USI &amp;j, const OCP_DBL &amp;val, vector&lt; OCP_DBL &gt; &amp;outdata, vector&lt; OCP_DBL &gt; &amp;slope)</div><div class="ttdef"><b>Definition:</b> <a href="OCPTable_8cpp_source.html#l00046">OCPTable.cpp:46</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="OCPConst_8hpp_source.html#l00059">CONV1</a>, <a class="el" href="DenseMat_8cpp_source.html#l00037">Dcopy()</a>, <a class="el" href="OCPTable_8cpp_source.html#l00046">OCPTable::Eval_All()</a>, <a class="el" href="Mixture_8hpp_source.html#l00157">Mixture::mu</a>, <a class="el" href="Mixture_8hpp_source.html#l00149">Mixture::Ni</a>, <a class="el" href="Mixture_8hpp_source.html#l00161">Mixture::Nt</a>, <a class="el" href="Mixture_8hpp_source.html#l00145">Mixture::numCom</a>, <a class="el" href="Mixture_8hpp_source.html#l00144">Mixture::numPhase</a>, <a class="el" href="Mixture_8hpp_source.html#l00150">Mixture::phaseExist</a>, <a class="el" href="Mixture_8hpp_source.html#l00152">Mixture::rho</a>, <a class="el" href="Mixture_8hpp_source.html#l00158">Mixture::v</a>, <a class="el" href="Mixture_8hpp_source.html#l00160">Mixture::vf</a>, <a class="el" href="Mixture_8hpp_source.html#l00170">Mixture::vfi</a>, <a class="el" href="Mixture_8hpp_source.html#l00168">Mixture::vfp</a>, <a class="el" href="Mixture_8hpp_source.html#l00153">Mixture::xi</a>, and <a class="el" href="Mixture_8hpp_source.html#l00154">Mixture::xij</a>.</p>

</div>
</div>
<a id="a2ceb9b4dc6753763425bb5c52249a1ac" name="a2ceb9b4dc6753763425bb5c52249a1ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ceb9b4dc6753763425bb5c52249a1ac">&#9670;&#160;</a></span>FlashDeriv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::FlashDeriv </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>Pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>Tin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *&#160;</td>
          <td class="paramname"><em>Niin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;&#160;</td>
          <td class="paramname"><em>ftype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;&#160;</td>
          <td class="paramname"><em>lastNP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *&#160;</td>
          <td class="paramname"><em>lastKs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flash calculation with moles of components and Calculate the derivative. </p>

<p>Implements <a class="el" href="classMixture.html#a8d5ffc780d16baf60a3bafaa971abf87">Mixture</a>.</p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00278">278</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  281</span>{</div>
<div class="line"><span class="lineno">  282</span>    ftype = Myftype;</div>
<div class="line"><span class="lineno">  283</span>    lNP   = lastNP;</div>
<div class="line"><span class="lineno">  284</span>    <span class="keywordflow">if</span> (lNP == 2) {</div>
<div class="line"><span class="lineno">  285</span>        <a class="code hl_function" href="DenseMat_8hpp.html#ae3d6d69eb9175bc2ed3414c44bde7a8d">Dcopy</a>(NC, &amp;lKs[0], lastKs);</div>
<div class="line"><span class="lineno">  286</span>    }</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>    CalFlash(Pin, Tin, Niin);</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>    <span class="comment">// Calculate derivates for hydrocarbon phase and components</span></div>
<div class="line"><span class="lineno">  291</span>    <span class="comment">// d vf / d Ni, d vf / d P</span></div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span><span class="preprocessor">#ifdef OCP_NEW_FIM_n</span></div>
<div class="line"><span class="lineno">  294</span>    CalVjpVfpVfn_partial();</div>
<div class="line"><span class="lineno">  295</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  296</span>    CalVfiVfp_full02();</div>
<div class="line"><span class="lineno">  297</span><span class="preprocessor">#endif </span><span class="comment">// OCP_NEW_FIM_n</span></div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>    <span class="comment">// Water Properties</span></div>
<div class="line"><span class="lineno">  301</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> Wpid                  = <a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1;</div>
<div class="line"><span class="lineno">  302</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> Wcid                  = <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> - 1;</div>
<div class="line"><span class="lineno">  303</span>    <a class="code hl_variable" href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">phaseExist</a>[Wpid]          = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  304</span>    <a class="code hl_variable" href="classMixture.html#a9958b097000a344df9bfbdc845db850c">xij</a>[Wpid * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + Wcid] = 1.0;</div>
<div class="line"><span class="lineno">  305</span>    <a class="code hl_variable" href="classMixture.html#aa0d6fa9514fce1774cc277826d304061">nj</a>[Wpid] = <a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[Wcid];</div>
<div class="line"><span class="lineno">  306</span>    <a class="code hl_variable" href="classMixture.html#a9d5376ba600228135d16bbd76d4b38de">Nt</a> = Nh + <a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[Wcid];</div>
<div class="line"><span class="lineno">  307</span>    PVTW.<a class="code hl_function" href="classOCPTable.html#a047b61a09961d8a5015ba8b071320b7b">Eval_All</a>(0, P, data, cdata);</div>
<div class="line"><span class="lineno">  308</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pw0 = data[0];</div>
<div class="line"><span class="lineno">  309</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> bw0 = data[1];</div>
<div class="line"><span class="lineno">  310</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> cbw = data[2];</div>
<div class="line"><span class="lineno">  311</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> bw  = bw0 * (1 - cbw * (P - Pw0));</div>
<div class="line"><span class="lineno">  312</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> bwp = -cbw * bw0;</div>
<div class="line"><span class="lineno">  313</span>    <a class="code hl_variable" href="classMixture.html#a170e493a88e391f9afe0896181d76786">mu</a>[Wpid]    = data[3];</div>
<div class="line"><span class="lineno">  314</span>    <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[Wpid]    = 1 / (<a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a> * bw);</div>
<div class="line"><span class="lineno">  315</span>    <a class="code hl_variable" href="classMixture.html#a16c6595220dc0a04cfa960d44f3016c7">rho</a>[Wpid]   = std_RhoW / bw;</div>
<div class="line"><span class="lineno">  316</span>    <a class="code hl_variable" href="classMixture.html#ae1531b7594246b0b03bdb7d974800ca4">muP</a>[Wpid]   = cdata[3];</div>
<div class="line"><span class="lineno">  317</span>    <a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[Wpid]   = -bwp / (bw * bw * <a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a>);</div>
<div class="line"><span class="lineno">  318</span>    <a class="code hl_variable" href="classMixture.html#a0a42129a94c1ba7c92c9577f0eb0234f">rhoP</a>[Wpid]  = <a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a> * <a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[Wpid] * std_RhoW;</div>
<div class="line"><span class="lineno">  319</span>    <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[Wpid]     = <a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a> * <a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[Wcid] * bw;</div>
<div class="line"><span class="lineno">  320</span>    <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[Wcid]   = <a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a> * bw;</div>
<div class="line"><span class="lineno">  321</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> vwp = <a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a> * <a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[Wcid] * bwp;</div>
<div class="line"><span class="lineno">  322</span>    <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> += <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[Wpid];</div>
<div class="line"><span class="lineno">  323</span>    <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> += vwp;</div>
<div class="line"><span class="lineno">  324</span>    <a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1][<a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> - 1] = <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[Wcid];</div>
<div class="line"><span class="lineno">  325</span>    <a class="code hl_variable" href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">vjp</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1] = vwp;</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>    CalSaturation();</div>
<div class="line"><span class="lineno">  328</span> </div>
<div class="line"><span class="lineno">  329</span><span class="preprocessor">#ifdef OCP_NEW_FIM_n </span></div>
<div class="line"><span class="lineno">  330</span>    CaldXsdXpAPI03();</div>
<div class="line"><span class="lineno">  331</span>    CalXiPn_partial();</div>
<div class="line"><span class="lineno">  332</span>    CalRhoPn_partial();</div>
<div class="line"><span class="lineno">  333</span>    CalMuPn_partial();</div>
<div class="line"><span class="lineno">  334</span>    CalVfiVfp_full03();</div>
<div class="line"><span class="lineno">  335</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  336</span><span class="preprocessor">#ifdef OCP_NEW_FIM</span></div>
<div class="line"><span class="lineno">  337</span>    CaldXsdXpAPI02p();</div>
<div class="line"><span class="lineno">  338</span>    CalXiPNX_partial();</div>
<div class="line"><span class="lineno">  339</span>    CalRhoPX_partial();</div>
<div class="line"><span class="lineno">  340</span>    CalMuPX_partial();</div>
<div class="line"><span class="lineno">  341</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  342</span>    CaldXsdXpAPI02();</div>
<div class="line"><span class="lineno">  343</span>    CalXiPNX_partial();</div>
<div class="line"><span class="lineno">  344</span>    CalRhoPX_partial();</div>
<div class="line"><span class="lineno">  345</span>    CalMuPX_partial();</div>
<div class="line"><span class="lineno">  346</span><span class="preprocessor">#endif </span><span class="comment">// OCP_NEW_FIM</span></div>
<div class="line"><span class="lineno">  347</span><span class="preprocessor">#endif </span><span class="comment">// OCP_NEW_FIM_n</span></div>
<div class="line"><span class="lineno">  348</span> </div>
<div class="line"><span class="lineno">  349</span>    <span class="comment">// Calculate pEnumCom</span></div>
<div class="line"><span class="lineno">  350</span>    fill(<a class="code hl_variable" href="classMixture.html#a12f16b1b3d45f0052be513f14d323835">pEnumCom</a>.begin(), <a class="code hl_variable" href="classMixture.html#a12f16b1b3d45f0052be513f14d323835">pEnumCom</a>.end(), 0.0);</div>
<div class="line"><span class="lineno">  351</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">phaseExist</a>[0]) <a class="code hl_variable" href="classMixture.html#a12f16b1b3d45f0052be513f14d323835">pEnumCom</a>[0] = NC;</div>
<div class="line"><span class="lineno">  352</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">phaseExist</a>[1]) <a class="code hl_variable" href="classMixture.html#a12f16b1b3d45f0052be513f14d323835">pEnumCom</a>[1] = NC;</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>}</div>
<div class="ttc" id="aclassMixture_html_a12f16b1b3d45f0052be513f14d323835"><div class="ttname"><a href="classMixture.html#a12f16b1b3d45f0052be513f14d323835">Mixture::pEnumCom</a></div><div class="ttdeci">vector&lt; USI &gt; pEnumCom</div><div class="ttdoc">see pEnumCom in bulk</div><div class="ttdef"><b>Definition:</b> <a href="Mixture_8hpp_source.html#l00184">Mixture.hpp:184</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="OCPConst_8hpp_source.html#l00059">CONV1</a>, <a class="el" href="DenseMat_8cpp_source.html#l00037">Dcopy()</a>, <a class="el" href="OCPTable_8cpp_source.html#l00046">OCPTable::Eval_All()</a>, <a class="el" href="Mixture_8hpp_source.html#l00157">Mixture::mu</a>, <a class="el" href="Mixture_8hpp_source.html#l00173">Mixture::muP</a>, <a class="el" href="Mixture_8hpp_source.html#l00149">Mixture::Ni</a>, <a class="el" href="Mixture_8hpp_source.html#l00156">Mixture::nj</a>, <a class="el" href="Mixture_8hpp_source.html#l00161">Mixture::Nt</a>, <a class="el" href="Mixture_8hpp_source.html#l00145">Mixture::numCom</a>, <a class="el" href="Mixture_8hpp_source.html#l00144">Mixture::numPhase</a>, <a class="el" href="Mixture_8hpp_source.html#l00184">Mixture::pEnumCom</a>, <a class="el" href="Mixture_8hpp_source.html#l00150">Mixture::phaseExist</a>, <a class="el" href="Mixture_8hpp_source.html#l00152">Mixture::rho</a>, <a class="el" href="Mixture_8hpp_source.html#l00175">Mixture::rhoP</a>, <a class="el" href="Mixture_8hpp_source.html#l00158">Mixture::v</a>, <a class="el" href="Mixture_8hpp_source.html#l00160">Mixture::vf</a>, <a class="el" href="Mixture_8hpp_source.html#l00170">Mixture::vfi</a>, <a class="el" href="Mixture_8hpp_source.html#l00168">Mixture::vfp</a>, <a class="el" href="Mixture_8hpp_source.html#l00165">Mixture::vji</a>, <a class="el" href="Mixture_8hpp_source.html#l00166">Mixture::vjp</a>, <a class="el" href="Mixture_8hpp_source.html#l00153">Mixture::xi</a>, <a class="el" href="Mixture_8hpp_source.html#l00154">Mixture::xij</a>, and <a class="el" href="Mixture_8hpp_source.html#l00174">Mixture::xiP</a>.</p>

</div>
</div>
<a id="aec54b4c31ae55907ffd7449e63f38eac" name="aec54b4c31ae55907ffd7449e63f38eac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec54b4c31ae55907ffd7449e63f38eac">&#9670;&#160;</a></span>FlashDeriv_n()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::FlashDeriv_n </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>Pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>Tin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *&#160;</td>
          <td class="paramname"><em>Niin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *&#160;</td>
          <td class="paramname"><em>Sjin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *&#160;</td>
          <td class="paramname"><em>xijin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *&#160;</td>
          <td class="paramname"><em>njin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;&#160;</td>
          <td class="paramname"><em>ftype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> *&#160;</td>
          <td class="paramname"><em>phaseExistin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;&#160;</td>
          <td class="paramname"><em>lastNP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *&#160;</td>
          <td class="paramname"><em>lastKs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Becareful if NP &gt; 2 (temp)</p>

<p>Implements <a class="el" href="classMixture.html">Mixture</a>.</p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00357">357</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  361</span>{  </div>
<div class="line"><span class="lineno">  362</span>    inputNP = 0;</div>
<div class="line"><span class="lineno">  363</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; <a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a>; j++) {</div>
<div class="line"><span class="lineno">  364</span>        <span class="keywordflow">if</span> (phaseExistin[j] == 1)</div>
<div class="line"><span class="lineno">  365</span>            inputNP++;</div>
<div class="line"><span class="lineno">  366</span>    }</div>
<div class="line"><span class="lineno">  367</span>    inputNP--;</div>
<div class="line"><span class="lineno">  368</span> </div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>    <span class="keywordflow">if</span> (inputNP == 1 || <span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno">  371</span>        ftype = myftype;</div>
<div class="line"><span class="lineno">  372</span>        lNP = lastNP;</div>
<div class="line"><span class="lineno">  373</span>        <span class="keywordflow">if</span> (lNP == 2) {</div>
<div class="line"><span class="lineno">  374</span>            <a class="code hl_function" href="DenseMat_8hpp.html#ae3d6d69eb9175bc2ed3414c44bde7a8d">Dcopy</a>(NC, &amp;lKs[0], lastKs);</div>
<div class="line"><span class="lineno">  375</span>        }</div>
<div class="line"><span class="lineno">  376</span>        CalFlash(Pin, Tin, Niin);</div>
<div class="line"><span class="lineno">  377</span>    }</div>
<div class="line"><span class="lineno">  378</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  380</span>        NP = inputNP;</div>
<div class="line"><span class="lineno">  381</span>        P = Pin; T = Tin;</div>
<div class="line"><span class="lineno">  382</span>        setNi(Niin); </div>
<div class="line"><span class="lineno">  383</span>        CalAiBi();</div>
<div class="line"><span class="lineno">  384</span>        Nh = <a class="code hl_function" href="DenseMat_8hpp.html#accb44af625653de07f0a8dba403348d1">Dnorm1</a>(NC, &amp;<a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[0]);</div>
<div class="line"><span class="lineno">  385</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno">  386</span>            <a class="code hl_variable" href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">phaseExist</a>[j] = phaseExistin[j];</div>
<div class="line"><span class="lineno">  387</span>            <a class="code hl_variable" href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">S</a>[j] = Sjin[j];</div>
<div class="line"><span class="lineno">  388</span>            nu[j] = njin[j]; </div>
<div class="line"><span class="lineno">  389</span>            <a class="code hl_variable" href="classMixture.html#aa0d6fa9514fce1774cc277826d304061">nj</a>[j] = njin[j];</div>
<div class="line"><span class="lineno">  390</span>            <a class="code hl_function" href="DenseMat_8hpp.html#ae3d6d69eb9175bc2ed3414c44bde7a8d">Dcopy</a>(NC, &amp;x[j][0], &amp;xijin[j * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>]);</div>
<div class="line"><span class="lineno">  391</span>            <a class="code hl_function" href="DenseMat_8hpp.html#ae3d6d69eb9175bc2ed3414c44bde7a8d">Dcopy</a>(NC, &amp;<a class="code hl_variable" href="classMixture.html#a9958b097000a344df9bfbdc845db850c">xij</a>[j * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>], &amp;xijin[j * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>]);</div>
<div class="line"><span class="lineno">  392</span>        }</div>
<div class="line"><span class="lineno">  393</span>        CalFugPhiAll();</div>
<div class="line"><span class="lineno">  394</span>        <a class="code hl_variable" href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">S</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1] = Sjin[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1];</div>
<div class="line"><span class="lineno">  395</span>        phaseLabel[0] = <a class="code hl_variable" href="OCPConst_8hpp.html#a704c56c5968152c30c92dbac7dae7be1">OIL</a>;   phaseLabel[1] = <a class="code hl_variable" href="OCPConst_8hpp.html#a25937aac20f17898658d207fed2c0215">GAS</a>;</div>
<div class="line"><span class="lineno">  396</span>        CalMW();</div>
<div class="line"><span class="lineno">  397</span>        CalVfXiRho();</div>
<div class="line"><span class="lineno">  398</span>        CalViscosity();</div>
<div class="line"><span class="lineno">  399</span>        <a class="code hl_function" href="classMixtureComp.html#a04a0d98d3277d79d1403dff71ba21fd5">CopyPhase</a>();</div>
<div class="line"><span class="lineno">  400</span>        CalSurfaceTension();</div>
<div class="line"><span class="lineno">  401</span>    }</div>
<div class="line"><span class="lineno">  402</span> </div>
<div class="line"><span class="lineno">  403</span> </div>
<div class="line"><span class="lineno">  404</span>    CalVjpVfpVfn_partial();</div>
<div class="line"><span class="lineno">  405</span> </div>
<div class="line"><span class="lineno">  406</span>    <span class="comment">// Water Properties</span></div>
<div class="line"><span class="lineno">  407</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> Wpid = <a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1;</div>
<div class="line"><span class="lineno">  408</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> Wcid = <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> - 1;</div>
<div class="line"><span class="lineno">  409</span>    <a class="code hl_variable" href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">phaseExist</a>[Wpid] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  410</span>    <a class="code hl_variable" href="classMixture.html#a9958b097000a344df9bfbdc845db850c">xij</a>[Wpid * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + Wcid] = 1.0;</div>
<div class="line"><span class="lineno">  411</span>    <a class="code hl_variable" href="classMixture.html#aa0d6fa9514fce1774cc277826d304061">nj</a>[Wpid] = <a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[Wcid];</div>
<div class="line"><span class="lineno">  412</span>    <a class="code hl_variable" href="classMixture.html#a9d5376ba600228135d16bbd76d4b38de">Nt</a> = Nh + <a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[Wcid];</div>
<div class="line"><span class="lineno">  413</span>    PVTW.<a class="code hl_function" href="classOCPTable.html#a047b61a09961d8a5015ba8b071320b7b">Eval_All</a>(0, P, data, cdata);</div>
<div class="line"><span class="lineno">  414</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pw0 = data[0];</div>
<div class="line"><span class="lineno">  415</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> bw0 = data[1];</div>
<div class="line"><span class="lineno">  416</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> cbw = data[2];</div>
<div class="line"><span class="lineno">  417</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> bw = bw0 * (1 - cbw * (P - Pw0));</div>
<div class="line"><span class="lineno">  418</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> bwp = -cbw * bw0;</div>
<div class="line"><span class="lineno">  419</span>    <a class="code hl_variable" href="classMixture.html#a170e493a88e391f9afe0896181d76786">mu</a>[Wpid] = data[3];</div>
<div class="line"><span class="lineno">  420</span>    <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[Wpid] = 1 / (<a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a> * bw);</div>
<div class="line"><span class="lineno">  421</span>    <a class="code hl_variable" href="classMixture.html#a16c6595220dc0a04cfa960d44f3016c7">rho</a>[Wpid] = std_RhoW / bw;</div>
<div class="line"><span class="lineno">  422</span>    <a class="code hl_variable" href="classMixture.html#ae1531b7594246b0b03bdb7d974800ca4">muP</a>[Wpid] = cdata[3];</div>
<div class="line"><span class="lineno">  423</span>    <a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[Wpid] = -bwp / (bw * bw * <a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a>);</div>
<div class="line"><span class="lineno">  424</span>    <a class="code hl_variable" href="classMixture.html#a0a42129a94c1ba7c92c9577f0eb0234f">rhoP</a>[Wpid] = <a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a> * <a class="code hl_variable" href="classMixture.html#ad86bd94527d09c2afcf767ce6e3a8a71">xiP</a>[Wpid] * std_RhoW;</div>
<div class="line"><span class="lineno">  425</span>    <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[Wpid] = <a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a> * <a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[Wcid] * bw;</div>
<div class="line"><span class="lineno">  426</span>    <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[Wcid] = <a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a> * bw;</div>
<div class="line"><span class="lineno">  427</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> vwp = <a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a> * <a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[Wcid] * bwp;</div>
<div class="line"><span class="lineno">  428</span>    <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> += <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[Wpid];</div>
<div class="line"><span class="lineno">  429</span>    <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> += vwp;</div>
<div class="line"><span class="lineno">  430</span>    <a class="code hl_variable" href="classMixture.html#a382c30078dd1579e7f375ad2f60e2f44">vji</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1][<a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> - 1] = <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[Wcid];</div>
<div class="line"><span class="lineno">  431</span>    <a class="code hl_variable" href="classMixture.html#a334d229b6dbbc015a9e7de974f08c76d">vjp</a>[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1] = vwp;</div>
<div class="line"><span class="lineno">  432</span> </div>
<div class="line"><span class="lineno">  433</span>    CalSaturation();</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>    <span class="comment">// calculate diff    </span></div>
<div class="line"><span class="lineno">  436</span>    <span class="keywordflow">if</span> (inputNP == NP &amp;&amp; NP == 2 &amp;&amp; <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno">  437</span>        cout &lt;&lt; scientific &lt;&lt; setprecision(3);</div>
<div class="line"><span class="lineno">  438</span>        cout &lt;&lt; <span class="stringliteral">&quot;--------- &quot;</span> &lt;&lt; NP &lt;&lt; <span class="stringliteral">&quot; --------- &quot;</span> &lt;&lt; inputNP &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  439</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno">  440</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j1 = phaseLabel[j];</div>
<div class="line"><span class="lineno">  441</span>            cout &lt;&lt; setw(10) &lt;&lt; <a class="code hl_variable" href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">S</a>[j1] - Sjin[j1] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span></div>
<div class="line"><span class="lineno">  442</span>                &lt;&lt; setw(10) &lt;&lt; (<a class="code hl_variable" href="classMixture.html#aa0d6fa9514fce1774cc277826d304061">nj</a>[j1] - njin[j1]) / njin[j1] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>;</div>
<div class="line"><span class="lineno">  443</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno">  444</span>                cout &lt;&lt; setw(10) &lt;&lt; <a class="code hl_variable" href="classMixture.html#a9958b097000a344df9bfbdc845db850c">xij</a>[j1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + i] - xijin[j1 * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + i] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>;</div>
<div class="line"><span class="lineno">  445</span>            }</div>
<div class="line"><span class="lineno">  446</span>            cout &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  447</span>        }</div>
<div class="line"><span class="lineno">  448</span>        cout &lt;&lt; <a class="code hl_variable" href="classMixture.html#a763d1e12b91ae451b2df175cbc45ef84">S</a>[2] - Sjin[2] &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  449</span>    }</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span> </div>
<div class="line"><span class="lineno">  452</span>    CaldXsdXpAPI03();</div>
<div class="line"><span class="lineno">  453</span>    CalXiPn_partial();</div>
<div class="line"><span class="lineno">  454</span>    CalRhoPn_partial();</div>
<div class="line"><span class="lineno">  455</span>    CalMuPn_partial();</div>
<div class="line"><span class="lineno">  456</span>    CalVfiVfp_full03();</div>
<div class="line"><span class="lineno">  457</span> </div>
<div class="line"><span class="lineno">  458</span>    <span class="comment">// Calculate pEnumCom</span></div>
<div class="line"><span class="lineno">  459</span>    fill(<a class="code hl_variable" href="classMixture.html#a12f16b1b3d45f0052be513f14d323835">pEnumCom</a>.begin(), <a class="code hl_variable" href="classMixture.html#a12f16b1b3d45f0052be513f14d323835">pEnumCom</a>.end(), 0.0);</div>
<div class="line"><span class="lineno">  460</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">phaseExist</a>[0]) <a class="code hl_variable" href="classMixture.html#a12f16b1b3d45f0052be513f14d323835">pEnumCom</a>[0] = NC;</div>
<div class="line"><span class="lineno">  461</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">phaseExist</a>[1]) <a class="code hl_variable" href="classMixture.html#a12f16b1b3d45f0052be513f14d323835">pEnumCom</a>[1] = NC;</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>}</div>
<div class="ttc" id="aOCPConst_8hpp_html_a25937aac20f17898658d207fed2c0215"><div class="ttname"><a href="OCPConst_8hpp.html#a25937aac20f17898658d207fed2c0215">GAS</a></div><div class="ttdeci">const USI GAS</div><div class="ttdoc">Fluid type = gas.</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00083">OCPConst.hpp:83</a></div></div>
<div class="ttc" id="aOCPConst_8hpp_html_a704c56c5968152c30c92dbac7dae7be1"><div class="ttname"><a href="OCPConst_8hpp.html#a704c56c5968152c30c92dbac7dae7be1">OIL</a></div><div class="ttdeci">const USI OIL</div><div class="ttdoc">Fluid type = oil.</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00082">OCPConst.hpp:82</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="OCPConst_8hpp_source.html#l00059">CONV1</a>, <a class="el" href="MixtureComp_8cpp_source.html#l02155">CopyPhase()</a>, <a class="el" href="DenseMat_8cpp_source.html#l00037">Dcopy()</a>, <a class="el" href="DenseMat_8cpp_source.html#l00050">Dnorm1()</a>, <a class="el" href="OCPTable_8cpp_source.html#l00046">OCPTable::Eval_All()</a>, <a class="el" href="OCPConst_8hpp_source.html#l00083">GAS</a>, <a class="el" href="Mixture_8hpp_source.html#l00157">Mixture::mu</a>, <a class="el" href="Mixture_8hpp_source.html#l00173">Mixture::muP</a>, <a class="el" href="Mixture_8hpp_source.html#l00149">Mixture::Ni</a>, <a class="el" href="Mixture_8hpp_source.html#l00156">Mixture::nj</a>, <a class="el" href="Mixture_8hpp_source.html#l00161">Mixture::Nt</a>, <a class="el" href="Mixture_8hpp_source.html#l00145">Mixture::numCom</a>, <a class="el" href="Mixture_8hpp_source.html#l00144">Mixture::numPhase</a>, <a class="el" href="OCPConst_8hpp_source.html#l00082">OIL</a>, <a class="el" href="Mixture_8hpp_source.html#l00184">Mixture::pEnumCom</a>, <a class="el" href="Mixture_8hpp_source.html#l00150">Mixture::phaseExist</a>, <a class="el" href="Mixture_8hpp_source.html#l00152">Mixture::rho</a>, <a class="el" href="Mixture_8hpp_source.html#l00175">Mixture::rhoP</a>, <a class="el" href="Mixture_8hpp_source.html#l00151">Mixture::S</a>, <a class="el" href="Mixture_8hpp_source.html#l00158">Mixture::v</a>, <a class="el" href="Mixture_8hpp_source.html#l00160">Mixture::vf</a>, <a class="el" href="Mixture_8hpp_source.html#l00170">Mixture::vfi</a>, <a class="el" href="Mixture_8hpp_source.html#l00168">Mixture::vfp</a>, <a class="el" href="Mixture_8hpp_source.html#l00165">Mixture::vji</a>, <a class="el" href="Mixture_8hpp_source.html#l00166">Mixture::vjp</a>, <a class="el" href="Mixture_8hpp_source.html#l00153">Mixture::xi</a>, <a class="el" href="Mixture_8hpp_source.html#l00154">Mixture::xij</a>, and <a class="el" href="Mixture_8hpp_source.html#l00174">Mixture::xiP</a>.</p>

</div>
</div>
<a id="a3a9f34f9f35c5ac14421e2345daa1d4d" name="a3a9f34f9f35c5ac14421e2345daa1d4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a9f34f9f35c5ac14421e2345daa1d4d">&#9670;&#160;</a></span>GammaPhaseG()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> MixtureComp::GammaPhaseG </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>Pin</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>return gamma of gas phase, gamma equals to mass density times gravity factor. </p>

<p>Implements <a class="el" href="classMixture.html#a9de9ed64d5f446edba28cbc109ab8f62">Mixture</a>.</p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8hpp_source.html#l00185">185</a> of file <a class="el" href="MixtureComp_8hpp_source.html">MixtureComp.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  185</span>{ <a class="code hl_define" href="UtilError_8hpp.html#aecfc13af45c4bb869301d5ce54cba0af">OCP_ABORT</a>(<span class="stringliteral">&quot;Should not be used in Compositional mode!&quot;</span>); };</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="UtilError_8hpp_source.html#l00047">OCP_ABORT</a>.</p>

</div>
</div>
<a id="a405999f154866821f3513f596d77a6fa" name="a405999f154866821f3513f596d77a6fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a405999f154866821f3513f596d77a6fa">&#9670;&#160;</a></span>GammaPhaseO()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> MixtureComp::GammaPhaseO </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>Pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>Pbbin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>return gamma of oil phase, gamma equals to mass density times gravity factor. </p>

<p>Implements <a class="el" href="classMixture.html#a4b03229a8c9a74f7cc02f7e1bc9f29bd">Mixture</a>.</p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8hpp_source.html#l00184">184</a> of file <a class="el" href="MixtureComp_8hpp_source.html">MixtureComp.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  184</span>{ <a class="code hl_define" href="UtilError_8hpp.html#aecfc13af45c4bb869301d5ce54cba0af">OCP_ABORT</a>(<span class="stringliteral">&quot;Should not be used in Compositional mode!&quot;</span>); };</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="UtilError_8hpp_source.html#l00047">OCP_ABORT</a>.</p>

</div>
</div>
<a id="ab6569e8518d8579046e2633298181b44" name="ab6569e8518d8579046e2633298181b44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6569e8518d8579046e2633298181b44">&#9670;&#160;</a></span>GammaPhaseOG()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> MixtureComp::GammaPhaseOG </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>Pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>Tin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *&#160;</td>
          <td class="paramname"><em>Ziin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >return gamma of hydrocarbon mixture, gamma equals to mass density times gravity factor. </p>

<p>Implements <a class="el" href="classMixture.html#a489c10ddf83a8856fb492476bdc10c37">Mixture</a>.</p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00547">547</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  549</span>{</div>
<div class="line"><span class="lineno">  550</span>    <span class="comment">// assume that only single phase exists here, no matter it&#39;s oil or gas</span></div>
<div class="line"><span class="lineno">  551</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> rhotmp = <a class="code hl_function" href="classMixtureComp.html#adbd472704ecf3f04ffe35316fbbf5ccf">RhoPhase</a>(Pin, Tin, Ziin);</div>
<div class="line"><span class="lineno">  552</span>    <span class="keywordflow">return</span> rhotmp * <a class="code hl_variable" href="OCPConst_8hpp.html#a340b34fe6fb4d1bc8b7544ed32eee7e8">GRAVITY_FACTOR</a>;</div>
<div class="line"><span class="lineno">  553</span>}</div>
<div class="ttc" id="aclassMixtureComp_html_adbd472704ecf3f04ffe35316fbbf5ccf"><div class="ttname"><a href="classMixtureComp.html#adbd472704ecf3f04ffe35316fbbf5ccf">MixtureComp::RhoPhase</a></div><div class="ttdeci">OCP_DBL RhoPhase(const OCP_DBL &amp;Pin, const OCP_DBL &amp;Tin, const OCP_DBL *Ziin) override</div><div class="ttdoc">return mass density of phase.</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8cpp_source.html#l00517">MixtureComp.cpp:517</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="OCPConst_8hpp_source.html#l00052">GRAVITY_FACTOR</a>, and <a class="el" href="MixtureComp_8cpp_source.html#l00517">RhoPhase()</a>.</p>

</div>
</div>
<a id="a5f208b3dbcf938c2512cbb420c7797bb" name="a5f208b3dbcf938c2512cbb420c7797bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f208b3dbcf938c2512cbb420c7797bb">&#9670;&#160;</a></span>GammaPhaseW()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> MixtureComp::GammaPhaseW </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>Pin</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>return gamma of water phase, gamma equals to mass density times gravity factor. </p>

<p>Implements <a class="el" href="classMixture.html#a01d078d68a0a09d1cbb7f69a92090a56">Mixture</a>.</p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00536">536</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  537</span>{</div>
<div class="line"><span class="lineno">  538</span>    PVTW.<a class="code hl_function" href="classOCPTable.html#a047b61a09961d8a5015ba8b071320b7b">Eval_All</a>(0, Pin, data, cdata);</div>
<div class="line"><span class="lineno">  539</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pw0 = data[0];</div>
<div class="line"><span class="lineno">  540</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> bw0 = data[1];</div>
<div class="line"><span class="lineno">  541</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> cbw = data[2];</div>
<div class="line"><span class="lineno">  542</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> bw  = (bw0 * (1 - cbw * (Pin - Pw0)));</div>
<div class="line"><span class="lineno">  543</span> </div>
<div class="line"><span class="lineno">  544</span>    <span class="keywordflow">return</span> std_GammaW / bw;</div>
<div class="line"><span class="lineno">  545</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="OCPTable_8cpp_source.html#l00046">OCPTable::Eval_All()</a>.</p>

</div>
</div>
<a id="aab79a234af33bcd0af7c892ef2a4389d" name="aab79a234af33bcd0af7c892ef2a4389d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab79a234af33bcd0af7c892ef2a4389d">&#9670;&#160;</a></span>GetErrorPEC()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> MixtureComp::GetErrorPEC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classMixture.html">Mixture</a>.</p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8hpp_source.html#l00131">131</a> of file <a class="el" href="MixtureComp_8hpp_source.html">MixtureComp.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  131</span>{ <span class="keywordflow">return</span> ePEC; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aeefcb156305678f735a32db2d9f31900" name="aeefcb156305678f735a32db2d9f31900"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeefcb156305678f735a32db2d9f31900">&#9670;&#160;</a></span>GetFlagSkip()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MixtureComp::GetFlagSkip </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classMixture.html">Mixture</a>.</p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8hpp_source.html#l00350">350</a> of file <a class="el" href="MixtureComp_8hpp_source.html">MixtureComp.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  350</span>{ <span class="keywordflow">return</span> flagSkip; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aea695edd604aa0523a6d2cccbefc9b87" name="aea695edd604aa0523a6d2cccbefc9b87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea695edd604aa0523a6d2cccbefc9b87">&#9670;&#160;</a></span>GetFtype()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> MixtureComp::GetFtype </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classMixture.html">Mixture</a>.</p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8hpp_source.html#l00194">194</a> of file <a class="el" href="MixtureComp_8hpp_source.html">MixtureComp.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  194</span>{ <span class="keywordflow">return</span> ftype; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a985a745b95690525a2d6e4462cf60c39" name="a985a745b95690525a2d6e4462cf60c39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a985a745b95690525a2d6e4462cf60c39">&#9670;&#160;</a></span>GetMinEigenSkip()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a4cf987f6993b48c88ec4970ad351b100">OCP_SIN</a> MixtureComp::GetMinEigenSkip </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classMixture.html">Mixture</a>.</p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8hpp_source.html#l00349">349</a> of file <a class="el" href="MixtureComp_8hpp_source.html">MixtureComp.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  349</span>{ <span class="keywordflow">return</span> eigenSkip[0]; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a85c6f061fd1afad9d7d6b7a5d8d91fc1" name="a85c6f061fd1afad9d7d6b7a5d8d91fc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85c6f061fd1afad9d7d6b7a5d8d91fc1">&#9670;&#160;</a></span>GetNRSPiters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#af7bad630928e2d245f39e3dc63ab3d93">OCP_ULL</a> MixtureComp::GetNRSPiters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classMixture.html">Mixture</a>.</p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8hpp_source.html#l00135">135</a> of file <a class="el" href="MixtureComp_8hpp_source.html">MixtureComp.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  135</span>{ <span class="keywordflow">return</span> NRSPiters; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4820f19bab85674e0e0e3a049d48d451" name="a4820f19bab85674e0e0e3a049d48d451"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4820f19bab85674e0e0e3a049d48d451">&#9670;&#160;</a></span>GetNRSTAiters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#af7bad630928e2d245f39e3dc63ab3d93">OCP_ULL</a> MixtureComp::GetNRSTAiters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classMixture.html">Mixture</a>.</p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8hpp_source.html#l00133">133</a> of file <a class="el" href="MixtureComp_8hpp_source.html">MixtureComp.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  133</span>{ <span class="keywordflow">return</span> NRSTAiters; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="adf1ac0ad6a024d267c5f0b9e646641b4" name="adf1ac0ad6a024d267c5f0b9e646641b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf1ac0ad6a024d267c5f0b9e646641b4">&#9670;&#160;</a></span>GetSSMSPiters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#af7bad630928e2d245f39e3dc63ab3d93">OCP_ULL</a> MixtureComp::GetSSMSPiters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classMixture.html">Mixture</a>.</p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8hpp_source.html#l00134">134</a> of file <a class="el" href="MixtureComp_8hpp_source.html">MixtureComp.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  134</span>{ <span class="keywordflow">return</span> SSMSPiters; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aae0fdd993eabded8f675ce17dfa8aa36" name="aae0fdd993eabded8f675ce17dfa8aa36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae0fdd993eabded8f675ce17dfa8aa36">&#9670;&#160;</a></span>GetSSMSTAiters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#af7bad630928e2d245f39e3dc63ab3d93">OCP_ULL</a> MixtureComp::GetSSMSTAiters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classMixture.html">Mixture</a>.</p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8hpp_source.html#l00132">132</a> of file <a class="el" href="MixtureComp_8hpp_source.html">MixtureComp.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  132</span>{ <span class="keywordflow">return</span> SSMSTAiters; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af5be5e6f2901bd71ff9103fc50a473cd" name="af5be5e6f2901bd71ff9103fc50a473cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5be5e6f2901bd71ff9103fc50a473cd">&#9670;&#160;</a></span>GetSurTen()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> MixtureComp::GetSurTen </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classMixture.html">Mixture</a>.</p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8hpp_source.html#l00196">196</a> of file <a class="el" href="MixtureComp_8hpp_source.html">MixtureComp.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  196</span>{ <span class="keywordflow">return</span> surTen; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1ff5eb07a2ed632bb5e9d37f79cc5314" name="a1ff5eb07a2ed632bb5e9d37f79cc5314"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ff5eb07a2ed632bb5e9d37f79cc5314">&#9670;&#160;</a></span>IdentifyPhase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::IdentifyPhase </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l02121">2121</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2122</span>{</div>
<div class="line"><span class="lineno"> 2123</span>    <a class="code hl_variable" href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">phaseExist</a>[0] = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2124</span>    <a class="code hl_variable" href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">phaseExist</a>[1] = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2125</span>    <span class="keywordflow">if</span> (NP == 1) {</div>
<div class="line"><span class="lineno"> 2126</span>        <span class="comment">// Critical Temperature Method</span></div>
<div class="line"><span class="lineno"> 2127</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> A = 0;</div>
<div class="line"><span class="lineno"> 2128</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> B = 0;</div>
<div class="line"><span class="lineno"> 2129</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 2130</span>            A += x[0][i] * Vc[i] * Tc[i];</div>
<div class="line"><span class="lineno"> 2131</span>            B += x[0][i] * Vc[i];</div>
<div class="line"><span class="lineno"> 2132</span>        }</div>
<div class="line"><span class="lineno"> 2133</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Tc = A / B;</div>
<div class="line"><span class="lineno"> 2134</span>        <span class="keywordflow">if</span> (T &gt; Tc) {</div>
<div class="line"><span class="lineno"> 2135</span>            phaseLabel[0] = <a class="code hl_variable" href="OCPConst_8hpp.html#a25937aac20f17898658d207fed2c0215">GAS</a>;</div>
<div class="line"><span class="lineno"> 2136</span>            <a class="code hl_variable" href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">phaseExist</a>[1] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2137</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2138</span>            phaseLabel[0] = <a class="code hl_variable" href="OCPConst_8hpp.html#a704c56c5968152c30c92dbac7dae7be1">OIL</a>;</div>
<div class="line"><span class="lineno"> 2139</span>            <a class="code hl_variable" href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">phaseExist</a>[0] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2140</span>        }</div>
<div class="line"><span class="lineno"> 2141</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2142</span>        <span class="comment">// Compare MW</span></div>
<div class="line"><span class="lineno"> 2143</span>        <span class="keywordflow">if</span> (MW[0] &gt; MW[1]) {</div>
<div class="line"><span class="lineno"> 2144</span>            phaseLabel[0] = <a class="code hl_variable" href="OCPConst_8hpp.html#a704c56c5968152c30c92dbac7dae7be1">OIL</a>;</div>
<div class="line"><span class="lineno"> 2145</span>            phaseLabel[1] = <a class="code hl_variable" href="OCPConst_8hpp.html#a25937aac20f17898658d207fed2c0215">GAS</a>;</div>
<div class="line"><span class="lineno"> 2146</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2147</span>            phaseLabel[0] = <a class="code hl_variable" href="OCPConst_8hpp.html#a25937aac20f17898658d207fed2c0215">GAS</a>;</div>
<div class="line"><span class="lineno"> 2148</span>            phaseLabel[1] = <a class="code hl_variable" href="OCPConst_8hpp.html#a704c56c5968152c30c92dbac7dae7be1">OIL</a>;</div>
<div class="line"><span class="lineno"> 2149</span>        }</div>
<div class="line"><span class="lineno"> 2150</span>        <a class="code hl_variable" href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">phaseExist</a>[0] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2151</span>        <a class="code hl_variable" href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">phaseExist</a>[1] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2152</span>    }</div>
<div class="line"><span class="lineno"> 2153</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8b72cc6b06566e239085d0ca4bbc4606" name="a8b72cc6b06566e239085d0ca4bbc4606"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b72cc6b06566e239085d0ca4bbc4606">&#9670;&#160;</a></span>InitFlash()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::InitFlash </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>Pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>Pbbin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>Tin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *&#160;</td>
          <td class="paramname"><em>Sjin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>Vpore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *&#160;</td>
          <td class="paramname"><em>Ziin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>flash calculation with saturation of phases. </p>

<p>Implements <a class="el" href="classMixture.html#a35f1e56ebe2fa3275c508ac6ebf86cba">Mixture</a>.</p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00174">174</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  177</span>{</div>
<div class="line"><span class="lineno">  178</span>    <span class="comment">// Attention: zi[numCom - 1] = 0 here, that&#39;s Zw = 0;</span></div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>    ftype = 0;</div>
<div class="line"><span class="lineno">  181</span>    lNP   = 0;</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>    Nh    = 1;</div>
<div class="line"><span class="lineno">  184</span>    nu[0] = 1;</div>
<div class="line"><span class="lineno">  185</span>    setPT(Pin, Tin);</div>
<div class="line"><span class="lineno">  186</span>    setZi(Ziin);</div>
<div class="line"><span class="lineno">  187</span>    PhaseEquilibrium();</div>
<div class="line"><span class="lineno">  188</span>    <span class="comment">// Attention Nt = 1 now</span></div>
<div class="line"><span class="lineno">  189</span>    CalMW();</div>
<div class="line"><span class="lineno">  190</span>    CalVfXiRho();</div>
<div class="line"><span class="lineno">  191</span>    CalViscosity();</div>
<div class="line"><span class="lineno">  192</span>    CalSurfaceTension();</div>
<div class="line"><span class="lineno">  193</span>    IdentifyPhase();</div>
<div class="line"><span class="lineno">  194</span>    <a class="code hl_function" href="classMixtureComp.html#a04a0d98d3277d79d1403dff71ba21fd5">CopyPhase</a>();</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span>    <span class="comment">// Calulate Nt, water is exclued</span></div>
<div class="line"><span class="lineno">  197</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Sw = Sjin[<a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1];</div>
<div class="line"><span class="lineno">  198</span>    Nh         = Vpore * (1 - Sw) / <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a>;</div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span>    <span class="comment">// Next, nu represents moles of phase instead of molar fraction of phase</span></div>
<div class="line"><span class="lineno">  201</span>    <a class="code hl_function" href="DenseMat_8hpp.html#a3fb701e3ab34443119b7b2ba7a2bc6c7">Dscalar</a>(NP, Nh, &amp;nu[0]);</div>
<div class="line"><span class="lineno">  202</span>    <span class="comment">// correct vj, vf with new Nt</span></div>
<div class="line"><span class="lineno">  203</span>    <a class="code hl_function" href="DenseMat_8hpp.html#a3fb701e3ab34443119b7b2ba7a2bc6c7">Dscalar</a>(NPmax, Nh, &amp;<a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[0]);</div>
<div class="line"><span class="lineno">  204</span>    <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> *= Nh;</div>
<div class="line"><span class="lineno">  205</span>    <span class="comment">//CalVfiVfp_full01();</span></div>
<div class="line"><span class="lineno">  206</span>    CalVfiVfp_full02();</div>
<div class="line"><span class="lineno">  207</span>    <span class="comment">// Calculate Ni</span></div>
<div class="line"><span class="lineno">  208</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno">  209</span>        <a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[i] = zi[i] * Nh;</div>
<div class="line"><span class="lineno">  210</span>    }</div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>    <span class="comment">// Water Properties</span></div>
<div class="line"><span class="lineno">  213</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> Wpid                  = <a class="code hl_variable" href="classMixture.html#a33b6d34ba499a57d9923d5316b652efc">numPhase</a> - 1;</div>
<div class="line"><span class="lineno">  214</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> Wcid                  = <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> - 1;</div>
<div class="line"><span class="lineno">  215</span>    <a class="code hl_variable" href="classMixture.html#a1a1b7838c46e07a94c3a95ae9b37e511">phaseExist</a>[Wpid]          = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  216</span>    <a class="code hl_variable" href="classMixture.html#a9958b097000a344df9bfbdc845db850c">xij</a>[Wpid * <a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> + Wcid] = 1.0;</div>
<div class="line"><span class="lineno">  217</span>    PVTW.<a class="code hl_function" href="classOCPTable.html#a047b61a09961d8a5015ba8b071320b7b">Eval_All</a>(0, P, data, cdata);</div>
<div class="line"><span class="lineno">  218</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pw0 = data[0];</div>
<div class="line"><span class="lineno">  219</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> bw0 = data[1];</div>
<div class="line"><span class="lineno">  220</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> cbw = data[2];</div>
<div class="line"><span class="lineno">  221</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> bw  = bw0 * (1 - cbw * (P - Pw0));</div>
<div class="line"><span class="lineno">  222</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> bwp = -cbw * bw0;</div>
<div class="line"><span class="lineno">  223</span>    <a class="code hl_variable" href="classMixture.html#a170e493a88e391f9afe0896181d76786">mu</a>[Wpid]    = data[3];</div>
<div class="line"><span class="lineno">  224</span>    <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[Wpid]    = 1 / (<a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a> * bw);</div>
<div class="line"><span class="lineno">  225</span>    <a class="code hl_variable" href="classMixture.html#a16c6595220dc0a04cfa960d44f3016c7">rho</a>[Wpid]   = std_RhoW / bw;</div>
<div class="line"><span class="lineno">  226</span>    <a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[Wcid]    = Vpore * Sw * <a class="code hl_variable" href="classMixture.html#afad5616464982e92b25adba0c84f4eb5">xi</a>[Wpid];</div>
<div class="line"><span class="lineno">  227</span>    <a class="code hl_variable" href="classMixture.html#a9d5376ba600228135d16bbd76d4b38de">Nt</a> = Nh + <a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[Wcid];</div>
<div class="line"><span class="lineno">  228</span>    <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[Wpid] = <a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a> * <a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[Wcid] * bw;</div>
<div class="line"><span class="lineno">  229</span>    <a class="code hl_variable" href="classMixture.html#ad8a687cfb963101e8fdddb1467fa2c1f">vf</a> += <a class="code hl_variable" href="classMixture.html#a7463b9517217397b77d51012f4367a28">v</a>[Wpid];</div>
<div class="line"><span class="lineno">  230</span>    <a class="code hl_variable" href="classMixture.html#ab4dd3e54d542aca8eccdcbd208a38504">vfi</a>[Wcid] = <a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a> * bw;</div>
<div class="line"><span class="lineno">  231</span>    <a class="code hl_variable" href="classMixture.html#adf4f5e549cc50a366951dba65d196198">vfp</a> += <a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a> * <a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[Wcid] * bwp;</div>
<div class="line"><span class="lineno">  232</span> </div>
<div class="line"><span class="lineno">  233</span>    <span class="comment">// Calculate Sj</span></div>
<div class="line"><span class="lineno">  234</span>    CalSaturation();</div>
<div class="line"><span class="lineno">  235</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="OCPConst_8hpp_source.html#l00059">CONV1</a>, <a class="el" href="MixtureComp_8cpp_source.html#l02155">CopyPhase()</a>, <a class="el" href="DenseMat_8cpp_source.html#l00062">Dscalar()</a>, <a class="el" href="OCPTable_8cpp_source.html#l00046">OCPTable::Eval_All()</a>, <a class="el" href="Mixture_8hpp_source.html#l00157">Mixture::mu</a>, <a class="el" href="Mixture_8hpp_source.html#l00149">Mixture::Ni</a>, <a class="el" href="Mixture_8hpp_source.html#l00161">Mixture::Nt</a>, <a class="el" href="Mixture_8hpp_source.html#l00145">Mixture::numCom</a>, <a class="el" href="Mixture_8hpp_source.html#l00144">Mixture::numPhase</a>, <a class="el" href="Mixture_8hpp_source.html#l00150">Mixture::phaseExist</a>, <a class="el" href="Mixture_8hpp_source.html#l00152">Mixture::rho</a>, <a class="el" href="Mixture_8hpp_source.html#l00158">Mixture::v</a>, <a class="el" href="Mixture_8hpp_source.html#l00160">Mixture::vf</a>, <a class="el" href="Mixture_8hpp_source.html#l00170">Mixture::vfi</a>, <a class="el" href="Mixture_8hpp_source.html#l00168">Mixture::vfp</a>, <a class="el" href="Mixture_8hpp_source.html#l00153">Mixture::xi</a>, and <a class="el" href="Mixture_8hpp_source.html#l00154">Mixture::xij</a>.</p>

</div>
</div>
<a id="a2740a0dd827b57af17e7b3f7888ccfde" name="a2740a0dd827b57af17e7b3f7888ccfde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2740a0dd827b57af17e7b3f7888ccfde">&#9670;&#160;</a></span>PhaseEquilibrium()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::PhaseEquilibrium </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00989">989</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  990</span>{</div>
<div class="line"><span class="lineno">  991</span>    NP   = 1;</div>
<div class="line"><span class="lineno">  992</span>    x[0] = zi;</div>
<div class="line"><span class="lineno">  993</span>    CalAiBi();</div>
<div class="line"><span class="lineno">  994</span>    CalAjBj(Aj[0], Bj[0], x[0]);</div>
<div class="line"><span class="lineno">  995</span>    SolEoS(Zj[0], Aj[0], Bj[0]);</div>
<div class="line"><span class="lineno">  996</span> </div>
<div class="line"><span class="lineno">  997</span>    flagSkip = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  998</span> </div>
<div class="line"><span class="lineno">  999</span>    <span class="comment">// tmpFtype = ftype;</span></div>
<div class="line"><span class="lineno"> 1000</span>    <span class="comment">// ftype = 0;</span></div>
<div class="line"><span class="lineno"> 1001</span> </div>
<div class="line"><span class="lineno"> 1002</span>    <span class="keywordflow">switch</span> (ftype) {</div>
<div class="line"><span class="lineno"> 1003</span>        <span class="keywordflow">case</span> 0:</div>
<div class="line"><span class="lineno"> 1004</span>            <span class="comment">// flash from single phase</span></div>
<div class="line"><span class="lineno"> 1005</span>            CalKwilson();</div>
<div class="line"><span class="lineno"> 1006</span>            <span class="keywordflow">while</span> (!PhaseStable()) {</div>
<div class="line"><span class="lineno"> 1007</span>                NP++;</div>
<div class="line"><span class="lineno"> 1008</span>                PhaseSplit();</div>
<div class="line"><span class="lineno"> 1009</span>                <span class="keywordflow">if</span> (NP == NPmax || NP == 1) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1010</span>            }</div>
<div class="line"><span class="lineno"> 1011</span>            <span class="comment">// record error</span></div>
<div class="line"><span class="lineno"> 1012</span>            <span class="keywordflow">if</span> (NP == 1) {</div>
<div class="line"><span class="lineno"> 1013</span>                <span class="keywordflow">if</span> (EoSctrl.NRsta.<a class="code hl_variable" href="classNRparamSTA.html#a3acf7b521ae923bea18cb7317773877f">conflag</a>)</div>
<div class="line"><span class="lineno"> 1014</span>                    ePEC = EoSctrl.NRsta.<a class="code hl_variable" href="classNRparamSTA.html#a61fadf74bf5639d9fce2d7c256d25ad7">realTol</a>;</div>
<div class="line"><span class="lineno"> 1015</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#a8edb30773a4bf5767ba6020519277d7b">conflag</a>)</div>
<div class="line"><span class="lineno"> 1016</span>                    ePEC = EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#a17207f8db073cbeeb39cf6900c5127c9">realTol</a>;</div>
<div class="line"><span class="lineno"> 1017</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1018</span>                    ePEC = 1E8;</div>
<div class="line"><span class="lineno"> 1019</span>            }</div>
<div class="line"><span class="lineno"> 1020</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1021</span>                <span class="keywordflow">if</span> (EoSctrl.NRsp.<a class="code hl_variable" href="classNRparamSP.html#a9c9b51d4724052f1f8d382cd33ba2b0a">conflag</a>)</div>
<div class="line"><span class="lineno"> 1022</span>                    ePEC = EoSctrl.NRsp.<a class="code hl_variable" href="classNRparamSP.html#aed7856955acd84622f1df9454a47b8c0">realTol</a>;</div>
<div class="line"><span class="lineno"> 1023</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (EoSctrl.SSMsp.<a class="code hl_variable" href="classSSMparamSP.html#a05d81a40beea3948897c6d30d27a4bc2">conflag</a>)</div>
<div class="line"><span class="lineno"> 1024</span>                    ePEC = EoSctrl.SSMsp.<a class="code hl_variable" href="classSSMparamSP.html#a9a13a509d652ba8fe7877074e13a8672">realTol</a>;</div>
<div class="line"><span class="lineno"> 1025</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1026</span>                    ePEC = 1E8;</div>
<div class="line"><span class="lineno"> 1027</span>            }</div>
<div class="line"><span class="lineno"> 1028</span> </div>
<div class="line"><span class="lineno"> 1029</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1030</span>        <span class="keywordflow">case</span> 1:</div>
<div class="line"><span class="lineno"> 1031</span>            <span class="comment">// Skip Phase Stability analysis, only single phase exists</span></div>
<div class="line"><span class="lineno"> 1032</span>            NP = 1; </div>
<div class="line"><span class="lineno"> 1033</span>            <span class="comment">// record error</span></div>
<div class="line"><span class="lineno"> 1034</span>            ePEC = 0.0;</div>
<div class="line"><span class="lineno"> 1035</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1036</span> </div>
<div class="line"><span class="lineno"> 1037</span>        <span class="keywordflow">case</span> 2: <span class="comment">// not used now</span></div>
<div class="line"><span class="lineno"> 1038</span>            <span class="comment">// Skip Phase Stability analysis, two phases exist</span></div>
<div class="line"><span class="lineno"> 1039</span>            CalKwilson();</div>
<div class="line"><span class="lineno"> 1040</span>            NP                    = 2;</div>
<div class="line"><span class="lineno"> 1041</span>            EoSctrl.SSMsp.<a class="code hl_variable" href="classSSMparamSP.html#a05d81a40beea3948897c6d30d27a4bc2">conflag</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1042</span>            EoSctrl.NRsp.<a class="code hl_variable" href="classNRparamSP.html#a9c9b51d4724052f1f8d382cd33ba2b0a">conflag</a>  = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1043</span>            Ks[NP - 2]            = Kw[0];</div>
<div class="line"><span class="lineno"> 1044</span>            SplitSSM(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1045</span>            SplitNR();</div>
<div class="line"><span class="lineno"> 1046</span>            <span class="keywordflow">while</span> (!EoSctrl.NRsp.<a class="code hl_variable" href="classNRparamSP.html#a9c9b51d4724052f1f8d382cd33ba2b0a">conflag</a>) {</div>
<div class="line"><span class="lineno"> 1047</span>                SplitSSM(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1048</span>                SplitNR();</div>
<div class="line"><span class="lineno"> 1049</span>                <span class="keywordflow">if</span> (!CheckSplit()) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1050</span>                <span class="keywordflow">if</span> (EoSctrl.SSMsp.<a class="code hl_variable" href="classSSMparamSP.html#a05d81a40beea3948897c6d30d27a4bc2">conflag</a>) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1051</span>            }</div>
<div class="line"><span class="lineno"> 1052</span>            CheckSplit();</div>
<div class="line"><span class="lineno"> 1053</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1054</span> </div>
<div class="line"><span class="lineno"> 1055</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1056</span>            <a class="code hl_define" href="UtilError_8hpp.html#aecfc13af45c4bb869301d5ce54cba0af">OCP_ABORT</a>(<span class="stringliteral">&quot;Wrong flash type!&quot;</span>);</div>
<div class="line"><span class="lineno"> 1057</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1058</span>    }</div>
<div class="line"><span class="lineno"> 1059</span> </div>
<div class="line"><span class="lineno"> 1060</span>    <span class="keywordflow">if</span> (NP &gt; 1)  flagSkip = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1061</span>    <span class="keywordflow">if</span> (NP == 1 &amp;&amp; ftype == 0 &amp;&amp; flagSkip) {</div>
<div class="line"><span class="lineno"> 1062</span>        <a class="code hl_function" href="classMixtureComp.html#a3bc05dc7dba2aa52761afe81bd033a26">CalPhiNSTA</a>();</div>
<div class="line"><span class="lineno"> 1063</span>        AssembleSkipMatSTA();</div>
<div class="line"><span class="lineno"> 1064</span><span class="preprocessor">#ifdef _DEBUG</span></div>
<div class="line"><span class="lineno"> 1065</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="DenseMat_8hpp.html#a56bc3abd4d498e5055b3da3a58d45bad">CheckNan</a>(skipMatSTA.size(), &amp;skipMatSTA[0])) {</div>
<div class="line"><span class="lineno"> 1066</span>            <a class="code hl_define" href="UtilError_8hpp.html#a9873f9158c73c6b79a8e3cb9c0dc8e4a">OCP_WARNING</a>(<span class="stringliteral">&quot;Nan in skipMatSTA!&quot;</span>);</div>
<div class="line"><span class="lineno"> 1067</span>        }</div>
<div class="line"><span class="lineno"> 1068</span><span class="preprocessor">#endif </span><span class="comment">// _DEBUG </span></div>
<div class="line"><span class="lineno"> 1069</span> </div>
<div class="line"><span class="lineno"> 1070</span>        <a class="code hl_function" href="DenseMat_8hpp.html#a6ee439e768dcede341bc3f03c9d63e00">MinEigenSY</a>(NC, &amp;skipMatSTA[0], &amp;eigenSkip[0], &amp;eigenWork[0], leigenWork);</div>
<div class="line"><span class="lineno"> 1071</span>        <span class="comment">// PrintDX(NC, &amp;eigenSkip[0]);</span></div>
<div class="line"><span class="lineno"> 1072</span>        <span class="comment">// cout &lt;&lt; &quot;done!&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1073</span>    }</div>
<div class="line"><span class="lineno"> 1074</span>}</div>
<div class="ttc" id="aDenseMat_8hpp_html_a6ee439e768dcede341bc3f03c9d63e00"><div class="ttname"><a href="DenseMat_8hpp.html#a6ee439e768dcede341bc3f03c9d63e00">MinEigenSY</a></div><div class="ttdeci">void MinEigenSY(const int &amp;N, float *A, float *w, float *work, const int &amp;lwork)</div><div class="ttdoc">Calculate the minimal eigenvalue for sysmetric matrix with mkl lapack.</div><div class="ttdef"><b>Definition:</b> <a href="DenseMat_8cpp_source.html#l00014">DenseMat.cpp:14</a></div></div>
<div class="ttc" id="aUtilError_8hpp_html_a9873f9158c73c6b79a8e3cb9c0dc8e4a"><div class="ttname"><a href="UtilError_8hpp.html#a9873f9158c73c6b79a8e3cb9c0dc8e4a">OCP_WARNING</a></div><div class="ttdeci">#define OCP_WARNING(msg)</div><div class="ttdoc">Log warning messages.</div><div class="ttdef"><b>Definition:</b> <a href="UtilError_8hpp_source.html#l00039">UtilError.hpp:39</a></div></div>
<div class="ttc" id="aclassMixtureComp_html_a3bc05dc7dba2aa52761afe81bd033a26"><div class="ttname"><a href="classMixtureComp.html#a3bc05dc7dba2aa52761afe81bd033a26">MixtureComp::CalPhiNSTA</a></div><div class="ttdeci">void CalPhiNSTA()</div><div class="ttdoc">Calculate d ln phi[i][j] / d n[k][j].</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8cpp_source.html#l01974">MixtureComp.cpp:1974</a></div></div>
<div class="ttc" id="aclassNRparamSP_html_aed7856955acd84622f1df9454a47b8c0"><div class="ttname"><a href="classNRparamSP.html#aed7856955acd84622f1df9454a47b8c0">NRparamSP::realTol</a></div><div class="ttdeci">OCP_DBL realTol</div><div class="ttdoc">Real tol.</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00079">MixtureComp.hpp:79</a></div></div>
<div class="ttc" id="aclassNRparamSTA_html_a61fadf74bf5639d9fce2d7c256d25ad7"><div class="ttname"><a href="classNRparamSTA.html#a61fadf74bf5639d9fce2d7c256d25ad7">NRparamSTA::realTol</a></div><div class="ttdeci">OCP_DBL realTol</div><div class="ttdoc">Real tol.</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00051">MixtureComp.hpp:51</a></div></div>
<div class="ttc" id="aclassSSMparamSP_html_a05d81a40beea3948897c6d30d27a4bc2"><div class="ttname"><a href="classSSMparamSP.html#a05d81a40beea3948897c6d30d27a4bc2">SSMparamSP::conflag</a></div><div class="ttdeci">bool conflag</div><div class="ttdoc">convergence flag, if converges, conflag = true</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00066">MixtureComp.hpp:66</a></div></div>
<div class="ttc" id="aclassSSMparamSP_html_a9a13a509d652ba8fe7877074e13a8672"><div class="ttname"><a href="classSSMparamSP.html#a9a13a509d652ba8fe7877074e13a8672">SSMparamSP::realTol</a></div><div class="ttdeci">OCP_DBL realTol</div><div class="ttdoc">Real tol.</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00065">MixtureComp.hpp:65</a></div></div>
<div class="ttc" id="aclassSSMparamSTA_html_a17207f8db073cbeeb39cf6900c5127c9"><div class="ttname"><a href="classSSMparamSTA.html#a17207f8db073cbeeb39cf6900c5127c9">SSMparamSTA::realTol</a></div><div class="ttdeci">OCP_DBL realTol</div><div class="ttdoc">Real tol.</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00037">MixtureComp.hpp:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a409ea8976c8718296c0f9c467aa13393" name="a409ea8976c8718296c0f9c467aa13393"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a409ea8976c8718296c0f9c467aa13393">&#9670;&#160;</a></span>PhaseSplit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::PhaseSplit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l01507">1507</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1508</span>{</div>
<div class="line"><span class="lineno"> 1509</span>    EoSctrl.SSMsp.<a class="code hl_variable" href="classSSMparamSP.html#a05d81a40beea3948897c6d30d27a4bc2">conflag</a> = <span class="keyword">false</span>;   </div>
<div class="line"><span class="lineno"> 1510</span>    EoSctrl.SSMsp.<a class="code hl_variable" href="classSSMparamSP.html#a28e78dd994ba4610aeef8d49ab552044">curIt</a> = 0;</div>
<div class="line"><span class="lineno"> 1511</span>    EoSctrl.NRsp.<a class="code hl_variable" href="classNRparamSP.html#a9c9b51d4724052f1f8d382cd33ba2b0a">conflag</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1512</span>    EoSctrl.NRsp.<a class="code hl_variable" href="classNRparamSP.html#a6792b7efbb8165c655ed01e9ec8316b6">curIt</a> = 0;</div>
<div class="line"><span class="lineno"> 1513</span> </div>
<div class="line"><span class="lineno"> 1514</span>    SplitSSM(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1515</span>    SplitNR();</div>
<div class="line"><span class="lineno"> 1516</span>    <span class="keywordflow">while</span> (!EoSctrl.NRsp.<a class="code hl_variable" href="classNRparamSP.html#a9c9b51d4724052f1f8d382cd33ba2b0a">conflag</a>) {</div>
<div class="line"><span class="lineno"> 1517</span>        SplitSSM(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1518</span>        SplitNR();</div>
<div class="line"><span class="lineno"> 1519</span>        <span class="keywordflow">if</span> (!CheckSplit()) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1520</span>        <span class="keywordflow">if</span> (EoSctrl.SSMsp.<a class="code hl_variable" href="classSSMparamSP.html#a05d81a40beea3948897c6d30d27a4bc2">conflag</a>) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1521</span>    }</div>
<div class="line"><span class="lineno"> 1522</span>    CheckSplit();</div>
<div class="line"><span class="lineno"> 1523</span> </div>
<div class="line"><span class="lineno"> 1524</span>    SSMSPiters += EoSctrl.SSMsp.<a class="code hl_variable" href="classSSMparamSP.html#a28e78dd994ba4610aeef8d49ab552044">curIt</a>;</div>
<div class="line"><span class="lineno"> 1525</span>    NRSPiters += EoSctrl.NRsp.<a class="code hl_variable" href="classNRparamSP.html#a6792b7efbb8165c655ed01e9ec8316b6">curIt</a>;</div>
<div class="line"><span class="lineno"> 1526</span> </div>
<div class="line"><span class="lineno"> 1527</span>    <span class="comment">//cout &lt;&lt; scientific &lt;&lt; setprecision(8);</span></div>
<div class="line"><span class="lineno"> 1528</span>    <span class="comment">//for (USI i = 0; i &lt; NC; i++) {</span></div>
<div class="line"><span class="lineno"> 1529</span>    <span class="comment">//    cout &lt;&lt; x[0][i] / x[1][i] &lt;&lt; &quot;   &quot;;</span></div>
<div class="line"><span class="lineno"> 1530</span>    <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 1531</span>    <span class="comment">//cout &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1532</span>    <span class="comment">//cout &lt;&lt; &quot;Yt = &quot; &lt;&lt; scientific &lt;&lt; setprecision(12) &lt;&lt; Yt &lt;&lt; &quot;   &quot;</span></div>
<div class="line"><span class="lineno"> 1533</span>    <span class="comment">//    &lt;&lt; setw(3) &lt;&lt; &quot;SSMtol = &quot; &lt;&lt; setprecision(6) &lt;&lt; sqrt(EoSctrl.SSMsp.realTol) &lt;&lt; &quot;   &quot;</span></div>
<div class="line"><span class="lineno"> 1534</span>    <span class="comment">//    &lt;&lt; setw(3) &lt;&lt; EoSctrl.SSMsp.curIt &lt;&lt; &quot;   &quot;</span></div>
<div class="line"><span class="lineno"> 1535</span>    <span class="comment">//    &lt;&lt; setw(3) &lt;&lt; &quot;NRtol = &quot; &lt;&lt; setprecision(6) &lt;&lt; EoSctrl.NRsp.realTol &lt;&lt; &quot;   &quot;</span></div>
<div class="line"><span class="lineno"> 1536</span>    <span class="comment">//    &lt;&lt; setw(3) &lt;&lt; EoSctrl.NRsp.curIt &lt;&lt; &quot;   &quot;</span></div>
<div class="line"><span class="lineno"> 1537</span>    <span class="comment">//    &lt;&lt; setw(2) &lt;&lt; lNP &lt;&lt; &quot;   &quot; &lt;&lt; setw(2) &lt;&lt; NP &lt;&lt; &quot;   &quot;</span></div>
<div class="line"><span class="lineno"> 1538</span>    <span class="comment">//    &lt;&lt; (lNP == NP ? &quot;N&quot; : &quot;Y&quot;) &lt;&lt; &quot;   &quot;;</span></div>
<div class="line"><span class="lineno"> 1539</span>}</div>
<div class="ttc" id="aclassNRparamSP_html_a6792b7efbb8165c655ed01e9ec8316b6"><div class="ttname"><a href="classNRparamSP.html#a6792b7efbb8165c655ed01e9ec8316b6">NRparamSP::curIt</a></div><div class="ttdeci">USI curIt</div><div class="ttdoc">current Iters</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00082">MixtureComp.hpp:82</a></div></div>
<div class="ttc" id="aclassSSMparamSP_html_a28e78dd994ba4610aeef8d49ab552044"><div class="ttname"><a href="classSSMparamSP.html#a28e78dd994ba4610aeef8d49ab552044">SSMparamSP::curIt</a></div><div class="ttdeci">USI curIt</div><div class="ttdoc">current Iters</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00068">MixtureComp.hpp:68</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa3278e9ca799f6810324d2566d1c3e34" name="aa3278e9ca799f6810324d2566d1c3e34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3278e9ca799f6810324d2566d1c3e34">&#9670;&#160;</a></span>PhaseStable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool MixtureComp::PhaseStable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l01076">1076</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1077</span>{</div>
<div class="line"><span class="lineno"> 1078</span>    <span class="keywordflow">if</span> (NP == 1) {</div>
<div class="line"><span class="lineno"> 1079</span>        testPId = 0;</div>
<div class="line"><span class="lineno"> 1080</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1081</span>        CalMW();</div>
<div class="line"><span class="lineno"> 1082</span>        testPId = FindMWmax();</div>
<div class="line"><span class="lineno"> 1083</span>    }</div>
<div class="line"><span class="lineno"> 1084</span> </div>
<div class="line"><span class="lineno"> 1085</span>    EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#a8edb30773a4bf5767ba6020519277d7b">conflag</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1086</span>    EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#a309251e5bbcbf9c32f32796d14d571c4">curIt</a> = 0;</div>
<div class="line"><span class="lineno"> 1087</span>    EoSctrl.NRsta.<a class="code hl_variable" href="classNRparamSTA.html#a3acf7b521ae923bea18cb7317773877f">conflag</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1088</span>    EoSctrl.NRsta.<a class="code hl_variable" href="classNRparamSTA.html#aa4f883fb13b40f9f7bcdb2444ae42966">curIt</a>  = 0;</div>
<div class="line"><span class="lineno"> 1089</span> </div>
<div class="line"><span class="lineno"> 1090</span>    <span class="comment">// Test if a phase is stable, if stable return true, else return false</span></div>
<div class="line"><span class="lineno"> 1091</span>    <span class="keywordtype">bool</span> flag;</div>
<div class="line"><span class="lineno"> 1092</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>  tmpNP = NP;</div>
<div class="line"><span class="lineno"> 1093</span> </div>
<div class="line"><span class="lineno"> 1094</span>    <span class="keywordflow">if</span> (lNP == 0) {</div>
<div class="line"><span class="lineno"> 1095</span>        <span class="comment">// strict stability ananlysis</span></div>
<div class="line"><span class="lineno"> 1096</span>        flag = <a class="code hl_function" href="classMixtureComp.html#ae28a25d1c0c5a2190a5962a82a10a28d">StableSSM</a>(testPId);</div>
<div class="line"><span class="lineno"> 1097</span>    } </div>
<div class="line"><span class="lineno"> 1098</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1099</span>        flag = <a class="code hl_function" href="classMixtureComp.html#a16d6930ae2115d9dfc3f627580cd3605">StableSSM01</a>(testPId);</div>
<div class="line"><span class="lineno"> 1100</span>        <span class="keywordflow">if</span> (!flag) tmpNP++;</div>
<div class="line"><span class="lineno"> 1101</span> </div>
<div class="line"><span class="lineno"> 1102</span>        <span class="keywordflow">if</span> (tmpNP != lNP) {</div>
<div class="line"><span class="lineno"> 1103</span>            flag = <a class="code hl_function" href="classMixtureComp.html#ae28a25d1c0c5a2190a5962a82a10a28d">StableSSM</a>(testPId);</div>
<div class="line"><span class="lineno"> 1104</span>            flagSkip = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1105</span>        }</div>
<div class="line"><span class="lineno"> 1106</span>    }</div>
<div class="line"><span class="lineno"> 1107</span>    SSMSTAiters += EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#a309251e5bbcbf9c32f32796d14d571c4">curIt</a>;</div>
<div class="line"><span class="lineno"> 1108</span>    NRSTAiters += EoSctrl.NRsta.<a class="code hl_variable" href="classNRparamSTA.html#aa4f883fb13b40f9f7bcdb2444ae42966">curIt</a>;</div>
<div class="line"><span class="lineno"> 1109</span>    <span class="comment">//cout &lt;&lt; &quot;Yt = &quot; &lt;&lt; setprecision(8) &lt;&lt; scientific &lt;&lt; Yt &lt;&lt; &quot;  &quot; &lt;&lt; setw(2)</span></div>
<div class="line"><span class="lineno"> 1110</span>    <span class="comment">//    &lt;&lt; EoSctrl.SSMsta.curIt &lt;&lt; &quot;  &quot; &lt;&lt; setw(2) &lt;&lt; EoSctrl.NRsta.curIt &lt;&lt; &quot;  &quot;</span></div>
<div class="line"><span class="lineno"> 1111</span>    <span class="comment">//    &lt;&lt; lNP &lt;&lt; &quot;  &quot; &lt;&lt; tmpNP &lt;&lt; &quot;  &quot; &lt;&lt; tmpFtype &lt;&lt; &quot;   &quot;</span></div>
<div class="line"><span class="lineno"> 1112</span>    <span class="comment">//    &lt;&lt; (lNP == tmpNP ? &quot;N&quot; : &quot;Y&quot;) &lt;&lt; &quot;  &quot;;</span></div>
<div class="line"><span class="lineno"> 1113</span>    <span class="comment">//if (lNP == 1 &amp;&amp; tmpNP == 2 &amp;&amp; tmpFtype == 1) {</span></div>
<div class="line"><span class="lineno"> 1114</span>    <span class="comment">//    cout &lt;&lt; &quot;AAA&quot; &lt;&lt; &quot;  &quot;;</span></div>
<div class="line"><span class="lineno"> 1115</span>    <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 1116</span>    <span class="keywordflow">return</span> flag;</div>
<div class="line"><span class="lineno"> 1117</span>}</div>
<div class="ttc" id="aclassMixtureComp_html_a16d6930ae2115d9dfc3f627580cd3605"><div class="ttname"><a href="classMixtureComp.html#a16d6930ae2115d9dfc3f627580cd3605">MixtureComp::StableSSM01</a></div><div class="ttdeci">bool StableSSM01(const USI &amp;Id)</div><div class="ttdoc">relaxable SSM</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8cpp_source.html#l01119">MixtureComp.cpp:1119</a></div></div>
<div class="ttc" id="aclassMixtureComp_html_ae28a25d1c0c5a2190a5962a82a10a28d"><div class="ttname"><a href="classMixtureComp.html#ae28a25d1c0c5a2190a5962a82a10a28d">MixtureComp::StableSSM</a></div><div class="ttdeci">bool StableSSM(const USI &amp;Id)</div><div class="ttdoc">strict SSM</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8cpp_source.html#l01218">MixtureComp.cpp:1218</a></div></div>
<div class="ttc" id="aclassNRparamSTA_html_aa4f883fb13b40f9f7bcdb2444ae42966"><div class="ttname"><a href="classNRparamSTA.html#aa4f883fb13b40f9f7bcdb2444ae42966">NRparamSTA::curIt</a></div><div class="ttdeci">USI curIt</div><div class="ttdoc">current Iters</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00054">MixtureComp.hpp:54</a></div></div>
<div class="ttc" id="aclassSSMparamSTA_html_a309251e5bbcbf9c32f32796d14d571c4"><div class="ttname"><a href="classSSMparamSTA.html#a309251e5bbcbf9c32f32796d14d571c4">SSMparamSTA::curIt</a></div><div class="ttdeci">USI curIt</div><div class="ttdoc">current Iterations</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00040">MixtureComp.hpp:40</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab69c6a23d5c813b02d8393838a1b74ab" name="ab69c6a23d5c813b02d8393838a1b74ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab69c6a23d5c813b02d8393838a1b74ab">&#9670;&#160;</a></span>PrintFugN()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::PrintFugN </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l01925">1925</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1926</span>{</div>
<div class="line"><span class="lineno"> 1927</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 1928</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1929</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; NC; k++) {</div>
<div class="line"><span class="lineno"> 1930</span>                cout &lt;&lt; fugN[j][i * NC + k] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>;</div>
<div class="line"><span class="lineno"> 1931</span>            }</div>
<div class="line"><span class="lineno"> 1932</span>            cout &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 1933</span>        }</div>
<div class="line"><span class="lineno"> 1934</span>        cout &lt;&lt; <span class="stringliteral">&quot;---------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 1935</span>    }</div>
<div class="line"><span class="lineno"> 1936</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ace7524402082e123b33e7eff650a13dc" name="ace7524402082e123b33e7eff650a13dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace7524402082e123b33e7eff650a13dc">&#9670;&#160;</a></span>PrintX()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::PrintX </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00919">919</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  920</span>{</div>
<div class="line"><span class="lineno">  921</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno">  922</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno">  923</span>            cout &lt;&lt; x[j][i] &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>;</div>
<div class="line"><span class="lineno">  924</span>        }</div>
<div class="line"><span class="lineno">  925</span>        cout &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  926</span>    }</div>
<div class="line"><span class="lineno">  927</span>    cout &lt;&lt; <span class="stringliteral">&quot;----------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  928</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab870f35221c9f0fcef6b4fb0cb4cb681" name="ab870f35221c9f0fcef6b4fb0cb4cb681"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab870f35221c9f0fcef6b4fb0cb4cb681">&#9670;&#160;</a></span>PrintZtmp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::PrintZtmp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>test </p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8hpp_source.html#l00263">263</a> of file <a class="el" href="MixtureComp_8hpp_source.html">MixtureComp.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  264</span>    {</div>
<div class="line"><span class="lineno">  265</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> z : Ztmp) cout &lt;&lt; z &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><span class="lineno">  266</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab6ca68ebdd84c48a7d0c4544bc9d698a" name="ab6ca68ebdd84c48a7d0c4544bc9d698a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6ca68ebdd84c48a7d0c4544bc9d698a">&#9670;&#160;</a></span>RachfordRice2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::RachfordRice2 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Used when NP = 2. </p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l01665">1665</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1666</span>{</div>
<div class="line"><span class="lineno"> 1667</span>    <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; Ktmp = Ks[0];</div>
<div class="line"><span class="lineno"> 1668</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>                Kmin = Ktmp[0];</div>
<div class="line"><span class="lineno"> 1669</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>                Kmax = Ktmp[0];</div>
<div class="line"><span class="lineno"> 1670</span> </div>
<div class="line"><span class="lineno"> 1671</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 1; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1672</span>        <span class="keywordflow">if</span> (Ktmp[i] &lt; Kmin) Kmin = Ktmp[i];</div>
<div class="line"><span class="lineno"> 1673</span>        <span class="keywordflow">if</span> (Ktmp[i] &gt; Kmax) Kmax = Ktmp[i];</div>
<div class="line"><span class="lineno"> 1674</span>    }</div>
<div class="line"><span class="lineno"> 1675</span> </div>
<div class="line"><span class="lineno"> 1676</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> numin = 1 / (1 - Kmax);</div>
<div class="line"><span class="lineno"> 1677</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> numax = 1 / (1 - Kmin);</div>
<div class="line"><span class="lineno"> 1678</span> </div>
<div class="line"><span class="lineno"> 1679</span>    nu[0] = 0.5 * (numin + numax);</div>
<div class="line"><span class="lineno"> 1680</span> </div>
<div class="line"><span class="lineno"> 1681</span>    <span class="comment">// Solve RR with NR</span></div>
<div class="line"><span class="lineno"> 1682</span>    fill(tmpRR.begin(), tmpRR.end(), 0);</div>
<div class="line"><span class="lineno"> 1683</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> rj, J, dnuj, tmp;</div>
<div class="line"><span class="lineno"> 1684</span> </div>
<div class="line"><span class="lineno"> 1685</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     iter  = 0;</div>
<div class="line"><span class="lineno"> 1686</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> RRtol = EoSctrl.RR.<a class="code hl_variable" href="classRRparam.html#af38c3b481183d18bb91b4a722ec84254">tol</a>;</div>
<div class="line"><span class="lineno"> 1687</span>    <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 1688</span> </div>
<div class="line"><span class="lineno"> 1689</span>        rj = 0;</div>
<div class="line"><span class="lineno"> 1690</span>        J  = 0;</div>
<div class="line"><span class="lineno"> 1691</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1692</span>            tmpRR[i] = 1 + nu[0] * (Ktmp[i] - 1);</div>
<div class="line"><span class="lineno"> 1693</span>            rj += zi[i] * (Ktmp[i] - 1) / tmpRR[i];</div>
<div class="line"><span class="lineno"> 1694</span>            J -= zi[i] * (Ktmp[i] - 1) * (Ktmp[i] - 1) / (tmpRR[i] * tmpRR[i]);</div>
<div class="line"><span class="lineno"> 1695</span>        }</div>
<div class="line"><span class="lineno"> 1696</span> </div>
<div class="line"><span class="lineno"> 1697</span>        <span class="keywordflow">if</span> (fabs(rj) &lt; RRtol || iter &gt; EoSctrl.RR.<a class="code hl_variable" href="classRRparam.html#a280d832a8525124b2c589abbf329b566">maxIt</a>) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1698</span> </div>
<div class="line"><span class="lineno"> 1699</span>        dnuj = -rj / J;</div>
<div class="line"><span class="lineno"> 1700</span>        tmp  = nu[0] + dnuj;</div>
<div class="line"><span class="lineno"> 1701</span>        <span class="keywordflow">if</span> (tmp &lt; numax &amp;&amp; tmp &gt; numin) {</div>
<div class="line"><span class="lineno"> 1702</span>            nu[0] = tmp;</div>
<div class="line"><span class="lineno"> 1703</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1704</span>            <span class="keywordflow">if</span> (dnuj &gt; 0) {</div>
<div class="line"><span class="lineno"> 1705</span>                nu[0] = (nu[0] + numax) / 2;</div>
<div class="line"><span class="lineno"> 1706</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1707</span>                nu[0] = (nu[0] + numin) / 2;</div>
<div class="line"><span class="lineno"> 1708</span>            }</div>
<div class="line"><span class="lineno"> 1709</span>        }</div>
<div class="line"><span class="lineno"> 1710</span> </div>
<div class="line"><span class="lineno"> 1711</span>        iter++;</div>
<div class="line"><span class="lineno"> 1712</span>    }</div>
<div class="line"><span class="lineno"> 1713</span> </div>
<div class="line"><span class="lineno"> 1714</span>    <span class="comment">// if (iter &gt; EoSctrl.RR.maxIt) {</span></div>
<div class="line"><span class="lineno"> 1715</span>    <span class="comment">//  OCP_WARNING(&quot;RR2 not converged!&quot;);</span></div>
<div class="line"><span class="lineno"> 1716</span>    <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 1717</span> </div>
<div class="line"><span class="lineno"> 1718</span>    nu[1] = 1 - nu[0];</div>
<div class="line"><span class="lineno"> 1719</span> </div>
<div class="line"><span class="lineno"> 1720</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno"> 1721</span>    cout &lt;&lt; nu[0] &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 1722</span><span class="preprocessor">#endif </span><span class="comment">// DEBUG</span></div>
<div class="line"><span class="lineno"> 1723</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="MixtureComp_8hpp_source.html#l00089">RRparam::maxIt</a>, and <a class="el" href="MixtureComp_8hpp_source.html#l00090">RRparam::tol</a>.</p>

</div>
</div>
<a id="a34670e4fb36f3506687915321e3f175a" name="a34670e4fb36f3506687915321e3f175a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34670e4fb36f3506687915321e3f175a">&#9670;&#160;</a></span>RachfordRice3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::RachfordRice3 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Used when NP &gt; 2. </p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l01725">1725</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1726</span>{</div>
<div class="line"><span class="lineno"> 1727</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="adbd472704ecf3f04ffe35316fbbf5ccf" name="adbd472704ecf3f04ffe35316fbbf5ccf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbd472704ecf3f04ffe35316fbbf5ccf">&#9670;&#160;</a></span>RhoPhase()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> MixtureComp::RhoPhase </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>Pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>Tin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *&#160;</td>
          <td class="paramname"><em>Ziin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>return mass density of phase. </p>

<p>Implements <a class="el" href="classMixture.html#adf1be0ad34ced8062a5d4da2deb54d8e">Mixture</a>.</p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00517">517</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  519</span>{</div>
<div class="line"><span class="lineno">  520</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> xitmp = <a class="code hl_function" href="classMixtureComp.html#ad5be09d1c319768b761bcf6427bc8535">XiPhase</a>(Pin, Tin, Ziin);</div>
<div class="line"><span class="lineno">  521</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> rhotmp;</div>
<div class="line"><span class="lineno">  522</span>    <span class="comment">// assume that only single phase exists here</span></div>
<div class="line"><span class="lineno">  523</span>    <span class="keywordflow">if</span> (Ziin[<a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> - 1] &gt; 1 - 1e-6) {</div>
<div class="line"><span class="lineno">  524</span>        <span class="comment">// water phase</span></div>
<div class="line"><span class="lineno">  525</span>        rhotmp = std_RhoW * (<a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a> * xitmp);</div>
<div class="line"><span class="lineno">  526</span>        <span class="keywordflow">return</span> rhotmp;</div>
<div class="line"><span class="lineno">  527</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  528</span>        <span class="comment">// hydrocarbon phase</span></div>
<div class="line"><span class="lineno">  529</span>        x[0] = zi;</div>
<div class="line"><span class="lineno">  530</span>        CalMW();</div>
<div class="line"><span class="lineno">  531</span>        rhotmp = MW[0] * xitmp;</div>
<div class="line"><span class="lineno">  532</span>        <span class="keywordflow">return</span> rhotmp;</div>
<div class="line"><span class="lineno">  533</span>    }</div>
<div class="line"><span class="lineno">  534</span>}</div>
<div class="ttc" id="aclassMixtureComp_html_ad5be09d1c319768b761bcf6427bc8535"><div class="ttname"><a href="classMixtureComp.html#ad5be09d1c319768b761bcf6427bc8535">MixtureComp::XiPhase</a></div><div class="ttdeci">OCP_DBL XiPhase(const OCP_DBL &amp;Pin, const OCP_DBL &amp;Tin, const OCP_DBL *Ziin) override</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8cpp_source.html#l00487">MixtureComp.cpp:487</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="OCPConst_8hpp_source.html#l00059">CONV1</a>, <a class="el" href="Mixture_8hpp_source.html#l00145">Mixture::numCom</a>, and <a class="el" href="MixtureComp_8cpp_source.html#l00487">XiPhase()</a>.</p>

</div>
</div>
<a id="a373e381d48f04a4858928bde2103073a" name="a373e381d48f04a4858928bde2103073a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a373e381d48f04a4858928bde2103073a">&#9670;&#160;</a></span>setNi()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::setNi </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *&#160;</td>
          <td class="paramname"><em>Niin</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8hpp_source.html#l00192">192</a> of file <a class="el" href="MixtureComp_8hpp_source.html">MixtureComp.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  192</span>{ <a class="code hl_function" href="DenseMat_8hpp.html#ae3d6d69eb9175bc2ed3414c44bde7a8d">Dcopy</a>(<a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a>, &amp;<a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[0], Niin); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a55e004ef7b183f9c7f580634a922666f" name="a55e004ef7b183f9c7f580634a922666f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55e004ef7b183f9c7f580634a922666f">&#9670;&#160;</a></span>setPT()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::setPT </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8hpp_source.html#l00189">189</a> of file <a class="el" href="MixtureComp_8hpp_source.html">MixtureComp.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  189</span>{ P = p; T = t; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a30d1201549ef269c47017f5d7b31784b" name="a30d1201549ef269c47017f5d7b31784b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30d1201549ef269c47017f5d7b31784b">&#9670;&#160;</a></span>setZi() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::setZi </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8hpp_source.html#l00191">191</a> of file <a class="el" href="MixtureComp_8hpp_source.html">MixtureComp.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  191</span>{ <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) zi[i] = <a class="code hl_variable" href="classMixture.html#aa73863601ffb8962b26415352b41bffa">Ni</a>[i] / Nh; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a47ffdba69ad801ebb6d85d9661fb6adb" name="a47ffdba69ad801ebb6d85d9661fb6adb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47ffdba69ad801ebb6d85d9661fb6adb">&#9670;&#160;</a></span>setZi() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::setZi </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *&#160;</td>
          <td class="paramname"><em>Ziin</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8hpp_source.html#l00190">190</a> of file <a class="el" href="MixtureComp_8hpp_source.html">MixtureComp.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  190</span>{ <a class="code hl_function" href="DenseMat_8hpp.html#ae3d6d69eb9175bc2ed3414c44bde7a8d">Dcopy</a>(NC, &amp;zi[0], Ziin); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9659d58415fc4f9a20ce2b68b1b2e1c0" name="a9659d58415fc4f9a20ce2b68b1b2e1c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9659d58415fc4f9a20ce2b68b1b2e1c0">&#9670;&#160;</a></span>SolEoS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::SolEoS </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>ZjT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>AjT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>BjT</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00596">596</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  597</span>{</div>
<div class="line"><span class="lineno">  598</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> aj = AjT;</div>
<div class="line"><span class="lineno">  599</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> bj = BjT;</div>
<div class="line"><span class="lineno">  600</span> </div>
<div class="line"><span class="lineno">  601</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> a = (delta1 + delta2 - 1) * bj - 1;</div>
<div class="line"><span class="lineno">  602</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> b =</div>
<div class="line"><span class="lineno">  603</span>        (aj + delta1 * delta2 * bj * bj - (delta1 + delta2) * bj * (bj + 1));</div>
<div class="line"><span class="lineno">  604</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> c = -(aj * bj + delta1 * delta2 * bj * bj * (bj + 1));</div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> flag = <a class="code hl_function" href="classMixtureComp.html#a22d627ebaf3134a25502d0c56608b721">CubicRoot</a>(a, b, c, <span class="keyword">true</span>); <span class="comment">// True with NT</span></div>
<div class="line"><span class="lineno">  607</span>    <span class="keywordflow">if</span> (flag == 1) {</div>
<div class="line"><span class="lineno">  608</span>        ZjT = Ztmp[0];</div>
<div class="line"><span class="lineno">  609</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  610</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> zj1 = Ztmp[0];</div>
<div class="line"><span class="lineno">  611</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> zj2 = Ztmp[2];</div>
<div class="line"><span class="lineno">  612</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> dG  = (zj2 - zj1) + log((zj1 - bj) / (zj2 - bj)) -</div>
<div class="line"><span class="lineno">  613</span>                     aj / (bj * (delta2 - delta1)) *</div>
<div class="line"><span class="lineno">  614</span>                         log((zj1 + delta1 * bj) * (zj2 + delta2 * bj) /</div>
<div class="line"><span class="lineno">  615</span>                             ((zj1 + delta2 * bj) * (zj2 + delta1 * bj)));</div>
<div class="line"><span class="lineno">  616</span>        <span class="keywordflow">if</span> (dG &gt; 0)</div>
<div class="line"><span class="lineno">  617</span>            ZjT = zj1;</div>
<div class="line"><span class="lineno">  618</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  619</span>            ZjT = zj2;</div>
<div class="line"><span class="lineno">  620</span>    }</div>
<div class="line"><span class="lineno">  621</span>}</div>
<div class="ttc" id="aclassMixtureComp_html_a22d627ebaf3134a25502d0c56608b721"><div class="ttname"><a href="classMixtureComp.html#a22d627ebaf3134a25502d0c56608b721">MixtureComp::CubicRoot</a></div><div class="ttdeci">USI CubicRoot(const OCP_DBL &amp;a, const OCP_DBL &amp;b, const OCP_DBL &amp;c, const bool &amp;NTflag=false) const</div><div class="ttdoc">Result is stored in Ztmp.</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8cpp_source.html#l04844">MixtureComp.cpp:4844</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af444be2fa5d53e165cfedfb20490f9e9" name="af444be2fa5d53e165cfedfb20490f9e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af444be2fa5d53e165cfedfb20490f9e9">&#9670;&#160;</a></span>SplitNR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::SplitNR </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l01744">1744</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1745</span>{</div>
<div class="line"><span class="lineno"> 1746</span>    EoSctrl.NRsp.<a class="code hl_variable" href="classNRparamSP.html#a9c9b51d4724052f1f8d382cd33ba2b0a">conflag</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1747</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 1748</span>        nu[j] = fabs(nu[j]);</div>
<div class="line"><span class="lineno"> 1749</span>    }</div>
<div class="line"><span class="lineno"> 1750</span> </div>
<div class="line"><span class="lineno"> 1751</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> len = NC * (NP - 1);</div>
<div class="line"><span class="lineno"> 1752</span>    <a class="code hl_function" href="classMixtureComp.html#af3de24acaa27101e5dfe6f6b47946fe1">x2n</a>();</div>
<div class="line"><span class="lineno"> 1753</span>    CalResSP();</div>
<div class="line"><span class="lineno"> 1754</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> eNR0;</div>
<div class="line"><span class="lineno"> 1755</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> eNR   = <a class="code hl_function" href="DenseMat_8hpp.html#af68dee47a6d8148b039abaa9620a4642">Dnorm2</a>(len, &amp;resSP[0]);</div>
<div class="line"><span class="lineno"> 1756</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> NRtol = EoSctrl.NRsp.<a class="code hl_variable" href="classNRparamSP.html#ab370afbdbd3c29bc56bc841b5884157e">tol</a>;</div>
<div class="line"><span class="lineno"> 1757</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> alpha;</div>
<div class="line"><span class="lineno"> 1758</span> </div>
<div class="line"><span class="lineno"> 1759</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno"> 1760</span>    cout &lt;&lt; <span class="stringliteral">&quot;NRSP Begins!\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1761</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1762</span> </div>
<div class="line"><span class="lineno"> 1763</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> en;</div>
<div class="line"><span class="lineno"> 1764</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     iter = 0;</div>
<div class="line"><span class="lineno"> 1765</span>    eNR0         = eNR;</div>
<div class="line"><span class="lineno"> 1766</span>    <span class="keywordflow">while</span> (eNR &gt; NRtol) {</div>
<div class="line"><span class="lineno"> 1767</span> </div>
<div class="line"><span class="lineno"> 1768</span>        <span class="comment">// eNR0 = eNR;</span></div>
<div class="line"><span class="lineno"> 1769</span> </div>
<div class="line"><span class="lineno"> 1770</span>        ln = n;</div>
<div class="line"><span class="lineno"> 1771</span>        CalFugNAll();</div>
<div class="line"><span class="lineno"> 1772</span>        AssembleJmatSP();</div>
<div class="line"><span class="lineno"> 1773</span> </div>
<div class="line"><span class="lineno"> 1774</span>        <span class="comment">// LUSolve(1, len, &amp;JmatSP[0], &amp;resSP[0], &amp;pivot[0]);</span></div>
<div class="line"><span class="lineno"> 1775</span>        <span class="comment">// PrintDX(NC, &amp;resSP[0]);</span></div>
<div class="line"><span class="lineno"> 1776</span> </div>
<div class="line"><span class="lineno"> 1777</span>        <a class="code hl_function" href="DenseMat_8hpp.html#a002a44a13631003380d535feab8c5f5e">SYSSolve</a>(1, &amp;uplo, len, &amp;JmatSP[0], &amp;resSP[0], &amp;pivot[0], &amp;JmatWork[0], lJmatWork);</div>
<div class="line"><span class="lineno"> 1778</span>        <span class="comment">// PrintDX(NC, &amp;resSP[0]);</span></div>
<div class="line"><span class="lineno"> 1779</span> </div>
<div class="line"><span class="lineno"> 1780</span>        alpha = CalStepNRsp();</div>
<div class="line"><span class="lineno"> 1781</span> </div>
<div class="line"><span class="lineno"> 1782</span>        n[NP - 1] = zi;</div>
<div class="line"><span class="lineno"> 1783</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP - 1; j++) {</div>
<div class="line"><span class="lineno"> 1784</span>            <a class="code hl_function" href="DenseMat_8hpp.html#a5da432e006319d9f82b5da4c0a186c1f">Daxpy</a>(NC, alpha, &amp;resSP[j * NC], &amp;n[j][0]);</div>
<div class="line"><span class="lineno"> 1785</span>            <a class="code hl_function" href="DenseMat_8hpp.html#a5da432e006319d9f82b5da4c0a186c1f">Daxpy</a>(NC, -1, &amp;n[j][0], &amp;n[NP - 1][0]);</div>
<div class="line"><span class="lineno"> 1786</span> </div>
<div class="line"><span class="lineno"> 1787</span>            nu[j] = <a class="code hl_function" href="DenseMat_8hpp.html#accb44af625653de07f0a8dba403348d1">Dnorm1</a>(NC, &amp;n[j][0]);</div>
<div class="line"><span class="lineno"> 1788</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1789</span>                x[j][i] = n[j][i] / nu[j];</div>
<div class="line"><span class="lineno"> 1790</span>            }</div>
<div class="line"><span class="lineno"> 1791</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno"> 1792</span>            <a class="code hl_function" href="DenseMat_8hpp.html#acedbc13077af74f057b5d243d36a64da">PrintDX</a>(NC, &amp;x[j][0]);</div>
<div class="line"><span class="lineno"> 1793</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1794</span>        }</div>
<div class="line"><span class="lineno"> 1795</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1796</span>            n[NP - 1][i] = fabs(n[NP - 1][i]);</div>
<div class="line"><span class="lineno"> 1797</span>        }</div>
<div class="line"><span class="lineno"> 1798</span>        nu[NP - 1] = <a class="code hl_function" href="DenseMat_8hpp.html#accb44af625653de07f0a8dba403348d1">Dnorm1</a>(NC, &amp;n[NP - 1][0]);</div>
<div class="line"><span class="lineno"> 1799</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1800</span>            x[NP - 1][i] = n[NP - 1][i] / nu[NP - 1];</div>
<div class="line"><span class="lineno"> 1801</span>        }</div>
<div class="line"><span class="lineno"> 1802</span> </div>
<div class="line"><span class="lineno"> 1803</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno"> 1804</span>        <a class="code hl_function" href="DenseMat_8hpp.html#acedbc13077af74f057b5d243d36a64da">PrintDX</a>(NC, &amp;x[NP - 1][0]);</div>
<div class="line"><span class="lineno"> 1805</span>        cout &lt;&lt; <span class="stringliteral">&quot;---------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 1806</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1807</span>        CalFugPhiAll();</div>
<div class="line"><span class="lineno"> 1808</span>        CalResSP();</div>
<div class="line"><span class="lineno"> 1809</span>        eNR = <a class="code hl_function" href="DenseMat_8hpp.html#af68dee47a6d8148b039abaa9620a4642">Dnorm2</a>(len, &amp;resSP[0]);</div>
<div class="line"><span class="lineno"> 1810</span>        iter++;</div>
<div class="line"><span class="lineno"> 1811</span>        <span class="keywordflow">if</span> (eNR &gt; eNR0 || iter &gt; EoSctrl.NRsp.<a class="code hl_variable" href="classNRparamSP.html#a92666e91c5347674e32907ed26f7f29e">maxIt</a>) {</div>
<div class="line"><span class="lineno"> 1812</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1813</span>        }</div>
<div class="line"><span class="lineno"> 1814</span> </div>
<div class="line"><span class="lineno"> 1815</span>        <span class="comment">// Maybe it should be execute before &quot;eNR &gt; eNR0 || iter &gt; EoSctrl.NRsp.maxIt&quot;</span></div>
<div class="line"><span class="lineno"> 1816</span>        en = 0;</div>
<div class="line"><span class="lineno"> 1817</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno"> 1818</span>            <a class="code hl_function" href="DenseMat_8hpp.html#a5da432e006319d9f82b5da4c0a186c1f">Daxpy</a>(NC, -1, &amp;n[j][0], &amp;ln[j][0]);</div>
<div class="line"><span class="lineno"> 1819</span>            en += <a class="code hl_function" href="DenseMat_8hpp.html#af68dee47a6d8148b039abaa9620a4642">Dnorm2</a>(NC, &amp;ln[j][0]);</div>
<div class="line"><span class="lineno"> 1820</span>        }</div>
<div class="line"><span class="lineno"> 1821</span>        <span class="keywordflow">if</span> (en / (NP * NC) &lt; 1E-8) {</div>
<div class="line"><span class="lineno"> 1822</span>            EoSctrl.NRsp.<a class="code hl_variable" href="classNRparamSP.html#a9c9b51d4724052f1f8d382cd33ba2b0a">conflag</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1823</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1824</span>        }</div>
<div class="line"><span class="lineno"> 1825</span>    }</div>
<div class="line"><span class="lineno"> 1826</span>    EoSctrl.NRsp.<a class="code hl_variable" href="classNRparamSP.html#aed7856955acd84622f1df9454a47b8c0">realTol</a> = eNR;</div>
<div class="line"><span class="lineno"> 1827</span>    <span class="keywordflow">if</span> (eNR &lt; NRtol) EoSctrl.NRsp.<a class="code hl_variable" href="classNRparamSP.html#a9c9b51d4724052f1f8d382cd33ba2b0a">conflag</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1828</span>    EoSctrl.NRsp.<a class="code hl_variable" href="classNRparamSP.html#a6792b7efbb8165c655ed01e9ec8316b6">curIt</a> += iter;</div>
<div class="line"><span class="lineno"> 1829</span>}</div>
<div class="ttc" id="aDenseMat_8hpp_html_a002a44a13631003380d535feab8c5f5e"><div class="ttname"><a href="DenseMat_8hpp.html#a002a44a13631003380d535feab8c5f5e">SYSSolve</a></div><div class="ttdeci">void SYSSolve(const int &amp;nrhs, const char *uplo, const int &amp;N, double *A, double *b, int *pivot, double *work, const int &amp;lwork)</div><div class="ttdoc">Calls dsysy to solve the linear system for symm matrices.</div><div class="ttdef"><b>Definition:</b> <a href="DenseMat_8cpp_source.html#l00199">DenseMat.cpp:199</a></div></div>
<div class="ttc" id="aDenseMat_8hpp_html_a5da432e006319d9f82b5da4c0a186c1f"><div class="ttname"><a href="DenseMat_8hpp.html#a5da432e006319d9f82b5da4c0a186c1f">Daxpy</a></div><div class="ttdeci">void Daxpy(const int &amp;n, const double &amp;alpha, const double *x, double *y)</div><div class="ttdoc">Constant times a vector plus a vector.</div><div class="ttdef"><b>Definition:</b> <a href="DenseMat_8cpp_source.html#l00069">DenseMat.cpp:69</a></div></div>
<div class="ttc" id="aDenseMat_8hpp_html_acedbc13077af74f057b5d243d36a64da"><div class="ttname"><a href="DenseMat_8hpp.html#acedbc13077af74f057b5d243d36a64da">PrintDX</a></div><div class="ttdeci">void PrintDX(const int &amp;N, const T *x)</div><div class="ttdoc">Prints a vector.</div><div class="ttdef"><b>Definition:</b> <a href="DenseMat_8hpp_source.html#l00122">DenseMat.hpp:122</a></div></div>
<div class="ttc" id="aDenseMat_8hpp_html_af68dee47a6d8148b039abaa9620a4642"><div class="ttname"><a href="DenseMat_8hpp.html#af68dee47a6d8148b039abaa9620a4642">Dnorm2</a></div><div class="ttdeci">double Dnorm2(const int &amp;N, double *x)</div><div class="ttdoc">Computes the L2-norm of a vector.</div><div class="ttdef"><b>Definition:</b> <a href="DenseMat_8cpp_source.html#l00056">DenseMat.cpp:56</a></div></div>
<div class="ttc" id="aclassMixtureComp_html_af3de24acaa27101e5dfe6f6b47946fe1"><div class="ttname"><a href="classMixtureComp.html#af3de24acaa27101e5dfe6f6b47946fe1">MixtureComp::x2n</a></div><div class="ttdeci">void x2n()</div><div class="ttdoc">x[j][i] -&gt; n[j][i]</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8cpp_source.html#l00907">MixtureComp.cpp:907</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0da9418aca89bdcb2b7d2f970e5d55f8" name="a0da9418aca89bdcb2b7d2f970e5d55f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0da9418aca89bdcb2b7d2f970e5d55f8">&#9670;&#160;</a></span>SplitSSM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::SplitSSM </td>
          <td>(</td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>flag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l01583">1583</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1584</span>{</div>
<div class="line"><span class="lineno"> 1585</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno"> 1586</span>    cout &lt;&lt; <span class="stringliteral">&quot;SSMSP Begins!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 1587</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1588</span> </div>
<div class="line"><span class="lineno"> 1589</span>    <span class="keywordflow">if</span> (NP == 2) {</div>
<div class="line"><span class="lineno"> 1590</span>        SplitSSM2(flag);</div>
<div class="line"><span class="lineno"> 1591</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1592</span>        SplitSSM3(flag);</div>
<div class="line"><span class="lineno"> 1593</span>    }</div>
<div class="line"><span class="lineno"> 1594</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afb268ce8d569ce5843ddb06d0c1ab27c" name="afb268ce8d569ce5843ddb06d0c1ab27c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb268ce8d569ce5843ddb06d0c1ab27c">&#9670;&#160;</a></span>SplitSSM2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::SplitSSM2 </td>
          <td>(</td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>flag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l01596">1596</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1597</span>{</div>
<div class="line"><span class="lineno"> 1598</span>    <span class="comment">// NP = 2 in this case</span></div>
<div class="line"><span class="lineno"> 1599</span>    <span class="comment">// Ks is very IMPORTANT!</span></div>
<div class="line"><span class="lineno"> 1600</span>    <span class="comment">// flag = true : Restart SSM</span></div>
<div class="line"><span class="lineno"> 1601</span>    <span class="comment">// flag = false : New SSM</span></div>
<div class="line"><span class="lineno"> 1602</span>    EoSctrl.SSMsp.<a class="code hl_variable" href="classSSMparamSP.html#a05d81a40beea3948897c6d30d27a4bc2">conflag</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1603</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Se            = 1;</div>
<div class="line"><span class="lineno"> 1604</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Stol          = EoSctrl.SSMsp.<a class="code hl_variable" href="classSSMparamSP.html#a68a0b481abc1d5564b374b9abcb3d0d6">tol2</a>;</div>
<div class="line"><span class="lineno"> 1605</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     maxIt         = EoSctrl.SSMsp.<a class="code hl_variable" href="classSSMparamSP.html#aa2f90176c63acb15ab0add7739ad4748">maxIt</a>;</div>
<div class="line"><span class="lineno"> 1606</span> </div>
<div class="line"><span class="lineno"> 1607</span>    <span class="keywordflow">if</span> (!flag) {</div>
<div class="line"><span class="lineno"> 1608</span>        <span class="keywordflow">if</span> (lNP == 2) {</div>
<div class="line"><span class="lineno"> 1609</span>            Ks[NP - 2] = lKs;</div>
<div class="line"><span class="lineno"> 1610</span>        }</div>
<div class="line"><span class="lineno"> 1611</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1612</span>            <span class="keywordflow">if</span> (Yt &lt; 1.1 || <span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 1613</span>                Ks[NP - 2] = Kw[0];</div>
<div class="line"><span class="lineno"> 1614</span>            }</div>
<div class="line"><span class="lineno"> 1615</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1616</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1617</span>                    <span class="comment">// Ks[NP - 2][i] = phi[testPId][i] / phiSta[i];</span></div>
<div class="line"><span class="lineno"> 1618</span>                    Ks[NP - 2][i] = Y[i] / x[testPId][i];</div>
<div class="line"><span class="lineno"> 1619</span>                }</div>
<div class="line"><span class="lineno"> 1620</span>            }</div>
<div class="line"><span class="lineno"> 1621</span>        }       </div>
<div class="line"><span class="lineno"> 1622</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1623</span>        Stol *= 1E-1;</div>
<div class="line"><span class="lineno"> 1624</span>        maxIt *= 2;</div>
<div class="line"><span class="lineno"> 1625</span>    }</div>
<div class="line"><span class="lineno"> 1626</span> </div>
<div class="line"><span class="lineno"> 1627</span>    <span class="keywordflow">if</span> (Yt &lt; 1.1) {</div>
<div class="line"><span class="lineno"> 1628</span>        Stol *= 1E-1;</div>
<div class="line"><span class="lineno"> 1629</span>        maxIt *= 2;</div>
<div class="line"><span class="lineno"> 1630</span>    }</div>
<div class="line"><span class="lineno"> 1631</span> </div>
<div class="line"><span class="lineno"> 1632</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno"> 1633</span>    PrintX();</div>
<div class="line"><span class="lineno"> 1634</span><span class="preprocessor">#endif </span><span class="comment">// DEBUG</span></div>
<div class="line"><span class="lineno"> 1635</span> </div>
<div class="line"><span class="lineno"> 1636</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> iter = 0;</div>
<div class="line"><span class="lineno"> 1637</span>    <span class="keywordflow">while</span> (Se &gt; Stol) {</div>
<div class="line"><span class="lineno"> 1638</span> </div>
<div class="line"><span class="lineno"> 1639</span>        <a class="code hl_function" href="classMixtureComp.html#ab6ca68ebdd84c48a7d0c4544bc9d698a">RachfordRice2</a>();</div>
<div class="line"><span class="lineno"> 1640</span>        <a class="code hl_function" href="classMixtureComp.html#a9c06637490fc903d9a0bd12c053b93b8">UpdateXRR</a>();</div>
<div class="line"><span class="lineno"> 1641</span>        CalFugPhiAll();</div>
<div class="line"><span class="lineno"> 1642</span>        Se = 0;</div>
<div class="line"><span class="lineno"> 1643</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1644</span>            Se += pow(fug[1][i] / fug[0][i] - 1, 2);</div>
<div class="line"><span class="lineno"> 1645</span>            Ks[0][i] = phi[1][i] / phi[0][i];</div>
<div class="line"><span class="lineno"> 1646</span>        }</div>
<div class="line"><span class="lineno"> 1647</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno"> 1648</span>        PrintX();</div>
<div class="line"><span class="lineno"> 1649</span><span class="preprocessor">#endif </span><span class="comment">// DEBUG</span></div>
<div class="line"><span class="lineno"> 1650</span> </div>
<div class="line"><span class="lineno"> 1651</span>        iter++;</div>
<div class="line"><span class="lineno"> 1652</span>        <span class="keywordflow">if</span> (iter &gt; maxIt) {</div>
<div class="line"><span class="lineno"> 1653</span>            <span class="comment">// OCP_WARNING(&quot;SSM not converged in Phase Spliting!&quot;);</span></div>
<div class="line"><span class="lineno"> 1654</span>            EoSctrl.SSMsp.<a class="code hl_variable" href="classSSMparamSP.html#a05d81a40beea3948897c6d30d27a4bc2">conflag</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1655</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1656</span>        }</div>
<div class="line"><span class="lineno"> 1657</span>    }</div>
<div class="line"><span class="lineno"> 1658</span> </div>
<div class="line"><span class="lineno"> 1659</span>    EoSctrl.SSMsp.<a class="code hl_variable" href="classSSMparamSP.html#a9a13a509d652ba8fe7877074e13a8672">realTol</a> = sqrt(Se);</div>
<div class="line"><span class="lineno"> 1660</span>    EoSctrl.SSMsp.<a class="code hl_variable" href="classSSMparamSP.html#a28e78dd994ba4610aeef8d49ab552044">curIt</a> += iter; </div>
<div class="line"><span class="lineno"> 1661</span>}</div>
<div class="ttc" id="aclassMixtureComp_html_a9c06637490fc903d9a0bd12c053b93b8"><div class="ttname"><a href="classMixtureComp.html#a9c06637490fc903d9a0bd12c053b93b8">MixtureComp::UpdateXRR</a></div><div class="ttdeci">void UpdateXRR()</div><div class="ttdoc">Update X according to RR.</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8cpp_source.html#l01729">MixtureComp.cpp:1729</a></div></div>
<div class="ttc" id="aclassMixtureComp_html_ab6ca68ebdd84c48a7d0c4544bc9d698a"><div class="ttname"><a href="classMixtureComp.html#ab6ca68ebdd84c48a7d0c4544bc9d698a">MixtureComp::RachfordRice2</a></div><div class="ttdeci">void RachfordRice2()</div><div class="ttdoc">Used when NP = 2.</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8cpp_source.html#l01665">MixtureComp.cpp:1665</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaa5ae3cc677230b038d14baa225374eb" name="aaa5ae3cc677230b038d14baa225374eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa5ae3cc677230b038d14baa225374eb">&#9670;&#160;</a></span>SplitSSM3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::SplitSSM3 </td>
          <td>(</td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>flag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l01663">1663</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1663</span>{}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aba425d5d3810cbc5638fe003986e6253" name="aba425d5d3810cbc5638fe003986e6253"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba425d5d3810cbc5638fe003986e6253">&#9670;&#160;</a></span>StableNR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool MixtureComp::StableNR </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;&#160;</td>
          <td class="paramname"><em>Id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l01317">1317</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1318</span>{</div>
<div class="line"><span class="lineno"> 1319</span> </div>
<div class="line"><span class="lineno"> 1320</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno"> 1321</span>    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Stable NR Begins !&quot;</span> &lt;&lt; endl &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 1322</span><span class="preprocessor">#endif </span><span class="comment">// DEBUG</span></div>
<div class="line"><span class="lineno"> 1323</span> </div>
<div class="line"><span class="lineno"> 1324</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1325</span>        resSTA[i] = log(fug[Id][i] / (fugSta[i] * Yt));</div>
<div class="line"><span class="lineno"> 1326</span>    }</div>
<div class="line"><span class="lineno"> 1327</span> </div>
<div class="line"><span class="lineno"> 1328</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno"> 1329</span>    <span class="comment">// PrintDX(NC, &amp;resSTA[0]);</span></div>
<div class="line"><span class="lineno"> 1330</span><span class="preprocessor">#endif </span><span class="comment">// DEBUG</span></div>
<div class="line"><span class="lineno"> 1331</span> </div>
<div class="line"><span class="lineno"> 1332</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     maxIt = EoSctrl.NRsta.<a class="code hl_variable" href="classNRparamSTA.html#aaaf5fa953901b9331260f4ff2991ea15">maxIt</a>;</div>
<div class="line"><span class="lineno"> 1333</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Stol  = EoSctrl.NRsta.<a class="code hl_variable" href="classNRparamSTA.html#a50dd883c925b1698481f4ef7c89b2102">tol</a>;</div>
<div class="line"><span class="lineno"> 1334</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Se    = <a class="code hl_function" href="DenseMat_8hpp.html#af68dee47a6d8148b039abaa9620a4642">Dnorm2</a>(NC, &amp;resSTA[0]);</div>
<div class="line"><span class="lineno"> 1335</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> alpha = 1;</div>
<div class="line"><span class="lineno"> 1336</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     iter  = 0;</div>
<div class="line"><span class="lineno"> 1337</span>    <span class="comment">// OCP_DBL Se0   = Se;</span></div>
<div class="line"><span class="lineno"> 1338</span> </div>
<div class="line"><span class="lineno"> 1339</span>    <span class="keywordflow">while</span> (Se &gt; Stol) {</div>
<div class="line"><span class="lineno"> 1340</span> </div>
<div class="line"><span class="lineno"> 1341</span>        <a class="code hl_function" href="classMixtureComp.html#a5d21c453b68aa83741dd4778ae53dbb1">CalFugXSTA</a>();</div>
<div class="line"><span class="lineno"> 1342</span>        AssembleJmatSTA();</div>
<div class="line"><span class="lineno"> 1343</span>        <span class="comment">// LUSolve(1, NC, &amp;JmatSTA[0], &amp;resSTA[0], &amp;pivot[0]);</span></div>
<div class="line"><span class="lineno"> 1344</span>        <a class="code hl_function" href="DenseMat_8hpp.html#a002a44a13631003380d535feab8c5f5e">SYSSolve</a>(1, &amp;uplo, NC, &amp;JmatSTA[0], &amp;resSTA[0], &amp;pivot[0], &amp;JmatWork[0], lJmatWork);</div>
<div class="line"><span class="lineno"> 1345</span>        <a class="code hl_function" href="DenseMat_8hpp.html#a3fb701e3ab34443119b7b2ba7a2bc6c7">Dscalar</a>(NC, Yt, &amp;Y[0]);</div>
<div class="line"><span class="lineno"> 1346</span>        <a class="code hl_function" href="DenseMat_8hpp.html#a5da432e006319d9f82b5da4c0a186c1f">Daxpy</a>(NC, alpha, &amp;resSTA[0], &amp;Y[0]);</div>
<div class="line"><span class="lineno"> 1347</span>        Yt = 0;</div>
<div class="line"><span class="lineno"> 1348</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1349</span>            Yt += Y[i];</div>
<div class="line"><span class="lineno"> 1350</span>        }</div>
<div class="line"><span class="lineno"> 1351</span>        <a class="code hl_function" href="DenseMat_8hpp.html#a3fb701e3ab34443119b7b2ba7a2bc6c7">Dscalar</a>(NC, 1 / Yt, &amp;Y[0]);</div>
<div class="line"><span class="lineno"> 1352</span> </div>
<div class="line"><span class="lineno"> 1353</span>        CalFugPhi(&amp;fugSta[0], &amp;Y[0]);</div>
<div class="line"><span class="lineno"> 1354</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1355</span>            resSTA[i] = log(fug[Id][i] / (fugSta[i] * Yt));</div>
<div class="line"><span class="lineno"> 1356</span>        }</div>
<div class="line"><span class="lineno"> 1357</span>        Se = <a class="code hl_function" href="DenseMat_8hpp.html#af68dee47a6d8148b039abaa9620a4642">Dnorm2</a>(NC, &amp;resSTA[0]);</div>
<div class="line"><span class="lineno"> 1358</span>        iter++;</div>
<div class="line"><span class="lineno"> 1359</span>        <span class="keywordflow">if</span> (iter &gt; maxIt) {</div>
<div class="line"><span class="lineno"> 1360</span>            <span class="comment">// cout &lt;&lt; &quot;---------------&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1361</span>            <span class="comment">// cout &lt;&lt; setprecision(6) &lt;&lt; scientific &lt;&lt; Se0 &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1362</span>            <span class="comment">// cout &lt;&lt; setprecision(6) &lt;&lt; scientific &lt;&lt; Se &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1363</span>            <span class="comment">// cout &lt;&lt; setprecision(6) &lt;&lt; scientific &lt;&lt; Yt &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1364</span>            <span class="comment">// PrintDX(NC, &amp;x[Id][0]);</span></div>
<div class="line"><span class="lineno"> 1365</span>            <span class="comment">// PrintDX(NC, &amp;Y[0]);</span></div>
<div class="line"><span class="lineno"> 1366</span>            <span class="comment">// cout &lt;&lt; &quot;---------------&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1367</span>            EoSctrl.NRsta.<a class="code hl_variable" href="classNRparamSTA.html#aa4f883fb13b40f9f7bcdb2444ae42966">curIt</a> += iter;</div>
<div class="line"><span class="lineno"> 1368</span>            EoSctrl.NRsta.<a class="code hl_variable" href="classNRparamSTA.html#a3acf7b521ae923bea18cb7317773877f">conflag</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1369</span>            EoSctrl.NRsta.<a class="code hl_variable" href="classNRparamSTA.html#a61fadf74bf5639d9fce2d7c256d25ad7">realTol</a> = Se;</div>
<div class="line"><span class="lineno"> 1370</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1371</span>        }</div>
<div class="line"><span class="lineno"> 1372</span> </div>
<div class="line"><span class="lineno"> 1373</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno"> 1374</span>        <span class="comment">// PrintDX(NC, &amp;resSTA[0]);</span></div>
<div class="line"><span class="lineno"> 1375</span><span class="preprocessor">#endif </span><span class="comment">// DEBUG</span></div>
<div class="line"><span class="lineno"> 1376</span>    }</div>
<div class="line"><span class="lineno"> 1377</span>    <span class="comment">// if (iter &gt; 0 &amp;&amp; !isfinite(Se)) {</span></div>
<div class="line"><span class="lineno"> 1378</span>    <span class="comment">//  cout &lt;&lt; &quot;---------------&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1379</span>    <span class="comment">//  cout &lt;&lt; setprecision(6) &lt;&lt; scientific &lt;&lt; Se0 &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1380</span>    <span class="comment">//  cout &lt;&lt; setprecision(6) &lt;&lt; scientific &lt;&lt; Se &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1381</span>    <span class="comment">//  cout &lt;&lt; setprecision(6) &lt;&lt; scientific &lt;&lt; Yt &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1382</span>    <span class="comment">//  PrintDX(NC, &amp;x[Id][0]);</span></div>
<div class="line"><span class="lineno"> 1383</span>    <span class="comment">//  PrintDX(NC, &amp;Y[0]);</span></div>
<div class="line"><span class="lineno"> 1384</span>    <span class="comment">//  cout &lt;&lt; &quot;done!&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1385</span>    <span class="comment">//  cout &lt;&lt; &quot;---------------&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1386</span>    <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 1387</span>    <span class="comment">// if (Yt &gt; 1 + 1E-8 &amp;&amp; iter &gt; 0) {</span></div>
<div class="line"><span class="lineno"> 1388</span>    <span class="comment">//  cout &lt;&lt; setprecision(6) &lt;&lt; scientific &lt;&lt; Se0 &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1389</span>    <span class="comment">//  cout &lt;&lt; setprecision(6) &lt;&lt; scientific &lt;&lt; Se &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1390</span>    <span class="comment">//  PrintDX(NC, &amp;x[Id][0]);</span></div>
<div class="line"><span class="lineno"> 1391</span>    <span class="comment">//  PrintDX(NC, &amp;Y[0]);</span></div>
<div class="line"><span class="lineno"> 1392</span>    <span class="comment">//  cout &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1393</span>    <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 1394</span> </div>
<div class="line"><span class="lineno"> 1395</span>    EoSctrl.NRsta.<a class="code hl_variable" href="classNRparamSTA.html#aa4f883fb13b40f9f7bcdb2444ae42966">curIt</a> += iter;</div>
<div class="line"><span class="lineno"> 1396</span>    EoSctrl.NRsta.<a class="code hl_variable" href="classNRparamSTA.html#a3acf7b521ae923bea18cb7317773877f">conflag</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1397</span>    EoSctrl.NRsta.<a class="code hl_variable" href="classNRparamSTA.html#a61fadf74bf5639d9fce2d7c256d25ad7">realTol</a> = Se;</div>
<div class="line"><span class="lineno"> 1398</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1399</span>}</div>
<div class="ttc" id="aclassMixtureComp_html_a5d21c453b68aa83741dd4778ae53dbb1"><div class="ttname"><a href="classMixtureComp.html#a5d21c453b68aa83741dd4778ae53dbb1">MixtureComp::CalFugXSTA</a></div><div class="ttdeci">void CalFugXSTA()</div><div class="ttdoc">Calculate d ln(Fug) / dx for Y.</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8cpp_source.html#l01401">MixtureComp.cpp:1401</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae28a25d1c0c5a2190a5962a82a10a28d" name="ae28a25d1c0c5a2190a5962a82a10a28d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae28a25d1c0c5a2190a5962a82a10a28d">&#9670;&#160;</a></span>StableSSM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool MixtureComp::StableSSM </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;&#160;</td>
          <td class="paramname"><em>Id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>strict SSM </p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l01218">1218</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1219</span>{</div>
<div class="line"><span class="lineno"> 1220</span>    <span class="comment">// if unsatble, return false</span></div>
<div class="line"><span class="lineno"> 1221</span>    <span class="comment">// if stable, return true </span></div>
<div class="line"><span class="lineno"> 1222</span> </div>
<div class="line"><span class="lineno"> 1223</span> </div>
<div class="line"><span class="lineno"> 1224</span>    <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; xj = x[Id];</div>
<div class="line"><span class="lineno"> 1225</span>    CalFugPhi(phi[Id], fug[Id], xj);</div>
<div class="line"><span class="lineno"> 1226</span>    <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; fugId = fug[Id];</div>
<div class="line"><span class="lineno"> 1227</span> </div>
<div class="line"><span class="lineno"> 1228</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1229</span>        di[i] = phi[Id][i] * xj[i];</div>
<div class="line"><span class="lineno"> 1230</span>    }</div>
<div class="line"><span class="lineno"> 1231</span> </div>
<div class="line"><span class="lineno"> 1232</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Stol  = EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#a65bf34c5fc93f81627061f04196ebb24">tol2</a>;</div>
<div class="line"><span class="lineno"> 1233</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     maxIt = EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#afa9aa64d939ebc09cafa04db1952cebb">maxIt</a>;</div>
<div class="line"><span class="lineno"> 1234</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> eYt   = EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#a35963a0398ba071ce0a6edf969afae88">eYt</a>;</div>
<div class="line"><span class="lineno"> 1235</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Se;</div>
<div class="line"><span class="lineno"> 1236</span>    <span class="keywordtype">bool</span>    flag;</div>
<div class="line"><span class="lineno"> 1237</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     iter;</div>
<div class="line"><span class="lineno"> 1238</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     k;</div>
<div class="line"><span class="lineno"> 1239</span> </div>
<div class="line"><span class="lineno"> 1240</span>    <span class="comment">// cout &lt;&lt; &quot;SSMBEGINS&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1241</span> </div>
<div class="line"><span class="lineno"> 1242</span>    <span class="keywordflow">for</span> (k = 0; k &lt; 4; k++) {</div>
<div class="line"><span class="lineno"> 1243</span> </div>
<div class="line"><span class="lineno"> 1244</span>        Yt = 0;</div>
<div class="line"><span class="lineno"> 1245</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1246</span>            Y[i] = xj[i] / Kw[k][i];</div>
<div class="line"><span class="lineno"> 1247</span>            Yt += Y[i];</div>
<div class="line"><span class="lineno"> 1248</span>        }</div>
<div class="line"><span class="lineno"> 1249</span>        <a class="code hl_function" href="DenseMat_8hpp.html#a3fb701e3ab34443119b7b2ba7a2bc6c7">Dscalar</a>(NC, 1 / Yt, &amp;Y[0]);</div>
<div class="line"><span class="lineno"> 1250</span>        <span class="comment">// CalFugPhi(phiSta, fugSta, Y);</span></div>
<div class="line"><span class="lineno"> 1251</span>        CalFugPhi(&amp;phiSta[0], &amp;fugSta[0], &amp;Y[0]);</div>
<div class="line"><span class="lineno"> 1252</span> </div>
<div class="line"><span class="lineno"> 1253</span>        Se = 0;</div>
<div class="line"><span class="lineno"> 1254</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1255</span>            Se += pow(log(fugSta[i] / fugId[i] * Yt), 2);</div>
<div class="line"><span class="lineno"> 1256</span>        }</div>
<div class="line"><span class="lineno"> 1257</span> </div>
<div class="line"><span class="lineno"> 1258</span>        flag = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1259</span>        iter = 0;</div>
<div class="line"><span class="lineno"> 1260</span> </div>
<div class="line"><span class="lineno"> 1261</span>        <span class="comment">// cout &lt;&lt; &quot;ssmbegins&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1262</span> </div>
<div class="line"><span class="lineno"> 1263</span>        <span class="keywordflow">while</span> (Se &gt; Stol) {</div>
<div class="line"><span class="lineno"> 1264</span> </div>
<div class="line"><span class="lineno"> 1265</span>            <span class="comment">// cout &lt;&lt; setprecision(6) &lt;&lt; scientific &lt;&lt; Se;</span></div>
<div class="line"><span class="lineno"> 1266</span>            <span class="comment">// cout &lt;&lt; &quot;         &quot;;</span></div>
<div class="line"><span class="lineno"> 1267</span>            <span class="comment">// cout &lt;&lt; setprecision(12) &lt;&lt; scientific &lt;&lt; Yt;</span></div>
<div class="line"><span class="lineno"> 1268</span>            <span class="comment">// cout &lt;&lt; &quot;         &quot; &lt;&lt; iter &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 1269</span>            <span class="comment">// PrintDX(NC, &amp;xj[0]);</span></div>
<div class="line"><span class="lineno"> 1270</span>            <span class="comment">// PrintDX(NC, &amp;Y[0]);</span></div>
<div class="line"><span class="lineno"> 1271</span> </div>
<div class="line"><span class="lineno"> 1272</span>            Yt = 0;</div>
<div class="line"><span class="lineno"> 1273</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1274</span>                Y[i] = di[i] / phiSta[i];</div>
<div class="line"><span class="lineno"> 1275</span>                Yt += Y[i];</div>
<div class="line"><span class="lineno"> 1276</span>            }</div>
<div class="line"><span class="lineno"> 1277</span>            <a class="code hl_function" href="DenseMat_8hpp.html#a3fb701e3ab34443119b7b2ba7a2bc6c7">Dscalar</a>(NC, 1 / Yt, &amp;Y[0]);</div>
<div class="line"><span class="lineno"> 1278</span>            <span class="comment">// CalFugPhi(phiSta, fugSta, Y);</span></div>
<div class="line"><span class="lineno"> 1279</span>            CalFugPhi(&amp;phiSta[0], &amp;fugSta[0], &amp;Y[0]);</div>
<div class="line"><span class="lineno"> 1280</span>            Se = 0;</div>
<div class="line"><span class="lineno"> 1281</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1282</span>                Se += pow(log(fugSta[i] / fugId[i] * Yt), 2);</div>
<div class="line"><span class="lineno"> 1283</span>            }</div>
<div class="line"><span class="lineno"> 1284</span> </div>
<div class="line"><span class="lineno"> 1285</span>            iter++;</div>
<div class="line"><span class="lineno"> 1286</span>            <span class="keywordflow">if</span> (iter &gt; maxIt) {</div>
<div class="line"><span class="lineno"> 1287</span>                flag = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1288</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1289</span>            }</div>
<div class="line"><span class="lineno"> 1290</span>        }</div>
<div class="line"><span class="lineno"> 1291</span>        EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#a309251e5bbcbf9c32f32796d14d571c4">curIt</a> += iter;</div>
<div class="line"><span class="lineno"> 1292</span>        flag = StableNR(Id);</div>
<div class="line"><span class="lineno"> 1293</span>        <span class="comment">// here, a relaxation is needed, on the one hand it can prevent the influence</span></div>
<div class="line"><span class="lineno"> 1294</span>        <span class="comment">// of rounding error, on the other hand, if Yt is too close to 1, phase</span></div>
<div class="line"><span class="lineno"> 1295</span>        <span class="comment">// splitting calculation may get into trouble and single phase is indentified</span></div>
<div class="line"><span class="lineno"> 1296</span>        <span class="comment">// finally</span></div>
<div class="line"><span class="lineno"> 1297</span>        <span class="keywordflow">if</span> (flag &amp;&amp; Yt &gt; 1 + eYt) {</div>
<div class="line"><span class="lineno"> 1298</span>            <span class="comment">// cout &lt;&lt; &quot;Yt = &quot; &lt;&lt; setprecision(12) &lt;&lt; scientific &lt;&lt; Yt &lt;&lt; &quot;    &quot; &lt;&lt;</span></div>
<div class="line"><span class="lineno"> 1299</span>            <span class="comment">// setw(3)</span></div>
<div class="line"><span class="lineno"> 1300</span>            <span class="comment">//     &lt;&lt; EoSctrl.SSMsta.curIt &lt;&lt; &quot;    &quot; &lt;&lt; setw(3) &lt;&lt; EoSctrl.NRsta.curIt</span></div>
<div class="line"><span class="lineno"> 1301</span>            <span class="comment">//     &lt;&lt; &quot;   &quot; &lt;&lt; flag &lt;&lt; &quot;   &quot; &lt;&lt; k &lt;&lt; &quot;   &quot; &lt;&lt; 2 &lt;&lt; &quot;   &quot;;</span></div>
<div class="line"><span class="lineno"> 1302</span>            EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#a8edb30773a4bf5767ba6020519277d7b">conflag</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1303</span>            EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#a17207f8db073cbeeb39cf6900c5127c9">realTol</a> = sqrt(Se);</div>
<div class="line"><span class="lineno"> 1304</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1305</span>        }</div>
<div class="line"><span class="lineno"> 1306</span>    }</div>
<div class="line"><span class="lineno"> 1307</span>    <span class="comment">// cout &lt;&lt; &quot;Yt = &quot; &lt;&lt; setprecision(12) &lt;&lt; scientific &lt;&lt; Yt &lt;&lt; &quot;    &quot; &lt;&lt; setw(3)</span></div>
<div class="line"><span class="lineno"> 1308</span>    <span class="comment">//     &lt;&lt; EoSctrl.SSMsta.curIt &lt;&lt; &quot;    &quot; &lt;&lt; setw(3) &lt;&lt; EoSctrl.NRsta.curIt &lt;&lt; &quot;   &quot;</span></div>
<div class="line"><span class="lineno"> 1309</span>    <span class="comment">//     &lt;&lt; flag &lt;&lt; &quot;   &quot; &lt;&lt; k &lt;&lt; &quot;   &quot; &lt;&lt; 1 &lt;&lt; &quot;   &quot;;</span></div>
<div class="line"><span class="lineno"> 1310</span>    <span class="comment">/*if (!flag) {</span></div>
<div class="line"><span class="lineno"> 1311</span><span class="comment">        OCP_WARNING(&quot;SSM not converged in Stability Analysis&quot;);</span></div>
<div class="line"><span class="lineno"> 1312</span><span class="comment">    }*/</span></div>
<div class="line"><span class="lineno"> 1313</span>    EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#a17207f8db073cbeeb39cf6900c5127c9">realTol</a> = sqrt(Se);</div>
<div class="line"><span class="lineno"> 1314</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1315</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="MixtureComp_8hpp_source.html#l00038">SSMparamSTA::conflag</a>, <a class="el" href="MixtureComp_8hpp_source.html#l00040">SSMparamSTA::curIt</a>, <a class="el" href="DenseMat_8cpp_source.html#l00062">Dscalar()</a>, <a class="el" href="MixtureComp_8hpp_source.html#l00035">SSMparamSTA::eYt</a>, <a class="el" href="MixtureComp_8hpp_source.html#l00031">SSMparamSTA::maxIt</a>, <a class="el" href="MixtureComp_8hpp_source.html#l00037">SSMparamSTA::realTol</a>, and <a class="el" href="MixtureComp_8hpp_source.html#l00036">SSMparamSTA::tol2</a>.</p>

</div>
</div>
<a id="a16d6930ae2115d9dfc3f627580cd3605" name="a16d6930ae2115d9dfc3f627580cd3605"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16d6930ae2115d9dfc3f627580cd3605">&#9670;&#160;</a></span>StableSSM01()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool MixtureComp::StableSSM01 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> &amp;&#160;</td>
          <td class="paramname"><em>Id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>relaxable SSM </p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l01119">1119</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1120</span>{</div>
<div class="line"><span class="lineno"> 1121</span>    <span class="comment">// if unsatble, return false</span></div>
<div class="line"><span class="lineno"> 1122</span>    <span class="comment">// if stable, return true </span></div>
<div class="line"><span class="lineno"> 1123</span> </div>
<div class="line"><span class="lineno"> 1124</span> </div>
<div class="line"><span class="lineno"> 1125</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Stol  = EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#a65bf34c5fc93f81627061f04196ebb24">tol2</a>;</div>
<div class="line"><span class="lineno"> 1126</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     maxIt = EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#afa9aa64d939ebc09cafa04db1952cebb">maxIt</a>;</div>
<div class="line"><span class="lineno"> 1127</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> eYt   = EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#a35963a0398ba071ce0a6edf969afae88">eYt</a>;</div>
<div class="line"><span class="lineno"> 1128</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Ktol  = EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#a56f7daf204765c65250a6d2647cba5b1">Ktol</a>;</div>
<div class="line"><span class="lineno"> 1129</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> dYtol = EoSctrl.SSMsta.dYtol;</div>
<div class="line"><span class="lineno"> 1130</span>    <span class="comment">// OCP_DBL&amp; Sk = EoSctrl.SSMsta.curSk;</span></div>
<div class="line"><span class="lineno"> 1131</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Se, Sk, dY;</div>
<div class="line"><span class="lineno"> 1132</span> </div>
<div class="line"><span class="lineno"> 1133</span>    <span class="keywordtype">bool</span>    flag, Tsol; <span class="comment">// Tsol, trivial solution</span></div>
<div class="line"><span class="lineno"> 1134</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     iter, k;</div>
<div class="line"><span class="lineno"> 1135</span> </div>
<div class="line"><span class="lineno"> 1136</span>    <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; xj = x[Id];</div>
<div class="line"><span class="lineno"> 1137</span>    CalFugPhi(phi[Id], fug[Id], xj);</div>
<div class="line"><span class="lineno"> 1138</span>    <span class="keyword">const</span> vector&lt;OCP_DBL&gt;&amp; fugId = fug[Id];</div>
<div class="line"><span class="lineno"> 1139</span>    vector&lt;OCP_DBL&gt;&amp;       ks    = Ks[0];</div>
<div class="line"><span class="lineno"> 1140</span> </div>
<div class="line"><span class="lineno"> 1141</span>    <span class="keywordflow">for</span> (k = 0; k &lt; 2; k++) {</div>
<div class="line"><span class="lineno"> 1142</span> </div>
<div class="line"><span class="lineno"> 1143</span>        ks   = Kw[k];</div>
<div class="line"><span class="lineno"> 1144</span>        iter = 0;</div>
<div class="line"><span class="lineno"> 1145</span>        flag = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1146</span>        Tsol = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1147</span>        <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 1148</span>            Yt = 0;</div>
<div class="line"><span class="lineno"> 1149</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1150</span>                Y[i] = xj[i] * ks[i];</div>
<div class="line"><span class="lineno"> 1151</span>                Yt += Y[i];</div>
<div class="line"><span class="lineno"> 1152</span>            }</div>
<div class="line"><span class="lineno"> 1153</span>            <a class="code hl_function" href="DenseMat_8hpp.html#a3fb701e3ab34443119b7b2ba7a2bc6c7">Dscalar</a>(NC, 1 / Yt, &amp;Y[0]);</div>
<div class="line"><span class="lineno"> 1154</span> </div>
<div class="line"><span class="lineno"> 1155</span>            <span class="keywordflow">if</span> (iter &gt; 0) {</div>
<div class="line"><span class="lineno"> 1156</span>                dY = 0;</div>
<div class="line"><span class="lineno"> 1157</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1158</span>                    dY += pow((Y[i] - di[i]), 2);</div>
<div class="line"><span class="lineno"> 1159</span>                }</div>
<div class="line"><span class="lineno"> 1160</span>                <span class="keywordflow">if</span> (dY &lt; dYtol) {</div>
<div class="line"><span class="lineno"> 1161</span>                    <span class="comment">// converges</span></div>
<div class="line"><span class="lineno"> 1162</span>                    flag = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1163</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1164</span>                }</div>
<div class="line"><span class="lineno"> 1165</span>            }</div>
<div class="line"><span class="lineno"> 1166</span> </div>
<div class="line"><span class="lineno"> 1167</span>            CalFugPhi(&amp;fugSta[0], &amp;Y[0]);</div>
<div class="line"><span class="lineno"> 1168</span>            Se = 0;</div>
<div class="line"><span class="lineno"> 1169</span>            Sk = 0;</div>
<div class="line"><span class="lineno"> 1170</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1171</span>                di[i] = fugId[i] / (fugSta[i] * Yt);</div>
<div class="line"><span class="lineno"> 1172</span>                ks[i] *= di[i];</div>
<div class="line"><span class="lineno"> 1173</span>                Se += pow(di[i] - 1, 2);</div>
<div class="line"><span class="lineno"> 1174</span>                <span class="comment">// Sk += pow(ks[i] - 1, 2);</span></div>
<div class="line"><span class="lineno"> 1175</span>                Sk += pow(log(ks[i]), 2);</div>
<div class="line"><span class="lineno"> 1176</span>            }</div>
<div class="line"><span class="lineno"> 1177</span> </div>
<div class="line"><span class="lineno"> 1178</span>            iter++;</div>
<div class="line"><span class="lineno"> 1179</span>            <span class="keywordflow">if</span> (Se &lt; Stol) {</div>
<div class="line"><span class="lineno"> 1180</span>                flag = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1181</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1182</span>            }</div>
<div class="line"><span class="lineno"> 1183</span>            <span class="keywordflow">if</span> (Sk &lt; Ktol) {</div>
<div class="line"><span class="lineno"> 1184</span>                <span class="comment">// Sk &lt; Ktol -&gt; trivial solution</span></div>
<div class="line"><span class="lineno"> 1185</span>                flag = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1186</span>                Tsol = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1187</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1188</span>            }</div>
<div class="line"><span class="lineno"> 1189</span>            <span class="keywordflow">if</span> (iter &gt; maxIt) {</div>
<div class="line"><span class="lineno"> 1190</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1191</span>            }</div>
<div class="line"><span class="lineno"> 1192</span> </div>
<div class="line"><span class="lineno"> 1193</span>            <span class="comment">// Record last Y with di</span></div>
<div class="line"><span class="lineno"> 1194</span>            di = Y;</div>
<div class="line"><span class="lineno"> 1195</span>        }</div>
<div class="line"><span class="lineno"> 1196</span>        <span class="comment">// if (!Tsol) {</span></div>
<div class="line"><span class="lineno"> 1197</span>        <span class="comment">// flag = StableNR(Id);</span></div>
<div class="line"><span class="lineno"> 1198</span>        <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 1199</span>        <span class="comment">//cout &lt;&lt; &quot;Yt = &quot; &lt;&lt; setprecision(8) &lt;&lt; scientific &lt;&lt; Yt &lt;&lt; &quot;   &quot; &lt;&lt; setw(2)</span></div>
<div class="line"><span class="lineno"> 1200</span>        <span class="comment">//    &lt;&lt; &quot;Sk = &quot; &lt;&lt; setprecision(3) &lt;&lt; scientific &lt;&lt; Sk &lt;&lt; &quot;   &quot; &lt;&lt; setw(2)</span></div>
<div class="line"><span class="lineno"> 1201</span>        <span class="comment">//    &lt;&lt; iter &lt;&lt; &quot;  &quot;;</span></div>
<div class="line"><span class="lineno"> 1202</span>        EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#a309251e5bbcbf9c32f32796d14d571c4">curIt</a> += iter;</div>
<div class="line"><span class="lineno"> 1203</span> </div>
<div class="line"><span class="lineno"> 1204</span>        <span class="keywordflow">if</span> (flag &amp;&amp; Yt &gt; 1 - 0.1 &amp;&amp; Sk &gt; 1) {</div>
<div class="line"><span class="lineno"> 1205</span>            <span class="comment">// close to phase boundary, or more than 1 phase, So don&#39;t skip at next step</span></div>
<div class="line"><span class="lineno"> 1206</span>            flagSkip = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1207</span>        }</div>
<div class="line"><span class="lineno"> 1208</span>        <span class="keywordflow">if</span> (flag &amp;&amp; Yt &gt; 1 + eYt) {</div>
<div class="line"><span class="lineno"> 1209</span>            EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#a8edb30773a4bf5767ba6020519277d7b">conflag</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1210</span>            EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#a17207f8db073cbeeb39cf6900c5127c9">realTol</a> = sqrt(Se);</div>
<div class="line"><span class="lineno"> 1211</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1212</span>        }</div>
<div class="line"><span class="lineno"> 1213</span>    }</div>
<div class="line"><span class="lineno"> 1214</span>    EoSctrl.SSMsta.<a class="code hl_variable" href="classSSMparamSTA.html#a17207f8db073cbeeb39cf6900c5127c9">realTol</a> = sqrt(Se);</div>
<div class="line"><span class="lineno"> 1215</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1216</span>}</div>
<div class="ttc" id="aclassSSMparamSTA_html_a56f7daf204765c65250a6d2647cba5b1"><div class="ttname"><a href="classSSMparamSTA.html#a56f7daf204765c65250a6d2647cba5b1">SSMparamSTA::Ktol</a></div><div class="ttdeci">OCP_DBL Ktol</div><div class="ttdoc">tolerace^2 for K</div><div class="ttdef"><b>Definition:</b> <a href="MixtureComp_8hpp_source.html#l00033">MixtureComp.hpp:33</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="MixtureComp_8hpp_source.html#l00038">SSMparamSTA::conflag</a>, <a class="el" href="MixtureComp_8hpp_source.html#l00040">SSMparamSTA::curIt</a>, <a class="el" href="DenseMat_8cpp_source.html#l00062">Dscalar()</a>, <a class="el" href="MixtureComp_8hpp_source.html#l00035">SSMparamSTA::eYt</a>, <a class="el" href="MixtureComp_8hpp_source.html#l00033">SSMparamSTA::Ktol</a>, <a class="el" href="MixtureComp_8hpp_source.html#l00031">SSMparamSTA::maxIt</a>, <a class="el" href="MixtureComp_8hpp_source.html#l00037">SSMparamSTA::realTol</a>, and <a class="el" href="MixtureComp_8hpp_source.html#l00036">SSMparamSTA::tol2</a>.</p>

</div>
</div>
<a id="a9c06637490fc903d9a0bd12c053b93b8" name="a9c06637490fc903d9a0bd12c053b93b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c06637490fc903d9a0bd12c053b93b8">&#9670;&#160;</a></span>UpdateXRR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::UpdateXRR </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update X according to RR. </p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l01729">1729</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1730</span>{</div>
<div class="line"><span class="lineno"> 1731</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp = 0;</div>
<div class="line"><span class="lineno"> 1732</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno"> 1733</span>        tmp = 1;</div>
<div class="line"><span class="lineno"> 1734</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP - 1; j++) {</div>
<div class="line"><span class="lineno"> 1735</span>            tmp += nu[j] * (Ks[j][i] - 1);</div>
<div class="line"><span class="lineno"> 1736</span>        }</div>
<div class="line"><span class="lineno"> 1737</span>        x[NP - 1][i] = zi[i] / tmp;</div>
<div class="line"><span class="lineno"> 1738</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP - 1; j++) {</div>
<div class="line"><span class="lineno"> 1739</span>            x[j][i] = Ks[j][i] * x[NP - 1][i];</div>
<div class="line"><span class="lineno"> 1740</span>        }</div>
<div class="line"><span class="lineno"> 1741</span>    }</div>
<div class="line"><span class="lineno"> 1742</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af3de24acaa27101e5dfe6f6b47946fe1" name="af3de24acaa27101e5dfe6f6b47946fe1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3de24acaa27101e5dfe6f6b47946fe1">&#9670;&#160;</a></span>x2n()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MixtureComp::x2n </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>x[j][i] -&gt; n[j][i] </p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00907">907</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  908</span>{</div>
<div class="line"><span class="lineno">  909</span>    <span class="comment">// Total moles are supposed to be 1</span></div>
<div class="line"><span class="lineno">  910</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; NP; j++) {</div>
<div class="line"><span class="lineno">  911</span> </div>
<div class="line"><span class="lineno">  912</span>        <span class="comment">// nu[j] = fabs(nu[j]);</span></div>
<div class="line"><span class="lineno">  913</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno">  914</span>            n[j][i] = nu[j] * x[j][i];</div>
<div class="line"><span class="lineno">  915</span>        }</div>
<div class="line"><span class="lineno">  916</span>    }</div>
<div class="line"><span class="lineno">  917</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad5be09d1c319768b761bcf6427bc8535" name="ad5be09d1c319768b761bcf6427bc8535"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5be09d1c319768b761bcf6427bc8535">&#9670;&#160;</a></span>XiPhase()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> MixtureComp::XiPhase </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>Pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>Tin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> *&#160;</td>
          <td class="paramname"><em>Ziin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Return molar density of phase, it's used to calculate the molar density of injection fluids in injection wells. </p>

<p>Implements <a class="el" href="classMixture.html#aac4ca8c6f7eeddb4b51ef075f49ec6bb">Mixture</a>.</p>

<p class="definition">Definition at line <a class="el" href="MixtureComp_8cpp_source.html#l00487">487</a> of file <a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  489</span>{</div>
<div class="line"><span class="lineno">  490</span>    <span class="comment">// assume that only single phase exists here</span></div>
<div class="line"><span class="lineno">  491</span>    <span class="keywordflow">if</span> (Ziin[<a class="code hl_variable" href="classMixture.html#a13babfd95b6ec1687fb5e479e5a01707">numCom</a> - 1] &gt; 1 - 1e-6) {</div>
<div class="line"><span class="lineno">  492</span>        <span class="comment">// water phase</span></div>
<div class="line"><span class="lineno">  493</span>        PVTW.<a class="code hl_function" href="classOCPTable.html#a047b61a09961d8a5015ba8b071320b7b">Eval_All</a>(0, Pin, data, cdata);</div>
<div class="line"><span class="lineno">  494</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pw0   = data[0];</div>
<div class="line"><span class="lineno">  495</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> bw0   = data[1];</div>
<div class="line"><span class="lineno">  496</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> cbw   = data[2];</div>
<div class="line"><span class="lineno">  497</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> bw    = bw0 * (1 - cbw * (P - Pw0));</div>
<div class="line"><span class="lineno">  498</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> xitmp = 1 / (<a class="code hl_variable" href="OCPConst_8hpp.html#a2d05bd9d04bf54565f5192d547dd415f">CONV1</a> * bw);</div>
<div class="line"><span class="lineno">  499</span>        <span class="keywordflow">return</span> xitmp;</div>
<div class="line"><span class="lineno">  500</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  501</span>        <span class="comment">// hydrocarbon phase</span></div>
<div class="line"><span class="lineno">  502</span>        setPT(Pin, Tin);</div>
<div class="line"><span class="lineno">  503</span>        setZi(Ziin);</div>
<div class="line"><span class="lineno">  504</span>        NP = 1;</div>
<div class="line"><span class="lineno">  505</span>        CalAiBi();</div>
<div class="line"><span class="lineno">  506</span>        CalAjBj(Aj[0], Bj[0], zi);</div>
<div class="line"><span class="lineno">  507</span>        SolEoS(Zj[0], Aj[0], Bj[0]);</div>
<div class="line"><span class="lineno">  508</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> vtmp = Zj[0] * <a class="code hl_variable" href="OCPConst_8hpp.html#acf2d5c7d361941d6394ac1c9dc3e5628">GAS_CONSTANT</a> * T / P;</div>
<div class="line"><span class="lineno">  509</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; NC; i++) {</div>
<div class="line"><span class="lineno">  510</span>            vtmp -= zi[i] * Vshift[i];</div>
<div class="line"><span class="lineno">  511</span>        }</div>
<div class="line"><span class="lineno">  512</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> xitmp = 1 / vtmp;</div>
<div class="line"><span class="lineno">  513</span>        <span class="keywordflow">return</span> xitmp;</div>
<div class="line"><span class="lineno">  514</span>    }</div>
<div class="line"><span class="lineno">  515</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="OCPConst_8hpp_source.html#l00059">CONV1</a>, <a class="el" href="OCPTable_8cpp_source.html#l00046">OCPTable::Eval_All()</a>, <a class="el" href="OCPConst_8hpp_source.html#l00035">GAS_CONSTANT</a>, and <a class="el" href="Mixture_8hpp_source.html#l00145">Mixture::numCom</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="MixtureComp_8hpp_source.html">MixtureComp.hpp</a></li>
<li><a class="el" href="MixtureComp_8cpp_source.html">MixtureComp.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Sep 21 2022 21:22:45 for OpenCAEPoro by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
